#!/usr/bin/env python3
import base64
exec(base64.b64decode('ZnJvbSBkb3RlbnYgaW1wb3J0IGxvYWRfZG90ZW52CmxvYWRfZG90ZW52KCkKCmltcG9ydCBzeXMsIGpzb24sIHJhbmRvbQpmcm9tIGRhdGV0aW1lIGltcG9ydCBkYXRldGltZQpmcm9tIGFwcDMuY29uZmlnLmltcG9ydHMgaW1wb3J0ICoKZnJvbSBhcHAzLm1lbnVzLnV0aWwgaW1wb3J0IGNsZWFyX3NjcmVlbngKZnJvbSBhcHAzLm1lbnVzLnNoYXJpbmcgaW1wb3J0IHNob3dfYmFsYW5jZV9hbGxvdG1lbnRfbWVudQoKCmRlZiBzaG93X21haW5fbWVudShwcm9maWxlOiBkaWN0LCBkaXNwbGF5X3F1b3RhOiBzdHIsIHNlZ21lbnRzOiBkaWN0KToKICAgIGNsZWFyX3NjcmVlbngoKQogICAgdGhlbWUgPSBnZXRfdGhlbWUoKQoKICAgIGV4cGlyZWRfYXRfdHMgPSBwcm9maWxlLmdldCgiYmFsYW5jZV9leHBpcmVkX2F0IikKICAgIGV4cGlyZWRfYXRfZHQgPSBkYXRldGltZS5mcm9tdGltZXN0YW1wKGV4cGlyZWRfYXRfdHMpLnN0cmZ0aW1lKCIlWS0lbS0lZCAlSDolTTolUyIpIGlmIGV4cGlyZWRfYXRfdHMgZWxzZSAiLSIKICAgIHB1bHNhX3N0ciA9IGdldF9ydXBpYWgocHJvZmlsZS5nZXQoImJhbGFuY2UiLCAwKSkKCiAgICBpbmZvX3RhYmxlID0gVGFibGUuZ3JpZChwYWRkaW5nPSgwLCAxKSkKICAgIGluZm9fdGFibGUuYWRkX2NvbHVtbihqdXN0aWZ5PSJsZWZ0Iiwgc3R5bGU9Z2V0X3RoZW1lX3N0eWxlKCJib3JkZXJfaW5mbyIpKQogICAgaW5mb190YWJsZS5hZGRfY29sdW1uKGp1c3RpZnk9ImxlZnQiLCBzdHlsZT1nZXRfdGhlbWVfc3R5bGUoInRleHRfYm9keSIpKQoKICAgIGluZm9fdGFibGUuYWRkX3JvdygiIE5vbW9yIiwgZiI6IPCfk54gW2JvbGQge3RoZW1lWyd0ZXh0X2JvZHknXX1de3Byb2ZpbGVbJ251bWJlciddfVsvXSIpCiAgICBpbmZvX3RhYmxlLmFkZF9yb3coIiBUeXBlIiwgZiI6IPCfp74gW3t0aGVtZVsndGV4dF9ib2R5J119XXtwcm9maWxlWydzdWJzY3JpcHRpb25fdHlwZSddfSAoe3Byb2ZpbGVbJ3N1YnNjcmliZXJfaWQnXX0pWy9dIikKICAgIGluZm9fdGFibGUuYWRkX3JvdygiIFB1bHNhIiwgZiI6IPCfkrAgUnAgW3t0aGVtZVsndGV4dF9tb25leSddfV17cHVsc2Ffc3RyfVsvXSIpCiAgICBpbmZvX3RhYmxlLmFkZF9yb3coIiBLdW90YSIsIGYiOiDwn5OKIFt7dGhlbWVbJ3RleHRfZGF0ZSddfV17ZGlzcGxheV9xdW90YX1bL10iKQogICAgaW5mb190YWJsZS5hZGRfcm93KCIgVGllcmluZyIsIGYiOiDwn4+FIFt7dGhlbWVbJ3RleHRfZGF0ZSddfV17cHJvZmlsZVsncG9pbnRfaW5mbyddfVsvXSIpCiAgICBpbmZvX3RhYmxlLmFkZF9yb3coIiBNYXNhIEFrdGlmIiwgZiI6IOKPsyBbe3RoZW1lWyd0ZXh0X2RhdGUnXX1de2V4cGlyZWRfYXRfZHR9Wy9dIikKCiAgICBjb25zb2xlLnByaW50KAogICAgICAgIFBhbmVsKAogICAgICAgICAgICBpbmZvX3RhYmxlLAogICAgICAgICAgICB0aXRsZT1mIlt7Z2V0X3RoZW1lX3N0eWxlKCd0ZXh0X3RpdGxlJyl9XVsgSW5mb3JtYXNpIEFrdW4gXVsvXSIsCiAgICAgICAgICAgIHRpdGxlX2FsaWduPSJjZW50ZXIiLAogICAgICAgICAgICBib3JkZXJfc3R5bGU9Z2V0X3RoZW1lX3N0eWxlKCJib3JkZXJfaW5mbyIpLAogICAgICAgICAgICBwYWRkaW5nPSgxLCAyKSwKICAgICAgICAgICAgZXhwYW5kPVRydWUsCiAgICAgICAgKQogICAgKQoKICAgIHNwZWNpYWxfcGFja2FnZXMgPSBzZWdtZW50cy5nZXQoInNwZWNpYWxfcGFja2FnZXMiLCBbXSkKICAgIGlmIHNwZWNpYWxfcGFja2FnZXM6CiAgICAgICAgYmVzdCA9IHJhbmRvbS5jaG9pY2Uoc3BlY2lhbF9wYWNrYWdlcykKICAgICAgICBuYW1lID0gYmVzdC5nZXQoIm5hbWUiLCAiLSIpCiAgICAgICAgZGlza29uX3BlcmNlbnQgPSBiZXN0LmdldCgiZGlza29uX3BlcmNlbnQiLCAwKQogICAgICAgIGRpc2tvbl9wcmljZSA9IGJlc3QuZ2V0KCJkaXNrb25fcHJpY2UiLCAwKQogICAgICAgIG9yaWdpbmFsX3ByaWNlID0gYmVzdC5nZXQoIm9yaWdpbmFsX3ByaWNlIiwgMCkKICAgICAgICBlbW9qaV9kaXNrb24gPSAi8J+SuCIgaWYgZGlza29uX3BlcmNlbnQgPj0gNTAgZWxzZSAiIgogICAgICAgIGVtb2ppX2t1b3RhID0gIvCflKUiIGlmIGJlc3QuZ2V0KCJrdW90YV9nYiIsIDApID49IDEwMCBlbHNlICIiCgogICAgICAgIHNwZWNpYWxfdGV4dCA9ICgKICAgICAgICAgICAgZiJbYm9sZCB7dGhlbWVbJ3RleHRfdGl0bGUnXX1d8J+UpfCflKXwn5SlIFBha2V0IFNwZWNpYWwgQnVhdCBMbyEg8J+UpfCflKXwn5SlWy97dGhlbWVbJ3RleHRfdGl0bGUnXX1dXG5cbiIKICAgICAgICAgICAgZiJbe3RoZW1lWyd0ZXh0X2JvZHknXX1de2Vtb2ppX2t1b3RhfSB7bmFtZX1bL3t0aGVtZVsndGV4dF9ib2R5J119XVxuIgogICAgICAgICAgICBmIkRpc2tvbiB7ZGlza29uX3BlcmNlbnR9JSB7ZW1vamlfZGlza29ufSAiCiAgICAgICAgICAgIGYiUnBbe3RoZW1lWyd0ZXh0X2VyciddfV1bc3RyaWtlXXtnZXRfcnVwaWFoKG9yaWdpbmFsX3ByaWNlKX1bL3N0cmlrZV1bL3t0aGVtZVsndGV4dF9lcnInXX1dIOKeoe+4jyAiCiAgICAgICAgICAgIGYiUnBbe3RoZW1lWyd0ZXh0X21vbmV5J119XXtnZXRfcnVwaWFoKGRpc2tvbl9wcmljZSl9Wy97dGhlbWVbJ3RleHRfbW9uZXknXX1dIgogICAgICAgICkKCiAgICAgICAgY29uc29sZS5wcmludCgKICAgICAgICAgICAgUGFuZWwoCiAgICAgICAgICAgICAgICBBbGlnbi5jZW50ZXIoc3BlY2lhbF90ZXh0KSwKICAgICAgICAgICAgICAgIGJvcmRlcl9zdHlsZT10aGVtZVsiYm9yZGVyX3dhcm5pbmciXSwKICAgICAgICAgICAgICAgIHBhZGRpbmc9KDAsIDIpLAogICAgICAgICAgICAgICAgd2lkdGg9Y29uc29sZS5zaXplLndpZHRoLAogICAgICAgICAgICApCiAgICAgICAgKQogICAgICAgIGNvbnNvbGUucHJpbnQoQWxpZ24uY2VudGVyKGYiW3t0aGVtZVsndGV4dF9zdWInXX1dUGlsaWggW1ldIGJ1YXQgbGloYXQgc2VtdWEgcGFrZXQgc3BlY2lhbFsve3RoZW1lWyd0ZXh0X3N1YiddfV0iKSkKCiAgICBtZW51X3RhYmxlID0gVGFibGUoc2hvd19oZWFkZXI9RmFsc2UsIGJveD1NSU5JTUFMX0RPVUJMRV9IRUFELCBleHBhbmQ9VHJ1ZSkKICAgIG1lbnVfdGFibGUuYWRkX2NvbHVtbigiS29kZSIsIGp1c3RpZnk9InJpZ2h0Iiwgc3R5bGU9Z2V0X3RoZW1lX3N0eWxlKCJ0ZXh0X2tleSIpLCB3aWR0aD02KQogICAgbWVudV90YWJsZS5hZGRfY29sdW1uKCJBa3NpIiwgc3R5bGU9Z2V0X3RoZW1lX3N0eWxlKCJ0ZXh0X2JvZHkiKSkKCiAgICBtZW51X3RhYmxlLmFkZF9yb3coIjEiLCAi8J+UkCBMb2dpbiAvIEdhbnRpIGFrdW4iKQogICAgbWVudV90YWJsZS5hZGRfcm93KCIyIiwgIvCfk5EgTGloYXQgcGFrZXQgYWt0aWYiKQogICAgbWVudV90YWJsZS5hZGRfcm93KCIzIiwgIvCfk5wgUml3YXlhdCBUcmFuc2Frc2kiKQogICAgbWVudV90YWJsZS5hZGRfcm93KCI0IiwgIvCflKUgQmVsaSBwYWtldCBIb3QgcHJvbW8iKQogICAgbWVudV90YWJsZS5hZGRfcm93KCI1IiwgIvCflKUgQmVsaSBwYWtldCBIb3QgcHJvbW8tMiIpCiAgICBtZW51X3RhYmxlLmFkZF9yb3coIjYiLCAi8J+StCBCZWxpIHBha2V0IHZpYSBPcHRpb24gQ29kZSIpCiAgICBtZW51X3RhYmxlLmFkZF9yb3coIjciLCAi8J+StSBCZWxpIHBha2V0IHZpYSBGYW1pbHkgQ29kZSIpCiAgICBtZW51X3RhYmxlLmFkZF9yb3coIjgiLCAi8J+UgSBCb3Jvbmcgc2VtdWEgcGFrZXQgZGkgRmFtaWx5IENvZGUiKQogICAgbWVudV90YWJsZS5hZGRfcm93KCI5IiwgIvCflIIgQXV0byBMb29wIHRhcmdldCBQYWtldCBieSBGYW1pbHkiKQogICAgbWVudV90YWJsZS5hZGRfcm93KCIiLCAiIikKICAgIG1lbnVfdGFibGUuYWRkX3JvdygiW0RdIiwgIvCfjq0gQmlraW4gYnVuZGxlIHBha2V0IGFsYSBkZWNveSIpCiAgICBtZW51X3RhYmxlLmFkZF9yb3coIltGXSIsICLwn5K+IFNhdmUvS2Vsb2xhIEZhbWlseSBDb2RlIGxvIikKICAgIG1lbnVfdGFibGUuYWRkX3JvdygiW0JdIiwgIvCfk4wgQm9va21hcmsgcGFrZXQgZmF2b3JpdCIpCiAgICBtZW51X3RhYmxlLmFkZF9yb3coIltDXSIsIGYiW3t0aGVtZVsndGV4dF9ib2R5J119XfCfp7kgQmVyc2loaW4gY2FjaGUgYWt1blsvXSIpCiAgICBtZW51X3RhYmxlLmFkZF9yb3coIltNXSIsIGYiW3t0aGVtZVsndGV4dF9ib2R5J119XeKYlSBMYW5qdXQga2UgbWVudSBiZXJpa3V0bnlhLi4uWy9dIikKICAgIG1lbnVfdGFibGUuYWRkX3JvdygiIiwgIiIpCiAgICBtZW51X3RhYmxlLmFkZF9yb3coIjY2IiwgZiJbe3RoZW1lWydib3JkZXJfd2FybmluZyddfV3wn5OiIEluZm8ga29kZSB1bmxvY2sgYWt1blsvXSIpCiAgICBtZW51X3RhYmxlLmFkZF9yb3coIjY5IiwgZiJbe3RoZW1lWyd0ZXh0X3N1YiddfV3wn46oIEdhbnRpIHRlbWEgQ0xJIGJpYXIga2VjZVsvXSIpCiAgICBtZW51X3RhYmxlLmFkZF9yb3coIjk5IiwgZiJbe3RoZW1lWyd0ZXh0X2VyciddfV3im5QgQ2FidXQgLyBUdXR1cCBhcGxpa2FzaVsvXSIpCgogICAgY29uc29sZS5wcmludCgKICAgICAgICBQYW5lbCgKICAgICAgICAgICAgbWVudV90YWJsZSwKICAgICAgICAgICAgdGl0bGU9ZiJbe2dldF90aGVtZV9zdHlsZSgndGV4dF90aXRsZScpfV3inKggTWVudSBVdGFtYSDinKhbL10iLAogICAgICAgICAgICB0aXRsZV9hbGlnbj0iY2VudGVyIiwKICAgICAgICAgICAgYm9yZGVyX3N0eWxlPWdldF90aGVtZV9zdHlsZSgiYm9yZGVyX3ByaW1hcnkiKSwKICAgICAgICAgICAgcGFkZGluZz0oMCwgMSksCiAgICAgICAgICAgIGV4cGFuZD1UcnVlLAogICAgICAgICkKICAgICkKCgpkZWYgc2hvd19tYWluX21lbnUyKGFjdGl2ZV91c2VyOiBkaWN0LCBwcm9maWxlOiBkaWN0KToKICAgIHRoZW1lID0gZ2V0X3RoZW1lKCkKCiAgICBpZiBub3QgYWN0aXZlX3VzZXIgb3IgInRva2VucyIgbm90IGluIGFjdGl2ZV91c2VyOgogICAgICAgIHByaW50X3BhbmVsKCLimqDvuI8gVXBzIiwgIlVzZXIgYmVsdW0gYWt0aWYgYnJvLCBsb2dpbiBkdWx1IPCfmqgiKQogICAgICAgIHBhdXNlKCkKICAgICAgICByZXR1cm4KCiAgICB3aGlsZSBUcnVlOgogICAgICAgIGNsZWFyX3NjcmVlbngoKQoKICAgICAgICBjb25zb2xlLnByaW50KFBhbmVsKAogICAgICAgICAgICBBbGlnbi5jZW50ZXIoIuKYlSBIYWxhbWFuIE1lbnUtMiIsIHZlcnRpY2FsPSJtaWRkbGUiKSwKICAgICAgICAgICAgYm9yZGVyX3N0eWxlPXRoZW1lWyJib3JkZXJfaW5mbyJdLAogICAgICAgICAgICBwYWRkaW5nPSgxLCAyKSwKICAgICAgICAgICAgZXhwYW5kPVRydWUKICAgICAgICApKQogICAgICAgIHNpbXBsZV9udW1iZXIoKQoKICAgICAgICBtZW51X3RhYmxlID0gVGFibGUoc2hvd19oZWFkZXI9RmFsc2UsIGJveD1NSU5JTUFMX0RPVUJMRV9IRUFELCBleHBhbmQ9VHJ1ZSkKICAgICAgICBtZW51X3RhYmxlLmFkZF9jb2x1bW4oIktvZGUiLCBqdXN0aWZ5PSJyaWdodCIsIHN0eWxlPXRoZW1lWyJ0ZXh0X2tleSJdLCB3aWR0aD02KQogICAgICAgIG1lbnVfdGFibGUuYWRkX2NvbHVtbigiQWtzaSIsIHN0eWxlPXRoZW1lWyJ0ZXh0X2JvZHkiXSkKCiAgICAgICAgbWVudV90YWJsZS5hZGRfcm93KCIxIiwgIvCflJAgTG9naW4gLyBHYW50aSBha3VuIikKICAgICAgICBtZW51X3RhYmxlLmFkZF9yb3coIjExIiwgIvCfpJ0gQWtyYWIgU3F1YWQgT3JnYW5pemVyIikKICAgICAgICBtZW51X3RhYmxlLmFkZF9yb3coIjEyIiwgIvCfkaUgQ2lyY2xlIE5vbmdrcm9uZyIpCiAgICAgICAgbWVudV90YWJsZS5hZGRfcm93KCIxMyIsICLwn4+sIFNlZ21lbiBTdG9yZSAobGFwYWspIikKICAgICAgICBtZW51X3RhYmxlLmFkZF9yb3coIjE0IiwgIvCfk4IgRmFtaWx5IExpc3QgUGFrZXQiKQogICAgICAgIG1lbnVfdGFibGUuYWRkX3JvdygiMTUiLCAi8J+TpiBQYWtldCBTdG9yZSIpCiAgICAgICAgbWVudV90YWJsZS5hZGRfcm93KCIxNiIsICLwn46BIFJlZGVlbSBSZXdhcmQvQm9udXMiKQogICAgICAgIG1lbnVfdGFibGUuYWRkX3JvdygiIiwgIiIpCiAgICAgICAgbWVudV90YWJsZS5hZGRfcm93KCJbVEZdIiwgIvCfkrggVHJhbnNmZXIgUHVsc2EiKQogICAgICAgIG1lbnVfdGFibGUuYWRkX3JvdygiW05dIiwgIvCflJQgQ2VrIE5vdGlmaWthc2kiKQogICAgICAgIG1lbnVfdGFibGUuYWRkX3JvdygiW1JdIiwgIvCfk50gUmVnaXN0cmFzaSBNU0lTRE4iKQogICAgICAgIG1lbnVfdGFibGUuYWRkX3JvdygiW1ZdIiwgIuKchSBWYWxpZGFzaSBOb21vciAoTVNJU0ROKSIpCiAgICAgICAgbWVudV90YWJsZS5hZGRfcm93KCIiLCAiIikKICAgICAgICBtZW51X3RhYmxlLmFkZF9yb3coIjAwIiwgZiJbe3RoZW1lWyd0ZXh0X3N1YiddfV3wn4+gIEJhbGlrIGtlIG1lbnUgdXRhbWFbL10iKQogICAgICAgIG1lbnVfdGFibGUuYWRkX3JvdygiOTkiLCBmIlt7dGhlbWVbJ3RleHRfZXJyJ119XeKblCBDYWJ1dCAvIFR1dHVwIGFwbGlrYXNpWy9dIikKCiAgICAgICAgY29uc29sZS5wcmludChQYW5lbCgKICAgICAgICAgICAgbWVudV90YWJsZSwKICAgICAgICAgICAgdGl0bGU9ZiJbe3RoZW1lWyd0ZXh0X3RpdGxlJ119XfCfp74gTWVudS0yWy9dIiwKICAgICAgICAgICAgYm9yZGVyX3N0eWxlPXRoZW1lWyJib3JkZXJfcHJpbWFyeSJdLAogICAgICAgICAgICBwYWRkaW5nPSgwLCAxKSwKICAgICAgICAgICAgZXhwYW5kPVRydWUKICAgICAgICApKQoKICAgICAgICBjaG9pY2UgPSBjb25zb2xlLmlucHV0KGYiW3t0aGVtZVsndGV4dF9zdWInXX1d8J+RiSBQaWxpaCBtZW51IGJybzpbL3t0aGVtZVsndGV4dF9zdWInXX1dICIpLnN0cmlwKCkKICAgICAgICBpZiBjaG9pY2UgPT0gIjEiOgogICAgICAgICAgICBzZWxlY3RlZF91c2VyX251bWJlciA9IHNob3dfYWNjb3VudF9tZW51KCkKICAgICAgICAgICAgaWYgc2VsZWN0ZWRfdXNlcl9udW1iZXI6CiAgICAgICAgICAgICAgICBBdXRoSW5zdGFuY2Uuc2V0X2FjdGl2ZV91c2VyKHNlbGVjdGVkX3VzZXJfbnVtYmVyKQogICAgICAgICAgICAgICAgI3ByaW50X3BhbmVsKCLinIUgTWFudGFwIiwgZiJBa3VuIGFrdGlmIGRpZ2FudGkga2Uge3NlbGVjdGVkX3VzZXJfbnVtYmVyfSIpCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBwcmludF9wYW5lbCgi4pqg77iPIFVwcyIsICJOZ2dhayBhZGEgdXNlciB0ZXJwaWxpaCBicm8g8J+aqCIpCiAgICAgICAgICAgIGNvbnRpbnVlCiAgICAgICAgZWxpZiBjaG9pY2UgPT0gIjExIjoKICAgICAgICAgICAgc2hvd19mYW1pbHlfaW5mbyhBdXRoSW5zdGFuY2UuYXBpX2tleSwgYWN0aXZlX3VzZXJbInRva2VucyJdKQogICAgICAgIGVsaWYgY2hvaWNlID09ICIxMiI6CiAgICAgICAgICAgIHNob3dfY2lyY2xlX2luZm8oQXV0aEluc3RhbmNlLmFwaV9rZXksIGFjdGl2ZV91c2VyWyJ0b2tlbnMiXSkKICAgICAgICBlbGlmIGNob2ljZSA9PSAiMTMiOgogICAgICAgICAgICBpc19lbnRlcnByaXNlID0gY29uc29sZS5pbnB1dChmIlt7dGhlbWVbJ3RleHRfc3ViJ119XfCfj6wgRW50ZXJwcmlzZSBzdG9yZT8gKHkvbik6Wy97dGhlbWVbJ3RleHRfc3ViJ119XSAiKS5sb3dlcigpID09ICJ5IgogICAgICAgICAgICBzaG93X3N0b3JlX3NlZ21lbnRzX21lbnUoaXNfZW50ZXJwcmlzZSkKICAgICAgICBlbGlmIGNob2ljZSA9PSAiMTQiOgogICAgICAgICAgICBpc19lbnRlcnByaXNlID0gY29uc29sZS5pbnB1dChmIlt7dGhlbWVbJ3RleHRfc3ViJ119XfCfk4IgRW50ZXJwcmlzZT8gKHkvbik6Wy97dGhlbWVbJ3RleHRfc3ViJ119XSAiKS5sb3dlcigpID09ICJ5IgogICAgICAgICAgICBzaG93X2ZhbWlseV9saXN0X21lbnUocHJvZmlsZVsic3Vic2NyaXB0aW9uX3R5cGUiXSwgaXNfZW50ZXJwcmlzZSkKICAgICAgICBlbGlmIGNob2ljZSA9PSAiMTUiOgogICAgICAgICAgICBpc19lbnRlcnByaXNlID0gY29uc29sZS5pbnB1dChmIlt7dGhlbWVbJ3RleHRfc3ViJ119XfCfk6YgRW50ZXJwcmlzZT8gKHkvbik6Wy97dGhlbWVbJ3RleHRfc3ViJ119XSAiKS5sb3dlcigpID09ICJ5IgogICAgICAgICAgICBzaG93X3N0b3JlX3BhY2thZ2VzX21lbnUocHJvZmlsZVsic3Vic2NyaXB0aW9uX3R5cGUiXSwgaXNfZW50ZXJwcmlzZSkKICAgICAgICBlbGlmIGNob2ljZSA9PSAiMTYiOgogICAgICAgICAgICBpc19lbnRlcnByaXNlID0gY29uc29sZS5pbnB1dChmIlt7dGhlbWVbJ3RleHRfc3ViJ119XfCfjoEgRW50ZXJwcmlzZT8gKHkvbik6Wy97dGhlbWVbJ3RleHRfc3ViJ119XSAiKS5sb3dlcigpID09ICJ5IgogICAgICAgICAgICBzaG93X3JlZGVlbWFibGVzX21lbnUoaXNfZW50ZXJwcmlzZSkKICAgICAgICBlbGlmIGNob2ljZS5sb3dlcigpID09ICJ0ZiI6CiAgICAgICAgICAgIHNob3dfYmFsYW5jZV9hbGxvdG1lbnRfbWVudSgpCiAgICAgICAgZWxpZiBjaG9pY2UubG93ZXIoKSA9PSAibiI6CiAgICAgICAgICAgIHNob3dfbm90aWZpY2F0aW9uX21lbnUoKQogICAgICAgIGVsaWYgY2hvaWNlLmxvd2VyKCkgPT0gInIiOgogICAgICAgICAgICBtc2lzZG4gPSBjb25zb2xlLmlucHV0KGYiW3t0aGVtZVsndGV4dF9zdWInXX1d8J+TnSBNYXN1a2luIG1zaXNkbiAoNjI4eHh4eCk6Wy97dGhlbWVbJ3RleHRfc3ViJ119XSAiKQogICAgICAgICAgICBuaWsgPSBjb25zb2xlLmlucHV0KCJNYXN1a2luIE5JSzogIikKICAgICAgICAgICAga2sgPSBjb25zb2xlLmlucHV0KCJNYXN1a2luIEtLOiAiKQogICAgICAgICAgICByZXMgPSBkdWtjYXBpbChBdXRoSW5zdGFuY2UuYXBpX2tleSwgbXNpc2RuLCBraywgbmlrKQogICAgICAgICAgICBwcmludF9wYW5lbCgi8J+TkSBIYXNpbCBSZWdpc3RyYXNpIiwganNvbi5kdW1wcyhyZXMsIGluZGVudD0yKSkKICAgICAgICAgICAgcGF1c2UoKQogICAgICAgIGVsaWYgY2hvaWNlLmxvd2VyKCkgPT0gInYiOgogICAgICAgICAgICBtc2lzZG4gPSBjb25zb2xlLmlucHV0KGYiW3t0aGVtZVsndGV4dF9zdWInXX1d4pyFIE1hc3VraW4gbXNpc2RuIGJ1YXQgdmFsaWRhc2kgKDYyOHh4eHgpOlsve3RoZW1lWyd0ZXh0X3N1YiddfV0gIikKICAgICAgICAgICAgcmVzID0gdmFsaWRhdGVfbXNpc2RuKEF1dGhJbnN0YW5jZS5hcGlfa2V5LCBhY3RpdmVfdXNlclsidG9rZW5zIl0sIG1zaXNkbikKICAgICAgICAgICAgcHJpbnRfcGFuZWwoIvCfk5EgSGFzaWwgVmFsaWRhc2kiLCBqc29uLmR1bXBzKHJlcywgaW5kZW50PTIpKQogICAgICAgICAgICBwYXVzZSgpCiAgICAgICAgZWxpZiBjaG9pY2UgPT0gIjAwIjoKICAgICAgICAgICAgd2l0aCBsaXZlX2xvYWRpbmcoIvCflIQgQmFsaWsga2UgbWVudSB1dGFtYS4uLiIsIHRoZW1lKToKICAgICAgICAgICAgICAgIHBhc3MKICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgZWxpZiBjaG9pY2UgPT0gIjk5IjoKICAgICAgICAgICAgcHJpbnRfcGFuZWwoIvCfkYsgU2FtcGFpIGp1bXBhIGJybyEiLCAiQXBsaWthc2kgZGl0dXR1cCBkZW5nYW4gYW1hbi4iKQogICAgICAgICAgICBzeXMuZXhpdCgwKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHByaW50X3BhbmVsKCLimqDvuI8gVXBzIiwgIlBpbGloYW4gbmdnYWsgdmFsaWQgYnJvIPCfmqgiKQogICAgICAgICAgICBwYXVzZSgpCgoKZGVmIG1haW4oKToKICAgIGVuc3VyZV9naXQoKQogICAgd2hpbGUgVHJ1ZToKICAgICAgICB0aGVtZSA9IGdldF90aGVtZSgpCiAgICAgICAgYWN0aXZlX3VzZXIgPSBBdXRoSW5zdGFuY2UuZ2V0X2FjdGl2ZV91c2VyKCkKICAgICAgICBpZiBhY3RpdmVfdXNlciBpcyBub3QgTm9uZToKICAgICAgICAgICAgYWNjb3VudF9pZCA9IGFjdGl2ZV91c2VyWyJudW1iZXIiXQoKICAgICAgICAgICAgIyBCYWxhbmNlIGNhY2hlIHBlciBha3VuIChUVEwgOTAgZGV0aWspCiAgICAgICAgICAgIGJhbGFuY2UgPSBnZXRfY2FjaGUoYWNjb3VudF9pZCwgImJhbGFuY2UiLCB0dGw9OTApCiAgICAgICAgICAgIGlmIG5vdCBiYWxhbmNlOgogICAgICAgICAgICAgICAgYmFsYW5jZSA9IGdldF9iYWxhbmNlKEF1dGhJbnN0YW5jZS5hcGlfa2V5LCBhY3RpdmVfdXNlclsidG9rZW5zIl1bImlkX3Rva2VuIl0pCiAgICAgICAgICAgICAgICBzZXRfY2FjaGUoYWNjb3VudF9pZCwgImJhbGFuY2UiLCBiYWxhbmNlKQoKICAgICAgICAgICAgIyBRdW90YSBjYWNoZSBwZXIgYWt1biAoVFRMIDYwIGRldGlrKQogICAgICAgICAgICBxdW90YSA9IGdldF9jYWNoZShhY2NvdW50X2lkLCAicXVvdGEiLCB0dGw9NzApCiAgICAgICAgICAgIGlmIG5vdCBxdW90YToKICAgICAgICAgICAgICAgIHF1b3RhID0gZ2V0X3F1b3RhKEF1dGhJbnN0YW5jZS5hcGlfa2V5LCBhY3RpdmVfdXNlclsidG9rZW5zIl1bImlkX3Rva2VuIl0pIG9yIHt9CiAgICAgICAgICAgICAgICBzZXRfY2FjaGUoYWNjb3VudF9pZCwgInF1b3RhIiwgcXVvdGEpCgogICAgICAgICAgICAjIFNlZ21lbnRzIGNhY2hlIHBlciBha3VuIChUVEwgMzAwIGRldGlrLCBmaWxlLWJhc2VkKQogICAgICAgICAgICBzZWdtZW50cyA9IGdldF9jYWNoZShhY2NvdW50X2lkLCAic2VnbWVudHMiLCB0dGw9MjkwLCB1c2VfZmlsZT1UcnVlKQogICAgICAgICAgICBpZiBub3Qgc2VnbWVudHM6CiAgICAgICAgICAgICAgICBzZWdtZW50cyA9IGRhc2hfc2VnbWVudHMoCiAgICAgICAgICAgICAgICAgICAgQXV0aEluc3RhbmNlLmFwaV9rZXksCiAgICAgICAgICAgICAgICAgICAgYWN0aXZlX3VzZXJbInRva2VucyJdWyJpZF90b2tlbiJdLAogICAgICAgICAgICAgICAgICAgIGFjdGl2ZV91c2VyWyJ0b2tlbnMiXVsiYWNjZXNzX3Rva2VuIl0KICAgICAgICAgICAgICAgICkgb3Ige30KICAgICAgICAgICAgICAgIHNldF9jYWNoZShhY2NvdW50X2lkLCAic2VnbWVudHMiLCBzZWdtZW50cywgdXNlX2ZpbGU9VHJ1ZSkKCiAgICAgICAgICAgIHJlbWFpbmluZyA9IHF1b3RhLmdldCgicmVtYWluaW5nIiwgMCkKICAgICAgICAgICAgdG90YWwgPSBxdW90YS5nZXQoInRvdGFsIiwgMCkKICAgICAgICAgICAgaGFzX3VubGltaXRlZCA9IHF1b3RhLmdldCgiaGFzX3VubGltaXRlZCIsIEZhbHNlKQogICAgICAgICAgICBpZiB0b3RhbCA+IDAgb3IgaGFzX3VubGltaXRlZDoKICAgICAgICAgICAgICAgIGRpc3BsYXlfcXVvdGEgPSBmIntyZW1haW5pbmcvMWU5Oi4yZn0gLyB7dG90YWwvMWU5Oi4yZn0gR0IiICsgKCIgKFVubGltaXRlZCkiIGlmIGhhc191bmxpbWl0ZWQgZWxzZSAiIikKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIGRpc3BsYXlfcXVvdGEgPSAiLSIKCiAgICAgICAgICAgIHBvaW50X2luZm8gPSAiUG9pbnRzOiBOL0EgfCBUaWVyOiBOL0EiCiAgICAgICAgICAgIGlmIGFjdGl2ZV91c2VyWyJzdWJzY3JpcHRpb25fdHlwZSJdID09ICJQUkVQQUlEIjoKICAgICAgICAgICAgICAgICMgVGllcmluZyBjYWNoZSBwZXIgYWt1biAoVFRMIDI0MCBkZXRpaykKICAgICAgICAgICAgICAgIHRpZXJpbmdfZGF0YSA9IGdldF9jYWNoZShhY2NvdW50X2lkLCAidGllcmluZyIsIHR0bD0yNTApCiAgICAgICAgICAgICAgICBpZiBub3QgdGllcmluZ19kYXRhOgogICAgICAgICAgICAgICAgICAgIHRpZXJpbmdfZGF0YSA9IGdldF90aWVyaW5nX2luZm8oQXV0aEluc3RhbmNlLmFwaV9rZXksIGFjdGl2ZV91c2VyWyJ0b2tlbnMiXSkKICAgICAgICAgICAgICAgICAgICBzZXRfY2FjaGUoYWNjb3VudF9pZCwgInRpZXJpbmciLCB0aWVyaW5nX2RhdGEpCiAgICAgICAgICAgICAgICBwb2ludF9pbmZvID0gZiJQb2ludHM6IHt0aWVyaW5nX2RhdGEuZ2V0KCdjdXJyZW50X3BvaW50JywwKX0gfCBUaWVyOiB7dGllcmluZ19kYXRhLmdldCgndGllcicsMCl9IgoKICAgICAgICAgICAgcHJvZmlsZSA9IHsKICAgICAgICAgICAgICAgICJudW1iZXIiOiBhY3RpdmVfdXNlclsibnVtYmVyIl0sCiAgICAgICAgICAgICAgICAic3Vic2NyaWJlcl9pZCI6IGFjdGl2ZV91c2VyWyJzdWJzY3JpYmVyX2lkIl0sCiAgICAgICAgICAgICAgICAic3Vic2NyaXB0aW9uX3R5cGUiOiBhY3RpdmVfdXNlclsic3Vic2NyaXB0aW9uX3R5cGUiXSwKICAgICAgICAgICAgICAgICJiYWxhbmNlIjogYmFsYW5jZS5nZXQoInJlbWFpbmluZyIpLAogICAgICAgICAgICAgICAgImJhbGFuY2VfZXhwaXJlZF9hdCI6IGJhbGFuY2UuZ2V0KCJleHBpcmVkX2F0IiksCiAgICAgICAgICAgICAgICAicG9pbnRfaW5mbyI6IHBvaW50X2luZm8sCiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHNob3dfbWFpbl9tZW51KHByb2ZpbGUsIGRpc3BsYXlfcXVvdGEsIHNlZ21lbnRzKQoKICAgICAgICAgICAgY2hvaWNlID0gY29uc29sZS5pbnB1dChmIlt7dGhlbWVbJ3RleHRfc3ViJ119XfCfkYkgUGlsaWggbWVudSBicm86Wy97dGhlbWVbJ3RleHRfc3ViJ119XSAiKS5zdHJpcCgpCgogICAgICAgICAgICBpZiBjaG9pY2UubG93ZXIoKSA9PSAidCI6CiAgICAgICAgICAgICAgICBwYXVzZSgpCiAgICAgICAgICAgIGVsaWYgY2hvaWNlID09ICIxIjoKICAgICAgICAgICAgICAgIHNlbGVjdGVkX3VzZXJfbnVtYmVyID0gc2hvd19hY2NvdW50X21lbnUoKQogICAgICAgICAgICAgICAgaWYgc2VsZWN0ZWRfdXNlcl9udW1iZXI6CiAgICAgICAgICAgICAgICAgICAgQXV0aEluc3RhbmNlLnNldF9hY3RpdmVfdXNlcihzZWxlY3RlZF91c2VyX251bWJlcikKICAgICAgICAgICAgICAgICAgICAjcHJpbnRfcGFuZWwoIuKchSBNYW50YXAiLCBmIkFrdW4gYWt0aWYgZGlnYW50aSBrZSB7c2VsZWN0ZWRfdXNlcl9udW1iZXJ9IikKICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgcHJpbnRfcGFuZWwoIuKaoO+4jyBVcHMiLCAiTmdnYWsgYWRhIHVzZXIgdGVycGlsaWggYnJvIPCfmqgiKQogICAgICAgICAgICAgICAgY29udGludWUKICAgICAgICAgICAgZWxpZiBjaG9pY2UgPT0gIjIiOgogICAgICAgICAgICAgICAgZmV0Y2hfbXlfcGFja2FnZXMoKQogICAgICAgICAgICAgICAgY29udGludWUKICAgICAgICAgICAgZWxpZiBjaG9pY2UgPT0gIjMiOgogICAgICAgICAgICAgICAgc2hvd190cmFuc2FjdGlvbl9oaXN0b3J5KEF1dGhJbnN0YW5jZS5hcGlfa2V5LCBhY3RpdmVfdXNlclsidG9rZW5zIl0pCiAgICAgICAgICAgIGVsaWYgY2hvaWNlID09ICI0IjoKICAgICAgICAgICAgICAgIHNob3dfaG90X21lbnUoKQogICAgICAgICAgICBlbGlmIGNob2ljZSA9PSAiNSI6CiAgICAgICAgICAgICAgICBzaG93X2hvdF9tZW51MigpCiAgICAgICAgICAgIGVsaWYgY2hvaWNlID09ICI2IjoKICAgICAgICAgICAgICAgIG9wdGlvbl9jb2RlID0gY29uc29sZS5pbnB1dChmIlt7dGhlbWVbJ3RleHRfc3ViJ119XfCflI4gTWFzdWtpbiBvcHRpb24gY29kZSBicm86Wy97dGhlbWVbJ3RleHRfc3ViJ119XSAiKQogICAgICAgICAgICAgICAgaWYgb3B0aW9uX2NvZGUgPT0gIjk5IjoKICAgICAgICAgICAgICAgICAgICBjb250aW51ZQogICAgICAgICAgICAgICAgc2hvd19wYWNrYWdlX2RldGFpbHMoQXV0aEluc3RhbmNlLmFwaV9rZXksIGFjdGl2ZV91c2VyWyJ0b2tlbnMiXSwgb3B0aW9uX2NvZGUsIEZhbHNlKQogICAgICAgICAgICBlbGlmIGNob2ljZSA9PSAiNyI6CiAgICAgICAgICAgICAgICBmYW1pbHlfY29kZSA9IGNvbnNvbGUuaW5wdXQoZiJbe3RoZW1lWyd0ZXh0X3N1YiddfV3wn5SOIE1hc3VraW4gZmFtaWx5IGNvZGUgYnJvOlsve3RoZW1lWyd0ZXh0X3N1YiddfV0gIikKICAgICAgICAgICAgICAgIGlmIGZhbWlseV9jb2RlID09ICI5OSI6CiAgICAgICAgICAgICAgICAgICAgY29udGludWUKICAgICAgICAgICAgICAgIGdldF9wYWNrYWdlc19ieV9mYW1pbHkoZmFtaWx5X2NvZGUpCiAgICAgICAgICAgIGVsaWYgY2hvaWNlID09ICI4IjoKICAgICAgICAgICAgICAgIGZhbWlseV9jb2RlID0gY29uc29sZS5pbnB1dChmIlt7dGhlbWVbJ3RleHRfc3ViJ119XfCflI4gTWFzdWtpbiBmYW1pbHkgY29kZSBicm86Wy97dGhlbWVbJ3RleHRfc3ViJ119XSAiKQogICAgICAgICAgICAgICAgaWYgZmFtaWx5X2NvZGUgPT0gIjk5IjoKICAgICAgICAgICAgICAgICAgICBjb250aW51ZQogICAgICAgICAgICAgICAgc3RhcnRfZnJvbV9vcHRpb24gPSBjb25zb2xlLmlucHV0KGYiW3t0aGVtZVsndGV4dF9zdWInXX1dTXVsYWkgZGFyaSBvcHRpb24gbnVtYmVyIChkZWZhdWx0IDEpOlsve3RoZW1lWyd0ZXh0X3N1YiddfV0gIikKICAgICAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgICAgICBzdGFydF9mcm9tX29wdGlvbiA9IGludChzdGFydF9mcm9tX29wdGlvbikKICAgICAgICAgICAgICAgIGV4Y2VwdCBWYWx1ZUVycm9yOgogICAgICAgICAgICAgICAgICAgIHN0YXJ0X2Zyb21fb3B0aW9uID0gMQogICAgICAgICAgICAgICAgdXNlX2RlY295ID0gY29uc29sZS5pbnB1dChmIlt7dGhlbWVbJ3RleHRfc3ViJ119XUd1bmFrYW4gZGVjb3kgcGFja2FnZT8gKHkvbik6Wy97dGhlbWVbJ3RleHRfc3ViJ119XSAiKS5sb3dlcigpID09ICJ5IgogICAgICAgICAgICAgICAgcGF1c2Vfb25fc3VjY2VzcyA9IGNvbnNvbGUuaW5wdXQoZiJbe3RoZW1lWyd0ZXh0X3N1YiddfV1QYXVzZSB0aWFwIHN1a3Nlcz8gKHkvbik6Wy97dGhlbWVbJ3RleHRfc3ViJ119XSAiKS5sb3dlcigpID09ICJ5IgogICAgICAgICAgICAgICAgZGVsYXlfc2Vjb25kcyA9IGNvbnNvbGUuaW5wdXQoZiJbe3RoZW1lWyd0ZXh0X3N1YiddfV1EZWxheSBhbnRhciBwZW1iZWxpYW4gKDAgPSB0YW5wYSBkZWxheSk6Wy97dGhlbWVbJ3RleHRfc3ViJ119XSAiKQogICAgICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgICAgIGRlbGF5X3NlY29uZHMgPSBpbnQoZGVsYXlfc2Vjb25kcykKICAgICAgICAgICAgICAgIGV4Y2VwdCBWYWx1ZUVycm9yOgogICAgICAgICAgICAgICAgICAgIGRlbGF5X3NlY29uZHMgPSAwCiAgICAgICAgICAgICAgICBwdXJjaGFzZV9ieV9mYW1pbHkoZmFtaWx5X2NvZGUsIHVzZV9kZWNveSwgcGF1c2Vfb25fc3VjY2VzcywgZGVsYXlfc2Vjb25kcywgc3RhcnRfZnJvbV9vcHRpb24pCiAgICAgICAgICAgIGVsaWYgY2hvaWNlID09ICI5IjoKICAgICAgICAgICAgICAgIGZhbWlseV9jb2RlID0gY29uc29sZS5pbnB1dChmIlt7dGhlbWVbJ3RleHRfc3ViJ119XU1hc3VraW4gZmFtaWx5IGNvZGUgYnJvOlsve3RoZW1lWyd0ZXh0X3N1YiddfV0gIikKICAgICAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgICAgICBvcmRlciA9IGludChjb25zb2xlLmlucHV0KGYiW3t0aGVtZVsndGV4dF9zdWInXX1dTWFzdWtpbiBvcmRlciBudW1iZXIgKGRlZmF1bHQgMSk6Wy97dGhlbWVbJ3RleHRfc3ViJ119XSAiKSBvciAxKQogICAgICAgICAgICAgICAgZXhjZXB0IFZhbHVlRXJyb3I6CiAgICAgICAgICAgICAgICAgICAgb3JkZXIgPSAxCiAgICAgICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICAgICAgZGVsYXkgPSBpbnQoY29uc29sZS5pbnB1dChmIlt7dGhlbWVbJ3RleHRfc3ViJ119XU1hc3VraW4gZGVsYXkgKGRldGlrKSAoZGVmYXVsdCAwKTpbL3t0aGVtZVsndGV4dF9zdWInXX1dICIpIG9yIDApCiAgICAgICAgICAgICAgICBleGNlcHQgVmFsdWVFcnJvcjoKICAgICAgICAgICAgICAgICAgICBkZWxheSA9IDAKICAgICAgICAgICAgICAgIHBhdXNlX29uX3N1Y2Nlc3MgPSBjb25zb2xlLmlucHV0KGYiW3t0aGVtZVsndGV4dF9zdWInXX1dQWt0aWZpbiBtb2RlIHBhdXNlPyAoeS9uKTpbL3t0aGVtZVsndGV4dF9zdWInXX1dICIpLmxvd2VyKCkgPT0gJ3knCiAgICAgICAgICAgICAgICB3aGlsZSBUcnVlOgogICAgICAgICAgICAgICAgICAgIHNob3VsZF9jb250aW51ZSA9IHB1cmNoYXNlX2xvb3AoCiAgICAgICAgICAgICAgICAgICAgICAgIGZhbWlseV9jb2RlPWZhbWlseV9jb2RlLAogICAgICAgICAgICAgICAgICAgICAgICBvcmRlcj1vcmRlciwKICAgICAgICAgICAgICAgICAgICAgICAgdXNlX2RlY295PVRydWUsCiAgICAgICAgICAgICAgICAgICAgICAgIGRlbGF5PWRlbGF5LAogICAgICAgICAgICAgICAgICAgICAgICBwYXVzZV9vbl9zdWNjZXNzPXBhdXNlX29uX3N1Y2Nlc3MKICAgICAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAgICAgaWYgbm90IHNob3VsZF9jb250aW51ZToKICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWsKICAgICAgICAgICAgICAgIGNvbnRpbnVlCiAgICAgICAgICAgIGVsaWYgY2hvaWNlLmxvd2VyKCkgPT0gImQiOgogICAgICAgICAgICAgICAgc2hvd19idW5kbGVfbWVudSgpCiAgICAgICAgICAgIGVsaWYgY2hvaWNlLmxvd2VyKCkgPT0gImYiOgogICAgICAgICAgICAgICAgc2hvd19mYW1pbHlfZ3J1cF9tZW51KCkKICAgICAgICAgICAgZWxpZiBjaG9pY2UubG93ZXIoKSA9PSAiYiI6CiAgICAgICAgICAgICAgICBzaG93X2Jvb2ttYXJrX21lbnUoKQogICAgICAgICAgICBlbGlmIGNob2ljZS5sb3dlcigpID09ICJtIjoKICAgICAgICAgICAgICAgIHNob3dfbWFpbl9tZW51MihhY3RpdmVfdXNlciwgcHJvZmlsZSkKICAgICAgICAgICAgZWxpZiBjaG9pY2UubG93ZXIoKSA9PSAiYyI6CiAgICAgICAgICAgICAgICBjbGVhcl9jYWNoZShhY2NvdW50X2lkKQogICAgICAgICAgICAgICAgcHJpbnRfcGFuZWwoIuKchSBNYW50YXAiLCBmIkNhY2hlIGFrdW4ge2FjY291bnRfaWR9IHVkYWggZGliZXJzaWhpbiDwn5qAIikKICAgICAgICAgICAgICAgIHBhdXNlKCkKICAgICAgICAgICAgZWxpZiBjaG9pY2UgPT0gIjY2IjoKICAgICAgICAgICAgICAgIHNob3dfaW5mb19tZW51KCkKICAgICAgICAgICAgZWxpZiBjaG9pY2UgPT0gIjY5IjoKICAgICAgICAgICAgICAgIHNob3dfdGhlbWVfbWVudSgpCiAgICAgICAgICAgIGVsaWYgY2hvaWNlID09ICI5OSI6CiAgICAgICAgICAgICAgICBwcmludF9wYW5lbCgi8J+RiyBTYW1wYWkganVtcGEgYnJvISIsICJBcGxpa2FzaSBkaXR1dHVwIGRlbmdhbiBhbWFuLiIpCiAgICAgICAgICAgICAgICBzeXMuZXhpdCgwKQogICAgICAgICAgICBlbGlmIGNob2ljZS5sb3dlcigpID09ICJ5IjoKICAgICAgICAgICAgICAgIHNob3dfc3BlY2lhbF9mb3JfeW91X21lbnUoYWN0aXZlX3VzZXJbInRva2VucyJdKQogICAgICAgICAgICBlbGlmIGNob2ljZS5sb3dlcigpID09ICJzIjoKICAgICAgICAgICAgICAgIGVudGVyX3NlbnRyeV9tb2RlKCkKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHByaW50X3BhbmVsKCLimqDvuI8gVXBzIiwgIlBpbGloYW4gbmdnYWsgdmFsaWQgYnJvIPCfmqgiKQogICAgICAgICAgICAgICAgcGF1c2UoKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHNlbGVjdGVkX3VzZXJfbnVtYmVyID0gc2hvd19hY2NvdW50X21lbnUoKQogICAgICAgICAgICBpZiBzZWxlY3RlZF91c2VyX251bWJlcjoKICAgICAgICAgICAgICAgIEF1dGhJbnN0YW5jZS5zZXRfYWN0aXZlX3VzZXIoc2VsZWN0ZWRfdXNlcl9udW1iZXIpCiAgICAgICAgICAgICAgICAjcHJpbnRfcGFuZWwoIuKchSBNYW50YXAiLCBmIkFrdW4gYWt0aWYgZGlnYW50aSBrZSB7c2VsZWN0ZWRfdXNlcl9udW1iZXJ9IikKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHByaW50X3BhbmVsKCLimqDvuI8gVXBzIiwgIk5nZ2FrIGFkYSB1c2VyIHRlcnBpbGloIGJybyDwn5qoIikKCmlmIF9fbmFtZV9fID09ICJfX21haW5fXyI6CiAgICB0cnk6CiAgICAgICAgd2l0aCBsaXZlX2xvYWRpbmcoIvCflIQgQ2hlY2tpbmcgZm9yIHVwZGF0ZXMuLi4iLCBnZXRfdGhlbWUoKSk6CiAgICAgICAgICAgIG5lZWRfdXBkYXRlID0gY2hlY2tfZm9yX3VwZGF0ZXMoKQogICAgICAgICMgSmlrYSBpbmdpbiBwYWtzYSB1cGRhdGUsIGFrdGlma2FuIGJsb2sgaW5pOgogICAgICAgICMgaWYgbmVlZF91cGRhdGU6CiAgICAgICAgIyAgICAgcHJpbnRfd2FybmluZygi4qyG77iPIiwgIlZlcnNpIGJhcnUgdGVyc2VkaWEsIHNpbGFrYW4gdXBkYXRlIHNlYmVsdW0gbWVsYW5qdXRrYW4uIikKICAgICAgICAjICAgICBwYXVzZSgpCiAgICAgICAgIyAgICAgc3lzLmV4aXQoMCkKICAgICAgICBtYWluKCkKICAgIGV4Y2VwdCBLZXlib2FyZEludGVycnVwdDoKICAgICAgICBwcmludF9lcnJvcigi8J+RiyBLZWx1YXIiLCAiQXBsaWthc2kgZGloZW50aWthbiBvbGVoIHBlbmdndW5hLiIpCg==').decode())
