#!/usr/bin/env python3
import base64
exec(base64.b64decode('aW1wb3J0IHN1YnByb2Nlc3MKaW1wb3J0IG9zCmltcG9ydCBzeXMKZnJvbSByaWNoLnBhbmVsIGltcG9ydCBQYW5lbApmcm9tIHJpY2gudGV4dCBpbXBvcnQgVGV4dApmcm9tIHJpY2guY29uc29sZSBpbXBvcnQgQ29uc29sZQpmcm9tIGFwcC5tZW51cy51dGlsIGltcG9ydCBwYXVzZQpmcm9tIGFwcC5tZW51cy51dGlsX2hlbHBlciBpbXBvcnQgbGl2ZV9sb2FkaW5nLCBwcmludF9wYW5lbApmcm9tIGFwcC5jb25maWcudGhlbWVfY29uZmlnIGltcG9ydCBnZXRfdGhlbWUsIGdldF90aGVtZV9zdHlsZQoKY29uc29sZSA9IENvbnNvbGUoKQoKZGVmIGlzX3JlYmFzZV9pbl9wcm9ncmVzcygpOgogICAgcmV0dXJuIG9zLnBhdGguZXhpc3RzKCIuZ2l0L3JlYmFzZS1hcHBseSIpIG9yIG9zLnBhdGguZXhpc3RzKCIuZ2l0L3JlYmFzZS1tZXJnZSIpCgpkZWYgZ2l0X3B1bGxfcmViYXNlKCk6CiAgICB0aGVtZSA9IGdldF90aGVtZSgpCiAgICByZXN1bHQgPSB7InN0YXR1cyI6IE5vbmUsICJlcnJvciI6IE5vbmUsICJvdXRwdXQiOiAiIn0KCiAgICBpZiBpc19yZWJhc2VfaW5fcHJvZ3Jlc3MoKToKICAgICAgICB0ZXh0ID0gVGV4dC5mcm9tX21hcmt1cCgKICAgICAgICAgICAgIltib2xkIHllbGxvd13imqDvuI8gUmViYXNlIHNlYmVsdW1ueWEgYmVsdW0gc2VsZXNhaVsvXVxuXG4iCiAgICAgICAgICAgICJbeWVsbG93XVNlbGVzYWlrYW4gZGVuZ2FuIGBnaXQgcmViYXNlIC0tY29udGludWVgIGF0YXUgYmF0YWxrYW4gZGVuZ2FuIGBnaXQgcmViYXNlIC0tYWJvcnRgWy9dIgogICAgICAgICkKICAgICAgICBjb25zb2xlLnByaW50KFBhbmVsKAogICAgICAgICAgICB0ZXh0LAogICAgICAgICAgICB0aXRsZT0i8J+TpSBVcGRhdGUgQ0xJIiwKICAgICAgICAgICAgYm9yZGVyX3N0eWxlPWdldF90aGVtZV9zdHlsZSgiYm9yZGVyX3dhcm5pbmciLCAieWVsbG93IiksCiAgICAgICAgICAgIHBhZGRpbmc9KDEsIDIpLAogICAgICAgICAgICBleHBhbmQ9VHJ1ZQogICAgICAgICkpCiAgICAgICAgcGF1c2UoKQogICAgICAgIHN5cy5leGl0KDEpCgogICAgZGVmIHJ1bl9naXRfcHVsbCgpOgogICAgICAgIHRyeToKICAgICAgICAgICAgc3VicHJvY2Vzcy5ydW4oWydnaXQnLCAncmV2LXBhcnNlJywgJy0taXMtaW5zaWRlLXdvcmstdHJlZSddLCBjaGVjaz1UcnVlLCBzdGRvdXQ9c3VicHJvY2Vzcy5ERVZOVUxMKQogICAgICAgICAgICBvdXRwdXQgPSBzdWJwcm9jZXNzLnJ1bigKICAgICAgICAgICAgICAgIFsnZ2l0JywgJ3B1bGwnLCAnLS1yZWJhc2UnXSwKICAgICAgICAgICAgICAgIHN0ZG91dD1zdWJwcm9jZXNzLlBJUEUsCiAgICAgICAgICAgICAgICBzdGRlcnI9c3VicHJvY2Vzcy5QSVBFLAogICAgICAgICAgICAgICAgdGV4dD1UcnVlLAogICAgICAgICAgICAgICAgY2hlY2s9VHJ1ZQogICAgICAgICAgICApCiAgICAgICAgICAgIHJlc3VsdFsic3RhdHVzIl0gPSAic3VjY2VzcyIKICAgICAgICAgICAgcmVzdWx0WyJvdXRwdXQiXSA9IG91dHB1dC5zdGRvdXQuc3RyaXAoKQogICAgICAgIGV4Y2VwdCBzdWJwcm9jZXNzLkNhbGxlZFByb2Nlc3NFcnJvciBhcyBlOgogICAgICAgICAgICByZXN1bHRbInN0YXR1cyJdID0gImZhaWwiCiAgICAgICAgICAgIHJlc3VsdFsiZXJyb3IiXSA9IGUuc3RkZXJyLnN0cmlwKCkKICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgIHJlc3VsdFsic3RhdHVzIl0gPSAiZXJyb3IiCiAgICAgICAgICAgIHJlc3VsdFsiZXJyb3IiXSA9IHN0cihlKQoKICAgIGRlZiBydW5fZ2l0X3Jlc2V0KCk6CiAgICAgICAgdHJ5OgogICAgICAgICAgICBicmFuY2ggPSBzdWJwcm9jZXNzLmNoZWNrX291dHB1dChbJ2dpdCcsICdyZXYtcGFyc2UnLCAnLS1hYmJyZXYtcmVmJywgJ0hFQUQnXSwgdGV4dD1UcnVlKS5zdHJpcCgpCiAgICAgICAgICAgIHN1YnByb2Nlc3MucnVuKFsnZ2l0JywgJ2ZldGNoJ10sIGNoZWNrPVRydWUsIHN0ZG91dD1zdWJwcm9jZXNzLkRFVk5VTEwpCiAgICAgICAgICAgIHJlc2V0X291dHB1dCA9IHN1YnByb2Nlc3MucnVuKAogICAgICAgICAgICAgICAgWydnaXQnLCAncmVzZXQnLCAnLS1oYXJkJywgZidvcmlnaW4ve2JyYW5jaH0nXSwKICAgICAgICAgICAgICAgIHN0ZG91dD1zdWJwcm9jZXNzLlBJUEUsCiAgICAgICAgICAgICAgICBzdGRlcnI9c3VicHJvY2Vzcy5QSVBFLAogICAgICAgICAgICAgICAgdGV4dD1UcnVlLAogICAgICAgICAgICAgICAgY2hlY2s9VHJ1ZQogICAgICAgICAgICApCiAgICAgICAgICAgIHJlc3VsdFsic3RhdHVzIl0gPSAicmVzZXQiCiAgICAgICAgICAgIHJlc3VsdFsib3V0cHV0Il0gPSByZXNldF9vdXRwdXQuc3Rkb3V0LnN0cmlwKCkKICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgIHJlc3VsdFsic3RhdHVzIl0gPSAicmVzZXRfZmFpbCIKICAgICAgICAgICAgcmVzdWx0WyJlcnJvciJdID0gc3RyKGUpCgogICAgd2l0aCBsaXZlX2xvYWRpbmcoIvCflIQgTWVuYXJpayB1cGRhdGUgZGFyaSByZXBvc2l0b3J5Li4uIiwgdGhlbWUpOgogICAgICAgIHJ1bl9naXRfcHVsbCgpCgogICAgaWYgcmVzdWx0WyJzdGF0dXMiXSA9PSAic3VjY2VzcyI6CiAgICAgICAgdGV4dCA9IFRleHQuZnJvbV9tYXJrdXAoCiAgICAgICAgICAgIGYi4pyFIFtib2xkIGdyZWVuXUdpdCBwdWxsIGJlcmhhc2lsWy9dXG5cblt3aGl0ZV17cmVzdWx0WydvdXRwdXQnXX1bL10iCiAgICAgICAgKQogICAgICAgIGNvbnNvbGUucHJpbnQoUGFuZWwoCiAgICAgICAgICAgIHRleHQsCiAgICAgICAgICAgIHRpdGxlPSLwn5OlIFVwZGF0ZSBDTEkiLAogICAgICAgICAgICBib3JkZXJfc3R5bGU9Z2V0X3RoZW1lX3N0eWxlKCJib3JkZXJfc3VjY2VzcyIsICJncmVlbiIpLAogICAgICAgICAgICBwYWRkaW5nPSgxLCAyKSwKICAgICAgICAgICAgZXhwYW5kPVRydWUKICAgICAgICApKQoKICAgIGVsaWYgcmVzdWx0WyJzdGF0dXMiXSA9PSAiZmFpbCI6CiAgICAgICAgdGV4dCA9IFRleHQuZnJvbV9tYXJrdXAoCiAgICAgICAgICAgIGYi4p2MIFtib2xkIHJlZF1HaXQgcHVsbCBnYWdhbFsvXVxuXG5bcmVkXXtyZXN1bHRbJ2Vycm9yJ119Wy9dXG5cblt5ZWxsb3ddTWVuY29iYSByZXNldCBwYWtzYS4uLlsvXSIKICAgICAgICApCiAgICAgICAgY29uc29sZS5wcmludChQYW5lbCgKICAgICAgICAgICAgdGV4dCwKICAgICAgICAgICAgdGl0bGU9IvCfk6UgVXBkYXRlIENMSSIsCiAgICAgICAgICAgIGJvcmRlcl9zdHlsZT1nZXRfdGhlbWVfc3R5bGUoImJvcmRlcl9lcnIiLCAicmVkIiksCiAgICAgICAgICAgIHBhZGRpbmc9KDEsIDIpLAogICAgICAgICAgICBleHBhbmQ9VHJ1ZQogICAgICAgICkpCgogICAgICAgIHdpdGggbGl2ZV9sb2FkaW5nKCLwn6e5IE1lbmphbGFua2FuIGdpdCByZXNldCAtLWhhcmQuLi4iLCB0aGVtZSk6CiAgICAgICAgICAgIHJ1bl9naXRfcmVzZXQoKQoKICAgICAgICBpZiByZXN1bHRbInN0YXR1cyJdID09ICJyZXNldCI6CiAgICAgICAgICAgIHRleHQgPSBUZXh0LmZyb21fbWFya3VwKAogICAgICAgICAgICAgICAgZiLinIUgW2JvbGQgZ3JlZW5dUmVzZXQgYmVyaGFzaWwsIENMSSBkaXNpbmtyb25rYW4ga2Ugb3JpZ2luWy9dXG5cblt3aGl0ZV17cmVzdWx0WydvdXRwdXQnXX1bL10iCiAgICAgICAgICAgICkKICAgICAgICAgICAgY29uc29sZS5wcmludChQYW5lbCgKICAgICAgICAgICAgICAgIHRleHQsCiAgICAgICAgICAgICAgICB0aXRsZT0i8J+TpSBVcGRhdGUgQ0xJIiwKICAgICAgICAgICAgICAgIGJvcmRlcl9zdHlsZT1nZXRfdGhlbWVfc3R5bGUoImJvcmRlcl9zdWNjZXNzIiwgImdyZWVuIiksCiAgICAgICAgICAgICAgICBwYWRkaW5nPSgxLCAyKSwKICAgICAgICAgICAgICAgIGV4cGFuZD1UcnVlCiAgICAgICAgICAgICkpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgdGV4dCA9IFRleHQuZnJvbV9tYXJrdXAoCiAgICAgICAgICAgICAgICBmIuKdjCBbYm9sZCByZWRdUmVzZXQgZ2FnYWxbL11cblxuW3JlZF17cmVzdWx0WydlcnJvciddfVsvXSIKICAgICAgICAgICAgKQogICAgICAgICAgICBjb25zb2xlLnByaW50KFBhbmVsKAogICAgICAgICAgICAgICAgdGV4dCwKICAgICAgICAgICAgICAgIHRpdGxlPSLwn5OlIFVwZGF0ZSBDTEkiLAogICAgICAgICAgICAgICAgYm9yZGVyX3N0eWxlPWdldF90aGVtZV9zdHlsZSgiYm9yZGVyX2VyciIsICJyZWQiKSwKICAgICAgICAgICAgICAgIHBhZGRpbmc9KDEsIDIpLAogICAgICAgICAgICAgICAgZXhwYW5kPVRydWUKICAgICAgICAgICAgKSkKICAgICAgICAgICAgcGF1c2UoKQogICAgICAgICAgICBzeXMuZXhpdCgxKQoKICAgIGVsc2U6CiAgICAgICAgdGV4dCA9IFRleHQuZnJvbV9tYXJrdXAoCiAgICAgICAgICAgIGYi4pqg77iPIFtib2xkIHllbGxvd11FcnJvciBzYWF0IG1lbmphbGFua2FuIGdpdCBwdWxsWy9dXG5cblt5ZWxsb3dde3Jlc3VsdFsnZXJyb3InXX1bL10iCiAgICAgICAgKQogICAgICAgIGNvbnNvbGUucHJpbnQoUGFuZWwoCiAgICAgICAgICAgIHRleHQsCiAgICAgICAgICAgIHRpdGxlPSLwn5OlIFVwZGF0ZSBDTEkiLAogICAgICAgICAgICBib3JkZXJfc3R5bGU9Z2V0X3RoZW1lX3N0eWxlKCJib3JkZXJfd2FybmluZyIsICJ5ZWxsb3ciKSwKICAgICAgICAgICAgcGFkZGluZz0oMSwgMiksCiAgICAgICAgICAgIGV4cGFuZD1UcnVlCiAgICAgICAgKSkKICAgICAgICBwYXVzZSgpCiAgICAgICAgc3lzLmV4aXQoMSkKCmRlZiBydW5fbWFpbigpOgogICAgaW1wb3J0IG1haW4KICAgIG1haW4ubWFpbigpCgppZiBfX25hbWVfXyA9PSAiX19tYWluX18iOgogICAgZ2l0X3B1bGxfcmViYXNlKCkKICAgIHJ1bl9tYWluKCkK').decode())
