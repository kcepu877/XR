#!/usr/bin/env python3
import base64
exec(base64.b64decode('aW1wb3J0IGpzb24KCmZyb20gYXBwMy5jb25maWcuaW1wb3J0cyBpbXBvcnQgKgpmcm9tIGFwcC5zZXJ2aWNlLmF1dGggaW1wb3J0IEF1dGhJbnN0YW5jZQpmcm9tIGFwcDMubWVudXMudXRpbCBpbXBvcnQgcGF1c2UsIGNsZWFyX3NjcmVlbiwgcHJpbnRfcGFuZWwsIGxpdmVfbG9hZGluZywgZ2V0X3J1cGlhaApmcm9tIGFwcDMuY2xpZW50LmVuZ3NlbCBpbXBvcnQgZ2V0X2JhbGFuY2UKZnJvbSBhcHAzLmNsaWVudC5zaGFyaW5nIGltcG9ydCBiYWxhbmNlX2FsbG90bWVudApmcm9tIGFwcDMuY2xpZW50LmNpYW0gaW1wb3J0IGdldF9hdXRoX2NvZGUKZnJvbSByaWNoLmNvbnNvbGUgaW1wb3J0IENvbnNvbGUKCmNvbnNvbGUgPSBDb25zb2xlKCkKCmRlZiBzaG93X2JhbGFuY2VfYWxsb3RtZW50X21lbnUoKToKICAgIHRoZW1lID0gZ2V0X3RoZW1lKCkKICAgIGFjdGl2ZV91c2VyID0gQXV0aEluc3RhbmNlLmdldF9hY3RpdmVfdXNlcigpCiAgICBjbGVhcl9zY3JlZW4oKQogICAgc2ltcGxlX251bWJlcigpCiAgICBlbnN1cmVfZ2l0KCkKCiAgICAjd2l0aCBsaXZlX2xvYWRpbmcoIvCflIQgTGFnaSBjZWsgc2FsZG8gYnJvLi4uIiwgdGhlbWUpOgogICAgYmFsYW5jZSA9IGdldF9iYWxhbmNlKEF1dGhJbnN0YW5jZS5hcGlfa2V5LCBhY3RpdmVfdXNlclsidG9rZW5zIl1bImlkX3Rva2VuIl0pCgogICAgaWYgbm90IGJhbGFuY2U6CiAgICAgICAgcHJpbnRfcGFuZWwoIuKaoO+4jyBVcHMiLCAiR2FnYWwgYW1iaWwgc2FsZG8gYnJvIPCfmqgiKQogICAgICAgIHBhdXNlKCkKICAgICAgICByZXR1cm4gIkJBQ0siCgogICAgYmFsYW5jZV9yZW1haW5pbmcgPSBiYWxhbmNlLmdldCgicmVtYWluaW5nIiwgMCkKICAgIGNvbnNvbGUucHJpbnQoUGFuZWwoCiAgICAgICAgQWxpZ24uY2VudGVyKGYi8J+SsCBCYWxhbmNlIFNoYXJpbmcgfCBScCB7Z2V0X3J1cGlhaChiYWxhbmNlX3JlbWFpbmluZyl9IiwgdmVydGljYWw9Im1pZGRsZSIpLAogICAgICAgIGJvcmRlcl9zdHlsZT10aGVtZVsiYm9yZGVyX2luZm8iXSwKICAgICAgICBwYWRkaW5nPSgxLCAyKSwKICAgICAgICBleHBhbmQ9VHJ1ZQogICAgKSkKICAgIGNvbnNvbGUucHJpbnQoUGFuZWwoCiAgICAgICAgQWxpZ24uY2VudGVyKCJQYXN0aWthbiBQSU4gdHJhbnNha3NpIHVkYWggZGktc2V0IGRpIE15WEwgYnJvIPCflJEiLCB2ZXJ0aWNhbD0ibWlkZGxlIiksCiAgICAgICAgYm9yZGVyX3N0eWxlPXRoZW1lWyJib3JkZXJfd2FybmluZyJdLAogICAgICAgIGV4cGFuZD1UcnVlCiAgICApKQoKICAgIHBpbiA9IGNvbnNvbGUuaW5wdXQoZiJbe3RoZW1lWyd0ZXh0X3N1YiddfV3wn5GJIE1hc3VraW4gUElOIDYgZGlnaXQ6Wy97dGhlbWVbJ3RleHRfc3ViJ119XSAiKS5zdHJpcCgpCiAgICBpZiBsZW4ocGluKSAhPSA2IG9yIG5vdCBwaW4uaXNkaWdpdCgpOgogICAgICAgIHByaW50X3BhbmVsKCLimqDvuI8gVXBzIiwgIkZvcm1hdCBQSU4gbmdhY28gYnJvIPCfmqgiKQogICAgICAgIHBhdXNlKCkKICAgICAgICByZXR1cm4gIkJBQ0siCgogICAgc3RhZ2VfdG9rZW4gPSBnZXRfYXV0aF9jb2RlKAogICAgICAgIGFjdGl2ZV91c2VyWyJ0b2tlbnMiXSwKICAgICAgICBwaW4sCiAgICAgICAgYWN0aXZlX3VzZXJbIm51bWJlciJdCiAgICApCiAgICBpZiBzdGFnZV90b2tlbiBpcyBOb25lOgogICAgICAgIHByaW50X3BhbmVsKCLimqDvuI8gVXBzIiwgIlN0YWdlIHRva2VuIGdhZ2FsIGRpYW1iaWwgYnJvIPCfmqgiKQogICAgICAgIHBhdXNlKCkKICAgICAgICByZXR1cm4gIkJBQ0siCgogICAgcmVjZWl2ZXJfbXNpc2RuID0gY29uc29sZS5pbnB1dChmIlt7dGhlbWVbJ3RleHRfc3ViJ119XfCfkYkgTWFzdWtpbiBub21vciBwZW5lcmltYSAoNjI4eHh4KTpbL3t0aGVtZVsndGV4dF9zdWInXX1dICIpLnN0cmlwKCkKICAgIGFtb3VudF9zdHIgPSBjb25zb2xlLmlucHV0KGYiW3t0aGVtZVsndGV4dF9zdWInXX1d8J+RiSBNYXN1a2luIG5vbWluYWwgKGN0aDogNTAwMCk6Wy97dGhlbWVbJ3RleHRfc3ViJ119XSAiKS5zdHJpcCgpCgogICAgdHJ5OgogICAgICAgIGFtb3VudCA9IGludChhbW91bnRfc3RyKQogICAgZXhjZXB0IFZhbHVlRXJyb3I6CiAgICAgICAgcHJpbnRfcGFuZWwoIuKaoO+4jyBVcHMiLCAiTm9taW5hbCBuZ2FjbyBicm8g8J+aqCIpCiAgICAgICAgcGF1c2UoKQogICAgICAgIHJldHVybiAiQkFDSyIKCiAgICB3aXRoIGxpdmVfbG9hZGluZygi8J+UhCBMYWdpIGtpcmltIHNhbGRvIGJyby4uLiIsIHRoZW1lKToKICAgICAgICByZXMgPSBiYWxhbmNlX2FsbG90bWVudCgKICAgICAgICAgICAgQXV0aEluc3RhbmNlLmFwaV9rZXksCiAgICAgICAgICAgIGFjdGl2ZV91c2VyWyJ0b2tlbnMiXSwKICAgICAgICAgICAgc3RhZ2VfdG9rZW4sCiAgICAgICAgICAgIHJlY2VpdmVyX21zaXNkbiwKICAgICAgICAgICAgYW1vdW50LAogICAgICAgICkKCiAgICBpZiByZXMgaXMgTm9uZToKICAgICAgICBwcmludF9wYW5lbCgi4pqg77iPIFVwcyIsICJCYWxhbmNlIGFsbG90bWVudCBnYWdhbCBicm8g8J+aqCIpCiAgICAgICAgcGF1c2UoKQogICAgICAgIHJldHVybiAiQkFDSyIKCiAgICBjb25zb2xlLnByaW50KFBhbmVsKAogICAgICAgIGpzb24uZHVtcHMocmVzLCBpbmRlbnQ9MiksCiAgICAgICAgdGl0bGU9ZiJbe3RoZW1lWyd0ZXh0X3RpdGxlJ119XfCfk5wgSGFzaWwgVHJhbnNha3NpWy9dIiwKICAgICAgICBib3JkZXJfc3R5bGU9dGhlbWVbImJvcmRlcl9zdWNjZXNzIl0sCiAgICAgICAgZXhwYW5kPVRydWUKICAgICkpCiAgICBwYXVzZSgpCiAgICByZXR1cm4gcmVzCg==').decode())
