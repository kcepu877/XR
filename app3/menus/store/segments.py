#!/usr/bin/env python3
import base64
exec(base64.b64decode('aW1wb3J0IGpzb24KZnJvbSBkYXRldGltZSBpbXBvcnQgZGF0ZXRpbWUKZnJvbSBhcHAzLmNsaWVudC5zdG9yZS5zZWdtZW50cyBpbXBvcnQgZ2V0X3NlZ21lbnRzCmZyb20gYXBwMy5tZW51cy51dGlsIGltcG9ydCAoCiAgICBjbGVhcl9zY3JlZW4sIHBhdXNlLCBwcmludF9wYW5lbCwgc2ltcGxlX251bWJlciwgZ2V0X3J1cGlhaAopCmZyb20gYXBwLnNlcnZpY2UuYXV0aCBpbXBvcnQgQXV0aEluc3RhbmNlCmZyb20gYXBwMy5tZW51cy5wYWNrYWdlIGltcG9ydCBzaG93X3BhY2thZ2VfZGV0YWlscwpmcm9tIGFwcDMuY29uZmlnLmltcG9ydHMgaW1wb3J0ICoKCmNvbnNvbGUgPSBDb25zb2xlKCkKCgpkZWYgc2hvd19zdG9yZV9zZWdtZW50c19tZW51KGlzX2VudGVycHJpc2U6IGJvb2wgPSBGYWxzZSk6CiAgICB0aGVtZSA9IGdldF90aGVtZSgpCiAgICBpbl9zdG9yZV9zZWdtZW50c19tZW51ID0gVHJ1ZQogICAgd2hpbGUgaW5fc3RvcmVfc2VnbWVudHNfbWVudToKICAgICAgICBhcGlfa2V5ID0gQXV0aEluc3RhbmNlLmFwaV9rZXkKICAgICAgICB0b2tlbnMgPSBBdXRoSW5zdGFuY2UuZ2V0X2FjdGl2ZV90b2tlbnMoKQogICAgICAgIAogICAgICAgIHNlZ21lbnRzX3JlcyA9IGdldF9zZWdtZW50cyhhcGlfa2V5LCB0b2tlbnMsIGlzX2VudGVycHJpc2UpCiAgICAgICAgaWYgbm90IHNlZ21lbnRzX3JlczoKICAgICAgICAgICAgcHJpbnRfcGFuZWwoIuKEue+4jyBJbmZvIiwgIlNlcGkgY3V5LCBuZ2dhayBhZGEgc3RvcmUgc2VnbWVudHMg8J+YtCIpCiAgICAgICAgICAgIGluX3N0b3JlX3NlZ21lbnRzX21lbnUgPSBGYWxzZQogICAgICAgICAgICBjb250aW51ZQogICAgICAgIAogICAgICAgIHNlZ21lbnRzID0gc2VnbWVudHNfcmVzLmdldCgiZGF0YSIsIHt9KS5nZXQoInN0b3JlX3NlZ21lbnRzIiwgW10pCiAgICAgICAgY2xlYXJfc2NyZWVuKCkKICAgICAgICBlbnN1cmVfZ2l0KCkKICAgICAgICAKICAgICAgICBjb25zb2xlLnByaW50KFBhbmVsKAogICAgICAgICAgICBBbGlnbi5jZW50ZXIoIvCfm5IgU3RvcmUgU2VnbWVudHMg8J+kmSIsIHZlcnRpY2FsPSJtaWRkbGUiKSwKICAgICAgICAgICAgYm9yZGVyX3N0eWxlPXRoZW1lWyJib3JkZXJfaW5mbyJdLAogICAgICAgICAgICBwYWRkaW5nPSgxLDIpLAogICAgICAgICAgICBleHBhbmQ9VHJ1ZQogICAgICAgICkpCiAgICAgICAgc2ltcGxlX251bWJlcigpCiAgICAgICAgCiAgICAgICAgcGFja2FnZXMgPSB7fQogICAgICAgIGZvciBpLCBzZWdtZW50IGluIGVudW1lcmF0ZShzZWdtZW50cyk6CiAgICAgICAgICAgIG5hbWUgPSBzZWdtZW50LmdldCgidGl0bGUiLCAiTi9BIikKICAgICAgICAgICAgYmFubmVycyA9IHNlZ21lbnQuZ2V0KCJiYW5uZXJzIiwgW10pCiAgICAgICAgICAgIGxldHRlciA9IGNocig2NSArIGkpICAjIENvbnZlcnQgMCAtPiBBLCAxIC0+IEIsIGV0Yy4KICAgICAgICAgICAgCiAgICAgICAgICAgIHRhYmxlID0gVGFibGUoYm94PU1JTklNQUxfRE9VQkxFX0hFQUQsIGV4cGFuZD1UcnVlKQogICAgICAgICAgICB0YWJsZS5hZGRfY29sdW1uKCJLb2RlIiwgc3R5bGU9dGhlbWVbInRleHRfa2V5Il0sIHdpZHRoPTYpCiAgICAgICAgICAgIHRhYmxlLmFkZF9jb2x1bW4oIkZhbWlseSIsIHN0eWxlPXRoZW1lWyJ0ZXh0X2JvZHkiXSkKICAgICAgICAgICAgdGFibGUuYWRkX2NvbHVtbigiUGFrZXQiLCBzdHlsZT10aGVtZVsidGV4dF9ib2R5Il0pCiAgICAgICAgICAgIHRhYmxlLmFkZF9jb2x1bW4oIkFrdGlmIiwgc3R5bGU9dGhlbWVbInRleHRfZGF0ZSJdKQogICAgICAgICAgICB0YWJsZS5hZGRfY29sdW1uKCJIYXJnYSIsIHN0eWxlPXRoZW1lWyJ0ZXh0X21vbmV5Il0sIGp1c3RpZnk9InJpZ2h0IikKICAgICAgICAgICAgCiAgICAgICAgICAgIGlmIG5vdCBiYW5uZXJzOgogICAgICAgICAgICAgICAgdGFibGUuYWRkX3JvdygiLSIsIGYie25hbWV9IChrb3NvbmcgYnJvKSIsICItIiwgIi0iLCAiLSIpCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBmb3IgaiwgYmFubmVyIGluIGVudW1lcmF0ZShiYW5uZXJzKToKICAgICAgICAgICAgICAgICAgICB0aXRsZSA9IGJhbm5lci5nZXQoInRpdGxlIiwgIk4vQSIpCiAgICAgICAgICAgICAgICAgICAgdmFsaWRpdHkgPSBiYW5uZXIuZ2V0KCJ2YWxpZGl0eSIsICJOL0EiKQogICAgICAgICAgICAgICAgICAgIGZhbWlseV9uYW1lID0gYmFubmVyLmdldCgiZmFtaWx5X25hbWUiLCAiTi9BIikKICAgICAgICAgICAgICAgICAgICBhY3Rpb25fcGFyYW0gPSBiYW5uZXIuZ2V0KCJhY3Rpb25fcGFyYW0iLCAiIikKICAgICAgICAgICAgICAgICAgICBhY3Rpb25fdHlwZSA9IGJhbm5lci5nZXQoImFjdGlvbl90eXBlIiwgIiIpCiAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgIyBoYXJnYTogb3JpZ2luYWwgKyBkaXNjb3VudGVkCiAgICAgICAgICAgICAgICAgICAgb3JpZ2luYWxfcHJpY2UgPSBiYW5uZXIuZ2V0KCJvcmlnaW5hbF9wcmljZSIsIDApCiAgICAgICAgICAgICAgICAgICAgZGlzY291bnRlZF9wcmljZSA9IGJhbm5lci5nZXQoImRpc2NvdW50ZWRfcHJpY2UiLCAwKQogICAgICAgICAgICAgICAgICAgIGlmIGRpc2NvdW50ZWRfcHJpY2UgYW5kIGRpc2NvdW50ZWRfcHJpY2UgPiAwOgogICAgICAgICAgICAgICAgICAgICAgICBoYXJnYV9zdHIgPSBmIntnZXRfcnVwaWFoKG9yaWdpbmFsX3ByaWNlKX0g4p6h77iPIHtnZXRfcnVwaWFoKGRpc2NvdW50ZWRfcHJpY2UpfSIKICAgICAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgICAgICBoYXJnYV9zdHIgPSBnZXRfcnVwaWFoKG9yaWdpbmFsX3ByaWNlKQogICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgIGNvZGUgPSBmIntsZXR0ZXJ9e2orMX0iCiAgICAgICAgICAgICAgICAgICAgcGFja2FnZXNbY29kZS5sb3dlcigpXSA9IHsKICAgICAgICAgICAgICAgICAgICAgICAgImFjdGlvbl9wYXJhbSI6IGFjdGlvbl9wYXJhbSwKICAgICAgICAgICAgICAgICAgICAgICAgImFjdGlvbl90eXBlIjogYWN0aW9uX3R5cGUKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgdGFibGUuYWRkX3Jvdyhjb2RlLCBmYW1pbHlfbmFtZSwgdGl0bGUsIHZhbGlkaXR5LCBoYXJnYV9zdHIpCiAgICAgICAgICAgIAogICAgICAgICAgICBjb25zb2xlLnByaW50KFBhbmVsKAogICAgICAgICAgICAgICAgdGFibGUsCiAgICAgICAgICAgICAgICB0aXRsZT1mIlt7dGhlbWVbJ3RleHRfdGl0bGUnXX1d8J+TgiBTZWdtZW50OiB7bmFtZX1bL10iLAogICAgICAgICAgICAgICAgYm9yZGVyX3N0eWxlPXRoZW1lWyJib3JkZXJfaW5mbyJdLAogICAgICAgICAgICAgICAgcGFkZGluZz0oMCwgMCksCiAgICAgICAgICAgICAgICBleHBhbmQ9VHJ1ZQogICAgICAgICAgICApKQogICAgICAgIAogICAgICAgIG5hdiA9IFRhYmxlKHNob3dfaGVhZGVyPUZhbHNlLCBib3g9TUlOSU1BTF9ET1VCTEVfSEVBRCwgZXhwYW5kPVRydWUpCiAgICAgICAgbmF2LmFkZF9jb2x1bW4oanVzdGlmeT0icmlnaHQiLCBzdHlsZT10aGVtZVsidGV4dF9rZXkiXSwgd2lkdGg9NikKICAgICAgICBuYXYuYWRkX2NvbHVtbihzdHlsZT10aGVtZVsidGV4dF9ib2R5Il0pCiAgICAgICAgbmF2LmFkZF9yb3coIjAwIiwgZiJbe3RoZW1lWyd0ZXh0X3N1YiddfV1DYWJ1dCBiYWxpayBrZSBtZW51IHV0YW1hIPCfj6BbL10iKQogICAgICAgIAogICAgICAgIGNvbnNvbGUucHJpbnQoUGFuZWwobmF2LCBib3JkZXJfc3R5bGU9dGhlbWVbImJvcmRlcl9wcmltYXJ5Il0sIGV4cGFuZD1UcnVlKSkKICAgICAgICAKICAgICAgICBjaG9pY2UgPSBjb25zb2xlLmlucHV0KGYiW3t0aGVtZVsndGV4dF9zdWInXX1dUGlsaWggYmFubmVyIChtaXNhbCBBMSwgQjIpOiDwn5GJIFsve3RoZW1lWyd0ZXh0X3N1YiddfV0gIikuc3RyaXAoKQogICAgICAgIGlmIGNob2ljZSA9PSAiMDAiOgogICAgICAgICAgICBpbl9zdG9yZV9zZWdtZW50c19tZW51ID0gRmFsc2UKICAgICAgICAgICAgY29udGludWUKICAgICAgICAKICAgICAgICBzZWxlY3RlZF9wa2cgPSBwYWNrYWdlcy5nZXQoY2hvaWNlLmxvd2VyKCkpCiAgICAgICAgaWYgbm90IHNlbGVjdGVkX3BrZzoKICAgICAgICAgICAgcHJpbnRfcGFuZWwoIuKdjCBVcHMiLCAiUGlsaWhhbiBsbyBuZ2FjbyBicm8g8J+kryIpCiAgICAgICAgICAgIHBhdXNlKCkKICAgICAgICAgICAgY29udGludWUKICAgICAgICAKICAgICAgICBhY3Rpb25fcGFyYW0gPSBzZWxlY3RlZF9wa2dbImFjdGlvbl9wYXJhbSJdCiAgICAgICAgYWN0aW9uX3R5cGUgPSBzZWxlY3RlZF9wa2dbImFjdGlvbl90eXBlIl0KICAgICAgICAKICAgICAgICBpZiBhY3Rpb25fdHlwZSA9PSAiUERQIjoKICAgICAgICAgICAgc2hvd19wYWNrYWdlX2RldGFpbHMoYXBpX2tleSwgdG9rZW5zLCBhY3Rpb25fcGFyYW0sIGlzX2VudGVycHJpc2UpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgcHJpbnRfcGFuZWwoIuKEue+4jyBJbmZvIiwgZiJCZWx1bSBhZGEgYWtzaSBidWF0IHRpcGUgaW5pIGJybzoge2FjdGlvbl90eXBlfVxuUGFyYW06IHthY3Rpb25fcGFyYW19IikKICAgICAgICAgICAgcGF1c2UoKQo=').decode())
