#!/usr/bin/env python3
import base64
exec(base64.b64decode('ZnJvbSBhcHAzLmNsaWVudC5zdG9yZS5zZWFyY2ggaW1wb3J0IGdldF9mYW1pbHlfbGlzdCwgZ2V0X3N0b3JlX3BhY2thZ2VzCmZyb20gYXBwMy5tZW51cy5wYWNrYWdlIGltcG9ydCBnZXRfcGFja2FnZXNfYnlfZmFtaWx5LCBzaG93X3BhY2thZ2VfZGV0YWlscwpmcm9tIGFwcDMubWVudXMudXRpbCBpbXBvcnQgY2xlYXJfc2NyZWVuLCBwYXVzZSwgcHJpbnRfcGFuZWwsIHNpbXBsZV9udW1iZXIsIGdldF9ydXBpYWgsIGxpdmVfbG9hZGluZwpmcm9tIGFwcC5zZXJ2aWNlLmF1dGggaW1wb3J0IEF1dGhJbnN0YW5jZQpmcm9tIGFwcDMuY29uZmlnLmltcG9ydHMgaW1wb3J0ICoKCmNvbnNvbGUgPSBDb25zb2xlKCkKCgpkZWYgc2hvd19mYW1pbHlfbGlzdF9tZW51KAogICAgc3Vic190eXBlOiBzdHIgPSAiUFJFUEFJRCIsCiAgICBpc19lbnRlcnByaXNlOiBib29sID0gRmFsc2UsCik6CiAgICB0aGVtZSA9IGdldF90aGVtZSgpCiAgICBpbl9mYW1pbHlfbGlzdF9tZW51ID0gVHJ1ZQogICAgd2hpbGUgaW5fZmFtaWx5X2xpc3RfbWVudToKICAgICAgICBhcGlfa2V5ID0gQXV0aEluc3RhbmNlLmFwaV9rZXkKICAgICAgICB0b2tlbnMgPSBBdXRoSW5zdGFuY2UuZ2V0X2FjdGl2ZV90b2tlbnMoKQogICAgICAgIAogICAgICAgIGZhbWlseV9saXN0X3JlcyA9IGdldF9mYW1pbHlfbGlzdChhcGlfa2V5LCB0b2tlbnMsIHN1YnNfdHlwZSwgaXNfZW50ZXJwcmlzZSkKICAgICAgICBpZiBub3QgZmFtaWx5X2xpc3RfcmVzOgogICAgICAgICAgICBwcmludF9wYW5lbCgi4oS577iPIEluZm8iLCAiU2VwaSBjdXksIG5nZ2FrIGFkYSBmYW1pbHkgbGlzdCDwn5i0IikKICAgICAgICAgICAgaW5fZmFtaWx5X2xpc3RfbWVudSA9IEZhbHNlCiAgICAgICAgICAgIGNvbnRpbnVlCiAgICAgICAgCiAgICAgICAgZmFtaWx5X2xpc3QgPSBmYW1pbHlfbGlzdF9yZXMuZ2V0KCJkYXRhIiwge30pLmdldCgicmVzdWx0cyIsIFtdKQogICAgICAgIGNsZWFyX3NjcmVlbigpCiAgICAgICAgZW5zdXJlX2dpdCgpCiAgICAgICAgCiAgICAgICAgY29uc29sZS5wcmludChQYW5lbCgKICAgICAgICAgICAgQWxpZ24uY2VudGVyKCLwn5Go4oCN8J+RqeKAjfCfkafigI3wn5GmIEZhbWlseSBMaXN0IPCfpJkiLCB2ZXJ0aWNhbD0ibWlkZGxlIiksCiAgICAgICAgICAgIGJvcmRlcl9zdHlsZT10aGVtZVsiYm9yZGVyX2luZm8iXSwKICAgICAgICAgICAgcGFkZGluZz0oMSwyKSwKICAgICAgICAgICAgZXhwYW5kPVRydWUKICAgICAgICApKQogICAgICAgIHNpbXBsZV9udW1iZXIoKQogICAgICAgIAogICAgICAgIHRhYmxlID0gVGFibGUoYm94PU1JTklNQUxfRE9VQkxFX0hFQUQsIGV4cGFuZD1UcnVlKQogICAgICAgIHRhYmxlLmFkZF9jb2x1bW4oIk5vIiwganVzdGlmeT0icmlnaHQiLCBzdHlsZT10aGVtZVsidGV4dF9rZXkiXSwgd2lkdGg9NCkKICAgICAgICB0YWJsZS5hZGRfY29sdW1uKCJOYW1hIEZhbWlseSIsIHN0eWxlPXRoZW1lWyJ0ZXh0X2JvZHkiXSkKICAgICAgICB0YWJsZS5hZGRfY29sdW1uKCJLb2RlIiwgc3R5bGU9dGhlbWVbImJvcmRlcl93YXJuaW5nIl0pCiAgICAgICAgCiAgICAgICAgZm9yIGksIGZhbWlseSBpbiBlbnVtZXJhdGUoZmFtaWx5X2xpc3QsIHN0YXJ0PTEpOgogICAgICAgICAgICB0YWJsZS5hZGRfcm93KHN0cihpKSwgZmFtaWx5LmdldCgibGFiZWwiLCJOL0EiKSwgZmFtaWx5LmdldCgiaWQiLCJOL0EiKSkKICAgICAgICAKICAgICAgICBjb25zb2xlLnByaW50KFBhbmVsKHRhYmxlLCBib3JkZXJfc3R5bGU9dGhlbWVbImJvcmRlcl9pbmZvIl0sIHBhZGRpbmc9KDAsIDApLCBleHBhbmQ9VHJ1ZSkpCiAgICAgICAgCiAgICAgICAgbmF2ID0gVGFibGUoc2hvd19oZWFkZXI9RmFsc2UsIGJveD1NSU5JTUFMX0RPVUJMRV9IRUFELCBleHBhbmQ9VHJ1ZSkKICAgICAgICBuYXYuYWRkX2NvbHVtbihqdXN0aWZ5PSJyaWdodCIsIHN0eWxlPXRoZW1lWyJ0ZXh0X2tleSJdLCB3aWR0aD02KQogICAgICAgIG5hdi5hZGRfY29sdW1uKHN0eWxlPXRoZW1lWyJ0ZXh0X2JvZHkiXSkKICAgICAgICBuYXYuYWRkX3JvdygiMDAiLCBmIlt7dGhlbWVbJ3RleHRfc3ViJ119XUNhYnV0IGJhbGlrIGtlIG1lbnUgdXRhbWEg8J+PoFsvXSIpCiAgICAgICAgCiAgICAgICAgY29uc29sZS5wcmludChQYW5lbChuYXYsIGJvcmRlcl9zdHlsZT10aGVtZVsiYm9yZGVyX3ByaW1hcnkiXSwgZXhwYW5kPVRydWUpKQogICAgICAgIAogICAgICAgIGNob2ljZSA9IGNvbnNvbGUuaW5wdXQoZiJbe3RoZW1lWyd0ZXh0X3N1YiddfV1QaWxpaCBmYW1pbHkgKG5vbW9yKTog8J+RiSBbL3t0aGVtZVsndGV4dF9zdWInXX1dICIpLnN0cmlwKCkKICAgICAgICBpZiBjaG9pY2UgPT0gIjAwIjoKICAgICAgICAgICAgaW5fZmFtaWx5X2xpc3RfbWVudSA9IEZhbHNlCiAgICAgICAgICAgIGNvbnRpbnVlCiAgICAgICAgaWYgY2hvaWNlLmlzZGlnaXQoKSBhbmQgMSA8PSBpbnQoY2hvaWNlKSA8PSBsZW4oZmFtaWx5X2xpc3QpOgogICAgICAgICAgICBzZWxlY3RlZF9mYW1pbHkgPSBmYW1pbHlfbGlzdFtpbnQoY2hvaWNlKS0xXQogICAgICAgICAgICBmYW1pbHlfY29kZSA9IHNlbGVjdGVkX2ZhbWlseS5nZXQoImlkIiwiIikKICAgICAgICAgICAgZmFtaWx5X25hbWUgPSBzZWxlY3RlZF9mYW1pbHkuZ2V0KCJsYWJlbCIsIk4vQSIpCiAgICAgICAgICAgIGNvbnNvbGUucHJpbnQoUGFuZWwoZiLwn5SNIExhZ2kgbnlhcmkgcGFrZXQgYnVhdCBmYW1pbHk6IHtmYW1pbHlfbmFtZX0g8J+agCIsIGJvcmRlcl9zdHlsZT10aGVtZVsiYm9yZGVyX2luZm8iXSkpCiAgICAgICAgICAgIGdldF9wYWNrYWdlc19ieV9mYW1pbHkoZmFtaWx5X2NvZGUpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgcHJpbnRfcGFuZWwoIuKdjCBVcHMiLCAiUGlsaWhhbiBsbyBuZ2FjbyBicm8g8J+kryIpCiAgICAgICAgICAgIHBhdXNlKCkKCgpkZWYgc2hvd19zdG9yZV9wYWNrYWdlc19tZW51KAogICAgc3Vic190eXBlOiBzdHIgPSAiUFJFUEFJRCIsCiAgICBpc19lbnRlcnByaXNlOiBib29sID0gRmFsc2UsCik6CiAgICB0aGVtZSA9IGdldF90aGVtZSgpCiAgICBpbl9zdG9yZV9wYWNrYWdlc19tZW51ID0gVHJ1ZQogICAgd2hpbGUgaW5fc3RvcmVfcGFja2FnZXNfbWVudToKICAgICAgICBhcGlfa2V5ID0gQXV0aEluc3RhbmNlLmFwaV9rZXkKICAgICAgICB0b2tlbnMgPSBBdXRoSW5zdGFuY2UuZ2V0X2FjdGl2ZV90b2tlbnMoKQogICAgICAgIAogICAgICAgIHN0b3JlX3BhY2thZ2VzX3JlcyA9IGdldF9zdG9yZV9wYWNrYWdlcyhhcGlfa2V5LCB0b2tlbnMsIHN1YnNfdHlwZSwgaXNfZW50ZXJwcmlzZSkKICAgICAgICBpZiBub3Qgc3RvcmVfcGFja2FnZXNfcmVzOgogICAgICAgICAgICBwcmludF9wYW5lbCgi4oS577iPIEluZm8iLCAiU2VwaSBjdXksIG5nZ2FrIGFkYSBwYWtldCBkaSBzdG9yZSDwn5i0IikKICAgICAgICAgICAgaW5fc3RvcmVfcGFja2FnZXNfbWVudSA9IEZhbHNlCiAgICAgICAgICAgIGNvbnRpbnVlCiAgICAgICAgCiAgICAgICAgc3RvcmVfcGFja2FnZXMgPSBzdG9yZV9wYWNrYWdlc19yZXMuZ2V0KCJkYXRhIiwge30pLmdldCgicmVzdWx0c19wcmljZV9vbmx5IiwgW10pCiAgICAgICAgY2xlYXJfc2NyZWVuKCkKICAgICAgICBlbnN1cmVfZ2l0KCkKICAgICAgICAKICAgICAgICBjb25zb2xlLnByaW50KFBhbmVsKAogICAgICAgICAgICBBbGlnbi5jZW50ZXIoIvCfm5IgU3RvcmUgUGFja2FnZXMg8J+kmSIsIHZlcnRpY2FsPSJtaWRkbGUiKSwKICAgICAgICAgICAgYm9yZGVyX3N0eWxlPXRoZW1lWyJib3JkZXJfaW5mbyJdLAogICAgICAgICAgICBwYWRkaW5nPSgxLDIpLAogICAgICAgICAgICBleHBhbmQ9VHJ1ZQogICAgICAgICkpCiAgICAgICAgc2ltcGxlX251bWJlcigpCgogICAgICAgIHdpdGggbGl2ZV9sb2FkaW5nKCLwn5SEIExhZ2kgbnl1c3VuIHRhYmVsIHBha2V0IGJyby4uLiIsIHRoZW1lKToKICAgICAgICAgICAgdGFibGUgPSBUYWJsZShib3g9TUlOSU1BTF9ET1VCTEVfSEVBRCwgZXhwYW5kPVRydWUpCiAgICAgICAgICAgIHRhYmxlLmFkZF9jb2x1bW4oIk5vIiwganVzdGlmeT0icmlnaHQiLCBzdHlsZT10aGVtZVsidGV4dF9rZXkiXSwgd2lkdGg9NCkKICAgICAgICAgICAgdGFibGUuYWRkX2NvbHVtbigiUGFrZXQiLCBzdHlsZT10aGVtZVsidGV4dF9ib2R5Il0pCiAgICAgICAgICAgIHRhYmxlLmFkZF9jb2x1bW4oIkZhbWlseSIsIHN0eWxlPXRoZW1lWyJ0ZXh0X2JvZHkiXSkKICAgICAgICAgICAgdGFibGUuYWRkX2NvbHVtbigiQWt0aWYiLCBzdHlsZT10aGVtZVsidGV4dF9kYXRlIl0pCiAgICAgICAgICAgIHRhYmxlLmFkZF9jb2x1bW4oIkhhcmdhIiwgc3R5bGU9dGhlbWVbInRleHRfbW9uZXkiXSwganVzdGlmeT0icmlnaHQiKQogICAgICAgICAgICAKICAgICAgICAgICAgcGFja2FnZXMgPSB7fQogICAgICAgICAgICBmb3IgaSwgcGFja2FnZSBpbiBlbnVtZXJhdGUoc3RvcmVfcGFja2FnZXMsIHN0YXJ0PTEpOgogICAgICAgICAgICAgICAgdGl0bGUgPSBwYWNrYWdlLmdldCgidGl0bGUiLCJOL0EiKQogICAgICAgICAgICAgICAgb3JpZ2luYWxfcHJpY2UgPSBwYWNrYWdlLmdldCgib3JpZ2luYWxfcHJpY2UiLDApCiAgICAgICAgICAgICAgICBkaXNjb3VudGVkX3ByaWNlID0gcGFja2FnZS5nZXQoImRpc2NvdW50ZWRfcHJpY2UiLDApCiAgICAgICAgICAgICAgICB2YWxpZGl0eSA9IHBhY2thZ2UuZ2V0KCJ2YWxpZGl0eSIsIk4vQSIpCiAgICAgICAgICAgICAgICBmYW1pbHlfbmFtZSA9IHBhY2thZ2UuZ2V0KCJmYW1pbHlfbmFtZSIsIk4vQSIpCiAgICAgICAgICAgICAgICBhY3Rpb25fdHlwZSA9IHBhY2thZ2UuZ2V0KCJhY3Rpb25fdHlwZSIsIiIpCiAgICAgICAgICAgICAgICBhY3Rpb25fcGFyYW0gPSBwYWNrYWdlLmdldCgiYWN0aW9uX3BhcmFtIiwiIikKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgcGFja2FnZXNbc3RyKGkpXSA9IHsiYWN0aW9uX3R5cGUiOiBhY3Rpb25fdHlwZSwgImFjdGlvbl9wYXJhbSI6IGFjdGlvbl9wYXJhbX0KICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgaWYgZGlzY291bnRlZF9wcmljZSBhbmQgZGlzY291bnRlZF9wcmljZSA+IDA6CiAgICAgICAgICAgICAgICAgICAgaGFyZ2Ffc3RyID0gZiJ7Z2V0X3J1cGlhaChvcmlnaW5hbF9wcmljZSl9IOKeoe+4jyB7Z2V0X3J1cGlhaChkaXNjb3VudGVkX3ByaWNlKX0iCiAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgIGhhcmdhX3N0ciA9IGdldF9ydXBpYWgob3JpZ2luYWxfcHJpY2UpCiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIHRhYmxlLmFkZF9yb3coc3RyKGkpLCB0aXRsZSwgZmFtaWx5X25hbWUsIHZhbGlkaXR5LCBoYXJnYV9zdHIpCiAgICAgICAgCiAgICAgICAgY29uc29sZS5wcmludChQYW5lbCh0YWJsZSwgYm9yZGVyX3N0eWxlPXRoZW1lWyJib3JkZXJfaW5mbyJdLCBwYWRkaW5nPSgwLCAwKSwgZXhwYW5kPVRydWUpKQogICAgICAgIAogICAgICAgIG5hdiA9IFRhYmxlKHNob3dfaGVhZGVyPUZhbHNlLCBib3g9TUlOSU1BTF9ET1VCTEVfSEVBRCwgZXhwYW5kPVRydWUpCiAgICAgICAgbmF2LmFkZF9jb2x1bW4oanVzdGlmeT0icmlnaHQiLCBzdHlsZT10aGVtZVsidGV4dF9rZXkiXSwgd2lkdGg9NikKICAgICAgICBuYXYuYWRkX2NvbHVtbihzdHlsZT10aGVtZVsidGV4dF9ib2R5Il0pCiAgICAgICAgbmF2LmFkZF9yb3coIjAwIiwgZiJbe3RoZW1lWyd0ZXh0X3N1YiddfV1DYWJ1dCBiYWxpayBrZSBtZW51IHV0YW1hIPCfj6BbL10iKQogICAgICAgIAogICAgICAgIGNvbnNvbGUucHJpbnQoUGFuZWwobmF2LCBib3JkZXJfc3R5bGU9dGhlbWVbImJvcmRlcl9wcmltYXJ5Il0sIGV4cGFuZD1UcnVlKSkKICAgICAgICAKICAgICAgICBjaG9pY2UgPSBjb25zb2xlLmlucHV0KGYiW3t0aGVtZVsndGV4dF9zdWInXX1dUGlsaWggcGFrZXQgKG5vbW9yKTog8J+RiSBbL3t0aGVtZVsndGV4dF9zdWInXX1dICIpLnN0cmlwKCkKICAgICAgICBpZiBjaG9pY2UgPT0gIjAwIjoKICAgICAgICAgICAgaW5fc3RvcmVfcGFja2FnZXNfbWVudSA9IEZhbHNlCiAgICAgICAgICAgIGNvbnRpbnVlCiAgICAgICAgZWxpZiBjaG9pY2UgaW4gcGFja2FnZXM6CiAgICAgICAgICAgIHNlbGVjdGVkID0gcGFja2FnZXNbY2hvaWNlXQogICAgICAgICAgICBpZiBzZWxlY3RlZFsiYWN0aW9uX3R5cGUiXSA9PSAiUERQIjoKICAgICAgICAgICAgICAgIHNob3dfcGFja2FnZV9kZXRhaWxzKGFwaV9rZXksIHRva2Vucywgc2VsZWN0ZWRbImFjdGlvbl9wYXJhbSJdLCBpc19lbnRlcnByaXNlKQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgcHJpbnRfcGFuZWwoIuKEue+4jyBJbmZvIiwgZiJCZWx1bSBhZGEgYWtzaSBidWF0IHRpcGUgaW5pIGJybzoge3NlbGVjdGVkWydhY3Rpb25fdHlwZSddfVxuUGFyYW06IHtzZWxlY3RlZFsnYWN0aW9uX3BhcmFtJ119IikKICAgICAgICAgICAgICAgIHBhdXNlKCkKICAgICAgICBlbHNlOgogICAgICAgICAgICBwcmludF9wYW5lbCgi4p2MIFVwcyIsICJQaWxpaGFuIGxvIG5nYWNvIGJybyDwn6SvIikKICAgICAgICAgICAgcGF1c2UoKQo=').decode())
