#!/usr/bin/env python3
import base64
exec(base64.b64decode('ZnJvbSBhcHAzLmNsaWVudC5zdG9yZS5yZWRlZW1hYmxlcyBpbXBvcnQgZ2V0X3JlZGVlbWFibGVzCmZyb20gYXBwLnNlcnZpY2UuYXV0aCBpbXBvcnQgQXV0aEluc3RhbmNlCmZyb20gYXBwMy5tZW51cy51dGlsIGltcG9ydCBjbGVhcl9zY3JlZW4sIHBhdXNlLCBwcmludF9wYW5lbCwgc2ltcGxlX251bWJlcgpmcm9tIGFwcDMubWVudXMucGFja2FnZSBpbXBvcnQgc2hvd19wYWNrYWdlX2RldGFpbHMsIGdldF9wYWNrYWdlc19ieV9mYW1pbHkKZnJvbSBhcHAzLmNvbmZpZy5pbXBvcnRzIGltcG9ydCAqCmZyb20gZGF0ZXRpbWUgaW1wb3J0IGRhdGV0aW1lCgpjb25zb2xlID0gQ29uc29sZSgpCgoKZGVmIHNob3dfcmVkZWVtYWJsZXNfbWVudShpc19lbnRlcnByaXNlOiBib29sID0gRmFsc2UpOgogICAgdGhlbWUgPSBnZXRfdGhlbWUoKQogICAgaW5fcmVkZWVtYWJsZXNfbWVudSA9IFRydWUKICAgIHdoaWxlIGluX3JlZGVlbWFibGVzX21lbnU6CiAgICAgICAgYXBpX2tleSA9IEF1dGhJbnN0YW5jZS5hcGlfa2V5CiAgICAgICAgdG9rZW5zID0gQXV0aEluc3RhbmNlLmdldF9hY3RpdmVfdG9rZW5zKCkKICAgICAgICAKICAgICAgICByZWRlZW1hYmxlc19yZXMgPSBnZXRfcmVkZWVtYWJsZXMoYXBpX2tleSwgdG9rZW5zLCBpc19lbnRlcnByaXNlKQogICAgICAgIGlmIG5vdCByZWRlZW1hYmxlc19yZXM6CiAgICAgICAgICAgIHByaW50X3BhbmVsKCLihLnvuI8gSW5mbyIsICJTZXBpIGN1eSwgbmdnYWsgYWRhIHJlZGVlbWFibGVzIG1hc3VrIPCfmLQiKQogICAgICAgICAgICBpbl9yZWRlZW1hYmxlc19tZW51ID0gRmFsc2UKICAgICAgICAgICAgY29udGludWUKICAgICAgICAKICAgICAgICBjYXRlZ29yaWVzID0gcmVkZWVtYWJsZXNfcmVzLmdldCgiZGF0YSIsIHt9KS5nZXQoImNhdGVnb3JpZXMiLCBbXSkKICAgICAgICBjbGVhcl9zY3JlZW4oKQogICAgICAgIGVuc3VyZV9naXQoKQogICAgICAgIAogICAgICAgIGNvbnNvbGUucHJpbnQoUGFuZWwoCiAgICAgICAgICAgIEFsaWduLmNlbnRlcigi8J+OgSBSZWRlZW1hYmxlcyDwn6SZIiwgdmVydGljYWw9Im1pZGRsZSIpLAogICAgICAgICAgICBib3JkZXJfc3R5bGU9dGhlbWVbImJvcmRlcl9pbmZvIl0sCiAgICAgICAgICAgIHBhZGRpbmc9KDEsMiksCiAgICAgICAgICAgIGV4cGFuZD1UcnVlCiAgICAgICAgKSkKICAgICAgICBzaW1wbGVfbnVtYmVyKCkKICAgICAgICAKICAgICAgICBwYWNrYWdlcyA9IHt9CiAgICAgICAgZm9yIGksIGNhdGVnb3J5IGluIGVudW1lcmF0ZShjYXRlZ29yaWVzKToKICAgICAgICAgICAgY2F0ZWdvcnlfbmFtZSA9IGNhdGVnb3J5LmdldCgiY2F0ZWdvcnlfbmFtZSIsICJOL0EiKQogICAgICAgICAgICBjYXRlZ29yeV9jb2RlID0gY2F0ZWdvcnkuZ2V0KCJjYXRlZ29yeV9jb2RlIiwgIk4vQSIpCiAgICAgICAgICAgIHJlZGVlbWFibGVzID0gY2F0ZWdvcnkuZ2V0KCJyZWRlZW1hYmxlcyIsIFtdKQogICAgICAgICAgICAKICAgICAgICAgICAgbGV0dGVyID0gY2hyKDY1ICsgaSkKICAgICAgICAgICAgdGFibGUgPSBUYWJsZShib3g9TUlOSU1BTF9ET1VCTEVfSEVBRCwgZXhwYW5kPVRydWUpCiAgICAgICAgICAgIHRhYmxlLmFkZF9jb2x1bW4oIktvZGUiLCBzdHlsZT10aGVtZVsidGV4dF9rZXkiXSwgd2lkdGg9NikKICAgICAgICAgICAgdGFibGUuYWRkX2NvbHVtbigiTmFtYSBCYXJhbmciLCBzdHlsZT10aGVtZVsidGV4dF9ib2R5Il0pCiAgICAgICAgICAgIHRhYmxlLmFkZF9jb2x1bW4oIkJlcmxha3UiLCBzdHlsZT10aGVtZVsidGV4dF9kYXRlIl0pCiAgICAgICAgICAgIHRhYmxlLmFkZF9jb2x1bW4oIlRpcGUiLCBzdHlsZT10aGVtZVsidGV4dF9ib2R5Il0pCiAgICAgICAgICAgIAogICAgICAgICAgICBpZiBub3QgcmVkZWVtYWJsZXM6CiAgICAgICAgICAgICAgICB0YWJsZS5hZGRfcm93KCItIiwgZiJ7Y2F0ZWdvcnlfbmFtZX0gKGtvc29uZyBicm8pIiwgIi0iLCAiLSIpCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBmb3IgaiwgcmVkZWVtYWJsZSBpbiBlbnVtZXJhdGUocmVkZWVtYWJsZXMpOgogICAgICAgICAgICAgICAgICAgIG5hbWUgPSByZWRlZW1hYmxlLmdldCgibmFtZSIsICJOL0EiKQogICAgICAgICAgICAgICAgICAgIHZhbGlkX3VudGlsID0gcmVkZWVtYWJsZS5nZXQoInZhbGlkX3VudGlsIiwgMCkKICAgICAgICAgICAgICAgICAgICB2YWxpZF91bnRpbF9kYXRlID0gZGF0ZXRpbWUuZnJvbXRpbWVzdGFtcCh2YWxpZF91bnRpbCkuc3RyZnRpbWUoIiVZLSVtLSVkIikKICAgICAgICAgICAgICAgICAgICBhY3Rpb25fcGFyYW0gPSByZWRlZW1hYmxlLmdldCgiYWN0aW9uX3BhcmFtIiwgIiIpCiAgICAgICAgICAgICAgICAgICAgYWN0aW9uX3R5cGUgPSByZWRlZW1hYmxlLmdldCgiYWN0aW9uX3R5cGUiLCAiIikKICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICBjb2RlID0gZiJ7bGV0dGVyfXtqKzF9IgogICAgICAgICAgICAgICAgICAgIHBhY2thZ2VzW2NvZGUubG93ZXIoKV0gPSB7CiAgICAgICAgICAgICAgICAgICAgICAgICJhY3Rpb25fcGFyYW0iOiBhY3Rpb25fcGFyYW0sCiAgICAgICAgICAgICAgICAgICAgICAgICJhY3Rpb25fdHlwZSI6IGFjdGlvbl90eXBlCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIHRhYmxlLmFkZF9yb3coY29kZSwgbmFtZSwgdmFsaWRfdW50aWxfZGF0ZSwgYWN0aW9uX3R5cGUpCiAgICAgICAgICAgIAogICAgICAgICAgICBjb25zb2xlLnByaW50KFBhbmVsKAogICAgICAgICAgICAgICAgdGFibGUsCiAgICAgICAgICAgICAgICB0aXRsZT1mIlt7dGhlbWVbJ3RleHRfdGl0bGUnXX1d8J+TgiBLYXRlZ29yaToge2NhdGVnb3J5X25hbWV9Wy9dIChLb2RlOiB7Y2F0ZWdvcnlfY29kZX0pIiwKICAgICAgICAgICAgICAgIGJvcmRlcl9zdHlsZT10aGVtZVsiYm9yZGVyX2luZm8iXSwKICAgICAgICAgICAgICAgIHBhZGRpbmc9KDAsIDApLAogICAgICAgICAgICAgICAgZXhwYW5kPVRydWUKICAgICAgICAgICAgKSkKICAgICAgICAKICAgICAgICBuYXYgPSBUYWJsZShzaG93X2hlYWRlcj1GYWxzZSwgYm94PU1JTklNQUxfRE9VQkxFX0hFQUQsIGV4cGFuZD1UcnVlKQogICAgICAgIG5hdi5hZGRfY29sdW1uKGp1c3RpZnk9InJpZ2h0Iiwgc3R5bGU9dGhlbWVbInRleHRfa2V5Il0sIHdpZHRoPTYpCiAgICAgICAgbmF2LmFkZF9jb2x1bW4oc3R5bGU9dGhlbWVbInRleHRfYm9keSJdKQogICAgICAgIG5hdi5hZGRfcm93KCIwMCIsIGYiW3t0aGVtZVsndGV4dF9zdWInXX1dQ2FidXQgYmFsaWsga2UgbWVudSB1dGFtYSDwn4+gWy9dIikKICAgICAgICAKICAgICAgICBjb25zb2xlLnByaW50KFBhbmVsKG5hdiwgYm9yZGVyX3N0eWxlPXRoZW1lWyJib3JkZXJfcHJpbWFyeSJdLCBleHBhbmQ9VHJ1ZSkpCiAgICAgICAgCiAgICAgICAgY2hvaWNlID0gY29uc29sZS5pbnB1dChmIlt7dGhlbWVbJ3RleHRfc3ViJ119XVBpbGloIHJlZGVlbWFibGUgKG1pc2FsIEExLCBCMik6IPCfkYkgWy97dGhlbWVbJ3RleHRfc3ViJ119XSAiKS5zdHJpcCgpCiAgICAgICAgaWYgY2hvaWNlID09ICIwMCI6CiAgICAgICAgICAgIGluX3JlZGVlbWFibGVzX21lbnUgPSBGYWxzZQogICAgICAgICAgICBjb250aW51ZQogICAgICAgIAogICAgICAgIHNlbGVjdGVkX3BrZyA9IHBhY2thZ2VzLmdldChjaG9pY2UubG93ZXIoKSkKICAgICAgICBpZiBub3Qgc2VsZWN0ZWRfcGtnOgogICAgICAgICAgICBwcmludF9wYW5lbCgi4p2MIFVwcyIsICJQaWxpaGFuIGxvIG5nYWNvIGJybyDwn6SvIikKICAgICAgICAgICAgcGF1c2UoKQogICAgICAgICAgICBjb250aW51ZQogICAgICAgIAogICAgICAgIGFjdGlvbl9wYXJhbSA9IHNlbGVjdGVkX3BrZ1siYWN0aW9uX3BhcmFtIl0KICAgICAgICBhY3Rpb25fdHlwZSA9IHNlbGVjdGVkX3BrZ1siYWN0aW9uX3R5cGUiXQogICAgICAgIAogICAgICAgIGlmIGFjdGlvbl90eXBlID09ICJQTFAiOgogICAgICAgICAgICBnZXRfcGFja2FnZXNfYnlfZmFtaWx5KGFjdGlvbl9wYXJhbSwgaXNfZW50ZXJwcmlzZSwgIiIpCiAgICAgICAgZWxpZiBhY3Rpb25fdHlwZSA9PSAiUERQIjoKICAgICAgICAgICAgc2hvd19wYWNrYWdlX2RldGFpbHMoYXBpX2tleSwgdG9rZW5zLCBhY3Rpb25fcGFyYW0sIGlzX2VudGVycHJpc2UpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgcHJpbnRfcGFuZWwoIuKEue+4jyBJbmZvIiwgZiJCZWx1bSBhZGEgYWtzaSBidWF0IHRpcGUgaW5pIGJybzoge2FjdGlvbl90eXBlfVxuUGFyYW06IHthY3Rpb25fcGFyYW19IikKICAgICAgICAgICAgcGF1c2UoKQo=').decode())
