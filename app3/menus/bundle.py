#!/usr/bin/env python3
import base64
exec(base64.b64decode('ZnJvbSBhcHAzLmNvbmZpZy5pbXBvcnRzIGltcG9ydCAqCmZyb20gYXBwMy5jbGllbnQucHVyY2hhc2UuYmFsYW5jZSBpbXBvcnQgc2V0dGxlbWVudF9iYWxhbmNlCmZyb20gYXBwMy5jbGllbnQucHVyY2hhc2UucXJpcyBpbXBvcnQgc2hvd19xcmlzX3BheW1lbnQKZnJvbSBhcHAzLmNsaWVudC5wdXJjaGFzZS5ld2FsbGV0IGltcG9ydCBzaG93X211bHRpcGF5bWVudApmcm9tIGFwcDMubWVudXMudXRpbCBpbXBvcnQgY2xlYXJfc2NyZWVuLCBwYXVzZSwgcHJpbnRfcGFuZWwsIGdldF9ydXBpYWgsIHNpbXBsZV9udW1iZXIKZnJvbSBhcHAzLm1lbnVzLnBhY2thZ2UgaW1wb3J0IGdldF9wYWNrYWdlc19ieV9mYW1pbHkKZnJvbSBhcHAzLm1lbnVzLmZhbWlseV9ncnVwIGltcG9ydCBzaG93X2ZhbWlseV9ncnVwX21lbnUKZnJvbSBhcHAzLm1lbnVzLmJvb2ttYXJrIGltcG9ydCBzaG93X2Jvb2ttYXJrX21lbnUKZnJvbSBhcHAudHlwZV9kaWN0IGltcG9ydCBQYXltZW50SXRlbQoKY29uc29sZSA9IENvbnNvbGUoKQoKCmRlZiBzaG93X2J1bmRsZV9tZW51KCk6CiAgICBhcGlfa2V5ID0gQXV0aEluc3RhbmNlLmFwaV9rZXkKICAgIHRva2VucyA9IEF1dGhJbnN0YW5jZS5nZXRfYWN0aXZlX3Rva2VucygpCiAgICB0aGVtZSA9IGdldF90aGVtZSgpCgogICAgY2FydF9pdGVtcyA9IFtdCiAgICBkaXNwbGF5X2NhcnQgPSBbXQogICAgdG90YWxfcHJpY2UgPSAwCgogICAgd2hpbGUgVHJ1ZToKICAgICAgICBjbGVhcl9zY3JlZW4oKQogICAgICAgIGVuc3VyZV9naXQoKQogICAgICAgIGNvbnNvbGUucHJpbnQoUGFuZWwoCiAgICAgICAgICAgIEFsaWduLmNlbnRlcigi8J+bkiBLZXJhbmphbmcgUGFrZXQg8J+kmSIsIHZlcnRpY2FsPSJtaWRkbGUiKSwKICAgICAgICAgICAgYm9yZGVyX3N0eWxlPXRoZW1lWyJib3JkZXJfaW5mbyJdLAogICAgICAgICAgICBwYWRkaW5nPSgxLCAyKSwKICAgICAgICAgICAgZXhwYW5kPVRydWUKICAgICAgICApKQogICAgICAgIHNpbXBsZV9udW1iZXIoKQoKICAgICAgICBpZiBjYXJ0X2l0ZW1zOgogICAgICAgICAgICB0YWJsZSA9IFRhYmxlKGJveD1NSU5JTUFMX0RPVUJMRV9IRUFELCBleHBhbmQ9VHJ1ZSkKICAgICAgICAgICAgdGFibGUuYWRkX2NvbHVtbigiTm8iLCBqdXN0aWZ5PSJyaWdodCIsIHN0eWxlPXRoZW1lWyJ0ZXh0X2tleSJdLCB3aWR0aD00KQogICAgICAgICAgICB0YWJsZS5hZGRfY29sdW1uKCJOYW1hIFBha2V0Iiwgc3R5bGU9dGhlbWVbInRleHRfYm9keSJdKQogICAgICAgICAgICB0YWJsZS5hZGRfY29sdW1uKCJIYXJnYSIsIHN0eWxlPXRoZW1lWyJ0ZXh0X21vbmV5Il0sIGp1c3RpZnk9InJpZ2h0IikKCiAgICAgICAgICAgIGZvciBpLCBpdGVtIGluIGVudW1lcmF0ZShkaXNwbGF5X2NhcnQsIHN0YXJ0PTEpOgogICAgICAgICAgICAgICAgdGFibGUuYWRkX3JvdyhzdHIoaSksIGl0ZW1bIm5hbWUiXSwgZ2V0X3J1cGlhaChpdGVtWyJwcmljZSJdKSkKCiAgICAgICAgICAgIGNvbnNvbGUucHJpbnQoUGFuZWwodGFibGUsIGJvcmRlcl9zdHlsZT10aGVtZVsiYm9yZGVyX2luZm8iXSwgcGFkZGluZz0oMCwgMSksIGV4cGFuZD1UcnVlKSkKICAgICAgICAgICAgY29uc29sZS5wcmludChmIlt7dGhlbWVbJ3RleHRfYm9keSddfV1Ub3RhbCBIYXJnYTogUnAge2dldF9ydXBpYWgodG90YWxfcHJpY2UpfVsvXSIpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgcHJpbnRfcGFuZWwoIuKEue+4jyBTYW50dXkiLCAiS2VyYW5qYW5nIGxvIG1hc2loIGtvc29uZyBicm8g8J+YtCIpCgogICAgICAgIG5hdiA9IFRhYmxlKHNob3dfaGVhZGVyPUZhbHNlLCBib3g9TUlOSU1BTF9ET1VCTEVfSEVBRCwgZXhwYW5kPVRydWUpCiAgICAgICAgbmF2LmFkZF9jb2x1bW4oanVzdGlmeT0icmlnaHQiLCBzdHlsZT10aGVtZVsidGV4dF9rZXkiXSwgd2lkdGg9NikKICAgICAgICBuYXYuYWRkX2NvbHVtbihzdHlsZT10aGVtZVsidGV4dF9ib2R5Il0pCiAgICAgICAgbmF2LmFkZF9yb3coIjEiLCAiVGFtYmFoIGRhcmkgQm9va21hcmsg8J+TjCIpCiAgICAgICAgbmF2LmFkZF9yb3coIjIiLCAiVGFtYmFoIGRhcmkgRmFtaWx5IENvZGUgVGVyc2ltcGFuIPCfkajigI3wn5Gp4oCN8J+Rp+KAjfCfkaYiKQogICAgICAgIG5hdi5hZGRfcm93KCIzIiwgIlRhbWJhaCBkYXJpIEZhbWlseSBDb2RlIE1hbnVhbCDinI3vuI8iKQogICAgICAgIGlmIGNhcnRfaXRlbXM6CiAgICAgICAgICAgIG5hdi5hZGRfcm93KCI0IiwgZiJbe3RoZW1lWyd0ZXh0X2VyciddfV3wn5eR77iPIEhhcHVzIEl0ZW0gZGFyaSBLZXJhbmphbmdbL10iKQogICAgICAgICAgICBuYXYuYWRkX3JvdygiNSIsIGYiW3t0aGVtZVsndGV4dF93YXJuJ119XfCfkrMgR2Fza2V1biBrZSBQZW1iYXlhcmFuWy9dIikKICAgICAgICBuYXYuYWRkX3JvdygiMDAiLCBmIlt7dGhlbWVbJ3RleHRfc3ViJ119XUNhYnV0IGJhbGlrIGtlIG1lbnUgdXRhbWEg8J+PoFsvXSIpCgogICAgICAgIGNvbnNvbGUucHJpbnQoUGFuZWwobmF2LCBib3JkZXJfc3R5bGU9dGhlbWVbImJvcmRlcl9wcmltYXJ5Il0sIHBhZGRpbmc9KDAsIDApLCBleHBhbmQ9VHJ1ZSkpCgogICAgICAgIGNob2ljZSA9IGNvbnNvbGUuaW5wdXQoZiJbe3RoZW1lWyd0ZXh0X3N1YiddfV1QaWxpaGFuIGxvIGJybzpbL3t0aGVtZVsndGV4dF9zdWInXX1dICIpLnN0cmlwKCkKCiAgICAgICAgZGVmIGFkZF90b19jYXJ0KGRldGFpbCwgbmFtZSk6CiAgICAgICAgICAgIG5vbmxvY2FsIHRvdGFsX3ByaWNlCiAgICAgICAgICAgIG9wdGlvbiA9IGRldGFpbFsicGFja2FnZV9vcHRpb24iXQogICAgICAgICAgICBjYXJ0X2l0ZW1zLmFwcGVuZChQYXltZW50SXRlbSgKICAgICAgICAgICAgICAgIGl0ZW1fY29kZT1vcHRpb25bInBhY2thZ2Vfb3B0aW9uX2NvZGUiXSwKICAgICAgICAgICAgICAgIHByb2R1Y3RfdHlwZT0iIiwgaXRlbV9wcmljZT1vcHRpb25bInByaWNlIl0sCiAgICAgICAgICAgICAgICBpdGVtX25hbWU9b3B0aW9uWyJuYW1lIl0sIHRheD0wLAogICAgICAgICAgICAgICAgdG9rZW5fY29uZmlybWF0aW9uPWRldGFpbFsidG9rZW5fY29uZmlybWF0aW9uIl0KICAgICAgICAgICAgKSkKICAgICAgICAgICAgZGlzcGxheV9jYXJ0LmFwcGVuZCh7Im5hbWUiOiBuYW1lLCAicHJpY2UiOiBvcHRpb25bInByaWNlIl19KQogICAgICAgICAgICB0b3RhbF9wcmljZSArPSBvcHRpb25bInByaWNlIl0KICAgICAgICAgICAgcHJpbnRfcGFuZWwoIuKchSBNYW50YXAiLCBmIlBha2V0ICd7bmFtZX0nIHVkYWggbWFzdWsga2VyYW5qYW5nIGJybyDwn5qAIikKICAgICAgICAgICAgcGF1c2UoKQoKICAgICAgICBpZiBjaG9pY2UgPT0gIjEiOgogICAgICAgICAgICByZXN1bHQgPSBzaG93X2Jvb2ttYXJrX21lbnUocmV0dXJuX3BhY2thZ2VfZGV0YWlsPVRydWUpCiAgICAgICAgICAgIGlmIGlzaW5zdGFuY2UocmVzdWx0LCB0dXBsZSk6CiAgICAgICAgICAgICAgICBkZXRhaWwsIG5hbWUgPSByZXN1bHQKICAgICAgICAgICAgICAgIGlmIGRldGFpbDoKICAgICAgICAgICAgICAgICAgICBhZGRfdG9fY2FydChkZXRhaWwsIG5hbWUpCgogICAgICAgIGVsaWYgY2hvaWNlID09ICIyIjoKICAgICAgICAgICAgcmVzdWx0ID0gc2hvd19mYW1pbHlfZ3J1cF9tZW51KHJldHVybl9wYWNrYWdlX2RldGFpbD1UcnVlKQogICAgICAgICAgICBpZiByZXN1bHQgPT0gIk1BSU4iOgogICAgICAgICAgICAgICAgYnJlYWsKICAgICAgICAgICAgZWxpZiBpc2luc3RhbmNlKHJlc3VsdCwgdHVwbGUpOgogICAgICAgICAgICAgICAgZGV0YWlsLCBuYW1lID0gcmVzdWx0CiAgICAgICAgICAgICAgICBpZiBkZXRhaWw6CiAgICAgICAgICAgICAgICAgICAgYWRkX3RvX2NhcnQoZGV0YWlsLCBuYW1lKQoKICAgICAgICBlbGlmIGNob2ljZSA9PSAiMyI6CiAgICAgICAgICAgIGZjID0gY29uc29sZS5pbnB1dChmIlt7dGhlbWVbJ3RleHRfc3ViJ119XU1hc3VraW4gRmFtaWx5IENvZGUgYnJvOlsve3RoZW1lWyd0ZXh0X3N1YiddfV0gIikuc3RyaXAoKQogICAgICAgICAgICByZXN1bHQgPSBnZXRfcGFja2FnZXNfYnlfZmFtaWx5KGZjLCByZXR1cm5fcGFja2FnZV9kZXRhaWw9VHJ1ZSkKICAgICAgICAgICAgaWYgcmVzdWx0ID09ICJNQUlOIjoKICAgICAgICAgICAgICAgIGJyZWFrCiAgICAgICAgICAgIGVsaWYgaXNpbnN0YW5jZShyZXN1bHQsIHR1cGxlKToKICAgICAgICAgICAgICAgIGRldGFpbCwgbmFtZSA9IHJlc3VsdAogICAgICAgICAgICAgICAgaWYgZGV0YWlsOgogICAgICAgICAgICAgICAgICAgIGFkZF90b19jYXJ0KGRldGFpbCwgbmFtZSkKCiAgICAgICAgZWxpZiBjaG9pY2UgPT0gIjQiIGFuZCBjYXJ0X2l0ZW1zOgogICAgICAgICAgICBpZHggPSBjb25zb2xlLmlucHV0KGYiW3t0aGVtZVsndGV4dF9zdWInXX1dTm9tb3IgaXRlbSB5YW5nIG1hdSBkaWhhcHVzOlsve3RoZW1lWyd0ZXh0X3N1YiddfV0gIikuc3RyaXAoKQogICAgICAgICAgICBpZiBpZHguaXNkaWdpdCgpIGFuZCAxIDw9IGludChpZHgpIDw9IGxlbihjYXJ0X2l0ZW1zKToKICAgICAgICAgICAgICAgIGkgPSBpbnQoaWR4KSAtIDEKICAgICAgICAgICAgICAgIHJlbW92ZWQgPSBkaXNwbGF5X2NhcnQucG9wKGkpCiAgICAgICAgICAgICAgICBjYXJ0X2l0ZW1zLnBvcChpKQogICAgICAgICAgICAgICAgdG90YWxfcHJpY2UgLT0gcmVtb3ZlZFsicHJpY2UiXQogICAgICAgICAgICAgICAgcHJpbnRfcGFuZWwoIvCfl5HvuI8gRGloYXB1cyIsIGYiSXRlbSAne3JlbW92ZWRbJ25hbWUnXX0nIHVkYWggZ3VlIGhhcHVzIGJybyDinIzvuI8iKQogICAgICAgICAgICAgICAgcGF1c2UoKQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgcHJpbnRfcGFuZWwoIuKaoO+4jyBVcHMiLCAiTm9tb3IgaXRlbSBuZ2dhayB2YWxpZCBicm8g8J+kryIpCiAgICAgICAgICAgICAgICBwYXVzZSgpCgogICAgICAgIGVsaWYgY2hvaWNlID09ICI1IiBhbmQgY2FydF9pdGVtczoKICAgICAgICAgICAgY2xlYXJfc2NyZWVuKCkKICAgICAgICAgICAgaW5mb190ZXh0ID0gVGV4dCgpCiAgICAgICAgICAgIGluZm9fdGV4dC5hcHBlbmQoIvCfkrMgRGV0YWlsIFBlbWJheWFyYW46XG4iLCBzdHlsZT10aGVtZVsidGV4dF9ib2R5Il0pCiAgICAgICAgICAgIGZvciBpLCBpdGVtIGluIGVudW1lcmF0ZShkaXNwbGF5X2NhcnQsIHN0YXJ0PTEpOgogICAgICAgICAgICAgICAgaW5mb190ZXh0LmFwcGVuZChmIntpfS4ge2l0ZW1bJ25hbWUnXX0gLSBScCB7Z2V0X3J1cGlhaChpdGVtWydwcmljZSddKX1cbiIsIHN0eWxlPXRoZW1lWyJ0ZXh0X2JvZHkiXSkKICAgICAgICAgICAgaW5mb190ZXh0LmFwcGVuZChmIlxuVG90YWw6IFJwIHtnZXRfcnVwaWFoKHRvdGFsX3ByaWNlKX0iLCBzdHlsZT10aGVtZVsidGV4dF9tb25leSJdKQoKICAgICAgICAgICAgY29uc29sZS5wcmludChQYW5lbCgKICAgICAgICAgICAgICAgIGluZm9fdGV4dCwKICAgICAgICAgICAgICAgIHRpdGxlPWYiW3t0aGVtZVsndGV4dF90aXRsZSddfV1JbmZvcm1hc2kgUGVtYmF5YXJhbiDwn6SZWy9dIiwKICAgICAgICAgICAgICAgIGJvcmRlcl9zdHlsZT10aGVtZVsiYm9yZGVyX2luZm8iXSwKICAgICAgICAgICAgICAgIHBhZGRpbmc9KDEsIDIpLAogICAgICAgICAgICAgICAgZXhwYW5kPVRydWUKICAgICAgICAgICAgKSkKICAgICAgICAgICAgc2ltcGxlX251bWJlcigpCgogICAgICAgICAgICB3aGlsZSBUcnVlOgogICAgICAgICAgICAgICAgbWV0aG9kX3RhYmxlID0gVGFibGUoc2hvd19oZWFkZXI9RmFsc2UsIGJveD1NSU5JTUFMX0RPVUJMRV9IRUFELCBleHBhbmQ9VHJ1ZSkKICAgICAgICAgICAgICAgIG1ldGhvZF90YWJsZS5hZGRfY29sdW1uKGp1c3RpZnk9InJpZ2h0Iiwgc3R5bGU9dGhlbWVbInRleHRfa2V5Il0sIHdpZHRoPTYpCiAgICAgICAgICAgICAgICBtZXRob2RfdGFibGUuYWRkX2NvbHVtbihzdHlsZT10aGVtZVsidGV4dF9ib2R5Il0pCiAgICAgICAgICAgICAgICBtZXRob2RfdGFibGUuYWRkX3JvdygiMSIsICLwn5KwIEJhbGFuY2UiKQogICAgICAgICAgICAgICAgbWV0aG9kX3RhYmxlLmFkZF9yb3coIjIiLCAi8J+SsyBFLVdhbGxldCIpCiAgICAgICAgICAgICAgICBtZXRob2RfdGFibGUuYWRkX3JvdygiMyIsICLwn5OxIFFSSVMiKQogICAgICAgICAgICAgICAgbWV0aG9kX3RhYmxlLmFkZF9yb3coIjAwIiwgZiJbe3RoZW1lWyd0ZXh0X3N1YiddfV1CYWxpayBrZSBtZW51IHNlYmVsdW1ueWFbL10iKQoKICAgICAgICAgICAgICAgIGNvbnNvbGUucHJpbnQoUGFuZWwoCiAgICAgICAgICAgICAgICAgICAgbWV0aG9kX3RhYmxlLAogICAgICAgICAgICAgICAgICAgIHRpdGxlPWYiW3t0aGVtZVsndGV4dF90aXRsZSddfV3wn5SlIFBpbGloIE1ldG9kZSBQZW1iYXlhcmFuWy9dIiwKICAgICAgICAgICAgICAgICAgICBib3JkZXJfc3R5bGU9dGhlbWVbImJvcmRlcl9wcmltYXJ5Il0sCiAgICAgICAgICAgICAgICAgICAgcGFkZGluZz0oMCwgMSksCiAgICAgICAgICAgICAgICAgICAgZXhwYW5kPVRydWUKICAgICAgICAgICAgICAgICkpCgogICAgICAgICAgICAgICAgbWV0aG9kID0gY29uc29sZS5pbnB1dChmIlt7dGhlbWVbJ3RleHRfc3ViJ119XU1hdSBwYWtlIG1ldG9kZSBhcGEgYnJvOlsve3RoZW1lWyd0ZXh0X3N1YiddfV0gIikuc3RyaXAoKQoKICAgICAgICAgICAgICAgIGlmIG1ldGhvZCA9PSAiMDAiOgogICAgICAgICAgICAgICAgICAgIGJyZWFrCgogICAgICAgICAgICAgICAgY29uZmlybSA9IGNvbnNvbGUuaW5wdXQoZiJbe3RoZW1lWyd0ZXh0X3N1YiddfV1HYXNrZXVuIHBha2UgbWV0b2RlIGluaT8gKHkvbik6Wy97dGhlbWVbJ3RleHRfc3ViJ119XSAiKS5zdHJpcCgpLmxvd2VyKCkKICAgICAgICAgICAgICAgIGlmIGNvbmZpcm0gIT0gInkiOgogICAgICAgICAgICAgICAgICAgIHByaW50X3BhbmVsKCLihLnvuI8gU2FudHV5IiwgIlBlbWJheWFyYW4gZGliYXRhbGluIGJybyDinIzvuI8iKQogICAgICAgICAgICAgICAgICAgIHBhdXNlKCkKICAgICAgICAgICAgICAgICAgICBjb250aW51ZQoKICAgICAgICAgICAgICAgIGlmIG1ldGhvZCA9PSAiMSI6CiAgICAgICAgICAgICAgICAgICAgc2V0dGxlbWVudF9iYWxhbmNlKGFwaV9rZXksIHRva2VucywgY2FydF9pdGVtcywgIkJVWV9QQUNLQUdFIiwgVHJ1ZSkKICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmlucHV0KGYiW3t0aGVtZVsndGV4dF9zdWInXX1d4pyFIFBlbWJheWFyYW4ga2VsYXIgYnJvLCB0ZWthbiBFbnRlci4uLlsve3RoZW1lWyd0ZXh0X3N1YiddfV0iKQogICAgICAgICAgICAgICAgICAgIGJyZWFrCiAgICAgICAgICAgICAgICBlbGlmIG1ldGhvZCA9PSAiMiI6CiAgICAgICAgICAgICAgICAgICAgc2hvd19tdWx0aXBheW1lbnQoYXBpX2tleSwgdG9rZW5zLCBjYXJ0X2l0ZW1zLCAiQlVZX1BBQ0tBR0UiLCBUcnVlKQogICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuaW5wdXQoZiJbe3RoZW1lWyd0ZXh0X3N1YiddfV3inIUgUGVtYmF5YXJhbiBrZWxhciBicm8sIHRla2FuIEVudGVyLi4uWy97dGhlbWVbJ3RleHRfc3ViJ119XSIpCiAgICAgICAgICAgICAgICAgICAgYnJlYWsKICAgICAgICAgICAgICAgIGVsaWYgbWV0aG9kID09ICIzIjoKICAgICAgICAgICAgICAgICAgICBzaG93X3FyaXNfcGF5bWVudChhcGlfa2V5LCB0b2tlbnMsIGNhcnRfaXRlbXMsICJCVVlfUEFDS0FHRSIsIFRydWUpCiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5pbnB1dChmIlt7dGhlbWVbJ3RleHRfc3ViJ119XeKchSBQZW1iYXlhcmFuIGtlbGFyIGJybywgdGVrYW4gRW50ZXIuLi5bL3t0aGVtZVsndGV4dF9zdWInXX1dIikKICAgICAgICAgICAgICAgICAgICBicmVhawogICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICBwcmludF9wYW5lbCgi4pqg77iPIFVwcyIsICJNZXRvZGUgbmdnYWsgdmFsaWQgYnJvIPCfpK8iKQogICAgICAgICAgICAgICAgICAgIHBhdXNlKCkKCiAgICAgICAgZWxpZiBjaG9pY2UgPT0gIjAwIjoKICAgICAgICAgICAgYnJlYWsKCiAgICAgICAgZWxzZToKICAgICAgICAgICAgcHJpbnRfcGFuZWwoIuKaoO+4jyBVcHMiLCAiUGlsaWhhbiBsbyBuZ2FjbyBicm8g8J+aqCIpCiAgICAgICAgICAgIHBhdXNlKCkK').decode())
