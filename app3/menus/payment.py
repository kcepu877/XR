#!/usr/bin/env python3
import base64
exec(base64.b64decode('ZnJvbSBkYXRldGltZSBpbXBvcnQgZGF0ZXRpbWUsIHRpbWVkZWx0YQoKZnJvbSBhcHAzLmNsaWVudC5lbmdzZWwgaW1wb3J0IGdldF90cmFuc2FjdGlvbl9oaXN0b3J5CmZyb20gYXBwMy5jb25maWcuaW1wb3J0cyBpbXBvcnQgKgpmcm9tIGFwcDMubWVudXMudXRpbCBpbXBvcnQgY2xlYXJfc2NyZWVuLCBwYXVzZSwgcHJpbnRfcGFuZWwsIHNpbXBsZV9udW1iZXIKCmNvbnNvbGUgPSBDb25zb2xlKCkKCgpkZWYgc2hvd190cmFuc2FjdGlvbl9oaXN0b3J5KGFwaV9rZXksIHRva2Vucyk6CiAgICB0aGVtZSA9IGdldF90aGVtZSgpCiAgICBpbl90cmFuc2FjdGlvbl9tZW51ID0gVHJ1ZQoKICAgIHdoaWxlIGluX3RyYW5zYWN0aW9uX21lbnU6CiAgICAgICAgY2xlYXJfc2NyZWVuKCkKICAgICAgICBlbnN1cmVfZ2l0KCkKICAgICAgICBjb25zb2xlLnByaW50KFBhbmVsKAogICAgICAgICAgICBBbGlnbi5jZW50ZXIoIvCfk4QgUml3YXlhdCBUcmFuc2Frc2kg8J+kmSIsIHZlcnRpY2FsPSJtaWRkbGUiKSwKICAgICAgICAgICAgYm9yZGVyX3N0eWxlPXRoZW1lWyJib3JkZXJfaW5mbyJdLAogICAgICAgICAgICBwYWRkaW5nPSgxLCAyKSwKICAgICAgICAgICAgZXhwYW5kPVRydWUKICAgICAgICApKQogICAgICAgIHNpbXBsZV9udW1iZXIoKQoKICAgICAgICB0cnk6CiAgICAgICAgICAgIGRhdGEgPSBnZXRfdHJhbnNhY3Rpb25faGlzdG9yeShhcGlfa2V5LCB0b2tlbnMpCiAgICAgICAgICAgIGhpc3RvcnkgPSBkYXRhLmdldCgibGlzdCIsIFtdKQogICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAgcHJpbnRfcGFuZWwoIuKaoO+4jyBVcHMiLCBmIkdhZ2FsIG5nYW1iaWwgcml3YXlhdCB0cmFuc2Frc2kgYnJvOiB7ZX0g8J+kryIpCiAgICAgICAgICAgIGhpc3RvcnkgPSBbXQoKICAgICAgICBpZiBub3QgaGlzdG9yeToKICAgICAgICAgICAgcHJpbnRfcGFuZWwoIuKEue+4jyBTYW50dXkiLCAiU2VwaSBjdXksIGJlbHVtIGFkYSByaXdheWF0IHRyYW5zYWtzaSDwn5i0IikKICAgICAgICBlbHNlOgogICAgICAgICAgICBmb3IgaWR4LCB0cmFuc2FjdGlvbiBpbiBlbnVtZXJhdGUoaGlzdG9yeSwgc3RhcnQ9MSk6CiAgICAgICAgICAgICAgICB0cyA9IHRyYW5zYWN0aW9uLmdldCgidGltZXN0YW1wIiwgMCkKICAgICAgICAgICAgICAgIGR0ID0gZGF0ZXRpbWUuZnJvbXRpbWVzdGFtcCh0cykgLSB0aW1lZGVsdGEoaG91cnM9NykKICAgICAgICAgICAgICAgIGZvcm1hdHRlZF90aW1lID0gZHQuc3RyZnRpbWUoIiVkICVCICVZIHwgJUg6JU0gV0lCIikKCiAgICAgICAgICAgICAgICB0ID0gVGFibGUoYm94PU1JTklNQUxfRE9VQkxFX0hFQUQsIGV4cGFuZD1UcnVlLCBwYWRkaW5nPSgwLCAwKSkKICAgICAgICAgICAgICAgIHQuYWRkX2NvbHVtbigiTGFiZWwiLCBqdXN0aWZ5PSJsZWZ0Iiwgc3R5bGU9dGhlbWVbInRleHRfYm9keSJdLCB3aWR0aD0xOCkKICAgICAgICAgICAgICAgIHQuYWRkX2NvbHVtbigiRGV0YWlsIiwganVzdGlmeT0icmlnaHQiLCBzdHlsZT10aGVtZVsidGV4dF9ib2R5Il0pCiAgICAgICAgICAgICAgICB0LmFkZF9yb3coIvCfk50gSnVkdWwiLCB0cmFuc2FjdGlvbi5nZXQoInRpdGxlIiwgIi0iKSkKICAgICAgICAgICAgICAgIHQuYWRkX3Jvdygi8J+SuCBIYXJnYSIsIGYiUnAge3RyYW5zYWN0aW9uLmdldCgncHJpY2UnLCAnLScpfSIpCiAgICAgICAgICAgICAgICB0LmFkZF9yb3coIvCfk4UgVGFuZ2dhbCIsIGZvcm1hdHRlZF90aW1lKQogICAgICAgICAgICAgICAgdC5hZGRfcm93KCLwn5KzIE1ldG9kZSIsIHRyYW5zYWN0aW9uLmdldCgicGF5bWVudF9tZXRob2RfbGFiZWwiLCAiLSIpKQogICAgICAgICAgICAgICAgdC5hZGRfcm93KCLwn5OmIFN0YXR1cyBUcmFuc2Frc2kiLCB0cmFuc2FjdGlvbi5nZXQoInN0YXR1cyIsICItIikpCiAgICAgICAgICAgICAgICB0LmFkZF9yb3coIuKchSBTdGF0dXMgUGVtYmF5YXJhbiIsIHRyYW5zYWN0aW9uLmdldCgicGF5bWVudF9zdGF0dXMiLCAiLSIpKQoKICAgICAgICAgICAgICAgIGNvbnNvbGUucHJpbnQoUGFuZWwodCwgdGl0bGU9ZiLwn6e+IFRyYW5zYWtzaSAje2lkeH0iLCBib3JkZXJfc3R5bGU9dGhlbWVbImJvcmRlcl9pbmZvIl0sIGV4cGFuZD1UcnVlKSkKCiAgICAgICAgbmF2X3RhYmxlID0gVGFibGUoc2hvd19oZWFkZXI9RmFsc2UsIGJveD1NSU5JTUFMX0RPVUJMRV9IRUFELCBleHBhbmQ9VHJ1ZSkKICAgICAgICBuYXZfdGFibGUuYWRkX2NvbHVtbihqdXN0aWZ5PSJyaWdodCIsIHN0eWxlPXRoZW1lWyJ0ZXh0X2tleSJdLCB3aWR0aD02KQogICAgICAgIG5hdl90YWJsZS5hZGRfY29sdW1uKGp1c3RpZnk9ImxlZnQiLCBzdHlsZT10aGVtZVsidGV4dF9ib2R5Il0pCiAgICAgICAgbmF2X3RhYmxlLmFkZF9yb3coIjAiLCAiUmVmcmVzaCDwn5SEICIpCiAgICAgICAgbmF2X3RhYmxlLmFkZF9yb3coIjAwIiwgZiJbe3RoZW1lWyd0ZXh0X3N1YiddfV1DYWJ1dCBiYWxpayBrZSBNZW51IFV0YW1hIPCfj6BbL10iKQoKICAgICAgICBjb25zb2xlLnByaW50KFBhbmVsKG5hdl90YWJsZSwgYm9yZGVyX3N0eWxlPXRoZW1lWyJib3JkZXJfcHJpbWFyeSJdLCBleHBhbmQ9VHJ1ZSkpCgogICAgICAgIGNob2ljZSA9IGNvbnNvbGUuaW5wdXQoZiJbe3RoZW1lWyd0ZXh0X3N1YiddfV1QaWxpaGFuIGxvIGJybzpbL3t0aGVtZVsndGV4dF9zdWInXX1dICIpLnN0cmlwKCkKICAgICAgICBpZiBjaG9pY2UgPT0gIjAiOgogICAgICAgICAgICBjb250aW51ZQogICAgICAgIGVsaWYgY2hvaWNlID09ICIwMCI6CiAgICAgICAgICAgIHJldHVybgogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHByaW50X3BhbmVsKCLimqDvuI8gVXBzIiwgIk9wc2kgbG8gbmdhY28gYnJvLCBjb2JhIGxhZ2kg8J+aqCIpCiAgICAgICAgICAgIHBhdXNlKCkK').decode())
