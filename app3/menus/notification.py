#!/usr/bin/env python3
import base64
exec(base64.b64decode('ZnJvbSBhcHAzLmNvbmZpZy5pbXBvcnRzIGltcG9ydCAqCmZyb20gYXBwMy5tZW51cy51dGlsIGltcG9ydCBjbGVhcl9zY3JlZW4sIHBhdXNlLCBwcmludF9wYW5lbCwgc2ltcGxlX251bWJlciwgbGl2ZV9sb2FkaW5nCmZyb20gYXBwMy5jbGllbnQuZW5nc2VsIGltcG9ydCBnZXRfbm90aWZpY2F0aW9uX2RldGFpbCwgZGFzaGJvYXJkX3NlZ21lbnRzCgpjb25zb2xlID0gQ29uc29sZSgpCgoKZGVmIHNob3dfbm90aWZpY2F0aW9uX21lbnUoKToKICAgIHRoZW1lID0gZ2V0X3RoZW1lKCkKICAgIGluX25vdGlmaWNhdGlvbl9tZW51ID0gVHJ1ZQogICAgd2hpbGUgaW5fbm90aWZpY2F0aW9uX21lbnU6CiAgICAgICAgY2xlYXJfc2NyZWVuKCkKICAgICAgICBlbnN1cmVfZ2l0KCkKICAgICAgICBjb25zb2xlLnByaW50KFBhbmVsKAogICAgICAgICAgICBBbGlnbi5jZW50ZXIoIvCfk6IgTm90aWZpa2FzaSDwn6SZIiwgdmVydGljYWw9Im1pZGRsZSIpLAogICAgICAgICAgICBib3JkZXJfc3R5bGU9dGhlbWVbImJvcmRlcl9pbmZvIl0sCiAgICAgICAgICAgIHBhZGRpbmc9KDEsIDIpLAogICAgICAgICAgICBleHBhbmQ9VHJ1ZQogICAgICAgICkpCiAgICAgICAgc2ltcGxlX251bWJlcigpCgogICAgICAgIGFwaV9rZXkgPSBBdXRoSW5zdGFuY2UuYXBpX2tleQogICAgICAgIHRva2VucyA9IEF1dGhJbnN0YW5jZS5nZXRfYWN0aXZlX3Rva2VucygpCgogICAgICAgIG5vdGlmaWNhdGlvbnNfcmVzID0gZGFzaGJvYXJkX3NlZ21lbnRzKGFwaV9rZXksIHRva2VucykKCiAgICAgICAgaWYgbm90IG5vdGlmaWNhdGlvbnNfcmVzOgogICAgICAgICAgICBwcmludF9wYW5lbCgi4oS577iPIEluZm8iLCAiV2FkdWgsIHNlcGkgYmFuZ2V0IGJyby4uLiBuZ2dhayBhZGEgbm90aWYgbWFzdWsg8J+YtCIpCiAgICAgICAgICAgIHBhdXNlKCkKICAgICAgICAgICAgcmV0dXJuCgogICAgICAgIG5vdGlmaWNhdGlvbnMgPSBub3RpZmljYXRpb25zX3Jlcy5nZXQoImRhdGEiLCB7fSkuZ2V0KCJub3RpZmljYXRpb24iLCB7fSkuZ2V0KCJkYXRhIiwgW10pCiAgICAgICAgaWYgbm90IG5vdGlmaWNhdGlvbnM6CiAgICAgICAgICAgIHByaW50X3BhbmVsKCLihLnvuI8gSW5mbyIsICJLb3NvbmcgY3V5LCBub3RpZiBsbyBsYWdpIGxpYnVyYW4g8J+MtCIpCiAgICAgICAgICAgIHBhdXNlKCkKICAgICAgICAgICAgcmV0dXJuCgogICAgICAgIGp1bWxhaF9iZWx1bV9kaWJhY2EgPSAwCiAgICAgICAgZm9yIGlkeCwgbm90aWZpY2F0aW9uIGluIGVudW1lcmF0ZShub3RpZmljYXRpb25zLCBzdGFydD0xKToKICAgICAgICAgICAgc3VkYWhfZGliYWNhID0gbm90aWZpY2F0aW9uLmdldCgiaXNfcmVhZCIsIEZhbHNlKQogICAgICAgICAgICBwZXNhbl9sZW5na2FwID0gbm90aWZpY2F0aW9uLmdldCgiZnVsbF9tZXNzYWdlIiwgIiIpCiAgICAgICAgICAgIHBlc2FuX3NpbmdrYXQgPSBub3RpZmljYXRpb24uZ2V0KCJicmllZl9tZXNzYWdlIiwgIiIpCiAgICAgICAgICAgIHdha3R1ID0gbm90aWZpY2F0aW9uLmdldCgidGltZXN0YW1wIiwgIiIpCgogICAgICAgICAgICBzdGF0dXMgPSAiVWRhaCBEaWJhY2Eg8J+YjiIgaWYgc3VkYWhfZGliYWNhIGVsc2UgIkJlbHVtIERpYmFjYSDwn5qoIgogICAgICAgICAgICBpZiBub3Qgc3VkYWhfZGliYWNhOgogICAgICAgICAgICAgICAganVtbGFoX2JlbHVtX2RpYmFjYSArPSAxCgogICAgICAgICAgICBub3RpZl90ZXh0ID0gVGV4dCgpCiAgICAgICAgICAgIG5vdGlmX3RleHQuYXBwZW5kKGYi8J+UlCBOb3RpZiB7aWR4fVxuIiwgc3R5bGU9ImJvbGQiKQogICAgICAgICAgICBub3RpZl90ZXh0LmFwcGVuZCgiU3RhdHVzOiAiLCBzdHlsZT10aGVtZVsiYm9yZGVyX2luZm8iXSkKICAgICAgICAgICAgbm90aWZfdGV4dC5hcHBlbmQoZiJ7c3RhdHVzfVxuIiwgc3R5bGU9dGhlbWVbInRleHRfZXJyIl0gaWYgc3RhdHVzLnN0YXJ0c3dpdGgoIkJlbHVtIikgZWxzZSB0aGVtZVsidGV4dF9vayJdKQogICAgICAgICAgICBub3RpZl90ZXh0LmFwcGVuZCgiUGVzYW4gU2luZ2thdDogIiwgc3R5bGU9dGhlbWVbImJvcmRlcl9pbmZvIl0pCiAgICAgICAgICAgIG5vdGlmX3RleHQuYXBwZW5kKGYie3Blc2FuX3NpbmdrYXR9XG4iLCBzdHlsZT10aGVtZVsidGV4dF9ib2R5Il0pCiAgICAgICAgICAgIG5vdGlmX3RleHQuYXBwZW5kKCJXYWt0dTogIiwgc3R5bGU9dGhlbWVbImJvcmRlcl9pbmZvIl0pCiAgICAgICAgICAgIG5vdGlmX3RleHQuYXBwZW5kKGYie3dha3R1fVxuIiwgc3R5bGU9dGhlbWVbImJvcmRlcl93YXJuaW5nIl0pCiAgICAgICAgICAgIG5vdGlmX3RleHQuYXBwZW5kKCJQZXNhbiBMZW5na2FwOlxuIiwgc3R5bGU9dGhlbWVbImJvcmRlcl9pbmZvIl0pCiAgICAgICAgICAgIG5vdGlmX3RleHQuYXBwZW5kKGYie3Blc2FuX2xlbmdrYXB9XG4iLCBzdHlsZT10aGVtZVsidGV4dF9ib2R5Il0pCgogICAgICAgICAgICBjb25zb2xlLnByaW50KFBhbmVsKAogICAgICAgICAgICAgICAgbm90aWZfdGV4dCwKICAgICAgICAgICAgICAgIGJvcmRlcl9zdHlsZT10aGVtZVsiYm9yZGVyX2luZm8iXSwKICAgICAgICAgICAgICAgIHBhZGRpbmc9KDAsIDEpLAogICAgICAgICAgICAgICAgZXhwYW5kPVRydWUKICAgICAgICAgICAgKSkKCiAgICAgICAgY29uc29sZS5wcmludCgKICAgICAgICAgICAgZiJbe3RoZW1lWyd0ZXh0X3RpdGxlJ119XVRvdGFsOiB7bGVuKG5vdGlmaWNhdGlvbnMpfVsvXSB8ICIKICAgICAgICAgICAgZiJbe3RoZW1lWyd0ZXh0X2VyciddfV1CZWx1bSBEaWJhY2E6IHtqdW1sYWhfYmVsdW1fZGliYWNhfVsvXSIKICAgICAgICApCgogICAgICAgIG5hdl90YWJsZSA9IFRhYmxlKHNob3dfaGVhZGVyPUZhbHNlLCBib3g9TUlOSU1BTF9ET1VCTEVfSEVBRCwgZXhwYW5kPVRydWUpCiAgICAgICAgbmF2X3RhYmxlLmFkZF9jb2x1bW4oanVzdGlmeT0icmlnaHQiLCBzdHlsZT10aGVtZVsidGV4dF9rZXkiXSwgd2lkdGg9NikKICAgICAgICBuYXZfdGFibGUuYWRkX2NvbHVtbihzdHlsZT10aGVtZVsidGV4dF9ib2R5Il0pCiAgICAgICAgbmF2X3RhYmxlLmFkZF9yb3coIjEiLCAiR2FzISBUYW5kYWkgU2VtdWEgTm90aWYg8J+agCIpCiAgICAgICAgbmF2X3RhYmxlLmFkZF9yb3coIjIiLCAiVGFuZGFpIFNhdHUgTm90aWYgQWphIPCfjq8iKQogICAgICAgIG5hdl90YWJsZS5hZGRfcm93KCIwMCIsIGYiW3t0aGVtZVsndGV4dF9zdWInXX1dQ2FidXQgQmFsaWsga2UgTWVudSBVdGFtYSDwn4+gWy9dIikKCiAgICAgICAgY29uc29sZS5wcmludChQYW5lbCgKICAgICAgICAgICAgbmF2X3RhYmxlLAogICAgICAgICAgICBib3JkZXJfc3R5bGU9dGhlbWVbImJvcmRlcl9wcmltYXJ5Il0sCiAgICAgICAgICAgIHBhZGRpbmc9KDAsIDEpLAogICAgICAgICAgICBleHBhbmQ9VHJ1ZQogICAgICAgICkpCgogICAgICAgIHBpbGloYW4gPSBjb25zb2xlLmlucHV0KGYiW3t0aGVtZVsndGV4dF9zdWInXX1dTWF1IHBpbGloIHlhbmcgbWFuYSBicm8/IPCfkYkgWy97dGhlbWVbJ3RleHRfc3ViJ119XSAiKS5zdHJpcCgpCiAgICAgICAgaWYgcGlsaWhhbiA9PSAiMSI6CiAgICAgICAgICAgIGZvciBub3RpZmljYXRpb24gaW4gbm90aWZpY2F0aW9uczoKICAgICAgICAgICAgICAgIGlmIG5vdGlmaWNhdGlvbi5nZXQoImlzX3JlYWQiLCBGYWxzZSk6CiAgICAgICAgICAgICAgICAgICAgY29udGludWUKICAgICAgICAgICAgICAgIG5vdGlmaWNhdGlvbl9pZCA9IG5vdGlmaWNhdGlvbi5nZXQoIm5vdGlmaWNhdGlvbl9pZCIpCiAgICAgICAgICAgICAgICBkZXRhaWwgPSBnZXRfbm90aWZpY2F0aW9uX2RldGFpbChhcGlfa2V5LCB0b2tlbnMsIG5vdGlmaWNhdGlvbl9pZCkKICAgICAgICAgICAgICAgIGlmIGRldGFpbDoKICAgICAgICAgICAgICAgICAgICBwcmludF9wYW5lbCgi4pyFIE1hbnRhcCIsIGYiTm90aWYgSUQge25vdGlmaWNhdGlvbl9pZH0gdWRhaCBndWUgdGFuZGFpbiBkaWJhY2EgYnJvIPCfpJ8iKQogICAgICAgICAgICBwYXVzZSgpCgogICAgICAgIGVsaWYgcGlsaWhhbiA9PSAiMiI6CiAgICAgICAgICAgIG5vbW9yID0gY29uc29sZS5pbnB1dChmIlt7dGhlbWVbJ3RleHRfc3ViJ119XU1hc3VraW4gbm9tb3Igbm90aWYgY3V5Olsve3RoZW1lWyd0ZXh0X3N1YiddfV0gIikuc3RyaXAoKQogICAgICAgICAgICBpZiBub3Qgbm9tb3IuaXNkaWdpdCgpOgogICAgICAgICAgICAgICAgcHJpbnRfcGFuZWwoIuKdjCBVcHMiLCAiTm9tb3IgbmdnYWsgdmFsaWQgYnJvLCBqYW5nYW4gbmdhY28g8J+kqiIpCiAgICAgICAgICAgICAgICBwYXVzZSgpCiAgICAgICAgICAgICAgICBjb250aW51ZQogICAgICAgICAgICBub21vciA9IGludChub21vcikKICAgICAgICAgICAgc2VsZWN0ZWQgPSBuZXh0KChuIGZvciBpLCBuIGluIGVudW1lcmF0ZShub3RpZmljYXRpb25zLCBzdGFydD0xKSBpZiBpID09IG5vbW9yKSwgTm9uZSkKICAgICAgICAgICAgaWYgbm90IHNlbGVjdGVkOgogICAgICAgICAgICAgICAgcHJpbnRfcGFuZWwoIuKdjCBVcHMiLCAiTm9tb3Igbm90aWYgbmdnYWsga2V0ZW11LCBqYW5nYW4gaGFsdSDwn6ugIikKICAgICAgICAgICAgICAgIHBhdXNlKCkKICAgICAgICAgICAgICAgIGNvbnRpbnVlCiAgICAgICAgICAgIGlmIHNlbGVjdGVkLmdldCgiaXNfcmVhZCIsIEZhbHNlKToKICAgICAgICAgICAgICAgIHByaW50X3BhbmVsKCLihLnvuI8gSW5mbyIsICJOb3RpZiBpbmkgdWRhaCBkaWJhY2Egc2ViZWx1bW55YSwgc2FudHV5IGFqYSDwn5iMIikKICAgICAgICAgICAgICAgIHBhdXNlKCkKICAgICAgICAgICAgICAgIGNvbnRpbnVlCiAgICAgICAgICAgIG5vdGlmaWNhdGlvbl9pZCA9IHNlbGVjdGVkLmdldCgibm90aWZpY2F0aW9uX2lkIikKICAgICAgICAgICAgZGV0YWlsID0gZ2V0X25vdGlmaWNhdGlvbl9kZXRhaWwoYXBpX2tleSwgdG9rZW5zLCBub3RpZmljYXRpb25faWQpCiAgICAgICAgICAgIGlmIGRldGFpbDoKICAgICAgICAgICAgICAgIHByaW50X3BhbmVsKCLinIUgTWFudGFwIiwgZiJOb3RpZiBJRCB7bm90aWZpY2F0aW9uX2lkfSB1ZGFoIGd1ZSB0YW5kYWluIGRpYmFjYSBicm8g8J+knyIpCiAgICAgICAgICAgIHBhdXNlKCkKCiAgICAgICAgZWxpZiBwaWxpaGFuID09ICIwMCI6CiAgICAgICAgICAgIGluX25vdGlmaWNhdGlvbl9tZW51ID0gRmFsc2UKCiAgICAgICAgZWxzZToKICAgICAgICAgICAgcHJpbnRfcGFuZWwoIuKaoO+4jyBCcm8iLCAiUGlsaWhhbiBsbyBuZ2FjbywgY29iYSBsYWdpIGRlaCDwn6SvIikKICAgICAgICAgICAgcGF1c2UoKQo=').decode())
