#!/usr/bin/env python3
import base64
exec(base64.b64decode('aW1wb3J0IG9zCmltcG9ydCBqc29uCgpmcm9tIGFwcDMuY29uZmlnLmltcG9ydHMgaW1wb3J0ICoKZnJvbSBhcHAzLm1lbnVzLnBhY2thZ2UgaW1wb3J0IGdldF9wYWNrYWdlc19ieV9mYW1pbHkKZnJvbSBhcHAzLm1lbnVzLnV0aWwgaW1wb3J0IGNsZWFyX3NjcmVlbiwgcGF1c2UsIHByaW50X3BhbmVsLCBsaXZlX2xvYWRpbmcsIHNpbXBsZV9udW1iZXIKCmNvbnNvbGUgPSBDb25zb2xlKCkKCgpGQU1JTFlfRklMRSA9IG9zLnBhdGguYWJzcGF0aCgiZmFtaWx5X2NvZGVzLmpzb24iKQoKCmRlZiBlbnN1cmVfZmFtaWx5X2ZpbGUoKToKICAgIGRlZmF1bHRfZGF0YSA9IHsiY29kZXMiOiBbXX0KICAgIGlmIG5vdCBvcy5wYXRoLmV4aXN0cyhGQU1JTFlfRklMRSk6CiAgICAgICAgd2l0aCBvcGVuKEZBTUlMWV9GSUxFLCAidyIpIGFzIGY6CiAgICAgICAgICAgIGpzb24uZHVtcChkZWZhdWx0X2RhdGEsIGYsIGluZGVudD0yKQogICAgICAgIHJldHVybiBkZWZhdWx0X2RhdGEKCiAgICB0cnk6CiAgICAgICAgd2l0aCBvcGVuKEZBTUlMWV9GSUxFLCAiciIpIGFzIGY6CiAgICAgICAgICAgIGRhdGEgPSBqc29uLmxvYWQoZikKICAgICAgICBpZiBub3QgaXNpbnN0YW5jZShkYXRhLCBkaWN0KSBvciAiY29kZXMiIG5vdCBpbiBkYXRhIG9yIG5vdCBpc2luc3RhbmNlKGRhdGFbImNvZGVzIl0sIGxpc3QpOgogICAgICAgICAgICByYWlzZSBWYWx1ZUVycm9yKCJTdHJ1a3R1ciB0aWRhayB2YWxpZCIpCiAgICAgICAgcmV0dXJuIGRhdGEKICAgIGV4Y2VwdCAoanNvbi5KU09ORGVjb2RlRXJyb3IsIFZhbHVlRXJyb3IpOgogICAgICAgIHdpdGggb3BlbihGQU1JTFlfRklMRSwgInciKSBhcyBmOgogICAgICAgICAgICBqc29uLmR1bXAoZGVmYXVsdF9kYXRhLCBmLCBpbmRlbnQ9MikKICAgICAgICByZXR1cm4gZGVmYXVsdF9kYXRhCgoKZGVmIGxpc3RfZmFtaWx5X2NvZGVzKCk6CiAgICByZXR1cm4gZW5zdXJlX2ZhbWlseV9maWxlKClbImNvZGVzIl0KCgpkZWYgYWRkX2ZhbWlseV9jb2RlKGNvZGUsIG5hbWUpOgogICAgaWYgbm90IGNvZGUuc3RyaXAoKSBvciBub3QgbmFtZS5zdHJpcCgpOgogICAgICAgIHJldHVybiBGYWxzZQogICAgZGF0YSA9IGVuc3VyZV9mYW1pbHlfZmlsZSgpCiAgICBpZiBhbnkoaXRlbVsiY29kZSJdID09IGNvZGUgZm9yIGl0ZW0gaW4gZGF0YVsiY29kZXMiXSk6CiAgICAgICAgcmV0dXJuIEZhbHNlCiAgICBkYXRhWyJjb2RlcyJdLmFwcGVuZCh7ImNvZGUiOiBjb2RlLnN0cmlwKCksICJuYW1lIjogbmFtZS5zdHJpcCgpfSkKICAgIHdpdGggb3BlbihGQU1JTFlfRklMRSwgInciKSBhcyBmOgogICAgICAgIGpzb24uZHVtcChkYXRhLCBmLCBpbmRlbnQ9MikKICAgIHJldHVybiBUcnVlCgoKZGVmIHJlbW92ZV9mYW1pbHlfY29kZShpbmRleCk6CiAgICBkYXRhID0gZW5zdXJlX2ZhbWlseV9maWxlKCkKICAgIGlmIDAgPD0gaW5kZXggPCBsZW4oZGF0YVsiY29kZXMiXSk6CiAgICAgICAgcmVtb3ZlZCA9IGRhdGFbImNvZGVzIl0ucG9wKGluZGV4KQogICAgICAgIHdpdGggb3BlbihGQU1JTFlfRklMRSwgInciKSBhcyBmOgogICAgICAgICAgICBqc29uLmR1bXAoZGF0YSwgZiwgaW5kZW50PTIpCiAgICAgICAgcmV0dXJuIHJlbW92ZWRbImNvZGUiXQogICAgcmV0dXJuIE5vbmUKCgpkZWYgZWRpdF9mYW1pbHlfbmFtZShpbmRleCwgbmV3X25hbWUpOgogICAgaWYgbm90IG5ld19uYW1lLnN0cmlwKCk6CiAgICAgICAgcmV0dXJuIEZhbHNlCiAgICBkYXRhID0gZW5zdXJlX2ZhbWlseV9maWxlKCkKICAgIGlmIDAgPD0gaW5kZXggPCBsZW4oZGF0YVsiY29kZXMiXSk6CiAgICAgICAgZGF0YVsiY29kZXMiXVtpbmRleF1bIm5hbWUiXSA9IG5ld19uYW1lLnN0cmlwKCkKICAgICAgICB3aXRoIG9wZW4oRkFNSUxZX0ZJTEUsICJ3IikgYXMgZjoKICAgICAgICAgICAganNvbi5kdW1wKGRhdGEsIGYsIGluZGVudD0yKQogICAgICAgIHJldHVybiBUcnVlCiAgICByZXR1cm4gRmFsc2UKCgpkZWYgc2hvd19mYW1pbHlfZ3J1cF9tZW51KHJldHVybl9wYWNrYWdlX2RldGFpbDogYm9vbCA9IEZhbHNlKToKICAgIHdoaWxlIFRydWU6CiAgICAgICAgY2xlYXJfc2NyZWVuKCkKICAgICAgICBlbnN1cmVfZ2l0KCkKICAgICAgICBzZW11YV9rb2RlID0gbGlzdF9mYW1pbHlfY29kZXMoKQogICAgICAgIHRoZW1lID0gZ2V0X3RoZW1lKCkKCiAgICAgICAgY29uc29sZS5wcmludChQYW5lbCgKICAgICAgICAgICAgQWxpZ24uY2VudGVyKCLwn5OLIExpc3QgRmFtaWx5IENvZGUg8J+kmSIsIHZlcnRpY2FsPSJtaWRkbGUiKSwKICAgICAgICAgICAgYm9yZGVyX3N0eWxlPXRoZW1lWyJib3JkZXJfaW5mbyJdLAogICAgICAgICAgICBwYWRkaW5nPSgxLCAyKSwKICAgICAgICAgICAgZXhwYW5kPVRydWUKICAgICAgICApKQogICAgICAgIHNpbXBsZV9udW1iZXIoKQoKICAgICAgICBwYWNrYWdlcyA9IFtdCiAgICAgICAgaWYgc2VtdWFfa29kZToKICAgICAgICAgICAgdGFibGUgPSBUYWJsZShib3g9TUlOSU1BTF9ET1VCTEVfSEVBRCwgZXhwYW5kPVRydWUpCiAgICAgICAgICAgIHRhYmxlLmFkZF9jb2x1bW4oIk5vIiwganVzdGlmeT0icmlnaHQiLCBzdHlsZT10aGVtZVsidGV4dF9rZXkiXSwgd2lkdGg9MykKICAgICAgICAgICAgdGFibGUuYWRkX2NvbHVtbigiTmFtYSBGQyIsIHN0eWxlPXRoZW1lWyJ0ZXh0X2JvZHkiXSkKICAgICAgICAgICAgdGFibGUuYWRkX2NvbHVtbigiRmFtaWx5IENvZGUiLCBzdHlsZT10aGVtZVsiYm9yZGVyX2luZm8iXSkKCiAgICAgICAgICAgIGZvciBpLCBpdGVtIGluIGVudW1lcmF0ZShzZW11YV9rb2RlLCBzdGFydD0xKToKICAgICAgICAgICAgICAgIHRhYmxlLmFkZF9yb3coc3RyKGkpLCBpdGVtWyJuYW1lIl0sIGl0ZW1bImNvZGUiXSkKICAgICAgICAgICAgICAgIHBhY2thZ2VzLmFwcGVuZCh7CiAgICAgICAgICAgICAgICAgICAgIm51bWJlciI6IGksCiAgICAgICAgICAgICAgICAgICAgImNvZGUiOiBpdGVtWyJjb2RlIl0sCiAgICAgICAgICAgICAgICAgICAgIm5hbWUiOiBpdGVtWyJuYW1lIl0KICAgICAgICAgICAgICAgIH0pCgogICAgICAgICAgICBjb25zb2xlLnByaW50KFBhbmVsKHRhYmxlLCBib3JkZXJfc3R5bGU9dGhlbWVbImJvcmRlcl9pbmZvIl0sIHBhZGRpbmc9KDAsIDApLCBleHBhbmQ9VHJ1ZSkpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgY29uc29sZS5wcmludChQYW5lbCgKICAgICAgICAgICAgICAgICJbaXRhbGljXVNlcGkgY3V5LCBiZWx1bSBhZGEgZmFtaWx5IGNvZGUg8J+YtFsvaXRhbGljXSIsCiAgICAgICAgICAgICAgICBib3JkZXJfc3R5bGU9dGhlbWVbImJvcmRlcl93YXJuaW5nIl0sCiAgICAgICAgICAgICAgICBwYWRkaW5nPSgxLCAyKSwKICAgICAgICAgICAgICAgIGV4cGFuZD1UcnVlCiAgICAgICAgICAgICkpCgogICAgICAgIG5hdl90YWJsZSA9IFRhYmxlKHNob3dfaGVhZGVyPUZhbHNlLCBib3g9TUlOSU1BTF9ET1VCTEVfSEVBRCwgZXhwYW5kPVRydWUpCiAgICAgICAgbmF2X3RhYmxlLmFkZF9jb2x1bW4oanVzdGlmeT0icmlnaHQiLCBzdHlsZT10aGVtZVsidGV4dF9rZXkiXSwgd2lkdGg9NikKICAgICAgICBuYXZfdGFibGUuYWRkX2NvbHVtbihzdHlsZT10aGVtZVsidGV4dF9ib2R5Il0pCiAgICAgICAgbmF2X3RhYmxlLmFkZF9yb3coIlQiLCAiVGFtYmFoIGZhbWlseSBjb2RlIOKelSAiKQogICAgICAgIGlmIHNlbXVhX2tvZGU6CiAgICAgICAgICAgIG5hdl90YWJsZS5hZGRfcm93KCJFIiwgIkVkaXQgbmFtYSBmYW1pbHkgY29kZSDinI/vuI8gIikKICAgICAgICAgICAgbmF2X3RhYmxlLmFkZF9yb3coIkgiLCBmIlt7dGhlbWVbJ3RleHRfZXJyJ119XUhhcHVzIGZhbWlseSBjb2RlIPCfl5HvuI8gWy9dIikKICAgICAgICBuYXZfdGFibGUuYWRkX3JvdygiMDAiLCBmIlt7dGhlbWVbJ3RleHRfc3ViJ119XUNhYnV0IGJhbGlrIGtlIG1lbnUgYXdhbCDwn4+gWy9dIikKCiAgICAgICAgY29uc29sZS5wcmludChQYW5lbChuYXZfdGFibGUsIGJvcmRlcl9zdHlsZT10aGVtZVsiYm9yZGVyX3ByaW1hcnkiXSwgcGFkZGluZz0oMCwgMSksIGV4cGFuZD1UcnVlKSkKCiAgICAgICAgYWtzaSA9IGNvbnNvbGUuaW5wdXQoZiJbe3RoZW1lWyd0ZXh0X3RpdGxlJ119XVBpbGloIGFrc2kgYXRhdSBub21vciBrb2RlIGJybzpbL3t0aGVtZVsndGV4dF90aXRsZSddfV0gIikuc3RyaXAoKS5sb3dlcigpCgogICAgICAgIGlmIGFrc2kgPT0gInQiOgogICAgICAgICAgICBjb2RlID0gY29uc29sZS5pbnB1dCgiTWFzdWtpbiBmYW1pbHkgY29kZTogIikuc3RyaXAoKQogICAgICAgICAgICBuYW1lID0gY29uc29sZS5pbnB1dCgiTWFzdWtpbiBuYW1hIGZhbWlseTogIikuc3RyaXAoKQogICAgICAgICAgICBzdWNjZXNzID0gYWRkX2ZhbWlseV9jb2RlKGNvZGUsIG5hbWUpCiAgICAgICAgICAgIHByaW50X3BhbmVsKCLinIUgTWFudGFwIiBpZiBzdWNjZXNzIGVsc2UgIuKaoO+4jyBVcHMiLCAKICAgICAgICAgICAgICAgICAgICAgICAgIkZhbWlseSBjb2RlIGJhcnUgdWRhaCBkaXRhbWJhaCBicm8g8J+agCIgaWYgc3VjY2VzcyBlbHNlICJHYWdhbCBuYW1iYWgsIGZhbWlseSBjb2RlIHVkYWggYWRhIPCfpK8iKQogICAgICAgICAgICBwYXVzZSgpCgogICAgICAgIGVsaWYgYWtzaSA9PSAiaCI6CiAgICAgICAgICAgIGlmIG5vdCBzZW11YV9rb2RlOgogICAgICAgICAgICAgICAgcHJpbnRfcGFuZWwoIuKEue+4jyBTYW50dXkiLCAiTmdnYWsgYWRhIGtvZGUgYnVhdCBkaWhhcHVzIGJybyDwn5i0IikKICAgICAgICAgICAgICAgIHBhdXNlKCkKICAgICAgICAgICAgICAgIGNvbnRpbnVlCiAgICAgICAgICAgIGlkeCA9IGNvbnNvbGUuaW5wdXQoIk5vbW9yIGtvZGUgeWFuZyBtYXUgZGloYXB1czogIikuc3RyaXAoKQogICAgICAgICAgICBpZiBpZHguaXNkaWdpdCgpIGFuZCAxIDw9IGludChpZHgpIDw9IGxlbihzZW11YV9rb2RlKToKICAgICAgICAgICAgICAgIGluZGV4ID0gaW50KGlkeCkgLSAxCiAgICAgICAgICAgICAgICBuYW1hID0gc2VtdWFfa29kZVtpbmRleF1bIm5hbWUiXQogICAgICAgICAgICAgICAga29kZSA9IHNlbXVhX2tvZGVbaW5kZXhdWyJjb2RlIl0KICAgICAgICAgICAgICAgIGtvbmZpcm1hc2kgPSBjb25zb2xlLmlucHV0KGYiWWFraW4gbWF1IGhhcHVzICd7bmFtYX0nICh7a29kZX0pPyAoeS9uKTogIikuc3RyaXAoKS5sb3dlcigpCiAgICAgICAgICAgICAgICBpZiBrb25maXJtYXNpID09ICJ5IjoKICAgICAgICAgICAgICAgICAgICByZW1vdmVkID0gcmVtb3ZlX2ZhbWlseV9jb2RlKGluZGV4KQogICAgICAgICAgICAgICAgICAgIHByaW50X3BhbmVsKCLinIUgTWFudGFwIiBpZiByZW1vdmVkIGVsc2UgIuKaoO+4jyBVcHMiLCAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmIkZhbWlseSBjb2RlIHtyZW1vdmVkfSB1ZGFoIGd1ZSBoYXB1cyBicm8g4pyM77iPIiBpZiByZW1vdmVkIGVsc2UgIkdhZ2FsIGhhcHVzIPCfpK8iKQogICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICBwcmludF9wYW5lbCgi4oS577iPIFNhbnR1eSIsICJQZW5naGFwdXNhbiBkaWJhdGFsaW4gYnJvIOKcjO+4jyIpCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBwcmludF9wYW5lbCgi4pqg77iPIFVwcyIsICJOb21vciBrb2RlIG5nZ2FrIHZhbGlkIGJybyDwn5qoIikKICAgICAgICAgICAgcGF1c2UoKQoKICAgICAgICBlbGlmIGFrc2kgPT0gImUiOgogICAgICAgICAgICBpZiBub3Qgc2VtdWFfa29kZToKICAgICAgICAgICAgICAgIHByaW50X3BhbmVsKCLihLnvuI8gU2FudHV5IiwgIk5nZ2FrIGFkYSBrb2RlIGJ1YXQgZGllZGl0IGJybyDwn5i0IikKICAgICAgICAgICAgICAgIHBhdXNlKCkKICAgICAgICAgICAgICAgIGNvbnRpbnVlCiAgICAgICAgICAgIGlkeCA9IGNvbnNvbGUuaW5wdXQoIk5vbW9yIGtvZGUgeWFuZyBtYXUgZGl1YmFoIG5hbWFueWE6ICIpLnN0cmlwKCkKICAgICAgICAgICAgaWYgaWR4LmlzZGlnaXQoKSBhbmQgMSA8PSBpbnQoaWR4KSA8PSBsZW4oc2VtdWFfa29kZSk6CiAgICAgICAgICAgICAgICBuZXdfbmFtZSA9IGNvbnNvbGUuaW5wdXQoIk1hc3VraW4gbmFtYSBiYXJ1OiAiKS5zdHJpcCgpCiAgICAgICAgICAgICAgICBzdWNjZXNzID0gZWRpdF9mYW1pbHlfbmFtZShpbnQoaWR4KSAtIDEsIG5ld19uYW1lKQogICAgICAgICAgICAgICAgcHJpbnRfcGFuZWwoIuKchSBNYW50YXAiIGlmIHN1Y2Nlc3MgZWxzZSAi4pqg77iPIFVwcyIsIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIk5hbWEgZmFtaWx5IGNvZGUgdWRhaCBkaWdhbnRpIGJybyDinKgiIGlmIHN1Y2Nlc3MgZWxzZSAiR2FnYWwgZ2FudGkgbmFtYSDwn6SvIikKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHByaW50X3BhbmVsKCLimqDvuI8gVXBzIiwgIk5vbW9yIGtvZGUgbmdnYWsgdmFsaWQgYnJvIPCfmqgiKQogICAgICAgICAgICBwYXVzZSgpCgogICAgICAgIGVsaWYgYWtzaSA9PSAiMDAiOgogICAgICAgICAgICByZXR1cm4gTm9uZSwgTm9uZSBpZiByZXR1cm5fcGFja2FnZV9kZXRhaWwgZWxzZSBOb25lCgogICAgICAgIGVsaWYgYWtzaS5pc2RpZ2l0KCk6CiAgICAgICAgICAgIG5vbW9yID0gaW50KGFrc2kpCiAgICAgICAgICAgIHNlbGVjdGVkID0gbmV4dCgocCBmb3IgcCBpbiBwYWNrYWdlcyBpZiBwWyJudW1iZXIiXSA9PSBub21vciksIE5vbmUpCiAgICAgICAgICAgIGlmIHNlbGVjdGVkOgogICAgICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IGdldF9wYWNrYWdlc19ieV9mYW1pbHkoc2VsZWN0ZWRbImNvZGUiXSwgcmV0dXJuX3BhY2thZ2VfZGV0YWlsPXJldHVybl9wYWNrYWdlX2RldGFpbCkKICAgICAgICAgICAgICAgICAgICBpZiByZXR1cm5fcGFja2FnZV9kZXRhaWw6CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIGlzaW5zdGFuY2UocmVzdWx0LCB0dXBsZSk6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVzdWx0CiAgICAgICAgICAgICAgICAgICAgICAgIGVsaWYgcmVzdWx0ID09ICJNQUlOIjoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAiTUFJTiIKICAgICAgICAgICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBOb25lLCBOb25lCiAgICAgICAgICAgICAgICAgICAgaWYgcmVzdWx0ID09ICJNQUlOIjoKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIE5vbmUKICAgICAgICAgICAgICAgICAgICBlbGlmIHJlc3VsdCA9PSAiQkFDSyI6CiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlCiAgICAgICAgICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgICAgICAgICAgcHJpbnRfcGFuZWwoIuKaoO+4jyBVcHMiLCBmIkdhZ2FsIG5hbXBpbGluIHBha2V0IGJybzoge2V9IikKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHByaW50X3BhbmVsKCLimqDvuI8gVXBzIiwgIk5vbW9yIGtvZGUgbmdnYWsgdmFsaWQgYnJvIPCfmqgiKQogICAgICAgICAgICBwYXVzZSgpCg==').decode())
