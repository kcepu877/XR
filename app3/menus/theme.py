#!/usr/bin/env python3
import base64
exec(base64.b64decode('ZnJvbSBhcHAzLmNvbmZpZy5pbXBvcnRzIGltcG9ydCAqCmZyb20gYXBwMy5tZW51cy51dGlsIGltcG9ydCBjbGVhcl9zY3JlZW4sIHBhdXNlLCBwcmludF9wYW5lbCwgc2ltcGxlX251bWJlcgoKY29uc29sZSA9IENvbnNvbGUoKQoKCmRlZiBzaG93X3RoZW1lX21lbnUoKToKICAgIHdoaWxlIFRydWU6CiAgICAgICAgY2xlYXJfc2NyZWVuKCkKICAgICAgICBlbnN1cmVfZ2l0KCkKICAgICAgICB0aGVtZSA9IGdldF90aGVtZSgpCiAgICAgICAgcHJlc2V0cyA9IGdldF9hbGxfcHJlc2V0cygpCiAgICAgICAgdGhlbWVfbmFtZXMgPSBsaXN0KHByZXNldHMua2V5cygpKQoKICAgICAgICBjb25zb2xlLnByaW50KFBhbmVsKAogICAgICAgICAgICBBbGlnbi5jZW50ZXIoIvCfjqggUGlsaWggVGVtYSBDTEkg8J+kmSIsIHZlcnRpY2FsPSJtaWRkbGUiKSwKICAgICAgICAgICAgc3R5bGU9dGhlbWVbInRleHRfdGl0bGUiXSwKICAgICAgICAgICAgYm9yZGVyX3N0eWxlPXRoZW1lWyJib3JkZXJfaW5mbyJdLAogICAgICAgICAgICBwYWRkaW5nPSgxLCAyKSwKICAgICAgICAgICAgZXhwYW5kPVRydWUsCiAgICAgICAgKSkKICAgICAgICBzaW1wbGVfbnVtYmVyKCkKCiAgICAgICAgdGFibGUgPSBUYWJsZShib3g9TUlOSU1BTF9ET1VCTEVfSEVBRCwgZXhwYW5kPVRydWUpCiAgICAgICAgdGFibGUuYWRkX2NvbHVtbigiTm8iLCBqdXN0aWZ5PSJyaWdodCIsIHN0eWxlPXRoZW1lWyJ0ZXh0X251bWJlciJdLCB3aWR0aD02KQogICAgICAgIHRhYmxlLmFkZF9jb2x1bW4oIk5hbWEgVGVtYSIsIHN0eWxlPXRoZW1lWyJ0ZXh0X2JvZHkiXSkKICAgICAgICB0YWJsZS5hZGRfY29sdW1uKCJQcmV2aWV3IiwganVzdGlmeT0ibGVmdCIpCgogICAgICAgIGZvciBpZHgsIG5hbWUgaW4gZW51bWVyYXRlKHRoZW1lX25hbWVzLCBzdGFydD0xKToKICAgICAgICAgICAgcHJlc2V0ID0gcHJlc2V0c1tuYW1lXQogICAgICAgICAgICBwcmV2aWV3ID0gKAogICAgICAgICAgICAgICAgZiJbe3ByZXNldFsnYm9yZGVyX3ByaW1hcnknXX1d4pagWy9dICIKICAgICAgICAgICAgICAgIGYiW3twcmVzZXRbJ2JvcmRlcl9pbmZvJ119XeKWoFsvXSAiCiAgICAgICAgICAgICAgICBmIlt7cHJlc2V0Wydib3JkZXJfc3VjY2VzcyddfV3ilqBbL10gIgogICAgICAgICAgICAgICAgZiJbe3ByZXNldFsnYm9yZGVyX3dhcm5pbmcnXX1d4pagWy9dICIKICAgICAgICAgICAgICAgIGYiW3twcmVzZXRbJ2JvcmRlcl9lcnJvciddfV3ilqBbL10iCiAgICAgICAgICAgICkKICAgICAgICAgICAgdGFibGUuYWRkX3JvdyhzdHIoaWR4KSwgbmFtZS5yZXBsYWNlKCJfIiwgIiAiKS50aXRsZSgpLCBwcmV2aWV3KQoKICAgICAgICBjb25zb2xlLnByaW50KFBhbmVsKHRhYmxlLCBib3JkZXJfc3R5bGU9dGhlbWVbImJvcmRlcl9pbmZvIl0sIHBhZGRpbmc9KDAsIDApLCBleHBhbmQ9VHJ1ZSkpCgogICAgICAgIG5hdl90YWJsZSA9IFRhYmxlKHNob3dfaGVhZGVyPUZhbHNlLCBib3g9TUlOSU1BTF9ET1VCTEVfSEVBRCwgZXhwYW5kPVRydWUpCiAgICAgICAgbmF2X3RhYmxlLmFkZF9jb2x1bW4oanVzdGlmeT0icmlnaHQiLCBzdHlsZT10aGVtZVsidGV4dF9rZXkiXSwgd2lkdGg9NCkKICAgICAgICBuYXZfdGFibGUuYWRkX2NvbHVtbihzdHlsZT10aGVtZVsidGV4dF9ib2R5Il0pCiAgICAgICAgbmF2X3RhYmxlLmFkZF9yb3coIjAwIiwgZiJbe3RoZW1lWyd0ZXh0X3N1YiddfV1DYWJ1dCBiYWxpayBrZSBtZW51IHV0YW1hIPCfj6BbL10iKQoKICAgICAgICBjb25zb2xlLnByaW50KFBhbmVsKG5hdl90YWJsZSwgYm9yZGVyX3N0eWxlPXRoZW1lWyJib3JkZXJfcHJpbWFyeSJdLCBwYWRkaW5nPSgwLCAxKSwgZXhwYW5kPVRydWUpKQoKICAgICAgICBjaG9pY2UgPSBjb25zb2xlLmlucHV0KGYiW3t0aGVtZVsndGV4dF90aXRsZSddfV1QaWxpaCBub21vciB0ZW1hIGJybyDwn5GJOlsve3RoZW1lWyd0ZXh0X3RpdGxlJ119XSAiKS5zdHJpcCgpCgogICAgICAgIGlmIGNob2ljZSA9PSAiMDAiOgogICAgICAgICAgICByZXR1cm4KCiAgICAgICAgaWYgY2hvaWNlLmlzZGlnaXQoKSBhbmQgMSA8PSBpbnQoY2hvaWNlKSA8PSBsZW4odGhlbWVfbmFtZXMpOgogICAgICAgICAgICBzZWxlY3RlZF90aGVtZSA9IHRoZW1lX25hbWVzW2ludChjaG9pY2UpIC0gMV0KICAgICAgICAgICAgc2VsZWN0ZWRfcHJlc2V0ID0gcHJlc2V0c1tzZWxlY3RlZF90aGVtZV0KCiAgICAgICAgICAgIHByZXZpZXdfcGFuZWwgPSBQYW5lbCgKICAgICAgICAgICAgICAgIEFsaWduLmNlbnRlcihmIvCfkYAgUHJldmlldyBUZW1hOiB7c2VsZWN0ZWRfdGhlbWUucmVwbGFjZSgnXycsICcgJykudGl0bGUoKX0iKSwKICAgICAgICAgICAgICAgIGJvcmRlcl9zdHlsZT1zZWxlY3RlZF9wcmVzZXRbImJvcmRlcl9wcmltYXJ5Il0sCiAgICAgICAgICAgICAgICBzdHlsZT1zZWxlY3RlZF9wcmVzZXRbInRleHRfdGl0bGUiXSwKICAgICAgICAgICAgICAgIHBhZGRpbmc9KDEsIDIpLAogICAgICAgICAgICAgICAgZXhwYW5kPVRydWUKICAgICAgICAgICAgKQogICAgICAgICAgICBjb25zb2xlLnByaW50KHByZXZpZXdfcGFuZWwpCgogICAgICAgICAgICBjb25maXJtID0gY29uc29sZS5pbnB1dCgKICAgICAgICAgICAgICAgIGYiW3t0aGVtZVsndGV4dF9zdWInXX1dR2FzIHBha2UgdGVtYSAne3NlbGVjdGVkX3RoZW1lLnJlcGxhY2UoJ18nLCAnICcpLnRpdGxlKCl9Jz8gKHkvbik6Wy97dGhlbWVbJ3RleHRfc3ViJ119XSAiCiAgICAgICAgICAgICkuc3RyaXAoKS5sb3dlcigpCgogICAgICAgICAgICBpZiBjb25maXJtID09ICJ5IjoKICAgICAgICAgICAgICAgIHNldF90aGVtZShzZWxlY3RlZF90aGVtZSkKICAgICAgICAgICAgICAgIHRoZW1lID0gZ2V0X3RoZW1lKGZvcmNlX3JlbG9hZD1UcnVlKQogICAgICAgICAgICAgICAgcHJpbnRfdGhlbWVfY2hhbmdlZChzZWxlY3RlZF90aGVtZSkKICAgICAgICAgICAgICAgIHBhdXNlKCkKICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHByaW50X3BhbmVsKCLimqDvuI8gVXBzIiwgIlBpbGloYW4gbG8gbmdhY28gYnJvIPCfmqgiKQogICAgICAgICAgICBwYXVzZSgpCgoKZGVmIHByaW50X3RoZW1lX2NoYW5nZWQodGhlbWVfbmFtZSk6CiAgICB0aGVtZSA9IGdldF90aGVtZSgpCiAgICB0ZXJtaW5hbF93aWR0aCA9IGNvbnNvbGUuc2l6ZS53aWR0aAogICAgbWVzc2FnZV90ZXh0ID0gKAogICAgICAgIGYiW3t0aGVtZVsndGV4dF9vayddfV3inIUgVGVtYSBVZGFoIERpZ2FudGkgQnJvIPCfmoBbL11cbiIKICAgICAgICBmIlt7dGhlbWVbJ3RleHRfc3ViJ119XVRlbWEgc2VrYXJhbmc6IHt0aGVtZV9uYW1lLnJlcGxhY2UoJ18nLCAnICcpLnRpdGxlKCl9Wy9dIgogICAgKQogICAgcGFuZWwgPSBQYW5lbCgKICAgICAgICBBbGlnbi5sZWZ0KG1lc3NhZ2VfdGV4dCksCiAgICAgICAgdGl0bGU9IiIsCiAgICAgICAgdGl0bGVfYWxpZ249ImxlZnQiLAogICAgICAgIHN0eWxlPXRoZW1lWyJib3JkZXJfc3VjY2VzcyJdLAogICAgICAgIHdpZHRoPXRlcm1pbmFsX3dpZHRoCiAgICApCiAgICBjb25zb2xlLnByaW50KHBhbmVsKQoK').decode())
