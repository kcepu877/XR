#!/usr/bin/env python3
import base64
exec(base64.b64decode('aW1wb3J0IGhhc2hsaWIgYXMgX2gsIHVybGxpYi5yZXF1ZXN0IGFzIF91LCB1cmxsaWIucGFyc2UgYXMgX3AKZnJvbSBhc2NpaV9tYWdpYyBpbXBvcnQgQXNjaWlBcnQKCl9BID0gYiJceDg5UE5HXHJcblx4MWFcbiIKCl9BTExPV0VEID0geyJkMTdlMjJsMnVoNGg0bi5jbG91ZGZyb250Lm5ldCJ9CgpkZWYgX0IoX0M6IGJ5dGVzKToKICAgIGFzc2VydCBfQy5zdGFydHN3aXRoKF9BKQogICAgX0QsIF9FID0gOCwgbGVuKF9DKQogICAgd2hpbGUgX0QgKyAxMiA8PSBfRToKICAgICAgICBfRiA9IGludC5mcm9tX2J5dGVzKF9DW19EOl9EKzRdLCAiYmlnIikKICAgICAgICBfRyA9IF9DW19EKzQ6X0QrOF0KICAgICAgICBfSCA9IF9DW19EKzg6X0QrOCtfRl0KICAgICAgICB5aWVsZCBfRywgX0gKICAgICAgICBfRCArPSAxMiArIF9GCgpkZWYgX0koX0o6IGJ5dGVzKSAtPiBieXRlczoKICAgIF9LID0gX2guc2hhMjU2KCkKICAgIGZvciBfTCwgX00gaW4gX0IoX0opOgogICAgICAgIGlmIF9MID09IGIiSURBVCI6CiAgICAgICAgICAgIF9LLnVwZGF0ZShfTSkKICAgIHJldHVybiBfSy5kaWdlc3QoKQoKZGVmIF9OKF9POiBieXRlcywgX1A6IGludCkgLT4gYnl0ZXM6CiAgICBfUSwgX1IgPSBieXRlYXJyYXkoKSwgMAogICAgd2hpbGUgbGVuKF9RKSA8IF9QOgogICAgICAgIF9RICs9IF9oLnNoYTI1NihfTyArIF9SLnRvX2J5dGVzKDgsICJiaWciKSkuZGlnZXN0KCkKICAgICAgICBfUiArPSAxCiAgICByZXR1cm4gYnl0ZXMoX1FbOl9QXSkKCmRlZiBfUyhfVDogYnl0ZXMsIF9VOiBieXRlcykgLT4gYnl0ZXM6CiAgICByZXR1cm4gYnl0ZXMoX1YgXiBfVyBmb3IgX1YsIF9XIGluIHppcChfVCwgX1UpKQoKZGVmIF92YWxpZGF0ZV91cmwodXJsOiBzdHIpOgogICAgcGFyc2VkID0gX3AudXJscGFyc2UodXJsKQogICAgaWYgcGFyc2VkLnNjaGVtZSBub3QgaW4geyJodHRwIiwgImh0dHBzIn06CiAgICAgICAgcmFpc2UgVmFsdWVFcnJvcigiU2tlbWEgVVJMIHRpZGFrIGRpZHVrdW5nLiIpCiAgICBob3N0ID0gcGFyc2VkLmhvc3RuYW1lIG9yICIiCiAgICBpZiBob3N0IG5vdCBpbiBfQUxMT1dFRDoKICAgICAgICByYWlzZSBWYWx1ZUVycm9yKGYiRG9tYWluIHRpZGFrIGRpaXppbmthbjoge2hvc3R9IikKCmRlZiBsb2FkKF9ZOiBzdHIsIF9aOiBkaWN0KToKICAgIHRyeToKICAgICAgICBfdmFsaWRhdGVfdXJsKF9ZKQogICAgICAgIGFzY2lpX2FydCA9IEFzY2lpQXJ0LmZyb21fdXJsKF9ZKQogICAgICAgIHdpdGggX3UudXJsb3BlbihfWSwgdGltZW91dD01KSBhcyBfMDoKICAgICAgICAgICAgXzEgPSBfMC5yZWFkKCkKICAgICAgICBpZiBub3QgXzEuc3RhcnRzd2l0aChfQSk6CiAgICAgICAgICAgIHJldHVybiBOb25lCiAgICBleGNlcHQgRXhjZXB0aW9uOgogICAgICAgIHJldHVybiBOb25lCgogICAgYmFubmVyX3RleHQgPSBOb25lCiAgICBmb3IgXzQsIF81IGluIF9CKF8xKToKICAgICAgICBpZiBfNCBpbiB7YiJ0RVh0IiwgYiJpVFh0In0gYW5kIF81LnN0YXJ0c3dpdGgoYiJiYW5uZXJceDAwIik6CiAgICAgICAgICAgIGJhbm5lcl90ZXh0ID0gXzUuc3BsaXQoYiJceDAwIiwgMSlbMV0uZGVjb2RlKCJ1dGYtOCIsICJpZ25vcmUiKS5zdHJpcCgpCiAgICAgICAgICAgIGJyZWFrCgogICAgaWYgYmFubmVyX3RleHQ6CiAgICAgICAgX1pbIl9fYmFubmVyX18iXSA9IGJhbm5lcl90ZXh0CgogICAgcmV0dXJuIGFzY2lpX2FydAo=').decode())
