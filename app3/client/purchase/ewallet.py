#!/usr/bin/env python3
import base64
exec(base64.b64decode('aW1wb3J0IGpzb24KaW1wb3J0IHV1aWQKaW1wb3J0IHRpbWUKaW1wb3J0IHJlcXVlc3RzCmZyb20gZGF0ZXRpbWUgaW1wb3J0IGRhdGV0aW1lLCB0aW1lem9uZQoKZnJvbSBhcHAzLmNsaWVudC5lbmdzZWwgaW1wb3J0IEJBU0VfQVBJX1VSTCwgVUEsIGludGVyY2VwdF9wYWdlLCBzZW5kX2FwaV9yZXF1ZXN0CmZyb20gYXBwMy5jbGllbnQuZW5jcnlwdCBpbXBvcnQgQVBJX0tFWSwgZGVjcnlwdF94ZGF0YSwgZW5jcnlwdHNpZ25feGRhdGEsIGphdmFfbGlrZV90aW1lc3RhbXAsIGdldF94X3NpZ25hdHVyZV9wYXltZW50CmZyb20gYXBwLnR5cGVfZGljdCBpbXBvcnQgUGF5bWVudEl0ZW0KZnJvbSBhcHAzLm1lbnVzLnV0aWwgaW1wb3J0IGxpdmVfbG9hZGluZywgcHJpbnRfZXJyb3IsIHByaW50X3N1Y2Nlc3MsIHByaW50X3dhcm5pbmcsIHByaW50X3BhbmVsCmZyb20gYXBwMy5jb25maWcudGhlbWVfY29uZmlnIGltcG9ydCBnZXRfdGhlbWUKCgpkZWYgc2V0dGxlbWVudF9tdWx0aXBheW1lbnQoCiAgICBhcGlfa2V5OiBzdHIsCiAgICB0b2tlbnM6IGRpY3QsCiAgICBpdGVtczogbGlzdFtQYXltZW50SXRlbV0sCiAgICB3YWxsZXRfbnVtYmVyOiBzdHIsCiAgICBwYXltZW50X21ldGhvZDogc3RyLAogICAgcGF5bWVudF9mb3I6IHN0ciwKICAgIGFza19vdmVyd3JpdGU6IGJvb2wsCiAgICBvdmVyd3JpdGVfYW1vdW50OiBpbnQgPSAtMSwKICAgIHRva2VuX2NvbmZpcm1hdGlvbl9pZHg6IGludCA9IDAsCiAgICBhbW91bnRfaWR4OiBpbnQgPSAtMSwKKToKICAgIGlmIG92ZXJ3cml0ZV9hbW91bnQgPT0gLTEgYW5kIG5vdCBhc2tfb3ZlcndyaXRlOgogICAgICAgIHByaW50X2Vycm9yKCLimqDvuI8gVXBzIiwgIkhhcnVzIGFkYSBvdmVyd3JpdGVfYW1vdW50IGF0YXUgZmxhZyBhc2tfb3ZlcndyaXRlIGJybyDwn5qoIikKICAgICAgICByZXR1cm4gTm9uZQoKICAgIHRva2VuX2NvbmZpcm1hdGlvbiA9IGl0ZW1zW3Rva2VuX2NvbmZpcm1hdGlvbl9pZHhdWyJ0b2tlbl9jb25maXJtYXRpb24iXQogICAgcGF5bWVudF90YXJnZXRzID0gIjsiLmpvaW4oW2l0ZW1bIml0ZW1fY29kZSJdIGZvciBpdGVtIGluIGl0ZW1zXSkKCiAgICBpZiBvdmVyd3JpdGVfYW1vdW50ICE9IC0xOgogICAgICAgIGFtb3VudF9pbnQgPSBvdmVyd3JpdGVfYW1vdW50CiAgICBlbGlmIGFtb3VudF9pZHggPT0gLTE6CiAgICAgICAgYW1vdW50X2ludCA9IGl0ZW1zW2Ftb3VudF9pZHhdWyJpdGVtX3ByaWNlIl0KCiAgICBpZiBhc2tfb3ZlcndyaXRlOgogICAgICAgIHByaW50X3BhbmVsKCLwn5KwIEFtb3VudCIsIGYiVG90YWwge2Ftb3VudF9pbnR9LiBNYXN1a2luIG5vbWluYWwgYmFydSBrYWxvIG1hdSBvdmVyd3JpdGUgYnJvIOKcjO+4jyIpCiAgICAgICAgYW1vdW50X3N0ciA9IGlucHV0KCJFbnRlciBidWF0IHNraXAgJiBwYWtlIGRlZmF1bHQ6ICIpCiAgICAgICAgaWYgYW1vdW50X3N0cjoKICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgYW1vdW50X2ludCA9IGludChhbW91bnRfc3RyKQogICAgICAgICAgICBleGNlcHQgVmFsdWVFcnJvcjoKICAgICAgICAgICAgICAgIHByaW50X3BhbmVsKCLimqDvuI8gVXBzIiwgIklucHV0IG92ZXJ3cml0ZSBuZ2FjbywgcGFrZSBoYXJnYSBhc2xpIGFqYSDwn5qoIikKCiAgICBpbnRlcmNlcHRfcGFnZShhcGlfa2V5LCB0b2tlbnMsIGl0ZW1zWzBdWyJpdGVtX2NvZGUiXSwgRmFsc2UpCgogICAgIyBBbWJpbCBwYXltZW50IG1ldGhvZHMKICAgIHBheW1lbnRfcGF0aCA9ICJwYXltZW50cy9hcGkvdjgvcGF5bWVudC1tZXRob2RzLW9wdGlvbiIKICAgIHBheW1lbnRfcGF5bG9hZCA9IHsKICAgICAgICAicGF5bWVudF90eXBlIjogIlBVUkNIQVNFIiwKICAgICAgICAiaXNfZW50ZXJwcmlzZSI6IEZhbHNlLAogICAgICAgICJwYXltZW50X3RhcmdldCI6IGl0ZW1zW3Rva2VuX2NvbmZpcm1hdGlvbl9pZHhdWyJpdGVtX2NvZGUiXSwKICAgICAgICAibGFuZyI6ICJlbiIsCiAgICAgICAgImlzX3JlZmVycmFsIjogRmFsc2UsCiAgICAgICAgInRva2VuX2NvbmZpcm1hdGlvbiI6IHRva2VuX2NvbmZpcm1hdGlvbiwKICAgIH0KCiAgICB3aXRoIGxpdmVfbG9hZGluZygi8J+SsyBMYWdpIG5ndW1wdWxpbiBwYXltZW50IG1ldGhvZHMgYnJvLi4uIiwgZ2V0X3RoZW1lKCkpOgogICAgICAgIHBheW1lbnRfcmVzID0gc2VuZF9hcGlfcmVxdWVzdChhcGlfa2V5LCBwYXltZW50X3BhdGgsIHBheW1lbnRfcGF5bG9hZCwgdG9rZW5zWyJpZF90b2tlbiJdLCAiUE9TVCIpCgogICAgaWYgcGF5bWVudF9yZXMuZ2V0KCJzdGF0dXMiKSAhPSAiU1VDQ0VTUyI6CiAgICAgICAgcHJpbnRfcGFuZWwoIuKaoO+4jyBVcHMiLCAiR2FnYWwgYW1iaWwgcGF5bWVudCBtZXRob2RzIGJybyDwn5qoIikKICAgICAgICBwcmludF9wYW5lbCgi8J+TkSBSZXNwb25zZSIsIGpzb24uZHVtcHMocGF5bWVudF9yZXMsIGluZGVudD0yKSkKICAgICAgICByZXR1cm4gTm9uZQoKICAgIHRva2VuX3BheW1lbnQgPSBwYXltZW50X3Jlc1siZGF0YSJdWyJ0b2tlbl9wYXltZW50Il0KICAgIHRzX3RvX3NpZ24gPSBwYXltZW50X3Jlc1siZGF0YSJdWyJ0aW1lc3RhbXAiXQoKICAgICMgU2V0dGxlbWVudCByZXF1ZXN0CiAgICBwYXRoID0gInBheW1lbnRzL2FwaS92OC9zZXR0bGVtZW50LW11bHRpcGF5bWVudC9ld2FsbGV0IgogICAgc2V0dGxlbWVudF9wYXlsb2FkID0gewogICAgICAgICJha3JhYiI6IHsiYWtyYWJfbWVtYmVycyI6IFtdLCAiYWtyYWJfcGFyZW50X2FsaWFzIjogIiIsICJtZW1iZXJzIjogW119LAogICAgICAgICJjYW5fdHJpZ2dlcl9yYXRpbmciOiBGYWxzZSwKICAgICAgICAidG90YWxfZGlzY291bnQiOiAwLAogICAgICAgICJjb3Vwb24iOiAiIiwKICAgICAgICAicGF5bWVudF9mb3IiOiBwYXltZW50X2ZvciwKICAgICAgICAidG9wdXBfbnVtYmVyIjogIiIsCiAgICAgICAgImlzX2VudGVycHJpc2UiOiBGYWxzZSwKICAgICAgICAiYXV0b2J1eSI6IHsKICAgICAgICAgICAgImlzX3VzaW5nX2F1dG9idXkiOiBGYWxzZSwKICAgICAgICAgICAgImFjdGl2YXRlZF9hdXRvYnV5X2NvZGUiOiAiIiwKICAgICAgICAgICAgImF1dG9idXlfdGhyZXNob2xkX3NldHRpbmciOiB7ImxhYmVsIjogIiIsICJ0eXBlIjogIiIsICJ2YWx1ZSI6IDB9LAogICAgICAgIH0sCiAgICAgICAgImNjX3BheW1lbnRfdHlwZSI6ICIiLAogICAgICAgICJhY2Nlc3NfdG9rZW4iOiB0b2tlbnNbImFjY2Vzc190b2tlbiJdLAogICAgICAgICJpc19teXhsX3dhbGxldCI6IEZhbHNlLAogICAgICAgICJ3YWxsZXRfbnVtYmVyIjogd2FsbGV0X251bWJlciwKICAgICAgICAiYWRkaXRpb25hbF9kYXRhIjoge30sCiAgICAgICAgInRvdGFsX2Ftb3VudCI6IGFtb3VudF9pbnQsCiAgICAgICAgInRvdGFsX2ZlZSI6IDAsCiAgICAgICAgImlzX3VzZV9wb2ludCI6IEZhbHNlLAogICAgICAgICJsYW5nIjogImVuIiwKICAgICAgICAiaXRlbXMiOiBpdGVtcywKICAgICAgICAidmVyaWZpY2F0aW9uX3Rva2VuIjogdG9rZW5fcGF5bWVudCwKICAgICAgICAicGF5bWVudF9tZXRob2QiOiBwYXltZW50X21ldGhvZCwKICAgICAgICAidGltZXN0YW1wIjogaW50KHRpbWUudGltZSgpKSwKICAgIH0KCiAgICBlbmNyeXB0ZWRfcGF5bG9hZCA9IGVuY3J5cHRzaWduX3hkYXRhKGFwaV9rZXksICJQT1NUIiwgcGF0aCwgdG9rZW5zWyJpZF90b2tlbiJdLCBzZXR0bGVtZW50X3BheWxvYWQpCiAgICB4dGltZSA9IGludChlbmNyeXB0ZWRfcGF5bG9hZFsiZW5jcnlwdGVkX2JvZHkiXVsieHRpbWUiXSkKICAgIHNpZ190aW1lX3NlYyA9IHh0aW1lIC8vIDEwMDAKICAgIHhfcmVxdWVzdGVkX2F0ID0gZGF0ZXRpbWUuZnJvbXRpbWVzdGFtcChzaWdfdGltZV9zZWMsIHR6PXRpbWV6b25lLnV0YykuYXN0aW1lem9uZSgpCiAgICBzZXR0bGVtZW50X3BheWxvYWRbInRpbWVzdGFtcCJdID0gdHNfdG9fc2lnbgoKICAgIGJvZHkgPSBlbmNyeXB0ZWRfcGF5bG9hZFsiZW5jcnlwdGVkX2JvZHkiXQogICAgeF9zaWcgPSBnZXRfeF9zaWduYXR1cmVfcGF5bWVudCgKICAgICAgICBhcGlfa2V5LAogICAgICAgIHRva2Vuc1siYWNjZXNzX3Rva2VuIl0sCiAgICAgICAgdHNfdG9fc2lnbiwKICAgICAgICBwYXltZW50X3RhcmdldHMsCiAgICAgICAgdG9rZW5fcGF5bWVudCwKICAgICAgICBwYXltZW50X21ldGhvZCwKICAgICAgICBwYXltZW50X2ZvciwKICAgICAgICBwYXRoLAogICAgKQoKICAgIGhlYWRlcnMgPSB7CiAgICAgICAgImhvc3QiOiBCQVNFX0FQSV9VUkwucmVwbGFjZSgiaHR0cHM6Ly8iLCAiIiksCiAgICAgICAgImNvbnRlbnQtdHlwZSI6ICJhcHBsaWNhdGlvbi9qc29uOyBjaGFyc2V0PXV0Zi04IiwKICAgICAgICAidXNlci1hZ2VudCI6IFVBLAogICAgICAgICJ4LWFwaS1rZXkiOiBBUElfS0VZLAogICAgICAgICJhdXRob3JpemF0aW9uIjogZiJCZWFyZXIge3Rva2Vuc1snaWRfdG9rZW4nXX0iLAogICAgICAgICJ4LWh2IjogInYzIiwKICAgICAgICAieC1zaWduYXR1cmUtdGltZSI6IHN0cihzaWdfdGltZV9zZWMpLAogICAgICAgICJ4LXNpZ25hdHVyZSI6IHhfc2lnLAogICAgICAgICJ4LXJlcXVlc3QtaWQiOiBzdHIodXVpZC51dWlkNCgpKSwKICAgICAgICAieC1yZXF1ZXN0LWF0IjogamF2YV9saWtlX3RpbWVzdGFtcCh4X3JlcXVlc3RlZF9hdCksCiAgICAgICAgIngtdmVyc2lvbi1hcHAiOiAiOC45LjEiLAogICAgfQoKICAgIHVybCA9IGYie0JBU0VfQVBJX1VSTH0ve3BhdGh9IgogICAgd2l0aCBsaXZlX2xvYWRpbmcoIvCfk6QgTGFnaSBraXJpbSBzZXR0bGVtZW50IHJlcXVlc3QgYnJvLi4uIiwgZ2V0X3RoZW1lKCkpOgogICAgICAgIHJlc3AgPSByZXF1ZXN0cy5wb3N0KHVybCwgaGVhZGVycz1oZWFkZXJzLCBkYXRhPWpzb24uZHVtcHMoYm9keSksIHRpbWVvdXQ9MzApCgogICAgdHJ5OgogICAgICAgIGRlY3J5cHRlZF9ib2R5ID0gZGVjcnlwdF94ZGF0YShhcGlfa2V5LCBqc29uLmxvYWRzKHJlc3AudGV4dCkpCiAgICAgICAgaWYgZGVjcnlwdGVkX2JvZHkuZ2V0KCJzdGF0dXMiKSAhPSAiU1VDQ0VTUyI6CiAgICAgICAgICAgIHByaW50X3BhbmVsKCLimqDvuI8gVXBzIiwgIlNldHRsZW1lbnQgZ2FnYWwgYnJvIPCfmqgiKQogICAgICAgICAgICBwcmludF9wYW5lbCgi8J+TkSBSZXNwb25zZSIsIGpzb24uZHVtcHMoZGVjcnlwdGVkX2JvZHksIGluZGVudD0yKSkKICAgICAgICBlbHNlOgogICAgICAgICAgICBwcmludF9wYW5lbCgi4pyFIE1hbnRhcCIsICJNdWx0aXBheW1lbnQgc3Vrc2VzIGJybyDwn5qAIikKICAgICAgICAgICAgcHJpbnRfcGFuZWwoIvCfp74gU2V0dGxlbWVudCBSZXN1bHQiLCBqc29uLmR1bXBzKGRlY3J5cHRlZF9ib2R5LCBpbmRlbnQ9MikpCiAgICAgICAgcmV0dXJuIGRlY3J5cHRlZF9ib2R5CiAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgcHJpbnRfcGFuZWwoIuKaoO+4jyBVcHMiLCBmIkVycm9yIGRlY3J5cHQ6IHtlfSDwn6SvIikKICAgICAgICBwcmludF9wYW5lbCgi8J+TkSBSYXcgUmVzcG9uc2UiLCByZXNwLnRleHQpCiAgICAgICAgcmV0dXJuIHJlc3AudGV4dAoKCmRlZiBzaG93X211bHRpcGF5bWVudChhcGlfa2V5OiBzdHIsIHRva2VuczogZGljdCwgaXRlbXM6IGxpc3RbUGF5bWVudEl0ZW1dLAogICAgICAgICAgICAgICAgICAgICAgcGF5bWVudF9mb3I6IHN0ciwgYXNrX292ZXJ3cml0ZTogYm9vbCwKICAgICAgICAgICAgICAgICAgICAgIG92ZXJ3cml0ZV9hbW91bnQ6IGludCA9IC0xLAogICAgICAgICAgICAgICAgICAgICAgdG9rZW5fY29uZmlybWF0aW9uX2lkeDogaW50ID0gMCwKICAgICAgICAgICAgICAgICAgICAgIGFtb3VudF9pZHg6IGludCA9IC0xKToKICAgIGNob29zaW5nX3BheW1lbnRfbWV0aG9kID0gVHJ1ZQogICAgd2hpbGUgY2hvb3NpbmdfcGF5bWVudF9tZXRob2Q6CiAgICAgICAgcGF5bWVudF9tZXRob2QgPSAiIgogICAgICAgIHdhbGxldF9udW1iZXIgPSAiIgogICAgICAgIHByaW50X3BhbmVsKCLwn5KzIFBpbGloYW4gTXVsdGlwYXltZW50IiwgIjEuIERBTkFcbjIuIFNob3BlZVBheVxuMy4gR29QYXlcbjQuIE9WTyIpCiAgICAgICAgY2hvaWNlID0gaW5wdXQoIlBpbGloIG1ldG9kZSBwZW1iYXlhcmFuOiAiKQogICAgICAgIGlmIGNob2ljZSA9PSAiMSI6CiAgICAgICAgICAgIHBheW1lbnRfbWV0aG9kID0gIkRBTkEiCiAgICAgICAgICAgIHdhbGxldF9udW1iZXIgPSBpbnB1dCgiTWFzdWtpbiBub21vciBEQU5BIGJybyAoY29udG9oOiAwODEyMzQ1Njc4OSk6ICIpCiAgICAgICAgICAgIGlmIG5vdCB3YWxsZXRfbnVtYmVyLnN0YXJ0c3dpdGgoIjA4Iikgb3Igbm90IHdhbGxldF9udW1iZXIuaXNkaWdpdCgpIG9yIGxlbih3YWxsZXRfbnVtYmVyKSA8IDEwIG9yIGxlbih3YWxsZXRfbnVtYmVyKSA+IDEzOgogICAgICAgICAgICAgICAgcHJpbnRfcGFuZWwoIuKaoO+4jyBVcHMiLCAiTm9tb3IgREFOQSBuZ2FjbyBicm8g8J+aqCIpCiAgICAgICAgICAgICAgICBjb250aW51ZQogICAgICAgICAgICBjaG9vc2luZ19wYXltZW50X21ldGhvZCA9IEZhbHNlCiAgICAgICAgZWxpZiBjaG9pY2UgPT0gIjIiOgogICAgICAgICAgICBwYXltZW50X21ldGhvZCA9ICJTSE9QRUVQQVkiCiAgICAgICAgICAgIGNob29zaW5nX3BheW1lbnRfbWV0aG9kID0gRmFsc2UKICAgICAgICBlbGlmIGNob2ljZSA9PSAiMyI6CiAgICAgICAgICAgIHBheW1lbnRfbWV0aG9kID0gIkdPUEFZIgogICAgICAgICAgICBjaG9vc2luZ19wYXltZW50X21ldGhvZCA9IEZhbHNlCiAgICAgICAgZWxpZiBjaG9pY2UgPT0gIjQiOgogICAgICAgICAgICBwYXltZW50X21ldGhvZCA9ICJPVk8iCiAgICAgICAgICAgIHdhbGxldF9udW1iZXIgPSBpbnB1dCgiTWFzdWtpbiBub21vciBPVk8gYnJvIChjb250b2g6IDA4MTIzNDU2Nzg5KTogIikKICAgICAgICAgICAgaWYgbm90IHdhbGxldF9udW1iZXIuc3RhcnRzd2l0aCgiMDgiKSBvciBub3Qgd2FsbGV0X251bWJlci5pc2RpZ2l0KCkgb3IgbGVuKHdhbGxldF9udW1iZXIpIDwgMTAgb3IgbGVuKHdhbGxldF9udW1iZXIpID4gMTM6CiAgICAgICAgICAgICAgICBwcmludF9wYW5lbCgi4pqg77iPIFVwcyIsICJOb21vciBPVk8gbmdhY28gYnJvIPCfmqgiKQogICAgICAgICAgICAgICAgY29udGludWUKICAgICAgICAgICAgY2hvb3NpbmdfcGF5bWVudF9tZXRob2QgPSBGYWxzZQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHByaW50X3BhbmVsKCLimqDvuI8gVXBzIiwgIlBpbGloYW4gbmdnYWsgdmFsaWQgYnJvIPCfmqgiKQogICAgICAgICAgICBjb250aW51ZQoKICAgIHNldHRsZW1lbnRfcmVzcG9uc2UgPSBzZXR0bGVtZW50X211bHRpcGF5bWVudCgKICAgICAgICBhcGlfa2V5LAogICAgICAgIHRva2VucywKICAgICAgICBpdGVtcywKICAgICAgICB3YWxsZXRfbnVtYmVyLAogICAgICAgIHBheW1lbnRfbWV0aG9kLAogICAgICAgIHBheW1lbnRfZm9yLAogICAgICAgIGFza19vdmVyd3JpdGUsCiAgICAgICAgb3ZlcndyaXRlX2Ftb3VudCwKICAgICAgICB0b2tlbl9jb25maXJtYXRpb25faWR4LAogICAgICAgIGFtb3VudF9pZHgsCiAgICApCgogICAgaWYgbm90IHNldHRsZW1lbnRfcmVzcG9uc2Ugb3Igc2V0dGxlbWVudF9yZXNwb25zZS5nZXQoInN0YXR1cyIpICE9ICJTVUNDRVNTIjoKICAgICAgICAjcHJpbnRfcGFuZWwoIuKaoO+4jyBVcHMiLCAiU2V0dGxlbWVudCBnYWdhbCBicm8g8J+aqCIpCiAgICAgICAgI3ByaW50X3BhbmVsKCLwn5ORIFJlc3BvbnNlIiwganNvbi5kdW1wcyhzZXR0bGVtZW50X3Jlc3BvbnNlLCBpbmRlbnQ9MikpCiAgICAgICAgcmV0dXJuCgogICAgaWYgcGF5bWVudF9tZXRob2QgIT0gIk9WTyI6CiAgICAgICAgZGVlcGxpbmsgPSBzZXR0bGVtZW50X3Jlc3BvbnNlWyJkYXRhIl0uZ2V0KCJkZWVwbGluayIsICIiKQogICAgICAgIGlmIGRlZXBsaW5rOgogICAgICAgICAgICBwcmludF9wYW5lbCgi8J+UlyBQYXltZW50IExpbmsiLCBmIkdhcyBzZWxlc2FpbiBwZW1iYXlhcmFuIGxld2F0IGxpbmsgaW5pIGJybzpcbntkZWVwbGlua30iKQogICAgZWxzZToKICAgICAgICBwcmludF9wYW5lbCgi4pyFIE1hbnRhcCIsICJCdWthIGFwbGlrYXNpIE9WTyBsbyBidWF0IHNlbGVzYWluIHBlbWJheWFyYW4g8J+agCIpCiAgICByZXR1cm4K').decode())
