#!/usr/bin/env python3
import base64
exec(base64.b64decode('aW1wb3J0IGpzb24KaW1wb3J0IHV1aWQKaW1wb3J0IGJhc2U2NAppbXBvcnQgcXJjb2RlCmltcG9ydCB0aW1lCmltcG9ydCByZXF1ZXN0cwpmcm9tIGRhdGV0aW1lIGltcG9ydCBkYXRldGltZSwgdGltZXpvbmUKCmZyb20gYXBwMy5jbGllbnQuZW5nc2VsIGltcG9ydCBCQVNFX0FQSV9VUkwsIFVBLCBpbnRlcmNlcHRfcGFnZSwgc2VuZF9hcGlfcmVxdWVzdApmcm9tIGFwcDMuY2xpZW50LmVuY3J5cHQgaW1wb3J0IEFQSV9LRVksIGRlY3J5cHRfeGRhdGEsIGVuY3J5cHRzaWduX3hkYXRhLCBqYXZhX2xpa2VfdGltZXN0YW1wLCBnZXRfeF9zaWduYXR1cmVfcGF5bWVudApmcm9tIGFwcC50eXBlX2RpY3QgaW1wb3J0IFBheW1lbnRJdGVtCmZyb20gYXBwMy5tZW51cy51dGlsIGltcG9ydCBsaXZlX2xvYWRpbmcsIHByaW50X3BhbmVsCmZyb20gYXBwMy5jb25maWcudGhlbWVfY29uZmlnIGltcG9ydCBnZXRfdGhlbWUKCgpkZWYgc2V0dGxlbWVudF9xcmlzKGFwaV9rZXk6IHN0ciwgdG9rZW5zOiBkaWN0LCBpdGVtczogbGlzdFtQYXltZW50SXRlbV0sCiAgICAgICAgICAgICAgICAgICAgcGF5bWVudF9mb3I6IHN0ciwgYXNrX292ZXJ3cml0ZTogYm9vbCwKICAgICAgICAgICAgICAgICAgICBvdmVyd3JpdGVfYW1vdW50OiBpbnQgPSAtMSwKICAgICAgICAgICAgICAgICAgICB0b2tlbl9jb25maXJtYXRpb25faWR4OiBpbnQgPSAwLAogICAgICAgICAgICAgICAgICAgIGFtb3VudF9pZHg6IGludCA9IC0xLAogICAgICAgICAgICAgICAgICAgIHRvcHVwX251bWJlcjogc3RyID0gIiIsCiAgICAgICAgICAgICAgICAgICAgc3RhZ2VfdG9rZW46IHN0ciA9ICIiKSAtPiBzdHIgfCBOb25lOgogICAgaWYgb3ZlcndyaXRlX2Ftb3VudCA9PSAtMSBhbmQgbm90IGFza19vdmVyd3JpdGU6CiAgICAgICAgcHJpbnRfcGFuZWwoIuKaoO+4jyBVcHMiLCAiSGFydXMgYWRhIG92ZXJ3cml0ZV9hbW91bnQgYXRhdSBmbGFnIGFza19vdmVyd3JpdGUgYnJvIPCfmqgiKQogICAgICAgIHJldHVybiBOb25lCgogICAgdG9rZW5fY29uZmlybWF0aW9uID0gaXRlbXNbdG9rZW5fY29uZmlybWF0aW9uX2lkeF1bInRva2VuX2NvbmZpcm1hdGlvbiJdCiAgICBwYXltZW50X3RhcmdldHMgPSAiOyIuam9pbihbaXRlbVsiaXRlbV9jb2RlIl0gZm9yIGl0ZW0gaW4gaXRlbXNdKQoKICAgICMgVGVudHVrYW4gYW1vdW50CiAgICBpZiBvdmVyd3JpdGVfYW1vdW50ICE9IC0xOgogICAgICAgIGFtb3VudF9pbnQgPSBvdmVyd3JpdGVfYW1vdW50CiAgICBlbGlmIGFtb3VudF9pZHggPT0gLTE6CiAgICAgICAgYW1vdW50X2ludCA9IGl0ZW1zW2Ftb3VudF9pZHhdWyJpdGVtX3ByaWNlIl0KCiAgICBpZiBhc2tfb3ZlcndyaXRlOgogICAgICAgIHByaW50X3BhbmVsKCLwn5KwIEFtb3VudCIsIGYiVG90YWwge2Ftb3VudF9pbnR9LiBNYXN1a2luIG5vbWluYWwgYmFydSBrYWxvIG1hdSBvdmVyd3JpdGUgYnJvIOKcjO+4jyIpCiAgICAgICAgYW1vdW50X3N0ciA9IGlucHV0KCJFbnRlciBidWF0IHNraXAgJiBwYWtlIGRlZmF1bHQ6ICIpCiAgICAgICAgaWYgYW1vdW50X3N0cjoKICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgYW1vdW50X2ludCA9IGludChhbW91bnRfc3RyKQogICAgICAgICAgICBleGNlcHQgVmFsdWVFcnJvcjoKICAgICAgICAgICAgICAgIHByaW50X3BhbmVsKCLimqDvuI8gVXBzIiwgIklucHV0IG92ZXJ3cml0ZSBuZ2FjbywgcGFrZSBoYXJnYSBhc2xpIGFqYSDwn5qoIikKCiAgICBpbnRlcmNlcHRfcGFnZShhcGlfa2V5LCB0b2tlbnMsIGl0ZW1zWzBdWyJpdGVtX2NvZGUiXSwgRmFsc2UpCgogICAgIyBBbWJpbCBwYXltZW50IG1ldGhvZHMKICAgIHBheW1lbnRfcGF0aCA9ICJwYXltZW50cy9hcGkvdjgvcGF5bWVudC1tZXRob2RzLW9wdGlvbiIKICAgIHBheW1lbnRfcGF5bG9hZCA9IHsKICAgICAgICAicGF5bWVudF90eXBlIjogIlBVUkNIQVNFIiwKICAgICAgICAiaXNfZW50ZXJwcmlzZSI6IEZhbHNlLAogICAgICAgICJwYXltZW50X3RhcmdldCI6IGl0ZW1zW3Rva2VuX2NvbmZpcm1hdGlvbl9pZHhdWyJpdGVtX2NvZGUiXSwKICAgICAgICAibGFuZyI6ICJlbiIsCiAgICAgICAgImlzX3JlZmVycmFsIjogRmFsc2UsCiAgICAgICAgInRva2VuX2NvbmZpcm1hdGlvbiI6IHRva2VuX2NvbmZpcm1hdGlvbiwKICAgIH0KCiAgICB3aXRoIGxpdmVfbG9hZGluZygi8J+SsyBMYWdpIG5ndW1wdWxpbiBwYXltZW50IG1ldGhvZHMgYnJvLi4uIiwgZ2V0X3RoZW1lKCkpOgogICAgICAgIHBheW1lbnRfcmVzID0gc2VuZF9hcGlfcmVxdWVzdChhcGlfa2V5LCBwYXltZW50X3BhdGgsIHBheW1lbnRfcGF5bG9hZCwgdG9rZW5zWyJpZF90b2tlbiJdLCAiUE9TVCIpCgogICAgaWYgcGF5bWVudF9yZXMuZ2V0KCJzdGF0dXMiKSAhPSAiU1VDQ0VTUyI6CiAgICAgICAgcHJpbnRfcGFuZWwoIuKaoO+4jyBVcHMiLCAiR2FnYWwgYW1iaWwgcGF5bWVudCBtZXRob2RzIGJybyDwn5qoIikKICAgICAgICBwcmludF9wYW5lbCgi8J+TkSBSZXNwb25zZSIsIGpzb24uZHVtcHMocGF5bWVudF9yZXMsIGluZGVudD0yKSkKICAgICAgICByZXR1cm4gTm9uZQoKICAgIHRva2VuX3BheW1lbnQgPSBwYXltZW50X3Jlc1siZGF0YSJdWyJ0b2tlbl9wYXltZW50Il0KICAgIHRzX3RvX3NpZ24gPSBwYXltZW50X3Jlc1siZGF0YSJdWyJ0aW1lc3RhbXAiXQoKICAgICMgU2V0dGxlbWVudCByZXF1ZXN0CiAgICBwYXRoID0gInBheW1lbnRzL2FwaS92OC9zZXR0bGVtZW50LW11bHRpcGF5bWVudC9xcmlzIgogICAgc2V0dGxlbWVudF9wYXlsb2FkID0gewogICAgICAgICJha3JhYiI6IHsiYWtyYWJfbWVtYmVycyI6IFtdLCAiYWtyYWJfcGFyZW50X2FsaWFzIjogIiIsICJtZW1iZXJzIjogW119LAogICAgICAgICJjYW5fdHJpZ2dlcl9yYXRpbmciOiBGYWxzZSwKICAgICAgICAidG90YWxfZGlzY291bnQiOiAwLAogICAgICAgICJjb3Vwb24iOiAiIiwKICAgICAgICAicGF5bWVudF9mb3IiOiBwYXltZW50X2ZvciwKICAgICAgICAidG9wdXBfbnVtYmVyIjogdG9wdXBfbnVtYmVyLAogICAgICAgICJzdGFnZV90b2tlbiI6IHN0YWdlX3Rva2VuLAogICAgICAgICJpc19lbnRlcnByaXNlIjogRmFsc2UsCiAgICAgICAgImF1dG9idXkiOiB7CiAgICAgICAgICAgICJpc191c2luZ19hdXRvYnV5IjogRmFsc2UsCiAgICAgICAgICAgICJhY3RpdmF0ZWRfYXV0b2J1eV9jb2RlIjogIiIsCiAgICAgICAgICAgICJhdXRvYnV5X3RocmVzaG9sZF9zZXR0aW5nIjogeyJsYWJlbCI6ICIiLCAidHlwZSI6ICIiLCAidmFsdWUiOiAwfSwKICAgICAgICB9LAogICAgICAgICJhY2Nlc3NfdG9rZW4iOiB0b2tlbnNbImFjY2Vzc190b2tlbiJdLAogICAgICAgICJpc19teXhsX3dhbGxldCI6IEZhbHNlLAogICAgICAgICJhZGRpdGlvbmFsX2RhdGEiOiB7CiAgICAgICAgICAgICJvcmlnaW5hbF9wcmljZSI6IGl0ZW1zWzBdWyJpdGVtX3ByaWNlIl0sCiAgICAgICAgICAgICJpc19zcGVuZF9saW1pdF90ZW1wb3JhcnkiOiBGYWxzZSwKICAgICAgICAgICAgIm1pZ3JhdGlvbl90eXBlIjogIiIsCiAgICAgICAgICAgICJzcGVuZF9saW1pdF9hbW91bnQiOiAwLAogICAgICAgICAgICAiaXNfc3BlbmRfbGltaXQiOiBGYWxzZSwKICAgICAgICAgICAgInRheCI6IDAsCiAgICAgICAgICAgICJiZW5lZml0X3R5cGUiOiAiIiwKICAgICAgICAgICAgInF1b3RhX2JvbnVzIjogMCwKICAgICAgICAgICAgImNhc2h0YWciOiAiIiwKICAgICAgICAgICAgImlzX2ZhbWlseV9wbGFuIjogRmFsc2UsCiAgICAgICAgICAgICJjb21ib19kZXRhaWxzIjogW10sCiAgICAgICAgICAgICJpc19zd2l0Y2hfcGxhbiI6IEZhbHNlLAogICAgICAgICAgICAiZGlzY291bnRfcmVjdXJyaW5nIjogMCwKICAgICAgICAgICAgImhhc19ib251cyI6IEZhbHNlLAogICAgICAgICAgICAiZGlzY291bnRfcHJvbW8iOiAwLAogICAgICAgIH0sCiAgICAgICAgInRvdGFsX2Ftb3VudCI6IGFtb3VudF9pbnQsCiAgICAgICAgInRvdGFsX2ZlZSI6IDAsCiAgICAgICAgImlzX3VzZV9wb2ludCI6IEZhbHNlLAogICAgICAgICJsYW5nIjogImVuIiwKICAgICAgICAiaXRlbXMiOiBpdGVtcywKICAgICAgICAidmVyaWZpY2F0aW9uX3Rva2VuIjogdG9rZW5fcGF5bWVudCwKICAgICAgICAicGF5bWVudF9tZXRob2QiOiAiUVJJUyIsCiAgICAgICAgInRpbWVzdGFtcCI6IGludCh0aW1lLnRpbWUoKSksCiAgICB9CgogICAgZW5jcnlwdGVkX3BheWxvYWQgPSBlbmNyeXB0c2lnbl94ZGF0YShhcGlfa2V5LCAiUE9TVCIsIHBhdGgsIHRva2Vuc1siaWRfdG9rZW4iXSwgc2V0dGxlbWVudF9wYXlsb2FkKQogICAgeHRpbWUgPSBpbnQoZW5jcnlwdGVkX3BheWxvYWRbImVuY3J5cHRlZF9ib2R5Il1bInh0aW1lIl0pCiAgICBzaWdfdGltZV9zZWMgPSB4dGltZSAvLyAxMDAwCiAgICB4X3JlcXVlc3RlZF9hdCA9IGRhdGV0aW1lLmZyb210aW1lc3RhbXAoc2lnX3RpbWVfc2VjLCB0ej10aW1lem9uZS51dGMpLmFzdGltZXpvbmUoKQogICAgc2V0dGxlbWVudF9wYXlsb2FkWyJ0aW1lc3RhbXAiXSA9IHRzX3RvX3NpZ24KCiAgICBib2R5ID0gZW5jcnlwdGVkX3BheWxvYWRbImVuY3J5cHRlZF9ib2R5Il0KICAgIHhfc2lnID0gZ2V0X3hfc2lnbmF0dXJlX3BheW1lbnQoYXBpX2tleSwgdG9rZW5zWyJhY2Nlc3NfdG9rZW4iXSwgdHNfdG9fc2lnbiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGF5bWVudF90YXJnZXRzLCB0b2tlbl9wYXltZW50LCAiUVJJUyIsIHBheW1lbnRfZm9yLCBwYXRoKQoKICAgIGhlYWRlcnMgPSB7CiAgICAgICAgImhvc3QiOiBCQVNFX0FQSV9VUkwucmVwbGFjZSgiaHR0cHM6Ly8iLCAiIiksCiAgICAgICAgImNvbnRlbnQtdHlwZSI6ICJhcHBsaWNhdGlvbi9qc29uOyBjaGFyc2V0PXV0Zi04IiwKICAgICAgICAidXNlci1hZ2VudCI6IFVBLAogICAgICAgICJ4LWFwaS1rZXkiOiBBUElfS0VZLAogICAgICAgICJhdXRob3JpemF0aW9uIjogZiJCZWFyZXIge3Rva2Vuc1snaWRfdG9rZW4nXX0iLAogICAgICAgICJ4LWh2IjogInYzIiwKICAgICAgICAieC1zaWduYXR1cmUtdGltZSI6IHN0cihzaWdfdGltZV9zZWMpLAogICAgICAgICJ4LXNpZ25hdHVyZSI6IHhfc2lnLAogICAgICAgICJ4LXJlcXVlc3QtaWQiOiBzdHIodXVpZC51dWlkNCgpKSwKICAgICAgICAieC1yZXF1ZXN0LWF0IjogamF2YV9saWtlX3RpbWVzdGFtcCh4X3JlcXVlc3RlZF9hdCksCiAgICAgICAgIngtdmVyc2lvbi1hcHAiOiAiOC45LjEiLAogICAgfQoKICAgIHVybCA9IGYie0JBU0VfQVBJX1VSTH0ve3BhdGh9IgogICAgd2l0aCBsaXZlX2xvYWRpbmcoIvCfk6QgTGFnaSBraXJpbSBzZXR0bGVtZW50IHJlcXVlc3QgYnJvLi4uIiwgZ2V0X3RoZW1lKCkpOgogICAgICAgIHJlc3AgPSByZXF1ZXN0cy5wb3N0KHVybCwgaGVhZGVycz1oZWFkZXJzLCBkYXRhPWpzb24uZHVtcHMoYm9keSksIHRpbWVvdXQ9MzApCgogICAgdHJ5OgogICAgICAgIGRlY3J5cHRlZF9ib2R5ID0gZGVjcnlwdF94ZGF0YShhcGlfa2V5LCBqc29uLmxvYWRzKHJlc3AudGV4dCkpCiAgICAgICAgaWYgZGVjcnlwdGVkX2JvZHkuZ2V0KCJzdGF0dXMiKSAhPSAiU1VDQ0VTUyI6CiAgICAgICAgICAgIHByaW50X3BhbmVsKCLimqDvuI8gVXBzIiwgIlNldHRsZW1lbnQgUVJJUyBnYWdhbCBicm8g8J+aqCIpCiAgICAgICAgICAgIHByaW50X3BhbmVsKCLwn5ORIFJlc3BvbnNlIiwganNvbi5kdW1wcyhkZWNyeXB0ZWRfYm9keSwgaW5kZW50PTIpKQogICAgICAgICAgICByZXR1cm4gTm9uZQogICAgICAgIHRyYW5zYWN0aW9uX2lkID0gZGVjcnlwdGVkX2JvZHlbImRhdGEiXVsidHJhbnNhY3Rpb25fY29kZSJdCiAgICAgICAgcHJpbnRfcGFuZWwoIuKchSBNYW50YXAiLCAiVHJhbnNha3NpIFFSSVMgYmVyaGFzaWwgZGlidWF0IPCfmoAiKQogICAgICAgIHJldHVybiB0cmFuc2FjdGlvbl9pZAogICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgIHByaW50X3BhbmVsKCLimqDvuI8gVXBzIiwgZiJFcnJvciBkZWNyeXB0OiB7ZX0g8J+kryIpCiAgICAgICAgcHJpbnRfcGFuZWwoIvCfk5EgUmF3IFJlc3BvbnNlIiwgcmVzcC50ZXh0KQogICAgICAgIHJldHVybiBOb25lCgoKZGVmIGdldF9xcmlzX2NvZGUoYXBpX2tleTogc3RyLCB0b2tlbnM6IGRpY3QsIHRyYW5zYWN0aW9uX2lkOiBzdHIpIC0+IHN0ciB8IE5vbmU6CiAgICBwYXRoID0gInBheW1lbnRzL2FwaS92OC9wZW5kaW5nLWRldGFpbCIKICAgIHBheWxvYWQgPSB7InRyYW5zYWN0aW9uX2lkIjogdHJhbnNhY3Rpb25faWQsICJpc19lbnRlcnByaXNlIjogRmFsc2UsICJsYW5nIjogImVuIiwgInN0YXR1cyI6ICIifQoKICAgIHdpdGggbGl2ZV9sb2FkaW5nKCLwn5SNIExhZ2kgbmd1bXB1bGluIFFSSVMgY29kZSBicm8uLi4iLCBnZXRfdGhlbWUoKSk6CiAgICAgICAgcmVzID0gc2VuZF9hcGlfcmVxdWVzdChhcGlfa2V5LCBwYXRoLCBwYXlsb2FkLCB0b2tlbnNbImlkX3Rva2VuIl0sICJQT1NUIikKCiAgICBpZiByZXMuZ2V0KCJzdGF0dXMiKSAhPSAiU1VDQ0VTUyI6CiAgICAgICAgcHJpbnRfcGFuZWwoIuKaoO+4jyBVcHMiLCAiR2FnYWwgYW1iaWwgUVJJUyBjb2RlIGJybyDwn5qoIikKICAgICAgICBwcmludF9wYW5lbCgi8J+TkSBSZXNwb25zZSIsIGpzb24uZHVtcHMocmVzLCBpbmRlbnQ9MikpCiAgICAgICAgcmV0dXJuIE5vbmUKCiAgICBwcmludF9wYW5lbCgi4pyFIE1hbnRhcCIsICJRUklTIGNvZGUgYmVyaGFzaWwgZGlhbWJpbCDwn5qAIikKICAgIHJldHVybiByZXNbImRhdGEiXVsicXJfY29kZSJdCgoKZGVmIHNob3dfcXJpc19wYXltZW50KGFwaV9rZXk6IHN0ciwgdG9rZW5zOiBkaWN0LCBpdGVtczogbGlzdFtQYXltZW50SXRlbV0sCiAgICAgICAgICAgICAgICAgICAgICBwYXltZW50X2Zvcjogc3RyLCBhc2tfb3ZlcndyaXRlOiBib29sLAogICAgICAgICAgICAgICAgICAgICAgb3ZlcndyaXRlX2Ftb3VudDogaW50ID0gLTEsCiAgICAgICAgICAgICAgICAgICAgICB0b2tlbl9jb25maXJtYXRpb25faWR4OiBpbnQgPSAwLAogICAgICAgICAgICAgICAgICAgICAgYW1vdW50X2lkeDogaW50ID0gLTEsCiAgICAgICAgICAgICAgICAgICAgICB0b3B1cF9udW1iZXI6IHN0ciA9ICIiLAogICAgICAgICAgICAgICAgICAgICAgc3RhZ2VfdG9rZW46IHN0ciA9ICIiKSAtPiBzdHIgfCBOb25lOgogICAgdHJhbnNhY3Rpb25faWQgPSBzZXR0bGVtZW50X3FyaXMoYXBpX2tleSwgdG9rZW5zLCBpdGVtcywgcGF5bWVudF9mb3IsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc2tfb3ZlcndyaXRlLCBvdmVyd3JpdGVfYW1vdW50LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG9rZW5fY29uZmlybWF0aW9uX2lkeCwgYW1vdW50X2lkeCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvcHVwX251bWJlciwgc3RhZ2VfdG9rZW4pCgogICAgaWYgbm90IHRyYW5zYWN0aW9uX2lkOgogICAgICAgIHByaW50X3BhbmVsKCLimqDvuI8gVXBzIiwgIkdhZ2FsIGJpa2luIHRyYW5zYWtzaSBRUklTIGJybyDwn5qoIikKICAgICAgICByZXR1cm4gTm9uZQoKICAgIHFyaXNfY29kZSA9IGdldF9xcmlzX2NvZGUoYXBpX2tleSwgdG9rZW5zLCB0cmFuc2FjdGlvbl9pZCkKICAgIGlmIG5vdCBxcmlzX2NvZGU6CiAgICAgICAgcHJpbnRfcGFuZWwoIuKaoO+4jyBVcHMiLCAiR2FnYWwgYW1iaWwgUVJJUyBjb2RlIGJybyDwn5qoIikKICAgICAgICByZXR1cm4gTm9uZQoKICAgIHByaW50X3BhbmVsKCLwn5OyIFFSSVMgRGF0YSIsIHFyaXNfY29kZSkKCiAgICBxciA9IHFyY29kZS5RUkNvZGUodmVyc2lvbj0xLCBlcnJvcl9jb3JyZWN0aW9uPXFyY29kZS5jb25zdGFudHMuRVJST1JfQ09SUkVDVF9MLAogICAgICAgICAgICAgICAgICAgICAgIGJveF9zaXplPTEsIGJvcmRlcj0xKQogICAgcXIuYWRkX2RhdGEocXJpc19jb2RlKQogICAgcXIubWFrZShmaXQ9VHJ1ZSkKICAgIHFyLnByaW50X2FzY2lpKGludmVydD1UcnVlKQoKICAgIHFyaXNfYjY0ID0gYmFzZTY0LnVybHNhZmVfYjY0ZW5jb2RlKHFyaXNfY29kZS5lbmNvZGUoKSkuZGVjb2RlKCkKICAgIHFyaXNfdXJsID0gZiJodHRwczovL2tpLWFyLWtvZC5uZXRsaWZ5LmFwcC8/ZGF0YT17cXJpc19iNjR9IgoKICAgIHByaW50X3BhbmVsKCLwn5SXIFFSSVMgTGluayIsIGYiQXRhdSBidWthIGxpbmsgaW5pIGJybyBidWF0IGxpaGF0IFFSSVM6XG57cXJpc191cmx9IikKICAgIHJldHVybiBxcmlzX2I2NAo=').decode())
