#!/usr/bin/env python3
import base64
exec(base64.b64decode('aW1wb3J0IGpzb24KZnJvbSBhcHAzLmNsaWVudC5lbmdzZWwgaW1wb3J0IHNlbmRfYXBpX3JlcXVlc3QKZnJvbSBhcHAzLm1lbnVzLnV0aWwgaW1wb3J0IGZvcm1hdF9xdW90YV9ieXRlLCBsaXZlX2xvYWRpbmcsIHByaW50X3BhbmVsCmZyb20gYXBwMy5jb25maWcudGhlbWVfY29uZmlnIGltcG9ydCBnZXRfdGhlbWUKCmRlZiBnZXRfZmFtaWx5X2RhdGEoCiAgICBhcGlfa2V5OiBzdHIsCiAgICB0b2tlbnM6IGRpY3QsCikgLT4gZGljdDoKICAgIHBhdGggPSAic2hhcmluZ3MvYXBpL3Y4L2ZhbWlseS1wbGFuL21lbWJlci1pbmZvIgoKICAgIHJhd19wYXlsb2FkID0gewogICAgICAgICJncm91cF9pZCI6IDAsCiAgICAgICAgImlzX2VudGVycHJpc2UiOiBGYWxzZSwKICAgICAgICAibGFuZyI6ICJlbiIKICAgIH0KCiAgICB3aXRoIGxpdmVfbG9hZGluZygi8J+RqOKAjfCfkanigI3wn5GnIExhZ2kgbmd1bXB1bGluIGRhdGEgZmFtaWx5IGJyby4uLiIsIGdldF90aGVtZSgpKToKICAgICAgICByZXMgPSBzZW5kX2FwaV9yZXF1ZXN0KGFwaV9rZXksIHBhdGgsIHJhd19wYXlsb2FkLCB0b2tlbnNbImlkX3Rva2VuIl0sICJQT1NUIikKCiAgICByZXR1cm4gcmVzCgpkZWYgdmFsaWRhdGVfbXNpc2RuKAogICAgYXBpX2tleTogc3RyLAogICAgdG9rZW5zOiBkaWN0LAogICAgbXNpc2RuOiBzdHIsCikgLT4gZGljdDoKICAgICMgcGF0aCA9ICJhcGkvdjgvYXV0aC92YWxpZGF0ZS1tc2lzZG4iCiAgICBwYXRoID0gImFwaS92OC9hdXRoL2NoZWNrLWR1a2NhcGlsIgoKICAgIHJhd19wYXlsb2FkID0gewogICAgICAgICJ3aXRoX2Jpem9uIjogVHJ1ZSwKICAgICAgICAid2l0aF9mYW1pbHlfcGxhbiI6IFRydWUsCiAgICAgICAgImlzX2VudGVycHJpc2UiOiBGYWxzZSwKICAgICAgICAid2l0aF9vcHRpbXVzIjogVHJ1ZSwKICAgICAgICAibGFuZyI6ICJlbiIsCiAgICAgICAgIm1zaXNkbiI6IG1zaXNkbiwKICAgICAgICAid2l0aF9yZWdpc3Rfc3RhdHVzIjogVHJ1ZSwKICAgICAgICAid2l0aF9lbnRlcnByaXNlIjogVHJ1ZQogICAgfQoKICAgIHdpdGggbGl2ZV9sb2FkaW5nKGYi8J+UjSBMYWdpIG5nZWNlayBub21vciB7bXNpc2RufSBicm8uLi4iLCBnZXRfdGhlbWUoKSk6CiAgICAgICAgcmVzID0gc2VuZF9hcGlfcmVxdWVzdChhcGlfa2V5LCBwYXRoLCByYXdfcGF5bG9hZCwgdG9rZW5zWyJpZF90b2tlbiJdLCAiUE9TVCIpCgogICAgcmV0dXJuIHJlcwoKZGVmIGNoYW5nZV9tZW1iZXIoCiAgICBhcGlfa2V5OiBzdHIsCiAgICB0b2tlbnM6IGRpY3QsCiAgICBwYXJlbnRfYWxpYXM6IHN0ciwKICAgIGFsaWFzOiBzdHIsCiAgICBzbG90X2lkOiBpbnQsCiAgICBmYW1pbHlfbWVtYmVyX2lkOiBzdHIsCiAgICBuZXdfbXNpc2RuOiBzdHIsCikgLT4gZGljdDoKICAgIHBhdGggPSAic2hhcmluZ3MvYXBpL3Y4L2ZhbWlseS1wbGFuL2NoYW5nZS1tZW1iZXIiCgogICAgcmF3X3BheWxvYWQgPSB7CiAgICAgICAgInBhcmVudF9hbGlhcyI6IHBhcmVudF9hbGlhcywKICAgICAgICAiaXNfZW50ZXJwcmlzZSI6IEZhbHNlLAogICAgICAgICJzbG90X2lkIjogc2xvdF9pZCwKICAgICAgICAiYWxpYXMiOiBhbGlhcywKICAgICAgICAibGFuZyI6ICJlbiIsCiAgICAgICAgIm1zaXNkbiI6IG5ld19tc2lzZG4sCiAgICAgICAgImZhbWlseV9tZW1iZXJfaWQiOiBmYW1pbHlfbWVtYmVyX2lkCiAgICB9CiAgICAKICAgIHdpdGggbGl2ZV9sb2FkaW5nKGYi8J+UhCBMYWdpIGFzc2lnbiBzbG90IHtzbG90X2lkfSBrZSB7bmV3X21zaXNkbn0gYnJvLi4uIiwgZ2V0X3RoZW1lKCkpOgogICAgICAgIHJlcyA9IHNlbmRfYXBpX3JlcXVlc3QoYXBpX2tleSwgcGF0aCwgcmF3X3BheWxvYWQsIHRva2Vuc1siaWRfdG9rZW4iXSwgIlBPU1QiKQoKICAgIHJldHVybiByZXMKCmRlZiByZW1vdmVfbWVtYmVyKAogICAgYXBpX2tleTogc3RyLAogICAgdG9rZW5zOiBkaWN0LAogICAgZmFtaWx5X21lbWJlcl9pZDogc3RyLAopIC0+IGRpY3Q6CiAgICBwYXRoID0gInNoYXJpbmdzL2FwaS92OC9mYW1pbHktcGxhbi9yZW1vdmUtbWVtYmVyIgoKICAgIHJhd19wYXlsb2FkID0gewogICAgICAgICJpc19lbnRlcnByaXNlIjogRmFsc2UsCiAgICAgICAgImZhbWlseV9tZW1iZXJfaWQiOiBmYW1pbHlfbWVtYmVyX2lkLAogICAgICAgICJsYW5nIjogImVuIgogICAgfQoKICAgIHdpdGggbGl2ZV9sb2FkaW5nKGYi8J+Xke+4jyBMYWdpIG5lbmRhbmcgbWVtYmVyIHtmYW1pbHlfbWVtYmVyX2lkfSBrZWx1YXIgYnJvLi4uIiwgZ2V0X3RoZW1lKCkpOgogICAgICAgIHJlcyA9IHNlbmRfYXBpX3JlcXVlc3QoYXBpX2tleSwgcGF0aCwgcmF3X3BheWxvYWQsIHRva2Vuc1siaWRfdG9rZW4iXSwgIlBPU1QiKQoKICAgIHJldHVybiByZXMKCmRlZiBzZXRfcXVvdGFfbGltaXQoCiAgICBhcGlfa2V5OiBzdHIsCiAgICB0b2tlbnM6IGRpY3QsCiAgICBvcmlnaW5hbF9hbGxvY2F0aW9uOiBpbnQsCiAgICBuZXdfYWxsb2NhdGlvbjogaW50LAogICAgZmFtaWx5X21lbWJlcl9pZDogc3RyLAopIC0+IGRpY3Q6CiAgICBwYXRoID0gInNoYXJpbmdzL2FwaS92OC9mYW1pbHktcGxhbi9hbGxvY2F0ZS1xdW90YSIKCiAgICByYXdfcGF5bG9hZCA9IHsKICAgICAgICAiaXNfZW50ZXJwcmlzZSI6IEZhbHNlLAogICAgICAgICJtZW1iZXJfYWxsb2NhdGlvbnMiOiBbewogICAgICAgICAgICAibmV3X3RleHRfYWxsb2NhdGlvbiI6IDAsCiAgICAgICAgICAgICJvcmlnaW5hbF90ZXh0X2FsbG9jYXRpb24iOiAwLAogICAgICAgICAgICAib3JpZ2luYWxfdm9pY2VfYWxsb2NhdGlvbiI6IDAsCiAgICAgICAgICAgICJvcmlnaW5hbF9hbGxvY2F0aW9uIjogb3JpZ2luYWxfYWxsb2NhdGlvbiwKICAgICAgICAgICAgIm5ld192b2ljZV9hbGxvY2F0aW9uIjogMCwKICAgICAgICAgICAgIm1lc3NhZ2UiOiAiIiwKICAgICAgICAgICAgIm5ld19hbGxvY2F0aW9uIjogbmV3X2FsbG9jYXRpb24sCiAgICAgICAgICAgICJmYW1pbHlfbWVtYmVyX2lkIjogZmFtaWx5X21lbWJlcl9pZCwKICAgICAgICAgICAgInN0YXR1cyI6ICIiCiAgICAgICAgfV0sCiAgICAgICAgImxhbmciOiAiZW4iCiAgICB9CiAgICAKICAgIGZvcm1hdHRlZF9uZXdfYWxsb2NhdGlvbiA9IGZvcm1hdF9xdW90YV9ieXRlKG5ld19hbGxvY2F0aW9uKQoKICAgIHdpdGggbGl2ZV9sb2FkaW5nKGYi8J+TiiBMYWdpIG5nYXR1ciBsaW1pdCBrdW90YSBidWF0IHtmYW1pbHlfbWVtYmVyX2lkfSBrZSB7Zm9ybWF0dGVkX25ld19hbGxvY2F0aW9ufSBicm8uLi4iLCBnZXRfdGhlbWUoKSk6CiAgICAgICAgcmVzID0gc2VuZF9hcGlfcmVxdWVzdChhcGlfa2V5LCBwYXRoLCByYXdfcGF5bG9hZCwgdG9rZW5zWyJpZF90b2tlbiJdLCAiUE9TVCIpCgogICAgcmV0dXJuIHJlcwo=').decode())
