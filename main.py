#!/usr/bin/env python3
import base64
exec(base64.b64decode('ZnJvbSBkb3RlbnYgaW1wb3J0IGxvYWRfZG90ZW52CmxvYWRfZG90ZW52KCkKCmltcG9ydCBzdWJwcm9jZXNzCmltcG9ydCBzeXMKaW1wb3J0IG9zCmZyb20gYXBwMi5jb25maWcuaW1wb3J0cyBpbXBvcnQgKgoKCmRlZiBpc19yZWJhc2VfaW5fcHJvZ3Jlc3MoKToKICAgIHJldHVybiBvcy5wYXRoLmV4aXN0cygiLmdpdC9yZWJhc2UtYXBwbHkiKSBvciBvcy5wYXRoLmV4aXN0cygiLmdpdC9yZWJhc2UtbWVyZ2UiKQoKCmRlZiBnaXRfcHVsbF9yZWJhc2UoKToKICAgIHRoZW1lID0gZ2V0X3RoZW1lKCkKICAgIHJlc3VsdCA9IHsic3RhdHVzIjogTm9uZSwgImVycm9yIjogTm9uZSwgIm91dHB1dCI6ICIifQoKICAgIGlmIGlzX3JlYmFzZV9pbl9wcm9ncmVzcygpOgogICAgICAgIHRleHQgPSBUZXh0LmZyb21fbWFya3VwKAogICAgICAgICAgICAiW2JvbGQgeWVsbG93XVJlYmFzZSBtYXNpaCBiZXJsYW5nc3VuZ1svXVxuXG4iCiAgICAgICAgICAgIGYiW3tnZXRfdGhlbWVfc3R5bGUoJ3RleHRfd2FybmluZycpfV1TZWxlc2Fpa2FuIGRlbmdhbiBgZ2l0IHJlYmFzZSAtLWNvbnRpbnVlYCBhdGF1IGJhdGFsa2FuIGRlbmdhbiBgZ2l0IHJlYmFzZSAtLWFib3J0YFsvXSIKICAgICAgICApCiAgICAgICAgY29uc29sZS5wcmludChQYW5lbCgKICAgICAgICAgICAgdGV4dCwKICAgICAgICAgICAgdGl0bGU9ZiJbe2dldF90aGVtZV9zdHlsZSgndGV4dF90aXRsZScpfV1VcGRhdGUgQ0xJWy9dIiwKICAgICAgICAgICAgYm9yZGVyX3N0eWxlPWdldF90aGVtZV9zdHlsZSgiYm9yZGVyX3dhcm5pbmciKSwKICAgICAgICAgICAgcGFkZGluZz0oMSwgMiksCiAgICAgICAgICAgIGV4cGFuZD1UcnVlCiAgICAgICAgKSkKICAgICAgICBwYXVzZSgpCiAgICAgICAgc3lzLmV4aXQoMSkKCiAgICBkZWYgcnVuX2dpdF9wdWxsKCk6CiAgICAgICAgdHJ5OgogICAgICAgICAgICBzdWJwcm9jZXNzLnJ1bihbJ2dpdCcsICdyZXYtcGFyc2UnLCAnLS1pcy1pbnNpZGUtd29yay10cmVlJ10sIGNoZWNrPVRydWUsIHN0ZG91dD1zdWJwcm9jZXNzLkRFVk5VTEwpCiAgICAgICAgICAgIG91dHB1dCA9IHN1YnByb2Nlc3MucnVuKAogICAgICAgICAgICAgICAgWydnaXQnLCAncHVsbCcsICctLXJlYmFzZSddLAogICAgICAgICAgICAgICAgc3Rkb3V0PXN1YnByb2Nlc3MuUElQRSwKICAgICAgICAgICAgICAgIHN0ZGVycj1zdWJwcm9jZXNzLlBJUEUsCiAgICAgICAgICAgICAgICB0ZXh0PVRydWUsCiAgICAgICAgICAgICAgICBjaGVjaz1UcnVlCiAgICAgICAgICAgICkKICAgICAgICAgICAgcmVzdWx0WyJzdGF0dXMiXSA9ICJzdWNjZXNzIgogICAgICAgICAgICByZXN1bHRbIm91dHB1dCJdID0gb3V0cHV0LnN0ZG91dC5zdHJpcCgpCiAgICAgICAgZXhjZXB0IHN1YnByb2Nlc3MuQ2FsbGVkUHJvY2Vzc0Vycm9yIGFzIGU6CiAgICAgICAgICAgIHJlc3VsdFsic3RhdHVzIl0gPSAiZmFpbCIKICAgICAgICAgICAgcmVzdWx0WyJlcnJvciJdID0gZS5zdGRlcnIuc3RyaXAoKQogICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAgcmVzdWx0WyJzdGF0dXMiXSA9ICJlcnJvciIKICAgICAgICAgICAgcmVzdWx0WyJlcnJvciJdID0gc3RyKGUpCgogICAgZGVmIHJ1bl9naXRfcmVzZXQoKToKICAgICAgICB0cnk6CiAgICAgICAgICAgIGJyYW5jaCA9IHN1YnByb2Nlc3MuY2hlY2tfb3V0cHV0KFsnZ2l0JywgJ3Jldi1wYXJzZScsICctLWFiYnJldi1yZWYnLCAnSEVBRCddLCB0ZXh0PVRydWUpLnN0cmlwKCkKICAgICAgICAgICAgc3VicHJvY2Vzcy5ydW4oWydnaXQnLCAnZmV0Y2gnXSwgY2hlY2s9VHJ1ZSwgc3Rkb3V0PXN1YnByb2Nlc3MuREVWTlVMTCkKICAgICAgICAgICAgcmVzZXRfb3V0cHV0ID0gc3VicHJvY2Vzcy5ydW4oCiAgICAgICAgICAgICAgICBbJ2dpdCcsICdyZXNldCcsICctLWhhcmQnLCBmJ29yaWdpbi97YnJhbmNofSddLAogICAgICAgICAgICAgICAgc3Rkb3V0PXN1YnByb2Nlc3MuUElQRSwKICAgICAgICAgICAgICAgIHN0ZGVycj1zdWJwcm9jZXNzLlBJUEUsCiAgICAgICAgICAgICAgICB0ZXh0PVRydWUsCiAgICAgICAgICAgICAgICBjaGVjaz1UcnVlCiAgICAgICAgICAgICkKICAgICAgICAgICAgcmVzdWx0WyJzdGF0dXMiXSA9ICJyZXNldCIKICAgICAgICAgICAgcmVzdWx0WyJvdXRwdXQiXSA9IHJlc2V0X291dHB1dC5zdGRvdXQuc3RyaXAoKQogICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAgcmVzdWx0WyJzdGF0dXMiXSA9ICJyZXNldF9mYWlsIgogICAgICAgICAgICByZXN1bHRbImVycm9yIl0gPSBzdHIoZSkKCiAgICB3aXRoIGxpdmVfbG9hZGluZygiTWVuYXJpayBwZW1iYXJ1YW4gZGFyaSByZXBvc2l0b3J5Li4uIiwgdGhlbWUpOgogICAgICAgIHJ1bl9naXRfcHVsbCgpCgogICAgaWYgcmVzdWx0WyJzdGF0dXMiXSA9PSAic3VjY2VzcyI6CiAgICAgICAgdGV4dCA9IFRleHQuZnJvbV9tYXJrdXAoCiAgICAgICAgICAgIGYiW2JvbGQge2dldF90aGVtZV9zdHlsZSgndGV4dF9kYXRlJyl9XUdpdCBwdWxsIGJlcmhhc2lsWy9dXG5cblt7Z2V0X3RoZW1lX3N0eWxlKCd0ZXh0X2JvZHknKX1de3Jlc3VsdFsnb3V0cHV0J119Wy9dIgogICAgICAgICkKICAgICAgICBjb25zb2xlLnByaW50KFBhbmVsKAogICAgICAgICAgICB0ZXh0LAogICAgICAgICAgICB0aXRsZT1mIlt7Z2V0X3RoZW1lX3N0eWxlKCd0ZXh0X3RpdGxlJyl9XVVwZGF0ZSBDTElbL10iLAogICAgICAgICAgICBib3JkZXJfc3R5bGU9Z2V0X3RoZW1lX3N0eWxlKCJib3JkZXJfaW5mbyIpLAogICAgICAgICAgICBwYWRkaW5nPSgxLCAyKSwKICAgICAgICAgICAgZXhwYW5kPVRydWUKICAgICAgICApKQoKICAgIGVsaWYgcmVzdWx0WyJzdGF0dXMiXSA9PSAiZmFpbCI6CiAgICAgICAgdGV4dCA9IFRleHQuZnJvbV9tYXJrdXAoCiAgICAgICAgICAgIGYiW2JvbGQge2dldF90aGVtZV9zdHlsZSgndGV4dF9lcnJvcicpfV1HaXQgcHVsbCBnYWdhbFsvXVxuXG5be2dldF90aGVtZV9zdHlsZSgndGV4dF9lcnJvcicpfV17cmVzdWx0WydlcnJvciddfVsvXVxuXG5be2dldF90aGVtZV9zdHlsZSgndGV4dF93YXJuaW5nJyl9XVNpbGFrYW4gY29iYSByZXNldCBwYWtzYSB0ZXJsZWJpaCBkYWh1bHVbL10iCiAgICAgICAgKQogICAgICAgIGNvbnNvbGUucHJpbnQoUGFuZWwoCiAgICAgICAgICAgIHRleHQsCiAgICAgICAgICAgIHRpdGxlPWYiW3tnZXRfdGhlbWVfc3R5bGUoJ3RleHRfdGl0bGUnKX1dVXBkYXRlIENMSVsvXSIsCiAgICAgICAgICAgIGJvcmRlcl9zdHlsZT1nZXRfdGhlbWVfc3R5bGUoImJvcmRlcl9lcnJvciIpLAogICAgICAgICAgICBwYWRkaW5nPSgxLCAyKSwKICAgICAgICAgICAgZXhwYW5kPVRydWUKICAgICAgICApKQoKICAgICAgICB3aXRoIGxpdmVfbG9hZGluZygiTWVsYWt1a2FuIHJlc2V0IGtlIG9yaWdpbi4uLiIsIHRoZW1lKToKICAgICAgICAgICAgcnVuX2dpdF9yZXNldCgpCgogICAgICAgIGlmIHJlc3VsdFsic3RhdHVzIl0gPT0gInJlc2V0IjoKICAgICAgICAgICAgdGV4dCA9IFRleHQuZnJvbV9tYXJrdXAoCiAgICAgICAgICAgICAgICBmIltib2xkIHtnZXRfdGhlbWVfc3R5bGUoJ3RleHRfc3VjY2VzcycpfV1SZXNldCBiZXJoYXNpbCwgcmVwb3NpdG9yeSB0ZWxhaCBzaW5rcm9uIGRlbmdhbiBvcmlnaW5bL11cblxuW3tnZXRfdGhlbWVfc3R5bGUoJ3RleHRfYm9keScpfV17cmVzdWx0WydvdXRwdXQnXX1bL10iCiAgICAgICAgICAgICkKICAgICAgICAgICAgY29uc29sZS5wcmludChQYW5lbCgKICAgICAgICAgICAgICAgIHRleHQsCiAgICAgICAgICAgICAgICB0aXRsZT1mIlt7Z2V0X3RoZW1lX3N0eWxlKCd0ZXh0X3RpdGxlJyl9XVVwZGF0ZSBDTElbL10iLAogICAgICAgICAgICAgICAgYm9yZGVyX3N0eWxlPWdldF90aGVtZV9zdHlsZSgiYm9yZGVyX3N1Y2Nlc3MiKSwKICAgICAgICAgICAgICAgIHBhZGRpbmc9KDEsIDIpLAogICAgICAgICAgICAgICAgZXhwYW5kPVRydWUKICAgICAgICAgICAgKSkKICAgICAgICBlbHNlOgogICAgICAgICAgICB0ZXh0ID0gVGV4dC5mcm9tX21hcmt1cCgKICAgICAgICAgICAgICAgIGYiW2JvbGQge2dldF90aGVtZV9zdHlsZSgndGV4dF9lcnJvcicpfV1SZXNldCBnYWdhbFsvXVxuXG5be2dldF90aGVtZV9zdHlsZSgndGV4dF9lcnJvcicpfV17cmVzdWx0WydlcnJvciddfVsvXSIKICAgICAgICAgICAgKQogICAgICAgICAgICBjb25zb2xlLnByaW50KFBhbmVsKAogICAgICAgICAgICAgICAgdGV4dCwKICAgICAgICAgICAgICAgIHRpdGxlPWYiW3tnZXRfdGhlbWVfc3R5bGUoJ3RleHRfdGl0bGUnKX1dVXBkYXRlIENMSVsvXSIsCiAgICAgICAgICAgICAgICBib3JkZXJfc3R5bGU9Z2V0X3RoZW1lX3N0eWxlKCJib3JkZXJfZXJyb3IiKSwKICAgICAgICAgICAgICAgIHBhZGRpbmc9KDEsIDIpLAogICAgICAgICAgICAgICAgZXhwYW5kPVRydWUKICAgICAgICAgICAgKSkKICAgICAgICAgICAgcGF1c2UoKQogICAgICAgICAgICBzeXMuZXhpdCgxKQoKICAgIGVsc2U6CiAgICAgICAgdGV4dCA9IFRleHQuZnJvbV9tYXJrdXAoCiAgICAgICAgICAgIGYiW2JvbGQge2dldF90aGVtZV9zdHlsZSgndGV4dF93YXJuaW5nJyl9XVRlcmphZGkga2VzYWxhaGFuIHNhYXQgZ2l0IHB1bGxbL11cblxuW3tnZXRfdGhlbWVfc3R5bGUoJ3RleHRfd2FybmluZycpfV17cmVzdWx0WydlcnJvciddfVsvXSIKICAgICAgICApCiAgICAgICAgY29uc29sZS5wcmludChQYW5lbCgKICAgICAgICAgICAgdGV4dCwKICAgICAgICAgICAgdGl0bGU9ZiJbe2dldF90aGVtZV9zdHlsZSgndGV4dF90aXRsZScpfV1VcGRhdGUgQ0xJWy9dIiwKICAgICAgICAgICAgYm9yZGVyX3N0eWxlPWdldF90aGVtZV9zdHlsZSgiYm9yZGVyX3dhcm5pbmciKSwKICAgICAgICAgICAgcGFkZGluZz0oMSwgMiksCiAgICAgICAgICAgIGV4cGFuZD1UcnVlCiAgICAgICAgKSkKICAgICAgICBwYXVzZSgpCiAgICAgICAgc3lzLmV4aXQoMSkKCgpkZWYgcnVuX21lbnUoKToKICAgICIiIkphbGFua2FuIG1hc3RlcjIucHkgc2VjYXJhIG90b21hdGlzIHRhbnBhIHByb21wdCIiIgogICAgaW1wb3J0IG1hc3RlcjIgYXMgbWFzdGVyCiAgICAKICAgIHRyeToKICAgICAgICBtYXN0ZXIubWFpbigpCiAgICBleGNlcHQgS2V5Ym9hcmRJbnRlcnJ1cHQ6CiAgICAgICAgcHJpbnRfcGFuZWwoIktlbHVhciIsICJBcGxpa2FzaSBkaWhlbnRpa2FuIG9sZWggcGVuZ2d1bmEiLCBib3JkZXJfc3R5bGU9Z2V0X3RoZW1lX3N0eWxlKCJib3JkZXJfaW5mbyIpKQogICAgICAgIHN5cy5leGl0KDApCiAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgcHJpbnRfZXJyb3IoIktlc2FsYWhhbiIsIGYiR2FnYWwgbWVuamFsYW5rYW4gYXBsaWthc2kgfCB7dHlwZShlKS5fX25hbWVfX30gLSB7ZX0iKQogICAgICAgIHBhdXNlKCkKICAgICAgICBzeXMuZXhpdCgxKQoKaWYgX19uYW1lX18gPT0gIl9fbWFpbl9fIjoKICAgIHRyeToKICAgICAgICB3aXRoIGxpdmVfbG9hZGluZygiTWVtZXJpa3NhIHBlbWJhcnVhbi4uLiIsIGdldF90aGVtZSgpKToKICAgICAgICAgICAgbmVlZF91cGRhdGUgPSBjaGVja19mb3JfdXBkYXRlcygpCiAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgcHJpbnRfd2FybmluZygiS2VzYWxhaGFuIiwgZiJHYWdhbCBtZW1lcmlrc2EgcGVtYmFydWFuOiB7ZX0iKQogICAgICAgIG5lZWRfdXBkYXRlID0gRmFsc2UKCiAgICBlbnN1cmVfZ2l0KCkKICAgIGlmIG5lZWRfdXBkYXRlOgogICAgICAgIGdpdF9wdWxsX3JlYmFzZSgpCgogICAgcnVuX21lbnUoKQo=').decode())
