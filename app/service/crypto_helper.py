#!/usr/bin/env python3
import base64
exec(base64.b64decode('aW1wb3J0IGhhc2hsaWIsIG9zLCBobWFjLCBiYXNlNjQKZnJvbSBiYXNlNjQgaW1wb3J0IHVybHNhZmVfYjY0ZW5jb2RlLCB1cmxzYWZlX2I2NGRlY29kZQpmcm9tIENyeXB0by5DaXBoZXIgaW1wb3J0IEFFUwpmcm9tIENyeXB0by5VdGlsLlBhZGRpbmcgaW1wb3J0IHBhZCwgdW5wYWQKClhEQVRBX0tFWT1vcy5nZXRlbnYoIlhEQVRBX0tFWSIpCkFYX0FQSV9TSUdfS0VZPW9zLmdldGVudigiQVhfQVBJX1NJR19LRVkiKQpYX0FQSV9CQVNFX1NFQ1JFVD1vcy5nZXRlbnYoIlhfQVBJX0JBU0VfU0VDUkVUIikKRU5DUllQVEVEX0ZJRUxEX0tFWT1vcy5nZXRlbnYoIkVOQ1JZUFRFRF9GSUVMRF9LRVkiKQoKZGVmIGRlcml2ZV9pdih4dGltZV9tczogaW50KSAtPiBieXRlczoKICAgIHNoYSA9IGhhc2hsaWIuc2hhMjU2KHN0cih4dGltZV9tcykuZW5jb2RlKCkpLmhleGRpZ2VzdCgpCiAgICByZXR1cm4gc2hhWzoxNl0uZW5jb2RlKCkKCmRlZiBlbmNyeXB0X3hkYXRhKHBsYWludGV4dDogc3RyLCB4dGltZV9tczogaW50KSAtPiBzdHI6CiAgICBpdiA9IGRlcml2ZV9pdih4dGltZV9tcykKICAgIGtleV9ieXRlcyA9IFhEQVRBX0tFWS5lbmNvZGUoKQogICAgCiAgICBjaXBoZXIgPSBBRVMubmV3KGtleV9ieXRlcywgQUVTLk1PREVfQ0JDLCBpdikKICAgIHJldHVybiB1cmxzYWZlX2I2NGVuY29kZShjaXBoZXIuZW5jcnlwdChwYWQocGxhaW50ZXh0LmVuY29kZSgpLCAxNiwgc3R5bGU9InBrY3M3IikpKS5kZWNvZGUoKQoKZGVmIGRlY3J5cHRfeGRhdGEoeGRhdGE6IHN0ciwgeHRpbWVfbXM6IGludCkgLT4gc3RyOgogICAgaXYgPSBkZXJpdmVfaXYoeHRpbWVfbXMpCiAgICBrZXlfYnl0ZXMgPSBYREFUQV9LRVkuZW5jb2RlKCkKICAgIAogICAgY3QgPSB1cmxzYWZlX2I2NGRlY29kZSh4ZGF0YSArICI9IiAqICgoNCAtIGxlbih4ZGF0YSkgJSA0KSAlIDQpKQogICAgcHQgPSBBRVMubmV3KGtleV9ieXRlcywgQUVTLk1PREVfQ0JDLCBpdikuZGVjcnlwdChjdCkKICAgIHJldHVybiB1bnBhZChwdCwgMTYsIHN0eWxlPSJwa2NzNyIpLmRlY29kZSgpCgpkZWYgbWFrZV94X3NpZ25hdHVyZSgKICAgIGlkX3Rva2VuOiBzdHIsCiAgICBtZXRob2Q6IHN0ciwKICAgIHBhdGg6c3RyLAogICAgc2lnX3RpbWVfc2VjOmludAopIC0+IHN0cjoKICAgIGtleV9zdHIgPSBmIntYX0FQSV9CQVNFX1NFQ1JFVH07e2lkX3Rva2VufTt7bWV0aG9kfTt7cGF0aH07e3NpZ190aW1lX3NlY30iCiAgICBrZXlfYnl0ZXMgPSBrZXlfc3RyLmVuY29kZSgidXRmLTgiKQogICAgCiAgICBtc2cgPSBmIntpZF90b2tlbn07e3NpZ190aW1lX3NlY307Ii5lbmNvZGUoInV0Zi04IikKICAgIAogICAgcmV0dXJuIGhtYWMubmV3KGtleV9ieXRlcywgbXNnLCBoYXNobGliLnNoYTUxMikuaGV4ZGlnZXN0KCkKCmRlZiBtYWtlX3hfc2lnbmF0dXJlX3BheW1lbnQoCiAgICBhY2Nlc3NfdG9rZW46IHN0ciwKICAgIHNpZ190aW1lX3NlYzogaW50LAogICAgcGFja2FnZV9jb2RlOiBzdHIsCiAgICB0b2tlbl9wYXltZW50OiBzdHIsCiAgICBwYXltZW50X21ldGhvZDogc3RyLAogICAgcGF5bWVudF9mb3I6IHN0ciwKICAgIHBhdGg6IHN0ciwKKSAtPiBzdHI6CiAgICBrZXlfc3RyID0gZiJ7WF9BUElfQkFTRV9TRUNSRVR9O3tzaWdfdGltZV9zZWN9I2FlLWhlaV85VGVlNmhlK0lrM0dhaXM1PTtQT1NUO3twYXRofTt7c2lnX3RpbWVfc2VjfSIKICAgIGtleV9ieXRlcyA9IGtleV9zdHIuZW5jb2RlKCJ1dGYtOCIpCgogICAgbXNnID0gZiJ7YWNjZXNzX3Rva2VufTt7dG9rZW5fcGF5bWVudH07e3NpZ190aW1lX3NlY307e3BheW1lbnRfZm9yfTt7cGF5bWVudF9tZXRob2R9O3twYWNrYWdlX2NvZGV9OyIuZW5jb2RlKCJ1dGYtOCIpCgogICAgcmV0dXJuIGhtYWMubmV3KGtleV9ieXRlcywgbXNnLCBoYXNobGliLnNoYTUxMikuaGV4ZGlnZXN0KCkKCmRlZiBtYWtlX2F4X2FwaV9zaWduYXR1cmUoCiAgICB0c19mb3Jfc2lnbjogc3RyLAogICAgY29udGFjdDogc3RyLAogICAgY29kZTogc3RyLAogICAgY29udGFjdF90eXBlOiBzdHIKKSAtPiBzdHI6CiAgICBrZXlfYnl0ZXMgPSBBWF9BUElfU0lHX0tFWS5lbmNvZGUoImFzY2lpIikKICAgIAogICAgcHJlaW1hZ2UgPSBmInt0c19mb3Jfc2lnbn1wYXNzd29yZHtjb250YWN0X3R5cGV9e2NvbnRhY3R9e2NvZGV9b3BlbmlkIgogICAgZGlnZXN0ID0gaG1hYy5uZXcoa2V5X2J5dGVzLCBwcmVpbWFnZS5lbmNvZGUoInV0Zi04IiksIGhhc2hsaWIuc2hhMjU2KS5kaWdlc3QoKQogICAgYjY0cmVzID0gYmFzZTY0LmI2NGVuY29kZShkaWdlc3QpLmRlY29kZSgiYXNjaWkiKQogICAgcmV0dXJuIGI2NHJlcwoKZGVmIG1ha2VfeF9zaWduYXR1cmVfYm91bnR5KAogICAgYWNjZXNzX3Rva2VuOiBzdHIsCiAgICBzaWdfdGltZV9zZWM6IGludCwKICAgIHBhY2thZ2VfY29kZTogc3RyLAogICAgdG9rZW5fcGF5bWVudDogc3RyLAogICAgKSAtPiBzdHI6CiAgICBwYXRoID0gImFwaS92OC9wZXJzb25hbGl6YXRpb24vYm91bnRpZXMtZXhjaGFuZ2UiCgogICAga2V5X3N0ciA9IGYie1hfQVBJX0JBU0VfU0VDUkVUfTt7YWNjZXNzX3Rva2VufTt7c2lnX3RpbWVfc2VjfSNhZS1oZWlfOVRlZTZoZStJazNHYWlzNT07UE9TVDt7cGF0aH07e3NpZ190aW1lX3NlY30iCiAgICBrZXlfYnl0ZXMgPSBrZXlfc3RyLmVuY29kZSgidXRmLTgiKQoKICAgIG1zZyA9IGYie2FjY2Vzc190b2tlbn07e3Rva2VuX3BheW1lbnR9O3tzaWdfdGltZV9zZWN9O3twYWNrYWdlX2NvZGV9OyIuZW5jb2RlKCJ1dGYtOCIpCgogICAgcmV0dXJuIGhtYWMubmV3KGtleV9ieXRlcywgbXNnLCBoYXNobGliLnNoYTUxMikuaGV4ZGlnZXN0KCkKCmRlZiBtYWtlX3hfc2lnbmF0dXJlX2xveWFsdHkoCiAgICBzaWdfdGltZV9zZWM6IGludCwKICAgIHBhY2thZ2VfY29kZTogc3RyLAogICAgdG9rZW5fY29uZmlybWF0aW9uOiBzdHIsCiAgICBwYXRoOiBzdHIsCikgLT4gc3RyOgogICAga2V5X3N0ciA9IGYie1hfQVBJX0JBU0VfU0VDUkVUfTt7c2lnX3RpbWVfc2VjfSNhZS1oZWlfOVRlZTZoZStJazNHYWlzNT07UE9TVDt7cGF0aH07e3NpZ190aW1lX3NlY30iCiAgICBrZXlfYnl0ZXMgPSBrZXlfc3RyLmVuY29kZSgidXRmLTgiKQogICAgCiAgICBtc2cgPSBmInt0b2tlbl9jb25maXJtYXRpb259O3tzaWdfdGltZV9zZWN9O3twYWNrYWdlX2NvZGV9OyIuZW5jb2RlKCJ1dGYtOCIpCiAgICAKICAgIHJldHVybiBobWFjLm5ldyhrZXlfYnl0ZXMsIG1zZywgaGFzaGxpYi5zaGE1MTIpLmhleGRpZ2VzdCgpCgpkZWYgZGVjcnlwdF9jaXJjbGVfbXNpc2RuKGVuY3J5cHRlZF9tc2lzZG5fYjY0OiBzdHIpIC0+IHN0cjoKICAgIGl2X2FzY2lpID0gZW5jcnlwdGVkX21zaXNkbl9iNjRbLTE2Ol0KICAgIGI2NF9wYXJ0ID0gZW5jcnlwdGVkX21zaXNkbl9iNjRbOi0xNl0KICAgIGtleSA9IEVOQ1JZUFRFRF9GSUVMRF9LRVkuZW5jb2RlKCdhc2NpaScpCiAgICBpdiA9IGl2X2FzY2lpLmVuY29kZSgnYXNjaWknKQogICAgCiAgICBwYWRkaW5nID0gbGVuKGI2NF9wYXJ0KSAlIDQKICAgIGlmIHBhZGRpbmc6CiAgICAgICAgYjY0X3BhcnQgKz0gJz0nICogKDQgLSBwYWRkaW5nKQogICAgdHJ5OgogICAgICAgIGN0ID0gYmFzZTY0LnVybHNhZmVfYjY0ZGVjb2RlKGI2NF9wYXJ0KQogICAgICAgIGNpcGhlciA9IEFFUy5uZXcoa2V5LCBBRVMuTU9ERV9DQkMsIGl2KQogICAgICAgIHB0X3BhZGRlZCA9IGNpcGhlci5kZWNyeXB0KGN0KQogICAgICAgIHB0ID0gdW5wYWQocHRfcGFkZGVkLCBBRVMuYmxvY2tfc2l6ZSwgc3R5bGU9J3BrY3M3JykKICAgICAgICByZXR1cm4gcHQuZGVjb2RlKCd1dGYtOCcpCiAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgcmV0dXJuICIiCgpkZWYgZW5jcnlwdF9jaXJjbGVfbXNpc2RuKG1zaXNkbjogc3RyKSAtPiBzdHI6CiAgICBrZXkgPSBFTkNSWVBURURfRklFTERfS0VZLmVuY29kZSgnYXNjaWknKQogICAgaXZfYXNjaWkgPSBvcy51cmFuZG9tKDgpLmhleCgpCiAgICBpdiA9IGl2X2FzY2lpLmVuY29kZSgnYXNjaWknKQoKICAgIGNpcGhlciA9IEFFUy5uZXcoa2V5LCBBRVMuTU9ERV9DQkMsIGl2KQogICAgY3QgPSBjaXBoZXIuZW5jcnlwdChwYWQobXNpc2RuLmVuY29kZSgndXRmLTgnKSwgQUVTLmJsb2NrX3NpemUpKQogICAgY3RfYjY0ID0gYmFzZTY0LnVybHNhZmVfYjY0ZW5jb2RlKGN0KS5kZWNvZGUoJ2FzY2lpJykKICAgIHJldHVybiBjdF9iNjQgKyBpdl9hc2NpaQoKZGVmIG1ha2VfeF9zaWduYXR1cmVfYm91bnR5X2FsbG90bWVudCgKICAgIHNpZ190aW1lX3NlYzogaW50LAogICAgcGFja2FnZV9jb2RlOiBzdHIsCiAgICB0b2tlbl9jb25maXJtYXRpb246IHN0ciwKICAgIHBhdGg6IHN0ciwKICAgIGRlc3RpbmF0aW9uX21zaXNkbjogc3RyLAogICAgKSAtPiBzdHI6ICAgIAogICAga2V5X3N0ciA9IGYie1hfQVBJX0JBU0VfU0VDUkVUfTt7c2lnX3RpbWVfc2VjfSNhZS1oZWlfOVRlZTZoZStJazNHYWlzNT07e2Rlc3RpbmF0aW9uX21zaXNkbn07UE9TVDt7cGF0aH07e3NpZ190aW1lX3NlY30iCiAgICBrZXlfYnl0ZXMgPSBrZXlfc3RyLmVuY29kZSgidXRmLTgiKQogICAgCiAgICBtc2cgPSBmInt0b2tlbl9jb25maXJtYXRpb259O3tzaWdfdGltZV9zZWN9O3tkZXN0aW5hdGlvbl9tc2lzZG59O3twYWNrYWdlX2NvZGV9OyIuZW5jb2RlKCJ1dGYtOCIpCiAgICAKICAgIHJldHVybiBobWFjLm5ldyhrZXlfYnl0ZXMsIG1zZywgaGFzaGxpYi5zaGE1MTIpLmhleGRpZ2VzdCgpCgpkZWYgbWFrZV94X3NpZ25hdHVyZV9iYXNpYygKICAgIG1ldGhvZDogc3RyLAogICAgcGF0aDogc3RyLAogICAgc2lnX3RpbWVfc2VjOiBpbnQsCikgLT4gc3RyOgogICAga2V5X3N0ciA9IGYie1hfQVBJX0JBU0VfU0VDUkVUfTt7bWV0aG9kfTt7cGF0aH07e3NpZ190aW1lX3NlY30iCiAgICBrZXlfYnl0ZXMgPSBrZXlfc3RyLmVuY29kZSgidXRmLTgiKQoKICAgIG1zZyA9IGYie3NpZ190aW1lX3NlY307ZW47Ii5lbmNvZGUoInV0Zi04IikKCiAgICByZXR1cm4gaG1hYy5uZXcoa2V5X2J5dGVzLCBtc2csIGhhc2hsaWIuc2hhNTEyKS5oZXhkaWdlc3QoKQo=').decode())
