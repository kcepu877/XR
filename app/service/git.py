#!/usr/bin/env python3
import base64
exec(base64.b64decode('aW1wb3J0IG9zCmltcG9ydCBzeXMKaW1wb3J0IHN1YnByb2Nlc3MKaW1wb3J0IHJlcXVlc3RzCmltcG9ydCBjb25maWdwYXJzZXIKaW1wb3J0IHhtbC5ldHJlZS5FbGVtZW50VHJlZSBhcyBFVApmcm9tIHJpY2guY29uc29sZSBpbXBvcnQgQ29uc29sZQpmcm9tIHJpY2gucGFuZWwgaW1wb3J0IFBhbmVsCmZyb20gcmljaC50ZXh0IGltcG9ydCBUZXh0CmZyb20gYXBwMi5jb25maWcudGhlbWVfY29uZmlnIGltcG9ydCBnZXRfdGhlbWVfc3R5bGUKZnJvbSBhcHAyLm1lbnVzLnV0aWwgaW1wb3J0IHByaW50X2Vycm9yLCBwcmludF9zdWNjZXNzLCBwcmludF93YXJuaW5nLCBwcmludF9wYW5lbAoKY29uc29sZSA9IENvbnNvbGUoKQoKT1dORVIgPSAia2NlcHU4NzciClJFUE8gPSAiWFIiCkJSQU5DSCA9ICJtYWluIgpFWFBFQ1RFRF9VUkwgPSBmImh0dHBzOi8vZ2l0aHViLmNvbS97T1dORVJ9L3tSRVBPfSIKCgpkZWYgZ2V0X3JlcG9fcm9vdCgpOgogICAgdHJ5OgogICAgICAgIHJldHVybiBzdWJwcm9jZXNzLmNoZWNrX291dHB1dChbImdpdCIsICJyZXYtcGFyc2UiLCAiLS1zaG93LXRvcGxldmVsIl0pLmRlY29kZSgpLnN0cmlwKCkKICAgIGV4Y2VwdCBFeGNlcHRpb246CiAgICAgICAgcmV0dXJuIG9zLnBhdGguYWJzcGF0aChvcy5wYXRoLmpvaW4ob3MucGF0aC5kaXJuYW1lKF9fZmlsZV9fKSwgIi4uIiwgIi4uIikpCgoKZGVmIGVuc3VyZV9naXQoc3RyaWN0PVRydWUpOgogICAgcm9vdF9wYXRoID0gZ2V0X3JlcG9fcm9vdCgpCiAgICBnaXRfY29uZmlnID0gb3MucGF0aC5qb2luKHJvb3RfcGF0aCwgIi5naXQiLCAiY29uZmlnIikKCiAgICBpZiBub3Qgb3MucGF0aC5leGlzdHMoZ2l0X2NvbmZpZyk6CiAgICAgICAgcHJpbnRfZXJyb3IoIktlc2FsYWhhbiIsICJTY3JpcHQgaW5pIGhhbnlhIGRhcGF0IGRpamFsYW5rYW4gamlrYSBoYXNpbCBnaXQgY2xvbmUuIikKICAgICAgICBwcmludF9wYW5lbCgiSW5mb3JtYXNpIiwgZiJDbG9uZSBkYXJpIHJlcG8gcmVzbWk6XG4gIGdpdCBjbG9uZSB7RVhQRUNURURfVVJMfSIpCiAgICAgICAgaWYgc3RyaWN0OgogICAgICAgICAgICBzeXMuZXhpdCgxKQogICAgICAgIHJldHVybiBGYWxzZQoKICAgIGNvbmZpZyA9IGNvbmZpZ3BhcnNlci5SYXdDb25maWdQYXJzZXIoc3RyaWN0PUZhbHNlKQogICAgY29uZmlnLnJlYWQoZ2l0X2NvbmZpZykKCiAgICBvcmlnaW5fdXJsID0gY29uZmlnLmdldCgncmVtb3RlICJvcmlnaW4iJywgJ3VybCcsIGZhbGxiYWNrPSIiKS5zdHJpcCgpCiAgICBpZiBvcmlnaW5fdXJsICE9IEVYUEVDVEVEX1VSTDoKICAgICAgICBwcmludF93YXJuaW5nKCJLZXNhbGFoYW4iLCAiUmVwbyBpbmkgYnVrYW4gZGFyaSBzdW1iZXIgcmVzbWkuIikKICAgICAgICBwcmludF9wYW5lbCgiSW5mb3JtYXNpIiwgZiJVUkwgc2FhdCBpbmk6IHtvcmlnaW5fdXJsfVxuQ2xvbmUgdWxhbmcgZGFyaTpcbiAgZ2l0IGNsb25lIHtFWFBFQ1RFRF9VUkx9IikKICAgICAgICBpZiBzdHJpY3Q6CiAgICAgICAgICAgIHN5cy5leGl0KDEpCiAgICAgICAgcmV0dXJuIEZhbHNlCgogICAgIyBwcmludF9zdWNjZXNzKCJCZXJoYXNpbCIsICJSZXBvIHZhbGlkLCBhc2xpIGRhcmkgc3VtYmVyIHJlc21pLiIpCiAgICByZXR1cm4gVHJ1ZQoKCmRlZiBnZXRfbG9jYWxfY29tbWl0KCk6CiAgICB0cnk6CiAgICAgICAgcmV0dXJuIHN1YnByb2Nlc3MuY2hlY2tfb3V0cHV0KFsiZ2l0IiwgInJldi1wYXJzZSIsICJIRUFEIl0sIHN0ZGVycj1zdWJwcm9jZXNzLkRFVk5VTEwpLmRlY29kZSgpLnN0cmlwKCkKICAgIGV4Y2VwdCBFeGNlcHRpb246CiAgICAgICAgcmV0dXJuIE5vbmUKCgpkZWYgZ2V0X2xhdGVzdF9jb21taXRfYXRvbSgpOgogICAgdXJsID0gZiJodHRwczovL2dpdGh1Yi5jb20ve09XTkVSfS97UkVQT30vY29tbWl0cy97QlJBTkNIfS5hdG9tIgogICAgciA9IHJlcXVlc3RzLmdldCh1cmwsIHRpbWVvdXQ9NSkKICAgIHIucmFpc2VfZm9yX3N0YXR1cygpCiAgICByb290ID0gRVQuZnJvbXN0cmluZyhyLnRleHQpCiAgICBucyA9IHsiYSI6ICJodHRwOi8vd3d3LnczLm9yZy8yMDA1L0F0b20ifQogICAgZW50cnkgPSByb290LmZpbmQoImE6ZW50cnkiLCBucykKICAgIGVudHJ5X2lkID0gZW50cnkuZmluZCgiYTppZCIsIG5zKSBpZiBlbnRyeSBpcyBub3QgTm9uZSBlbHNlIE5vbmUKICAgIHJldHVybiBlbnRyeV9pZC50ZXh0LnJzcGxpdCgiLyIsIDEpWy0xXSBpZiBlbnRyeV9pZCBpcyBub3QgTm9uZSBlbHNlIE5vbmUKCgpkZWYgY2hlY2tfZm9yX3VwZGF0ZXMoKToKICAgIGxvY2FsID0gZ2V0X2xvY2FsX2NvbW1pdCgpCiAgICB0cnk6CiAgICAgICAgcmVtb3RlID0gZ2V0X2xhdGVzdF9jb21taXRfYXRvbSgpCiAgICBleGNlcHQgRXhjZXB0aW9uOgogICAgICAgIHJlbW90ZSA9IE5vbmUKCiAgICBpZiBub3QgcmVtb3RlIG9yIG5vdCBsb2NhbDoKICAgICAgICBwcmludF93YXJuaW5nKCJLZXNhbGFoYW4iLCAiVGlkYWsgZGFwYXQgbWVtZXJpa3NhIHZlcnNpIHRlcmJhcnUuIikKICAgICAgICByZXR1cm4gRmFsc2UKCiAgICBpZiBsb2NhbCAhPSByZW1vdGU6CiAgICAgICAgcHJpbnRfd2FybmluZygiSW5mb3JtYXNpIiwgZiJBZGEgdXBkYXRlIHRlcmJhcnUgKGxvY2FsIHtsb2NhbFs6N119IHZzIHJlbW90ZSB7cmVtb3RlWzo3XX0pLiIpCiAgICAgICAgIyBwcmludF9wYW5lbCgiSW5mb3JtYXNpIiwgIkphbGFua2FuIHB1bGwgcmViYXNlOlxuW2JvbGRdZ2l0IHB1bGwgLS1yZWJhc2VbL10iKQogICAgICAgIHJldHVybiBUcnVlCgogICAgIyBwcmludF9zdWNjZXNzKCJCZXJoYXNpbCIsICJSZXBvIHN1ZGFoIHZlcnNpIHRlcmJhcnUuIikKICAgIHJldHVybiBGYWxzZQoKCmRlZiBzaG93X3BhbmVsKHRpdGxlLCBib2R5LCBzdHlsZT0iaW5mbyIpOgogICAgYm9yZGVyID0gZ2V0X3RoZW1lX3N0eWxlKGYiYm9yZGVyX3tzdHlsZX0iKQogICAgdGV4dCA9IFRleHQoKQogICAgZm9yIGxpbmUgaW4gYm9keS5zcGxpdCgiXG4iKToKICAgICAgICBsaW5lX3N0eWxlID0gZ2V0X3RoZW1lX3N0eWxlKCJ0ZXh0X2RhdGUiKSBpZiAiaHR0cCIgaW4gbGluZSBlbHNlIGdldF90aGVtZV9zdHlsZSgidGV4dF9ib2R5IikKICAgICAgICB0ZXh0LmFwcGVuZChsaW5lICsgIlxuIiwgc3R5bGU9bGluZV9zdHlsZSkKICAgIGNvbnNvbGUucHJpbnQoUGFuZWwodGV4dCwgdGl0bGU9dGl0bGUsIGJvcmRlcl9zdHlsZT1ib3JkZXIsIGV4cGFuZD1UcnVlKSkK').decode())
