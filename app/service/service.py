#!/usr/bin/env python3
import base64
exec(base64.b64decode('aW1wb3J0IG9zCmltcG9ydCBqc29uCmltcG9ydCBiYXNlNjQKZnJvbSBDcnlwdG8uQ2lwaGVyIGltcG9ydCBBRVMKZnJvbSBDcnlwdG8uVXRpbC5QYWRkaW5nIGltcG9ydCBwYWQsIHVucGFkCgppc19hbnUgPSBvcy5wYXRoLmpvaW4ob3MucGF0aC5kaXJuYW1lKF9fZmlsZV9fKSwgInVubG9ja19zdGF0dXMuanNvbiIpCmFudV9hZXMgPSBiJ2JhcmJleF9pZF9zZWNyZXQhJwoKCmRlZiBlbmNyeXB0X2Jhc2U2NChkYXRhOiBkaWN0KSAtPiBzdHI6CiAgICByYXcgPSBqc29uLmR1bXBzKGRhdGEpLmVuY29kZSgpCiAgICBjaXBoZXIgPSBBRVMubmV3KGFudV9hZXMsIEFFUy5NT0RFX0VDQikKICAgIGVuY3J5cHRlZCA9IGNpcGhlci5lbmNyeXB0KHBhZChyYXcsIEFFUy5ibG9ja19zaXplKSkKICAgIHJldHVybiBiYXNlNjQuYjY0ZW5jb2RlKGVuY3J5cHRlZCkuZGVjb2RlKCkKCmRlZiBkZWNyeXB0X2Jhc2U2NChlbmNvZGVkX2RhdGE6IHN0cikgLT4gZGljdDoKICAgIHRyeToKICAgICAgICBlbmNyeXB0ZWQgPSBiYXNlNjQuYjY0ZGVjb2RlKGVuY29kZWRfZGF0YS5lbmNvZGUoKSkKICAgICAgICBjaXBoZXIgPSBBRVMubmV3KGFudV9hZXMsIEFFUy5NT0RFX0VDQikKICAgICAgICBkZWNyeXB0ZWQgPSB1bnBhZChjaXBoZXIuZGVjcnlwdChlbmNyeXB0ZWQpLCBBRVMuYmxvY2tfc2l6ZSkKICAgICAgICByZXR1cm4ganNvbi5sb2FkcyhkZWNyeXB0ZWQuZGVjb2RlKCkpCiAgICBleGNlcHQgRXhjZXB0aW9uOgogICAgICAgIHJldHVybiB7ImlzX3VubG9ja2VkIjogRmFsc2V9CgpkZWYgbG9hZF9zdGF0dXMoKToKICAgIGlmIG5vdCBvcy5wYXRoLmV4aXN0cyhpc19hbnUpOgogICAgICAgIHJldHVybiB7ImlzX3VubG9ja2VkIjogRmFsc2V9CiAgICB0cnk6CiAgICAgICAgd2l0aCBvcGVuKGlzX2FudSwgInIiKSBhcyBmOgogICAgICAgICAgICBlbmNvZGVkX2RhdGEgPSBmLnJlYWQoKS5zdHJpcCgpCiAgICAgICAgcmV0dXJuIGRlY3J5cHRfYmFzZTY0KGVuY29kZWRfZGF0YSkKICAgIGV4Y2VwdCBFeGNlcHRpb246CiAgICAgICAgcmV0dXJuIHsiaXNfdW5sb2NrZWQiOiBGYWxzZX0KCmRlZiBzYXZlX3N0YXR1cyhzdGF0dXM6IGJvb2wpOgogICAgdHJ5OgogICAgICAgIGVuY29kZWQgPSBlbmNyeXB0X2Jhc2U2NCh7ImlzX3VubG9ja2VkIjogc3RhdHVzfSkKICAgICAgICB3aXRoIG9wZW4oaXNfYW51LCAidyIpIGFzIGY6CiAgICAgICAgICAgIGYud3JpdGUoZW5jb2RlZCkKICAgIGV4Y2VwdCBFeGNlcHRpb246CiAgICAgICAgcGFzcwo=').decode())
