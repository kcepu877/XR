#!/usr/bin/env python3
import base64
exec(base64.b64decode('aW1wb3J0IGpzb24KaW1wb3J0IG9zCmltcG9ydCB1dWlkCmZyb20gZGF0ZXRpbWUgaW1wb3J0IGRhdGV0aW1lLCB0aW1lem9uZQoKaW1wb3J0IHJlcXVlc3RzCgpmcm9tIGFwcC5jbGllbnQuZW5jcnlwdCBpbXBvcnQgKAogICAgQVBJX0tFWSwKICAgIGJ1aWxkX2VuY3J5cHRlZF9maWVsZCwKICAgIGRlY3J5cHRfeGRhdGEsCiAgICBlbmNyeXB0c2lnbl94ZGF0YSwKICAgIGdldF94X3NpZ25hdHVyZV9sb3lhbHR5LAogICAgamF2YV9saWtlX3RpbWVzdGFtcCwKICAgIGdldF94X3NpZ25hdHVyZV9ib3VudHkKKQpmcm9tIGFwcC5jbGllbnQuZW5nc2VsIGltcG9ydCBzZW5kX2FwaV9yZXF1ZXN0LCBCQVNFX0FQSV9VUkwsIFVBCgpCQVNFX0FQSV9VUkwgPSBvcy5nZXRlbnYoIkJBU0VfQVBJX1VSTCIpCkFYX0RFVklDRV9JRCA9IG9zLmdldGVudigiQVhfREVWSUNFX0lEIikKQVhfRlAgPSBvcy5nZXRlbnYoIkFYX0ZQIikKVUEgPSBvcy5nZXRlbnYoIlVBIikKCgpkZWYgZ2V0X3BheW1lbnRfbWV0aG9kcygKICAgICAgICBhcGlfa2V5OiBzdHIsCiAgICAgICAgdG9rZW5zOiBkaWN0LAogICAgICAgIHRva2VuX2NvbmZpcm1hdGlvbjogc3RyLAogICAgICAgIHBheW1lbnRfdGFyZ2V0OiBzdHIsCik6CiAgICBwYXltZW50X3BhdGggPSAicGF5bWVudHMvYXBpL3Y4L3BheW1lbnQtbWV0aG9kcy1vcHRpb24iCiAgICBwYXltZW50X3BheWxvYWQgPSB7CiAgICAgICAgInBheW1lbnRfdHlwZSI6ICJQVVJDSEFTRSIsCiAgICAgICAgImlzX2VudGVycHJpc2UiOiBGYWxzZSwKICAgICAgICAicGF5bWVudF90YXJnZXQiOiBwYXltZW50X3RhcmdldCwKICAgICAgICAibGFuZyI6ICJlbiIsCiAgICAgICAgImlzX3JlZmVycmFsIjogRmFsc2UsCiAgICAgICAgInRva2VuX2NvbmZpcm1hdGlvbiI6IHRva2VuX2NvbmZpcm1hdGlvbgogICAgfQoKICAgIHBheW1lbnRfcmVzID0gc2VuZF9hcGlfcmVxdWVzdChhcGlfa2V5LCBwYXltZW50X3BhdGgsIHBheW1lbnRfcGF5bG9hZCwgdG9rZW5zWyJpZF90b2tlbiJdLCAiUE9TVCIpCiAgICBpZiBwYXltZW50X3Jlc1sic3RhdHVzIl0gIT0gIlNVQ0NFU1MiOgogICAgICAgIHByaW50KCJGYWlsZWQgdG8gZmV0Y2ggcGF5bWVudCBtZXRob2RzLiIpCiAgICAgICAgcHJpbnQoZiJFcnJvcjoge3BheW1lbnRfcmVzfSIpCiAgICAgICAgcmV0dXJuIE5vbmUKCiAgICByZXR1cm4gcGF5bWVudF9yZXNbImRhdGEiXQoKCmRlZiBzZXR0bGVtZW50X2JvdW50eSgKICAgICAgICBhcGlfa2V5OiBzdHIsCiAgICAgICAgdG9rZW5zOiBkaWN0LAogICAgICAgIHRva2VuX2NvbmZpcm1hdGlvbjogc3RyLAogICAgICAgIHRzX3RvX3NpZ246IGludCwKICAgICAgICBwYXltZW50X3RhcmdldDogc3RyLAogICAgICAgIHByaWNlOiBpbnQsCiAgICAgICAgaXRlbV9uYW1lOiBzdHIgPSAiIiwKKToKICAgICMgU2V0dGxlbWVudCByZXF1ZXN0CiAgICBwYXRoID0gImFwaS92OC9wZXJzb25hbGl6YXRpb24vYm91bnRpZXMtZXhjaGFuZ2UiCiAgICBzZXR0bGVtZW50X3BheWxvYWQgPSB7CiAgICAgICAgInRvdGFsX2Rpc2NvdW50IjogMCwKICAgICAgICAiaXNfZW50ZXJwcmlzZSI6IEZhbHNlLAogICAgICAgICJwYXltZW50X3Rva2VuIjogIiIsCiAgICAgICAgInRva2VuX3BheW1lbnQiOiAiIiwKICAgICAgICAiYWN0aXZhdGVkX2F1dG9idXlfY29kZSI6ICIiLAogICAgICAgICJjY19wYXltZW50X3R5cGUiOiAiIiwKICAgICAgICAiaXNfbXl4bF93YWxsZXQiOiBGYWxzZSwKICAgICAgICAicGluIjogIiIsCiAgICAgICAgImV3YWxsZXRfcHJvbW9faWQiOiAiIiwKICAgICAgICAibWVtYmVycyI6IFtdLAogICAgICAgICJ0b3RhbF9mZWUiOiAwLAogICAgICAgICJmaW5nZXJwcmludCI6ICIiLAogICAgICAgICJhdXRvYnV5X3RocmVzaG9sZF9zZXR0aW5nIjogewogICAgICAgICAgICAibGFiZWwiOiAiIiwKICAgICAgICAgICAgInR5cGUiOiAiIiwKICAgICAgICAgICAgInZhbHVlIjogMAogICAgICAgIH0sCiAgICAgICAgImlzX3VzZV9wb2ludCI6IEZhbHNlLAogICAgICAgICJsYW5nIjogImVuIiwKICAgICAgICAicGF5bWVudF9tZXRob2QiOiAiQkFMQU5DRSIsCiAgICAgICAgInRpbWVzdGFtcCI6IHRzX3RvX3NpZ24sCiAgICAgICAgInBvaW50c19nYWluZWQiOiAwLAogICAgICAgICJjYW5fdHJpZ2dlcl9yYXRpbmciOiBGYWxzZSwKICAgICAgICAiYWtyYWJfbWVtYmVycyI6IFtdLAogICAgICAgICJha3JhYl9wYXJlbnRfYWxpYXMiOiAiIiwKICAgICAgICAicmVmZXJyYWxfdW5pcXVlX2NvZGUiOiAiIiwKICAgICAgICAiY291cG9uIjogIiIsCiAgICAgICAgInBheW1lbnRfZm9yIjogIlJFREVFTV9WT1VDSEVSIiwKICAgICAgICAid2l0aF91cHNlbGwiOiBGYWxzZSwKICAgICAgICAidG9wdXBfbnVtYmVyIjogIiIsCiAgICAgICAgInN0YWdlX3Rva2VuIjogIiIsCiAgICAgICAgImF1dGhlbnRpY2F0aW9uX2lkIjogIiIsCiAgICAgICAgImVuY3J5cHRlZF9wYXltZW50X3Rva2VuIjogYnVpbGRfZW5jcnlwdGVkX2ZpZWxkKHVybHNhZmVfYjY0PVRydWUpLAogICAgICAgICJ0b2tlbiI6ICIiLAogICAgICAgICJ0b2tlbl9jb25maXJtYXRpb24iOiB0b2tlbl9jb25maXJtYXRpb24sCiAgICAgICAgImFjY2Vzc190b2tlbiI6IHRva2Vuc1siYWNjZXNzX3Rva2VuIl0sCiAgICAgICAgIndhbGxldF9udW1iZXIiOiAiIiwKICAgICAgICAiZW5jcnlwdGVkX2F1dGhlbnRpY2F0aW9uX2lkIjogYnVpbGRfZW5jcnlwdGVkX2ZpZWxkKHVybHNhZmVfYjY0PVRydWUpLAogICAgICAgICJhZGRpdGlvbmFsX2RhdGEiOiB7CiAgICAgICAgICAgICJvcmlnaW5hbF9wcmljZSI6IDAsCiAgICAgICAgICAgICJpc19zcGVuZF9saW1pdF90ZW1wb3JhcnkiOiBGYWxzZSwKICAgICAgICAgICAgIm1pZ3JhdGlvbl90eXBlIjogIiIsCiAgICAgICAgICAgICJha3JhYl9tMm1fZ3JvdXBfaWQiOiAiIiwKICAgICAgICAgICAgInNwZW5kX2xpbWl0X2Ftb3VudCI6IDAsCiAgICAgICAgICAgICJpc19zcGVuZF9saW1pdCI6IEZhbHNlLAogICAgICAgICAgICAibWlzc2lvbl9pZCI6ICIiLAogICAgICAgICAgICAidGF4IjogMCwKICAgICAgICAgICAgImJlbmVmaXRfdHlwZSI6ICIiLAogICAgICAgICAgICAicXVvdGFfYm9udXMiOiAwLAogICAgICAgICAgICAiY2FzaHRhZyI6ICIiLAogICAgICAgICAgICAiaXNfZmFtaWx5X3BsYW4iOiBGYWxzZSwKICAgICAgICAgICAgImNvbWJvX2RldGFpbHMiOiBbXSwKICAgICAgICAgICAgImlzX3N3aXRjaF9wbGFuIjogRmFsc2UsCiAgICAgICAgICAgICJkaXNjb3VudF9yZWN1cnJpbmciOiAwLAogICAgICAgICAgICAiaXNfYWtyYWJfbTJtIjogRmFsc2UsCiAgICAgICAgICAgICJiYWxhbmNlX3R5cGUiOiAiIiwKICAgICAgICAgICAgImhhc19ib251cyI6IEZhbHNlLAogICAgICAgICAgICAiZGlzY291bnRfcHJvbW8iOiAwCiAgICAgICAgfSwKICAgICAgICAidG90YWxfYW1vdW50IjogMCwKICAgICAgICAiaXNfdXNpbmdfYXV0b2J1eSI6IEZhbHNlLAogICAgICAgICJpdGVtcyI6IFt7CiAgICAgICAgICAgICJpdGVtX2NvZGUiOiBwYXltZW50X3RhcmdldCwKICAgICAgICAgICAgInByb2R1Y3RfdHlwZSI6ICIiLAogICAgICAgICAgICAiaXRlbV9wcmljZSI6IHByaWNlLAogICAgICAgICAgICAiaXRlbV9uYW1lIjogaXRlbV9uYW1lLAogICAgICAgICAgICAidGF4IjogMAogICAgICAgIH1dCiAgICB9CgogICAgZW5jcnlwdGVkX3BheWxvYWQgPSBlbmNyeXB0c2lnbl94ZGF0YSgKICAgICAgICBhcGlfa2V5PWFwaV9rZXksCiAgICAgICAgbWV0aG9kPSJQT1NUIiwKICAgICAgICBwYXRoPXBhdGgsCiAgICAgICAgaWRfdG9rZW49dG9rZW5zWyJpZF90b2tlbiJdLAogICAgICAgIHBheWxvYWQ9c2V0dGxlbWVudF9wYXlsb2FkCiAgICApCgogICAgeHRpbWUgPSBpbnQoZW5jcnlwdGVkX3BheWxvYWRbImVuY3J5cHRlZF9ib2R5Il1bInh0aW1lIl0pCiAgICBzaWdfdGltZV9zZWMgPSAoeHRpbWUgLy8gMTAwMCkKICAgIHhfcmVxdWVzdGVkX2F0ID0gZGF0ZXRpbWUuZnJvbXRpbWVzdGFtcChzaWdfdGltZV9zZWMsIHR6PXRpbWV6b25lLnV0YykuYXN0aW1lem9uZSgpCiAgICBzZXR0bGVtZW50X3BheWxvYWRbInRpbWVzdGFtcCJdID0gdHNfdG9fc2lnbgoKICAgIGJvZHkgPSBlbmNyeXB0ZWRfcGF5bG9hZFsiZW5jcnlwdGVkX2JvZHkiXQoKICAgIHhfc2lnID0gZ2V0X3hfc2lnbmF0dXJlX2JvdW50eSgKICAgICAgICBhcGlfa2V5PWFwaV9rZXksCiAgICAgICAgYWNjZXNzX3Rva2VuPXRva2Vuc1siYWNjZXNzX3Rva2VuIl0sCiAgICAgICAgc2lnX3RpbWVfc2VjPXRzX3RvX3NpZ24sCiAgICAgICAgcGFja2FnZV9jb2RlPXBheW1lbnRfdGFyZ2V0LAogICAgICAgIHRva2VuX3BheW1lbnQ9dG9rZW5fY29uZmlybWF0aW9uCiAgICApCgogICAgaGVhZGVycyA9IHsKICAgICAgICAiaG9zdCI6IEJBU0VfQVBJX1VSTC5yZXBsYWNlKCJodHRwczovLyIsICIiKSwKICAgICAgICAiY29udGVudC10eXBlIjogImFwcGxpY2F0aW9uL2pzb247IGNoYXJzZXQ9dXRmLTgiLAogICAgICAgICJ1c2VyLWFnZW50IjogVUEsCiAgICAgICAgIngtYXBpLWtleSI6IEFQSV9LRVksCiAgICAgICAgImF1dGhvcml6YXRpb24iOiBmIkJlYXJlciB7dG9rZW5zWydpZF90b2tlbiddfSIsCiAgICAgICAgIngtaHYiOiAidjMiLAogICAgICAgICJ4LXNpZ25hdHVyZS10aW1lIjogc3RyKHNpZ190aW1lX3NlYyksCiAgICAgICAgIngtc2lnbmF0dXJlIjogeF9zaWcsCiAgICAgICAgIngtcmVxdWVzdC1pZCI6IHN0cih1dWlkLnV1aWQ0KCkpLAogICAgICAgICJ4LXJlcXVlc3QtYXQiOiBqYXZhX2xpa2VfdGltZXN0YW1wKHhfcmVxdWVzdGVkX2F0KSwKICAgICAgICAieC12ZXJzaW9uLWFwcCI6ICI4LjguMCIsCiAgICB9CgogICAgdXJsID0gZiJ7QkFTRV9BUElfVVJMfS97cGF0aH0iCiAgICBwcmludCgiU2VuZGluZyBib3VudHkgcmVxdWVzdC4uLiIpCiAgICByZXNwID0gcmVxdWVzdHMucG9zdCh1cmwsIGhlYWRlcnM9aGVhZGVycywgZGF0YT1qc29uLmR1bXBzKGJvZHkpLCB0aW1lb3V0PTMwKQoKICAgIHRyeToKICAgICAgICBkZWNyeXB0ZWRfYm9keSA9IGRlY3J5cHRfeGRhdGEoYXBpX2tleSwganNvbi5sb2FkcyhyZXNwLnRleHQpKQogICAgICAgIGlmIGRlY3J5cHRlZF9ib2R5WyJzdGF0dXMiXSAhPSAiU1VDQ0VTUyI6CiAgICAgICAgICAgIHByaW50KCJGYWlsZWQgdG8gY2xhaW0gYm91bnR5LiIpCiAgICAgICAgICAgIHByaW50KGYiRXJyb3I6IHtkZWNyeXB0ZWRfYm9keX0iKQogICAgICAgICAgICByZXR1cm4gTm9uZQoKICAgICAgICBwcmludChkZWNyeXB0ZWRfYm9keSkKCiAgICAgICAgcmV0dXJuIGRlY3J5cHRlZF9ib2R5CiAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgcHJpbnQoIltkZWNyeXB0IGVycl0iLCBlKQogICAgICAgIHJldHVybiByZXNwLnRleHQKCgpkZWYgc2V0dGxlbWVudF9sb3lhbHR5KAogICAgICAgIGFwaV9rZXk6IHN0ciwKICAgICAgICB0b2tlbnM6IGRpY3QsCiAgICAgICAgdG9rZW5fY29uZmlybWF0aW9uOiBzdHIsCiAgICAgICAgdHNfdG9fc2lnbjogaW50LAogICAgICAgIHBheW1lbnRfdGFyZ2V0OiBzdHIsCiAgICAgICAgcHJpY2U6IGludCwKKToKICAgICMgU2V0dGxlbWVudCByZXVlc3QKICAgIHBhdGggPSAiZ2FtaWZpY2F0aW9uL2FwaS92OC9sb3lhbHRpZXMvdGllcmluZy9leGNoYW5nZSIKICAgIHNldHRsZW1lbnRfcGF5bG9hZCA9IHsKICAgICAgICAiaXRlbV9jb2RlIjogcGF5bWVudF90YXJnZXQsCiAgICAgICAgImFtb3VudCI6IDAsCiAgICAgICAgInBhcnRuZXIiOiAiIiwKICAgICAgICAiaXNfZW50ZXJwcmlzZSI6IEZhbHNlLAogICAgICAgICJpdGVtX25hbWUiOiAiIiwKICAgICAgICAibGFuZyI6ICJlbiIsCiAgICAgICAgInBvaW50cyI6IHByaWNlLAogICAgICAgICJ0aW1lc3RhbXAiOiB0c190b19zaWduLAogICAgICAgICJ0b2tlbl9jb25maXJtYXRpb24iOiB0b2tlbl9jb25maXJtYXRpb24KICAgIH0KCiAgICBlbmNyeXB0ZWRfcGF5bG9hZCA9IGVuY3J5cHRzaWduX3hkYXRhKAogICAgICAgIGFwaV9rZXk9YXBpX2tleSwKICAgICAgICBtZXRob2Q9IlBPU1QiLAogICAgICAgIHBhdGg9cGF0aCwKICAgICAgICBpZF90b2tlbj10b2tlbnNbImlkX3Rva2VuIl0sCiAgICAgICAgcGF5bG9hZD1zZXR0bGVtZW50X3BheWxvYWQKICAgICkKCiAgICB4dGltZSA9IGludChlbmNyeXB0ZWRfcGF5bG9hZFsiZW5jcnlwdGVkX2JvZHkiXVsieHRpbWUiXSkKICAgIHNpZ190aW1lX3NlYyA9ICh4dGltZSAvLyAxMDAwKQogICAgeF9yZXF1ZXN0ZWRfYXQgPSBkYXRldGltZS5mcm9tdGltZXN0YW1wKHNpZ190aW1lX3NlYywgdHo9dGltZXpvbmUudXRjKS5hc3RpbWV6b25lKCkKICAgIHNldHRsZW1lbnRfcGF5bG9hZFsidGltZXN0YW1wIl0gPSB0c190b19zaWduCgogICAgYm9keSA9IGVuY3J5cHRlZF9wYXlsb2FkWyJlbmNyeXB0ZWRfYm9keSJdCgogICAgeF9zaWcgPSBnZXRfeF9zaWduYXR1cmVfbG95YWx0eSgKICAgICAgICBhcGlfa2V5PWFwaV9rZXksCiAgICAgICAgc2lnX3RpbWVfc2VjPXRzX3RvX3NpZ24sCiAgICAgICAgcGFja2FnZV9jb2RlPXBheW1lbnRfdGFyZ2V0LAogICAgICAgIHRva2VuX2NvbmZpcm1hdGlvbj10b2tlbl9jb25maXJtYXRpb24sCiAgICAgICAgcGF0aD1wYXRoCiAgICApCgogICAgaGVhZGVycyA9IHsKICAgICAgICAiaG9zdCI6IEJBU0VfQVBJX1VSTC5yZXBsYWNlKCJodHRwczovLyIsICIiKSwKICAgICAgICAiY29udGVudC10eXBlIjogImFwcGxpY2F0aW9uL2pzb247IGNoYXJzZXQ9dXRmLTgiLAogICAgICAgICJ1c2VyLWFnZW50IjogVUEsCiAgICAgICAgIngtYXBpLWtleSI6IEFQSV9LRVksCiAgICAgICAgImF1dGhvcml6YXRpb24iOiBmIkJlYXJlciB7dG9rZW5zWydpZF90b2tlbiddfSIsCiAgICAgICAgIngtaHYiOiAidjMiLAogICAgICAgICJ4LXNpZ25hdHVyZS10aW1lIjogc3RyKHNpZ190aW1lX3NlYyksCiAgICAgICAgIngtc2lnbmF0dXJlIjogeF9zaWcsCiAgICAgICAgIngtcmVxdWVzdC1pZCI6IHN0cih1dWlkLnV1aWQ0KCkpLAogICAgICAgICJ4LXJlcXVlc3QtYXQiOiBqYXZhX2xpa2VfdGltZXN0YW1wKHhfcmVxdWVzdGVkX2F0KSwKICAgICAgICAieC12ZXJzaW9uLWFwcCI6ICI4LjguMCIsCiAgICB9CgogICAgdXJsID0gZiJ7QkFTRV9BUElfVVJMfS97cGF0aH0iCiAgICBwcmludCgiU2VuZGluZyBsb3lhbHR5IHJlcXVlc3QuLi4iKQogICAgcmVzcCA9IHJlcXVlc3RzLnBvc3QodXJsLCBoZWFkZXJzPWhlYWRlcnMsIGRhdGE9anNvbi5kdW1wcyhib2R5KSwgdGltZW91dD0zMCkKCiAgICB0cnk6CiAgICAgICAgZGVjcnlwdGVkX2JvZHkgPSBkZWNyeXB0X3hkYXRhKGFwaV9rZXksIGpzb24ubG9hZHMocmVzcC50ZXh0KSkKICAgICAgICBpZiBkZWNyeXB0ZWRfYm9keVsic3RhdHVzIl0gIT0gIlNVQ0NFU1MiOgogICAgICAgICAgICBwcmludCgiRmFpbGVkIHB1cmNoYXNlLiIpCiAgICAgICAgICAgIHByaW50KGYiRXJyb3I6IHtkZWNyeXB0ZWRfYm9keX0iKQogICAgICAgICAgICByZXR1cm4gTm9uZQoKICAgICAgICBwcmludChkZWNyeXB0ZWRfYm9keSkKCiAgICAgICAgcmV0dXJuIGRlY3J5cHRlZF9ib2R5CiAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgcHJpbnQoIltkZWNyeXB0IGVycl0iLCBlKQogICAgICAgIHJldHVybiByZXNwLnRleHQK').decode())
