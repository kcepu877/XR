#!/usr/bin/env python3
import base64
exec(base64.b64decode('IyBDSVJDTEUKZnJvbSBhcHAuY2xpZW50LmVuZ3NlbCBpbXBvcnQgc2VuZF9hcGlfcmVxdWVzdApmcm9tIGFwcC5jbGllbnQuZW5jcnlwdCBpbXBvcnQgZW5jcnlwdF9jaXJjbGVfbXNpc2RuCgpkZWYgZ2V0X2dyb3VwX2RhdGEoCiAgICBhcGlfa2V5OiBzdHIsCiAgICB0b2tlbnM6IGRpY3QsCikgLT4gZGljdDoKICAgIHBhdGggPSAiZmFtaWx5LWh1Yi9hcGkvdjgvZ3JvdXBzL3N0YXR1cyIKCiAgICByYXdfcGF5bG9hZCA9IHsKICAgICAgICAiaXNfZW50ZXJwcmlzZSI6IEZhbHNlLAogICAgICAgICJsYW5nIjogImVuIgogICAgfQoKICAgIHByaW50KCJGZXRjaGluZyBncm91cCBkZXRhaWwuLi4iKQogICAgcmVzID0gc2VuZF9hcGlfcmVxdWVzdChhcGlfa2V5LCBwYXRoLCByYXdfcGF5bG9hZCwgdG9rZW5zWyJpZF90b2tlbiJdLCAiUE9TVCIpCgogICAgcmV0dXJuIHJlcwoKZGVmIGdldF9ncm91cF9tZW1iZXJzKAogICAgYXBpX2tleTogc3RyLAogICAgdG9rZW5zOiBkaWN0LAogICAgZ3JvdXBfaWQ6IHN0ciwKKSAtPiBkaWN0OgogICAgcGF0aCA9ICJmYW1pbHktaHViL2FwaS92OC9tZW1iZXJzL2luZm8iCgogICAgcmF3X3BheWxvYWQgPSB7CiAgICAgICAgImdyb3VwX2lkIjogZ3JvdXBfaWQsCiAgICAgICAgImlzX2VudGVycHJpc2UiOiBGYWxzZSwKICAgICAgICAibGFuZyI6ICJlbiIKICAgIH0KCiAgICBwcmludCgiRmV0Y2hpbmcgZ3JvdXAgbWVtYmVycy4uLiIpCiAgICByZXMgPSBzZW5kX2FwaV9yZXF1ZXN0KGFwaV9rZXksIHBhdGgsIHJhd19wYXlsb2FkLCB0b2tlbnNbImlkX3Rva2VuIl0sICJQT1NUIikKCiAgICByZXR1cm4gcmVzCgpkZWYgdmFsaWRhdGVfY2lyY2xlX21lbWJlcigKICAgIGFwaV9rZXk6IHN0ciwKICAgIHRva2VuczogZGljdCwKICAgIG1zaXNkbjogc3RyLAopIC0+IGRpY3Q6CiAgICBwYXRoID0gImZhbWlseS1odWIvYXBpL3Y4L21lbWJlcnMvdmFsaWRhdGUiCiAgICAKICAgIGVuY3J5cHRlZF9tc2lzZG4gPSBlbmNyeXB0X2NpcmNsZV9tc2lzZG4oYXBpX2tleSwgbXNpc2RuKQoKICAgIHJhd19wYXlsb2FkID0gewogICAgICAgICJtc2lzZG4iOiBlbmNyeXB0ZWRfbXNpc2RuLAogICAgICAgICJpc19lbnRlcnByaXNlIjogRmFsc2UsCiAgICAgICAgImxhbmciOiAiZW4iCiAgICB9CgogICAgcHJpbnQoZiJWYWxpZGF0aW5nIHttc2lzZG59Li4uIikKICAgIHJlcyA9IHNlbmRfYXBpX3JlcXVlc3QoYXBpX2tleSwgcGF0aCwgcmF3X3BheWxvYWQsIHRva2Vuc1siaWRfdG9rZW4iXSwgIlBPU1QiKQoKICAgIHJldHVybiByZXMKCmRlZiBpbnZpdGVfY2lyY2xlX21lbWJlcigKICAgIGFwaV9rZXk6IHN0ciwKICAgIHRva2VuczogZGljdCwKICAgIG1zaXNkbjogc3RyLAogICAgbmFtZTogc3RyLAogICAgZ3JvdXBfaWQ6IHN0ciwKICAgIG1lbWJlcl9pZF9wYXJlbnQ6IHN0ciwKKSAtPiBkaWN0OgogICAgcGF0aCA9ICJmYW1pbHktaHViL2FwaS92OC9tZW1iZXJzL2ludml0ZSIKICAgIAogICAgZW5jcnlwdGVkX21zaXNkbiA9IGVuY3J5cHRfY2lyY2xlX21zaXNkbihhcGlfa2V5LCBtc2lzZG4pCiAgICBwcmludChmIkVuY3J5cHRlZCBNU0lTRE46IHtlbmNyeXB0ZWRfbXNpc2RufSIpCgogICAgcmF3X3BheWxvYWQgPSB7CiAgICAgICAgImFjY2Vzc190b2tlbiI6IHRva2Vuc1siYWNjZXNzX3Rva2VuIl0sCiAgICAgICAgImdyb3VwX2lkIjogZ3JvdXBfaWQsCiAgICAgICAgImlzX2VudGVycHJpc2UiOiBGYWxzZSwKICAgICAgICAibWVtYmVycyI6IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgIm1zaXNkbiI6IGVuY3J5cHRlZF9tc2lzZG4sCiAgICAgICAgICAgICAgICAibmFtZSI6IG5hbWUKICAgICAgICAgICAgfSAgICAKICAgICAgICBdLAogICAgICAgICJsYW5nIjogImVuIiwKICAgICAgICAibWVtYmVyX2lkX3BhcmVudCI6IG1lbWJlcl9pZF9wYXJlbnQKICAgIH0KICAgIAogICAgcHJpbnQoZiJJbnZpdGluZyB7bXNpc2RufS4uLiIpCiAgICByZXMgPSBzZW5kX2FwaV9yZXF1ZXN0KGFwaV9rZXksIHBhdGgsIHJhd19wYXlsb2FkLCB0b2tlbnNbImlkX3Rva2VuIl0sICJQT1NUIikKCiAgICByZXR1cm4gcmVzCgpkZWYgcmVtb3ZlX2NpcmNsZV9tZW1iZXIoCiAgICBhcGlfa2V5OiBzdHIsCiAgICB0b2tlbnM6IGRpY3QsCiAgICBtZW1iZXJfaWQ6IHN0ciwKICAgIGdyb3VwX2lkOiBzdHIsCiAgICBtZW1iZXJfaWRfcGFyZW50OiBzdHIsCiAgICBpc19sYXN0X21lbWJlcjogYm9vbCA9IEZhbHNlLAopIC0+IGRpY3Q6CiAgICBwYXRoID0gImZhbWlseS1odWIvYXBpL3Y4L21lbWJlcnMvcmVtb3ZlIgoKICAgIHJhd19wYXlsb2FkID0gewogICAgICAgICJtZW1iZXJfaWQiOiBtZW1iZXJfaWQsCiAgICAgICAgImdyb3VwX2lkIjogZ3JvdXBfaWQsCiAgICAgICAgImlzX2VudGVycHJpc2UiOiBGYWxzZSwKICAgICAgICAiaXNfbGFzdF9tZW1iZXIiOiBpc19sYXN0X21lbWJlciwKICAgICAgICAibGFuZyI6ICJlbiIsCiAgICAgICAgIm1lbWJlcl9pZF9wYXJlbnQiOiBtZW1iZXJfaWRfcGFyZW50CiAgICB9CiAgICAKICAgIHByaW50KGYiUmVtb3ZpbmcgbWVtYmVyIHttZW1iZXJfaWR9IGZyb20gQ2lyY2xlLi4uIikKICAgIHJlcyA9IHNlbmRfYXBpX3JlcXVlc3QoYXBpX2tleSwgcGF0aCwgcmF3X3BheWxvYWQsIHRva2Vuc1siaWRfdG9rZW4iXSwgIlBPU1QiKQogICAgcmV0dXJuIHJlcwoKZGVmIGFjY2VwdF9jaXJjbGVfaW52aXRhdGlvbigKICAgIGFwaV9rZXk6IHN0ciwKICAgIHRva2VuczogZGljdCwKICAgIGdyb3VwX2lkOiBzdHIsCiAgICBtZW1iZXJfaWQ6IHN0ciwKKSAtPiBkaWN0OgogICAgcGF0aCA9ICJmYW1pbHktaHViL2FwaS92OC9ncm91cHMvYWNjZXB0LWludml0YXRpb24iCgogICAgcmF3X3BheWxvYWQgPSB7CiAgICAgICAgImFjY2Vzc190b2tlbiI6IHRva2Vuc1siYWNjZXNzX3Rva2VuIl0sCiAgICAgICAgImdyb3VwX2lkIjogZ3JvdXBfaWQsCiAgICAgICAgIm1lbWJlcl9pZCI6IG1lbWJlcl9pZCwKICAgICAgICAiaXNfZW50ZXJwcmlzZSI6IEZhbHNlLAogICAgICAgICJsYW5nIjogImVuIgogICAgfQoKICAgIHByaW50KGYiQWNjZXB0aW5nIGludml0YXRpb24gdG8gQ2lyY2xlIHtncm91cF9pZH0uLi4iKQogICAgcmVzID0gc2VuZF9hcGlfcmVxdWVzdChhcGlfa2V5LCBwYXRoLCByYXdfcGF5bG9hZCwgdG9rZW5zWyJpZF90b2tlbiJdLCAiUE9TVCIpCgogICAgcmV0dXJuIHJlcwoKZGVmIGNyZWF0ZV9jaXJjbGUoCiAgICBhcGlfa2V5OiBzdHIsCiAgICB0b2tlbnM6IGRpY3QsCiAgICBwYXJlbnRfbmFtZTogc3RyLAogICAgZ3JvdXBfbmFtZTogc3RyLAogICAgbWVtYmVyX21zaXNkbjogc3RyLAogICAgbWVtYmVyX25hbWU6IHN0ciwKKSAtPiBkaWN0OgogICAgcGF0aCA9ICJmYW1pbHktaHViL2FwaS92OC9ncm91cHMvY3JlYXRlIgoKICAgIHJhd19wYXlsb2FkID0gewogICAgICAgICJhY2Nlc3NfdG9rZW4iOiB0b2tlbnNbImFjY2Vzc190b2tlbiJdLAogICAgICAgICJwYXJlbnRfbmFtZSI6IHBhcmVudF9uYW1lLAogICAgICAgICJncm91cF9uYW1lIjogZ3JvdXBfbmFtZSwKICAgICAgICAiaXNfZW50ZXJwcmlzZSI6IEZhbHNlLAogICAgICAgICJtZW1iZXJzIjogWwogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAibXNpc2RuIjogZW5jcnlwdF9jaXJjbGVfbXNpc2RuKGFwaV9rZXksIG1lbWJlcl9tc2lzZG4pLAogICAgICAgICAgICAgICAgIm5hbWUiOiBtZW1iZXJfbmFtZQogICAgICAgICAgICB9CiAgICAgICAgXSwKICAgICAgICAibGFuZyI6ICJlbiIsCiAgICB9CiAgICAKICAgIHByaW50KGYiQ3JlYXRpbmcgQ2lyY2xlIHdpdGggbWVtYmVyIHttZW1iZXJfbXNpc2RufS4uLiIpCiAgICByZXMgPSBzZW5kX2FwaV9yZXF1ZXN0KGFwaV9rZXksIHBhdGgsIHJhd19wYXlsb2FkLCB0b2tlbnNbImlkX3Rva2VuIl0sICJQT1NUIikKICAgIAogICAgcmV0dXJuIHJlcwoKZGVmIHNwZW5kaW5nX3RyYWNrZXIoCiAgICBhcGlfa2V5OiBzdHIsCiAgICB0b2tlbnM6IGRpY3QsCiAgICBwYXJlbnRfc3Vic19pZDogc3RyLAogICAgZmFtaWx5X2lkOiBzdHIsCikgLT4gZGljdDoKICAgIHBhdGggPSAiZ2FtaWZpY2F0aW9uL2FwaS92OC9mYW1pbHktaHViL3NwZW5kaW5nLXRyYWNrZXIiCgogICAgcmF3X3BheWxvYWQgPSB7CiAgICAgICAgImlzX2VudGVycHJpc2UiOiBGYWxzZSwKICAgICAgICAicGFyZW50X3N1YnNfaWQiOiBwYXJlbnRfc3Vic19pZCwKICAgICAgICAiZmFtaWx5X2lkIjogZmFtaWx5X2lkLAogICAgICAgICJsYW5nIjogImVuIgogICAgfQoKICAgIHJlcyA9IHNlbmRfYXBpX3JlcXVlc3QoYXBpX2tleSwgcGF0aCwgcmF3X3BheWxvYWQsIHRva2Vuc1siaWRfdG9rZW4iXSwgIlBPU1QiKQoKICAgIHJldHVybiByZXMKCmRlZiBnZXRfYm9udXNfZGF0YSgKICAgIGFwaV9rZXk6IHN0ciwKICAgIHRva2VuczogZGljdCwKICAgIHBhcmVudF9zdWJzX2lkOiBzdHIsCiAgICBmYW1pbHlfaWQ6IHN0ciwKKSAtPiBkaWN0OgogICAgcGF0aCA9ICJnYW1pZmljYXRpb24vYXBpL3Y4L2ZhbWlseS1odWIvYm9udXMvbGlzdCIKCiAgICByYXdfcGF5bG9hZCA9IHsKICAgICAgICAiaXNfZW50ZXJwcmlzZSI6IEZhbHNlLAogICAgICAgICJwYXJlbnRfc3Vic19pZCI6IHBhcmVudF9zdWJzX2lkLAogICAgICAgICJmYW1pbHlfaWQiOiBmYW1pbHlfaWQsCiAgICAgICAgImxhbmciOiAiZW4iCiAgICB9CgogICAgcmVzID0gc2VuZF9hcGlfcmVxdWVzdChhcGlfa2V5LCBwYXRoLCByYXdfcGF5bG9hZCwgdG9rZW5zWyJpZF90b2tlbiJdLCAiUE9TVCIpCgogICAgcmV0dXJuIHJlcwo=').decode())
