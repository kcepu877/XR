#!/usr/bin/env python3
import base64
exec(base64.b64decode('aW1wb3J0IGpzb24KaW1wb3J0IHRpbWUKaW1wb3J0IHV1aWQKZnJvbSBkYXRldGltZSBpbXBvcnQgZGF0ZXRpbWUsIHRpbWV6b25lCgppbXBvcnQgcmVxdWVzdHMKCmZyb20gYXBwLmNsaWVudC5lbmNyeXB0IGltcG9ydCBBUElfS0VZLCBkZWNyeXB0X3hkYXRhLCBlbmNyeXB0c2lnbl94ZGF0YSwgamF2YV9saWtlX3RpbWVzdGFtcCwgZ2V0X3hfc2lnbmF0dXJlX3BheW1lbnQKZnJvbSBhcHAuY2xpZW50LmVuZ3NlbCBpbXBvcnQgQkFTRV9BUElfVVJMLCBVQSwgaW50ZXJjZXB0X3BhZ2UsIHNlbmRfYXBpX3JlcXVlc3QKZnJvbSBhcHAudHlwZV9kaWN0IGltcG9ydCBQYXltZW50SXRlbQoKCmRlZiBzZXR0bGVtZW50X211bHRpcGF5bWVudCgKICAgICAgICBhcGlfa2V5OiBzdHIsCiAgICAgICAgdG9rZW5zOiBkaWN0LAogICAgICAgIGl0ZW1zOiBsaXN0W1BheW1lbnRJdGVtXSwKICAgICAgICB3YWxsZXRfbnVtYmVyOiBzdHIsCiAgICAgICAgcGF5bWVudF9tZXRob2QsCiAgICAgICAgcGF5bWVudF9mb3IsCiAgICAgICAgYXNrX292ZXJ3cml0ZTogYm9vbCwKICAgICAgICBvdmVyd3JpdGVfYW1vdW50OiBpbnQgPSAtMSwKICAgICAgICB0b2tlbl9jb25maXJtYXRpb25faWR4OiBpbnQgPSAwLAogICAgICAgIGFtb3VudF9pZHg6IGludCA9IC0xLAopOgogICAgIyBTYW5pdHkgY2hlY2sKICAgIGlmIG92ZXJ3cml0ZV9hbW91bnQgPT0gLTEgYW5kIG5vdCBhc2tfb3ZlcndyaXRlOgogICAgICAgIHByaW50KCJFaXRoZXIgYXNrX292ZXJ3cml0ZSBtdXN0IGJlIFRydWUgb3Igb3ZlcndyaXRlX2Ftb3VudCBtdXN0IGJlIHNldC4iKQogICAgICAgIHJldHVybiBOb25lCgogICAgdG9rZW5fY29uZmlybWF0aW9uID0gaXRlbXNbdG9rZW5fY29uZmlybWF0aW9uX2lkeF1bInRva2VuX2NvbmZpcm1hdGlvbiJdCiAgICBwYXltZW50X3RhcmdldHMgPSAiIgogICAgZm9yIGl0ZW0gaW4gaXRlbXM6CiAgICAgICAgaWYgcGF5bWVudF90YXJnZXRzICE9ICIiOgogICAgICAgICAgICBwYXltZW50X3RhcmdldHMgKz0gIjsiCiAgICAgICAgcGF5bWVudF90YXJnZXRzICs9IGl0ZW1bIml0ZW1fY29kZSJdCgogICAgYW1vdW50X2ludCA9IDAKCiAgICAjIERldGVybWluZSBhbW91bnQgdG8gdXNlCiAgICBpZiBvdmVyd3JpdGVfYW1vdW50ICE9IC0xOgogICAgICAgIGFtb3VudF9pbnQgPSBvdmVyd3JpdGVfYW1vdW50CiAgICBlbGlmIGFtb3VudF9pZHggPT0gLTE6CiAgICAgICAgYW1vdW50X2ludCA9IGl0ZW1zW2Ftb3VudF9pZHhdWyJpdGVtX3ByaWNlIl0KCiAgICAjIElmIE92ZXJ3cml0ZQogICAgaWYgYXNrX292ZXJ3cml0ZToKICAgICAgICBwcmludChmIlRvdGFsIGFtb3VudCBpcyB7YW1vdW50X2ludH0uXG5FbnRlciBuZXcgYW1vdW50IGlmIHlvdSBuZWVkIHRvIG92ZXJ3cml0ZS4iKQogICAgICAgIGFtb3VudF9zdHIgPSBpbnB1dCgiUHJlc3MgZW50ZXIgdG8gaWdub3JlICYgdXNlIGRlZmF1bHQgYW1vdW50OiAiKQogICAgICAgIGlmIGFtb3VudF9zdHIgIT0gIiI6CiAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgIGFtb3VudF9pbnQgPSBpbnQoYW1vdW50X3N0cikKICAgICAgICAgICAgZXhjZXB0IFZhbHVlRXJyb3I6CiAgICAgICAgICAgICAgICBwcmludCgiSW52YWxpZCBvdmVyd3JpdGUgaW5wdXQsIHVzaW5nIG9yaWdpbmFsIHByaWNlLiIpCiAgICAgICAgICAgICAgICAjIHJldHVybiBOb25lCgogICAgaW50ZXJjZXB0X3BhZ2UoYXBpX2tleSwgdG9rZW5zLCBpdGVtc1swXVsiaXRlbV9jb2RlIl0sIEZhbHNlKQoKICAgICMgR2V0IHBheW1lbnQgbWV0aG9kcwogICAgcGF5bWVudF9wYXRoID0gInBheW1lbnRzL2FwaS92OC9wYXltZW50LW1ldGhvZHMtb3B0aW9uIgogICAgcGF5bWVudF9wYXlsb2FkID0gewogICAgICAgICJwYXltZW50X3R5cGUiOiAiUFVSQ0hBU0UiLAogICAgICAgICJpc19lbnRlcnByaXNlIjogRmFsc2UsCiAgICAgICAgInBheW1lbnRfdGFyZ2V0IjogaXRlbXNbdG9rZW5fY29uZmlybWF0aW9uX2lkeF1bIml0ZW1fY29kZSJdLAogICAgICAgICJsYW5nIjogImVuIiwKICAgICAgICAiaXNfcmVmZXJyYWwiOiBGYWxzZSwKICAgICAgICAidG9rZW5fY29uZmlybWF0aW9uIjogdG9rZW5fY29uZmlybWF0aW9uCiAgICB9CgogICAgcHJpbnQoIkdldHRpbmcgcGF5bWVudCBtZXRob2RzLi4uIikKICAgIHBheW1lbnRfcmVzID0gc2VuZF9hcGlfcmVxdWVzdChhcGlfa2V5LCBwYXltZW50X3BhdGgsIHBheW1lbnRfcGF5bG9hZCwgdG9rZW5zWyJpZF90b2tlbiJdLCAiUE9TVCIpCiAgICBpZiBwYXltZW50X3Jlc1sic3RhdHVzIl0gIT0gIlNVQ0NFU1MiOgogICAgICAgIHByaW50KCJGYWlsZWQgdG8gZmV0Y2ggcGF5bWVudCBtZXRob2RzLiIpCiAgICAgICAgcHJpbnQoZiJFcnJvcjoge3BheW1lbnRfcmVzfSIpCiAgICAgICAgcmV0dXJuIE5vbmUKCiAgICB0b2tlbl9wYXltZW50ID0gcGF5bWVudF9yZXNbImRhdGEiXVsidG9rZW5fcGF5bWVudCJdCiAgICB0c190b19zaWduID0gcGF5bWVudF9yZXNbImRhdGEiXVsidGltZXN0YW1wIl0KCiAgICAjIFNldHRsZW1lbnQgcmVxdWVzdAogICAgcGF0aCA9ICJwYXltZW50cy9hcGkvdjgvc2V0dGxlbWVudC1tdWx0aXBheW1lbnQvZXdhbGxldCIKICAgIHNldHRsZW1lbnRfcGF5bG9hZCA9IHsKICAgICAgICAiYWtyYWIiOiB7CiAgICAgICAgICAgICJha3JhYl9tZW1iZXJzIjogW10sCiAgICAgICAgICAgICJha3JhYl9wYXJlbnRfYWxpYXMiOiAiIiwKICAgICAgICAgICAgIm1lbWJlcnMiOiBbXQogICAgICAgIH0sCiAgICAgICAgImNhbl90cmlnZ2VyX3JhdGluZyI6IEZhbHNlLAogICAgICAgICJ0b3RhbF9kaXNjb3VudCI6IDAsCiAgICAgICAgImNvdXBvbiI6ICIiLAogICAgICAgICJwYXltZW50X2ZvciI6IHBheW1lbnRfZm9yLAogICAgICAgICJ0b3B1cF9udW1iZXIiOiAiIiwKICAgICAgICAiaXNfZW50ZXJwcmlzZSI6IEZhbHNlLAogICAgICAgICJhdXRvYnV5IjogewogICAgICAgICAgICAiaXNfdXNpbmdfYXV0b2J1eSI6IEZhbHNlLAogICAgICAgICAgICAiYWN0aXZhdGVkX2F1dG9idXlfY29kZSI6ICIiLAogICAgICAgICAgICAiYXV0b2J1eV90aHJlc2hvbGRfc2V0dGluZyI6IHsKICAgICAgICAgICAgICAgICJsYWJlbCI6ICIiLAogICAgICAgICAgICAgICAgInR5cGUiOiAiIiwKICAgICAgICAgICAgICAgICJ2YWx1ZSI6IDAKICAgICAgICAgICAgfQogICAgICAgIH0sCiAgICAgICAgImNjX3BheW1lbnRfdHlwZSI6ICIiLAogICAgICAgICJhY2Nlc3NfdG9rZW4iOiB0b2tlbnNbImFjY2Vzc190b2tlbiJdLAogICAgICAgICJpc19teXhsX3dhbGxldCI6IEZhbHNlLAogICAgICAgICJ3YWxsZXRfbnVtYmVyIjogd2FsbGV0X251bWJlciwKICAgICAgICAiYWRkaXRpb25hbF9kYXRhIjoge30sCiAgICAgICAgInRvdGFsX2Ftb3VudCI6IGFtb3VudF9pbnQsCiAgICAgICAgInRvdGFsX2ZlZSI6IDAsCiAgICAgICAgImlzX3VzZV9wb2ludCI6IEZhbHNlLAogICAgICAgICJsYW5nIjogImVuIiwKICAgICAgICAiaXRlbXMiOiBpdGVtcywKICAgICAgICAidmVyaWZpY2F0aW9uX3Rva2VuIjogdG9rZW5fcGF5bWVudCwKICAgICAgICAicGF5bWVudF9tZXRob2QiOiBwYXltZW50X21ldGhvZCwKICAgICAgICAidGltZXN0YW1wIjogaW50KHRpbWUudGltZSgpKQogICAgfQoKICAgIGVuY3J5cHRlZF9wYXlsb2FkID0gZW5jcnlwdHNpZ25feGRhdGEoCiAgICAgICAgYXBpX2tleT1hcGlfa2V5LAogICAgICAgIG1ldGhvZD0iUE9TVCIsCiAgICAgICAgcGF0aD1wYXRoLAogICAgICAgIGlkX3Rva2VuPXRva2Vuc1siaWRfdG9rZW4iXSwKICAgICAgICBwYXlsb2FkPXNldHRsZW1lbnRfcGF5bG9hZAogICAgKQoKICAgIHh0aW1lID0gaW50KGVuY3J5cHRlZF9wYXlsb2FkWyJlbmNyeXB0ZWRfYm9keSJdWyJ4dGltZSJdKQogICAgc2lnX3RpbWVfc2VjID0gKHh0aW1lIC8vIDEwMDApCiAgICB4X3JlcXVlc3RlZF9hdCA9IGRhdGV0aW1lLmZyb210aW1lc3RhbXAoc2lnX3RpbWVfc2VjLCB0ej10aW1lem9uZS51dGMpLmFzdGltZXpvbmUoKQogICAgc2V0dGxlbWVudF9wYXlsb2FkWyJ0aW1lc3RhbXAiXSA9IHRzX3RvX3NpZ24KCiAgICBib2R5ID0gZW5jcnlwdGVkX3BheWxvYWRbImVuY3J5cHRlZF9ib2R5Il0KICAgIHhfc2lnID0gZ2V0X3hfc2lnbmF0dXJlX3BheW1lbnQoCiAgICAgICAgYXBpX2tleSwKICAgICAgICB0b2tlbnNbImFjY2Vzc190b2tlbiJdLAogICAgICAgIHRzX3RvX3NpZ24sCiAgICAgICAgcGF5bWVudF90YXJnZXRzLAogICAgICAgIHRva2VuX3BheW1lbnQsCiAgICAgICAgcGF5bWVudF9tZXRob2QsCiAgICAgICAgcGF5bWVudF9mb3IsCiAgICAgICAgcGF0aAogICAgKQoKICAgIGhlYWRlcnMgPSB7CiAgICAgICAgImhvc3QiOiBCQVNFX0FQSV9VUkwucmVwbGFjZSgiaHR0cHM6Ly8iLCAiIiksCiAgICAgICAgImNvbnRlbnQtdHlwZSI6ICJhcHBsaWNhdGlvbi9qc29uOyBjaGFyc2V0PXV0Zi04IiwKICAgICAgICAidXNlci1hZ2VudCI6IFVBLAogICAgICAgICJ4LWFwaS1rZXkiOiBBUElfS0VZLAogICAgICAgICJhdXRob3JpemF0aW9uIjogZiJCZWFyZXIge3Rva2Vuc1snaWRfdG9rZW4nXX0iLAogICAgICAgICJ4LWh2IjogInYzIiwKICAgICAgICAieC1zaWduYXR1cmUtdGltZSI6IHN0cihzaWdfdGltZV9zZWMpLAogICAgICAgICJ4LXNpZ25hdHVyZSI6IHhfc2lnLAogICAgICAgICJ4LXJlcXVlc3QtaWQiOiBzdHIodXVpZC51dWlkNCgpKSwKICAgICAgICAieC1yZXF1ZXN0LWF0IjogamF2YV9saWtlX3RpbWVzdGFtcCh4X3JlcXVlc3RlZF9hdCksCiAgICAgICAgIngtdmVyc2lvbi1hcHAiOiAiOC44LjAiLAogICAgfQoKICAgIHVybCA9IGYie0JBU0VfQVBJX1VSTH0ve3BhdGh9IgogICAgcHJpbnQoIlNlbmRpbmcgc2V0dGxlbWVudCByZXF1ZXN0Li4uIikKICAgIHJlc3AgPSByZXF1ZXN0cy5wb3N0KHVybCwgaGVhZGVycz1oZWFkZXJzLCBkYXRhPWpzb24uZHVtcHMoYm9keSksIHRpbWVvdXQ9MzApCgogICAgdHJ5OgogICAgICAgIGRlY3J5cHRlZF9ib2R5ID0gZGVjcnlwdF94ZGF0YShhcGlfa2V5LCBqc29uLmxvYWRzKHJlc3AudGV4dCkpCiAgICAgICAgcmV0dXJuIGRlY3J5cHRlZF9ib2R5CiAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgcHJpbnQoIltkZWNyeXB0IGVycl0iLCBlKQogICAgICAgIHJldHVybiByZXNwLnRleHQKCgpkZWYgc2hvd19tdWx0aXBheW1lbnQoCiAgICAgICAgYXBpX2tleTogc3RyLAogICAgICAgIHRva2VuczogZGljdCwKICAgICAgICBpdGVtczogbGlzdFtQYXltZW50SXRlbV0sCiAgICAgICAgcGF5bWVudF9mb3IsCiAgICAgICAgYXNrX292ZXJ3cml0ZTogYm9vbCwKICAgICAgICBvdmVyd3JpdGVfYW1vdW50OiBpbnQgPSAtMSwKICAgICAgICB0b2tlbl9jb25maXJtYXRpb25faWR4OiBpbnQgPSAwLAogICAgICAgIGFtb3VudF9pZHg6IGludCA9IC0xLAopOgogICAgY2hvb3NpbmdfcGF5bWVudF9tZXRob2QgPSBUcnVlCiAgICB3aGlsZSBjaG9vc2luZ19wYXltZW50X21ldGhvZDoKICAgICAgICBwYXltZW50X21ldGhvZCA9ICIiCiAgICAgICAgd2FsbGV0X251bWJlciA9ICIiCiAgICAgICAgcHJpbnQoIlBpbGloYW4gbXVsdGlwYXltZW50OiIpCiAgICAgICAgcHJpbnQoIjEuIERBTkFcbjIuIFNob3BlZVBheVxuMy4gR29QYXlcbjQuIE9WTyIpCiAgICAgICAgY2hvaWNlID0gaW5wdXQoIlBpbGloIG1ldG9kZSBwZW1iYXlhcmFuOiAiKQogICAgICAgIGlmIGNob2ljZSA9PSAiMSI6CiAgICAgICAgICAgIHBheW1lbnRfbWV0aG9kID0gIkRBTkEiCiAgICAgICAgICAgIHdhbGxldF9udW1iZXIgPSBpbnB1dCgiTWFzdWtrYW4gbm9tb3IgREFOQSAoY29udG9oOiAwODEyMzQ1Njc4OSk6ICIpCiAgICAgICAgICAgICMgVmFsaWRhdGUgbnVtYmVyIGZvcm1hdAogICAgICAgICAgICBpZiBub3Qgd2FsbGV0X251bWJlci5zdGFydHN3aXRoKCIwOCIpIG9yIG5vdCB3YWxsZXRfbnVtYmVyLmlzZGlnaXQoKSBvciBsZW4od2FsbGV0X251bWJlcikgPCAxMCBvciBsZW4oCiAgICAgICAgICAgICAgICAgICAgd2FsbGV0X251bWJlcikgPiAxMzoKICAgICAgICAgICAgICAgIHByaW50KCJOb21vciBEQU5BIHRpZGFrIHZhbGlkLiBQYXN0aWthbiBub21vciBkaWF3YWxpIGRlbmdhbiAnMDgnIGRhbiBtZW1pbGlraSBwYW5qYW5nIHlhbmcgYmVuYXIuIikKICAgICAgICAgICAgICAgIGNvbnRpbnVlCiAgICAgICAgICAgIGNob29zaW5nX3BheW1lbnRfbWV0aG9kID0gRmFsc2UKICAgICAgICBlbGlmIGNob2ljZSA9PSAiMiI6CiAgICAgICAgICAgIHBheW1lbnRfbWV0aG9kID0gIlNIT1BFRVBBWSIKICAgICAgICAgICAgY2hvb3NpbmdfcGF5bWVudF9tZXRob2QgPSBGYWxzZQogICAgICAgIGVsaWYgY2hvaWNlID09ICIzIjoKICAgICAgICAgICAgcGF5bWVudF9tZXRob2QgPSAiR09QQVkiCiAgICAgICAgICAgIGNob29zaW5nX3BheW1lbnRfbWV0aG9kID0gRmFsc2UKICAgICAgICBlbGlmIGNob2ljZSA9PSAiNCI6CiAgICAgICAgICAgIHBheW1lbnRfbWV0aG9kID0gIk9WTyIKICAgICAgICAgICAgd2FsbGV0X251bWJlciA9IGlucHV0KCJNYXN1a2thbiBub21vciBPVk8gKGNvbnRvaDogMDgxMjM0NTY3ODkpOiAiKQogICAgICAgICAgICAjIFZhbGlkYXRlIG51bWJlciBmb3JtYXQKICAgICAgICAgICAgaWYgbm90IHdhbGxldF9udW1iZXIuc3RhcnRzd2l0aCgiMDgiKSBvciBub3Qgd2FsbGV0X251bWJlci5pc2RpZ2l0KCkgb3IgbGVuKHdhbGxldF9udW1iZXIpIDwgMTAgb3IgbGVuKAogICAgICAgICAgICAgICAgICAgIHdhbGxldF9udW1iZXIpID4gMTM6CiAgICAgICAgICAgICAgICBwcmludCgiTm9tb3IgT1ZPIHRpZGFrIHZhbGlkLiBQYXN0aWthbiBub21vciBkaWF3YWxpIGRlbmdhbiAnMDgnIGRhbiBtZW1pbGlraSBwYW5qYW5nIHlhbmcgYmVuYXIuIikKICAgICAgICAgICAgICAgIGNvbnRpbnVlCiAgICAgICAgICAgIGNob29zaW5nX3BheW1lbnRfbWV0aG9kID0gRmFsc2UKICAgICAgICBlbHNlOgogICAgICAgICAgICBwcmludCgiUGlsaWhhbiB0aWRhayB2YWxpZC4iKQogICAgICAgICAgICBjb250aW51ZQoKICAgIHNldHRsZW1lbnRfcmVzcG9uc2UgPSBzZXR0bGVtZW50X211bHRpcGF5bWVudCgKICAgICAgICBhcGlfa2V5LAogICAgICAgIHRva2VucywKICAgICAgICBpdGVtcywKICAgICAgICB3YWxsZXRfbnVtYmVyLAogICAgICAgIHBheW1lbnRfbWV0aG9kLAogICAgICAgIHBheW1lbnRfZm9yLAogICAgICAgIGFza19vdmVyd3JpdGUsCiAgICAgICAgb3ZlcndyaXRlX2Ftb3VudCwKICAgICAgICB0b2tlbl9jb25maXJtYXRpb25faWR4LAogICAgICAgIGFtb3VudF9pZHgsCiAgICApCgogICAgIyBwcmludChmIlNldHRsZW1lbnQgcmVzcG9uc2U6IHtqc29uLmR1bXBzKHNldHRsZW1lbnRfcmVzcG9uc2UsIGluZGVudD0yKX0iKQogICAgaWYgc2V0dGxlbWVudF9yZXNwb25zZVsic3RhdHVzIl0gIT0gIlNVQ0NFU1MiOgogICAgICAgIHByaW50KCJGYWlsZWQgdG8gaW5pdGlhdGUgc2V0dGxlbWVudC4iKQogICAgICAgIHByaW50KGYiRXJyb3I6IHtzZXR0bGVtZW50X3Jlc3BvbnNlfSIpCiAgICAgICAgcmV0dXJuCgogICAgaWYgcGF5bWVudF9tZXRob2QgIT0gIk9WTyI6CiAgICAgICAgZGVlcGxpbmsgPSBzZXR0bGVtZW50X3Jlc3BvbnNlWyJkYXRhIl0uZ2V0KCJkZWVwbGluayIsICIiKQogICAgICAgIGlmIGRlZXBsaW5rOgogICAgICAgICAgICBwcmludChmIlNpbGFoa2FuIHNlbGVzYWlrYW4gcGVtYmF5YXJhbiBtZWxhbHVpIGxpbmsgYmVyaWt1dDpcbntkZWVwbGlua30iKQogICAgZWxzZToKICAgICAgICBwcmludCgiU2lsYWhrYW4gYnVrYSBhcGxpa2FzaSBPVk8gQW5kYSB1bnR1ayBtZW55ZWxlc2Fpa2FuIHBlbWJheWFyYW4uIikKICAgIHJldHVybgo=').decode())
