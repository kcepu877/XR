#!/usr/bin/env python3
import base64
exec(base64.b64decode('aW1wb3J0IGpzb24KaW1wb3J0IHV1aWQKaW1wb3J0IHRpbWUKaW1wb3J0IHJlcXVlc3RzCgpmcm9tIGRhdGV0aW1lIGltcG9ydCBkYXRldGltZSwgdGltZXpvbmUsIHRpbWVkZWx0YQoKZnJvbSBhcHAuY2xpZW50LmVuZ3NlbCBpbXBvcnQgQkFTRV9BUElfVVJMLCBVQSwgaW50ZXJjZXB0X3BhZ2UsIHNlbmRfYXBpX3JlcXVlc3QKZnJvbSBhcHAuY2xpZW50LmVuY3J5cHQgaW1wb3J0IEFQSV9LRVksIGRlY3J5cHRfeGRhdGEsIGVuY3J5cHRzaWduX3hkYXRhLCBqYXZhX2xpa2VfdGltZXN0YW1wLCBnZXRfeF9zaWduYXR1cmVfcGF5bWVudApmcm9tIGFwcC50eXBlX2RpY3QgaW1wb3J0IFBheW1lbnRJdGVtCgpkZWYgc2V0dGxlbWVudF9tdWx0aXBheW1lbnQoCiAgICBhcGlfa2V5OiBzdHIsCiAgICB0b2tlbnM6IGRpY3QsCiAgICBpdGVtczogbGlzdFtQYXltZW50SXRlbV0sCiAgICB3YWxsZXRfbnVtYmVyOiBzdHIsCiAgICBwYXltZW50X21ldGhvZCwKICAgIHBheW1lbnRfZm9yLAogICAgYXNrX292ZXJ3cml0ZTogYm9vbCwKICAgIG92ZXJ3cml0ZV9hbW91bnQ6IGludCA9IC0xLAogICAgdG9rZW5fY29uZmlybWF0aW9uX2lkeDogaW50ID0gMCwKICAgIGFtb3VudF9pZHg6IGludCA9IC0xLAopOgogICAgIyBTYW5pdHkgY2hlY2sKICAgIGlmIG92ZXJ3cml0ZV9hbW91bnQgPT0gLTEgYW5kIG5vdCBhc2tfb3ZlcndyaXRlOgogICAgICAgIHByaW50KCJFaXRoZXIgYXNrX292ZXJ3cml0ZSBtdXN0IGJlIFRydWUgb3Igb3ZlcndyaXRlX2Ftb3VudCBtdXN0IGJlIHNldC4iKQogICAgICAgIHJldHVybiBOb25lCgogICAgdG9rZW5fY29uZmlybWF0aW9uID0gaXRlbXNbdG9rZW5fY29uZmlybWF0aW9uX2lkeF1bInRva2VuX2NvbmZpcm1hdGlvbiJdCiAgICBwYXltZW50X3RhcmdldHMgPSAiIgogICAgZm9yIGl0ZW0gaW4gaXRlbXM6CiAgICAgICAgaWYgcGF5bWVudF90YXJnZXRzICE9ICIiOgogICAgICAgICAgICBwYXltZW50X3RhcmdldHMgKz0gIjsiCiAgICAgICAgcGF5bWVudF90YXJnZXRzICs9IGl0ZW1bIml0ZW1fY29kZSJdCgogICAgYW1vdW50X2ludCA9IDAKICAgIAogICAgIyBEZXRlcm1pbmUgYW1vdW50IHRvIHVzZQogICAgaWYgb3ZlcndyaXRlX2Ftb3VudCAhPSAtMToKICAgICAgICBhbW91bnRfaW50ID0gb3ZlcndyaXRlX2Ftb3VudAogICAgZWxpZiBhbW91bnRfaWR4ID09IC0xOgogICAgICAgIGFtb3VudF9pbnQgPSBpdGVtc1thbW91bnRfaWR4XVsiaXRlbV9wcmljZSJdCgogICAgIyBJZiBPdmVyd3JpdGUKICAgIGlmIGFza19vdmVyd3JpdGU6CiAgICAgICAgcHJpbnQoZiJUb3RhbCBhbW91bnQgaXMge2Ftb3VudF9pbnR9LlxuRW50ZXIgbmV3IGFtb3VudCBpZiB5b3UgbmVlZCB0byBvdmVyd3JpdGUuIikKICAgICAgICBhbW91bnRfc3RyID0gaW5wdXQoIlByZXNzIGVudGVyIHRvIGlnbm9yZSAmIHVzZSBkZWZhdWx0IGFtb3VudDogIikKICAgICAgICBpZiBhbW91bnRfc3RyICE9ICIiOgogICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICBhbW91bnRfaW50ID0gaW50KGFtb3VudF9zdHIpCiAgICAgICAgICAgIGV4Y2VwdCBWYWx1ZUVycm9yOgogICAgICAgICAgICAgICAgcHJpbnQoIkludmFsaWQgb3ZlcndyaXRlIGlucHV0LCB1c2luZyBvcmlnaW5hbCBwcmljZS4iKQogICAgICAgICAgICAgICAgIyByZXR1cm4gTm9uZQogICAgCiAgICBpbnRlcmNlcHRfcGFnZShhcGlfa2V5LCB0b2tlbnMsIGl0ZW1zWzBdWyJpdGVtX2NvZGUiXSwgRmFsc2UpCiAgICAKICAgICMgR2V0IHBheW1lbnQgbWV0aG9kcwogICAgcGF5bWVudF9wYXRoID0gInBheW1lbnRzL2FwaS92OC9wYXltZW50LW1ldGhvZHMtb3B0aW9uIgogICAgcGF5bWVudF9wYXlsb2FkID0gewogICAgICAgICJwYXltZW50X3R5cGUiOiAiUFVSQ0hBU0UiLAogICAgICAgICJpc19lbnRlcnByaXNlIjogRmFsc2UsCiAgICAgICAgInBheW1lbnRfdGFyZ2V0IjogaXRlbXNbdG9rZW5fY29uZmlybWF0aW9uX2lkeF1bIml0ZW1fY29kZSJdLAogICAgICAgICJsYW5nIjogImVuIiwKICAgICAgICAiaXNfcmVmZXJyYWwiOiBGYWxzZSwKICAgICAgICAidG9rZW5fY29uZmlybWF0aW9uIjogdG9rZW5fY29uZmlybWF0aW9uCiAgICB9CiAgICAKICAgIHByaW50KCJHZXR0aW5nIHBheW1lbnQgbWV0aG9kcy4uLiIpCiAgICBwYXltZW50X3JlcyA9IHNlbmRfYXBpX3JlcXVlc3QoYXBpX2tleSwgcGF5bWVudF9wYXRoLCBwYXltZW50X3BheWxvYWQsIHRva2Vuc1siaWRfdG9rZW4iXSwgIlBPU1QiKQogICAgaWYgcGF5bWVudF9yZXNbInN0YXR1cyJdICE9ICJTVUNDRVNTIjoKICAgICAgICBwcmludCgiRmFpbGVkIHRvIGZldGNoIHBheW1lbnQgbWV0aG9kcy4iKQogICAgICAgIHByaW50KGYiRXJyb3I6IHtwYXltZW50X3Jlc30iKQogICAgICAgIHJldHVybiBOb25lCiAgICAKICAgIHRva2VuX3BheW1lbnQgPSBwYXltZW50X3Jlc1siZGF0YSJdWyJ0b2tlbl9wYXltZW50Il0KICAgIHRzX3RvX3NpZ24gPSBwYXltZW50X3Jlc1siZGF0YSJdWyJ0aW1lc3RhbXAiXQoKCiAgICAjIFNldHRsZW1lbnQgcmVxdWVzdAogICAgcGF0aCA9ICJwYXltZW50cy9hcGkvdjgvc2V0dGxlbWVudC1tdWx0aXBheW1lbnQvZXdhbGxldCIKICAgIHNldHRsZW1lbnRfcGF5bG9hZCA9IHsKICAgICAgICAiYWtyYWIiOiB7CiAgICAgICAgICAgICJha3JhYl9tZW1iZXJzIjogW10sCiAgICAgICAgICAgICJha3JhYl9wYXJlbnRfYWxpYXMiOiAiIiwKICAgICAgICAgICAgIm1lbWJlcnMiOiBbXQogICAgICAgIH0sCiAgICAgICAgImNhbl90cmlnZ2VyX3JhdGluZyI6IEZhbHNlLAogICAgICAgICJ0b3RhbF9kaXNjb3VudCI6IDAsCiAgICAgICAgImNvdXBvbiI6ICIiLAogICAgICAgICJwYXltZW50X2ZvciI6IHBheW1lbnRfZm9yLAogICAgICAgICJ0b3B1cF9udW1iZXIiOiAiIiwKICAgICAgICAiaXNfZW50ZXJwcmlzZSI6IEZhbHNlLAogICAgICAgICJhdXRvYnV5IjogewogICAgICAgICAgICAiaXNfdXNpbmdfYXV0b2J1eSI6IEZhbHNlLAogICAgICAgICAgICAiYWN0aXZhdGVkX2F1dG9idXlfY29kZSI6ICIiLAogICAgICAgICAgICAiYXV0b2J1eV90aHJlc2hvbGRfc2V0dGluZyI6IHsKICAgICAgICAgICAgICAgICJsYWJlbCI6ICIiLAogICAgICAgICAgICAgICAgInR5cGUiOiAiIiwKICAgICAgICAgICAgICAgICJ2YWx1ZSI6IDAKICAgICAgICAgICAgfQogICAgICAgIH0sCiAgICAgICAgImNjX3BheW1lbnRfdHlwZSI6ICIiLAogICAgICAgICJhY2Nlc3NfdG9rZW4iOiB0b2tlbnNbImFjY2Vzc190b2tlbiJdLAogICAgICAgICJpc19teXhsX3dhbGxldCI6IEZhbHNlLAogICAgICAgICJ3YWxsZXRfbnVtYmVyIjogd2FsbGV0X251bWJlciwKICAgICAgICAiYWRkaXRpb25hbF9kYXRhIjoge30sCiAgICAgICAgInRvdGFsX2Ftb3VudCI6IGFtb3VudF9pbnQsCiAgICAgICAgInRvdGFsX2ZlZSI6IDAsCiAgICAgICAgImlzX3VzZV9wb2ludCI6IEZhbHNlLAogICAgICAgICJsYW5nIjogImVuIiwKICAgICAgICAiaXRlbXMiOiBpdGVtcywKICAgICAgICAidmVyaWZpY2F0aW9uX3Rva2VuIjogdG9rZW5fcGF5bWVudCwKICAgICAgICAicGF5bWVudF9tZXRob2QiOiBwYXltZW50X21ldGhvZCwKICAgICAgICAidGltZXN0YW1wIjogaW50KHRpbWUudGltZSgpKQogICAgfQogICAgCiAgICBlbmNyeXB0ZWRfcGF5bG9hZCA9IGVuY3J5cHRzaWduX3hkYXRhKAogICAgICAgIGFwaV9rZXk9YXBpX2tleSwKICAgICAgICBtZXRob2Q9IlBPU1QiLAogICAgICAgIHBhdGg9cGF0aCwKICAgICAgICBpZF90b2tlbj10b2tlbnNbImlkX3Rva2VuIl0sCiAgICAgICAgcGF5bG9hZD1zZXR0bGVtZW50X3BheWxvYWQKICAgICkKICAgIAogICAgeHRpbWUgPSBpbnQoZW5jcnlwdGVkX3BheWxvYWRbImVuY3J5cHRlZF9ib2R5Il1bInh0aW1lIl0pCiAgICBzaWdfdGltZV9zZWMgPSAoeHRpbWUgLy8gMTAwMCkKICAgIHhfcmVxdWVzdGVkX2F0ID0gZGF0ZXRpbWUuZnJvbXRpbWVzdGFtcChzaWdfdGltZV9zZWMsIHR6PXRpbWV6b25lLnV0YykuYXN0aW1lem9uZSgpCiAgICBzZXR0bGVtZW50X3BheWxvYWRbInRpbWVzdGFtcCJdID0gdHNfdG9fc2lnbgogICAgCiAgICBib2R5ID0gZW5jcnlwdGVkX3BheWxvYWRbImVuY3J5cHRlZF9ib2R5Il0KICAgIHhfc2lnID0gZ2V0X3hfc2lnbmF0dXJlX3BheW1lbnQoCiAgICAgICAgICAgIGFwaV9rZXksCiAgICAgICAgICAgIHRva2Vuc1siYWNjZXNzX3Rva2VuIl0sCiAgICAgICAgICAgIHRzX3RvX3NpZ24sCiAgICAgICAgICAgIHBheW1lbnRfdGFyZ2V0cywKICAgICAgICAgICAgdG9rZW5fcGF5bWVudCwKICAgICAgICAgICAgcGF5bWVudF9tZXRob2QsCiAgICAgICAgICAgIHBheW1lbnRfZm9yLAogICAgICAgICAgICBwYXRoCiAgICAgICAgKQogICAgCiAgICBoZWFkZXJzID0gewogICAgICAgICJob3N0IjogQkFTRV9BUElfVVJMLnJlcGxhY2UoImh0dHBzOi8vIiwgIiIpLAogICAgICAgICJjb250ZW50LXR5cGUiOiAiYXBwbGljYXRpb24vanNvbjsgY2hhcnNldD11dGYtOCIsCiAgICAgICAgInVzZXItYWdlbnQiOiBVQSwKICAgICAgICAieC1hcGkta2V5IjogQVBJX0tFWSwKICAgICAgICAiYXV0aG9yaXphdGlvbiI6IGYiQmVhcmVyIHt0b2tlbnNbJ2lkX3Rva2VuJ119IiwKICAgICAgICAieC1odiI6ICJ2MyIsCiAgICAgICAgIngtc2lnbmF0dXJlLXRpbWUiOiBzdHIoc2lnX3RpbWVfc2VjKSwKICAgICAgICAieC1zaWduYXR1cmUiOiB4X3NpZywKICAgICAgICAieC1yZXF1ZXN0LWlkIjogc3RyKHV1aWQudXVpZDQoKSksCiAgICAgICAgIngtcmVxdWVzdC1hdCI6IGphdmFfbGlrZV90aW1lc3RhbXAoeF9yZXF1ZXN0ZWRfYXQpLAogICAgICAgICJ4LXZlcnNpb24tYXBwIjogIjguOS4wIiwKICAgIH0KICAgIAogICAgdXJsID0gZiJ7QkFTRV9BUElfVVJMfS97cGF0aH0iCiAgICBwcmludCgiU2VuZGluZyBzZXR0bGVtZW50IHJlcXVlc3QuLi4iKQogICAgcmVzcCA9IHJlcXVlc3RzLnBvc3QodXJsLCBoZWFkZXJzPWhlYWRlcnMsIGRhdGE9anNvbi5kdW1wcyhib2R5KSwgdGltZW91dD0zMCkKICAgIAogICAgdHJ5OgogICAgICAgIGRlY3J5cHRlZF9ib2R5ID0gZGVjcnlwdF94ZGF0YShhcGlfa2V5LCBqc29uLmxvYWRzKHJlc3AudGV4dCkpCiAgICAgICAgcmV0dXJuIGRlY3J5cHRlZF9ib2R5CiAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgcHJpbnQoIltkZWNyeXB0IGVycl0iLCBlKQogICAgICAgIHJldHVybiByZXNwLnRleHQKCmRlZiBzaG93X211bHRpcGF5bWVudCgKICAgIGFwaV9rZXk6IHN0ciwKICAgIHRva2VuczogZGljdCwKICAgIGl0ZW1zOiBsaXN0W1BheW1lbnRJdGVtXSwKICAgIHBheW1lbnRfZm9yLAogICAgYXNrX292ZXJ3cml0ZTogYm9vbCwKICAgIG92ZXJ3cml0ZV9hbW91bnQ6IGludCA9IC0xLAogICAgdG9rZW5fY29uZmlybWF0aW9uX2lkeDogaW50ID0gMCwKICAgIGFtb3VudF9pZHg6IGludCA9IC0xLAopOgogICAgY2hvb3NpbmdfcGF5bWVudF9tZXRob2QgPSBUcnVlCiAgICB3aGlsZSBjaG9vc2luZ19wYXltZW50X21ldGhvZDoKICAgICAgICBwYXltZW50X21ldGhvZCA9ICIiCiAgICAgICAgd2FsbGV0X251bWJlciA9ICIiCiAgICAgICAgcHJpbnQoIlBpbGloYW4gbXVsdGlwYXltZW50OiIpCiAgICAgICAgcHJpbnQoIjEuIERBTkFcbjIuIFNob3BlZVBheVxuMy4gR29QYXlcbjQuIE9WTyIpCiAgICAgICAgY2hvaWNlID0gaW5wdXQoIlBpbGloIG1ldG9kZSBwZW1iYXlhcmFuOiAiKQogICAgICAgIGlmIGNob2ljZSA9PSAiMSI6CiAgICAgICAgICAgIHBheW1lbnRfbWV0aG9kID0gIkRBTkEiCiAgICAgICAgICAgIHdhbGxldF9udW1iZXIgPSBpbnB1dCgiTWFzdWtrYW4gbm9tb3IgREFOQSAoY29udG9oOiAwODEyMzQ1Njc4OSk6ICIpCiAgICAgICAgICAgICMgVmFsaWRhdGUgbnVtYmVyIGZvcm1hdAogICAgICAgICAgICBpZiBub3Qgd2FsbGV0X251bWJlci5zdGFydHN3aXRoKCIwOCIpIG9yIG5vdCB3YWxsZXRfbnVtYmVyLmlzZGlnaXQoKSBvciBsZW4od2FsbGV0X251bWJlcikgPCAxMCBvciBsZW4od2FsbGV0X251bWJlcikgPiAxMzoKICAgICAgICAgICAgICAgIHByaW50KCJOb21vciBEQU5BIHRpZGFrIHZhbGlkLiBQYXN0aWthbiBub21vciBkaWF3YWxpIGRlbmdhbiAnMDgnIGRhbiBtZW1pbGlraSBwYW5qYW5nIHlhbmcgYmVuYXIuIikKICAgICAgICAgICAgICAgIGNvbnRpbnVlCiAgICAgICAgICAgIGNob29zaW5nX3BheW1lbnRfbWV0aG9kID0gRmFsc2UKICAgICAgICBlbGlmIGNob2ljZSA9PSAiMiI6CiAgICAgICAgICAgIHBheW1lbnRfbWV0aG9kID0gIlNIT1BFRVBBWSIKICAgICAgICAgICAgY2hvb3NpbmdfcGF5bWVudF9tZXRob2QgPSBGYWxzZQogICAgICAgIGVsaWYgY2hvaWNlID09ICIzIjoKICAgICAgICAgICAgcGF5bWVudF9tZXRob2QgPSAiR09QQVkiCiAgICAgICAgICAgIGNob29zaW5nX3BheW1lbnRfbWV0aG9kID0gRmFsc2UKICAgICAgICBlbGlmIGNob2ljZSA9PSAiNCI6CiAgICAgICAgICAgIHBheW1lbnRfbWV0aG9kID0gIk9WTyIKICAgICAgICAgICAgd2FsbGV0X251bWJlciA9IGlucHV0KCJNYXN1a2thbiBub21vciBPVk8gKGNvbnRvaDogMDgxMjM0NTY3ODkpOiAiKQogICAgICAgICAgICAjIFZhbGlkYXRlIG51bWJlciBmb3JtYXQKICAgICAgICAgICAgaWYgbm90IHdhbGxldF9udW1iZXIuc3RhcnRzd2l0aCgiMDgiKSBvciBub3Qgd2FsbGV0X251bWJlci5pc2RpZ2l0KCkgb3IgbGVuKHdhbGxldF9udW1iZXIpIDwgMTAgb3IgbGVuKHdhbGxldF9udW1iZXIpID4gMTM6CiAgICAgICAgICAgICAgICBwcmludCgiTm9tb3IgT1ZPIHRpZGFrIHZhbGlkLiBQYXN0aWthbiBub21vciBkaWF3YWxpIGRlbmdhbiAnMDgnIGRhbiBtZW1pbGlraSBwYW5qYW5nIHlhbmcgYmVuYXIuIikKICAgICAgICAgICAgICAgIGNvbnRpbnVlCiAgICAgICAgICAgIGNob29zaW5nX3BheW1lbnRfbWV0aG9kID0gRmFsc2UKICAgICAgICBlbHNlOgogICAgICAgICAgICBwcmludCgiUGlsaWhhbiB0aWRhayB2YWxpZC4iKQogICAgICAgICAgICBjb250aW51ZQogICAgCiAgICBzZXR0bGVtZW50X3Jlc3BvbnNlID0gc2V0dGxlbWVudF9tdWx0aXBheW1lbnQoCiAgICAgICAgYXBpX2tleSwKICAgICAgICB0b2tlbnMsCiAgICAgICAgaXRlbXMsCiAgICAgICAgd2FsbGV0X251bWJlciwKICAgICAgICBwYXltZW50X21ldGhvZCwKICAgICAgICBwYXltZW50X2ZvciwKICAgICAgICBhc2tfb3ZlcndyaXRlLAogICAgICAgIG92ZXJ3cml0ZV9hbW91bnQsCiAgICAgICAgdG9rZW5fY29uZmlybWF0aW9uX2lkeCwKICAgICAgICBhbW91bnRfaWR4LAogICAgKQogICAgCiAgICAjIHByaW50KGYiU2V0dGxlbWVudCByZXNwb25zZToge2pzb24uZHVtcHMoc2V0dGxlbWVudF9yZXNwb25zZSwgaW5kZW50PTIpfSIpCiAgICBpZiBzZXR0bGVtZW50X3Jlc3BvbnNlWyJzdGF0dXMiXSAhPSAiU1VDQ0VTUyI6CiAgICAgICAgcHJpbnQoIkZhaWxlZCB0byBpbml0aWF0ZSBzZXR0bGVtZW50LiIpCiAgICAgICAgcHJpbnQoZiJFcnJvcjoge3NldHRsZW1lbnRfcmVzcG9uc2V9IikKICAgICAgICByZXR1cm4KICAgIAogICAgaWYgcGF5bWVudF9tZXRob2QgIT0gIk9WTyI6CiAgICAgICAgZGVlcGxpbmsgPSBzZXR0bGVtZW50X3Jlc3BvbnNlWyJkYXRhIl0uZ2V0KCJkZWVwbGluayIsICIiKQogICAgICAgIGlmIGRlZXBsaW5rOgogICAgICAgICAgICBwcmludChmIlNpbGFoa2FuIHNlbGVzYWlrYW4gcGVtYmF5YXJhbiBtZWxhbHVpIGxpbmsgYmVyaWt1dDpcbntkZWVwbGlua30iKQogICAgZWxzZToKICAgICAgICBwcmludCgiU2lsYWhrYW4gYnVrYSBhcGxpa2FzaSBPVk8gQW5kYSB1bnR1ayBtZW55ZWxlc2Fpa2FuIHBlbWJheWFyYW4uIikKICAgIHJldHVybg==').decode())
