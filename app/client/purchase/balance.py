#!/usr/bin/env python3
import base64
exec(base64.b64decode('ZnJvbSBkYXRldGltZSBpbXBvcnQgdGltZXpvbmUsIGRhdGV0aW1lCmltcG9ydCBqc29uCmltcG9ydCB0aW1lCmltcG9ydCB1dWlkCgppbXBvcnQgcmVxdWVzdHMKZnJvbSBhcHAuY2xpZW50LmVuY3J5cHQgaW1wb3J0IEFQSV9LRVksIGJ1aWxkX2VuY3J5cHRlZF9maWVsZCwgZGVjcnlwdF94ZGF0YSwgZW5jcnlwdHNpZ25feGRhdGEsIGdldF94X3NpZ25hdHVyZV9wYXltZW50LCBqYXZhX2xpa2VfdGltZXN0YW1wCmZyb20gYXBwLmNsaWVudC5lbmdzZWwgaW1wb3J0IEJBU0VfQVBJX1VSTCwgVUEsIGludGVyY2VwdF9wYWdlLCBzZW5kX2FwaV9yZXF1ZXN0CmZyb20gYXBwLnR5cGVfZGljdCBpbXBvcnQgUGF5bWVudEl0ZW0KCmRlZiBzZXR0bGVtZW50X2JhbGFuY2UoCiAgICBhcGlfa2V5OiBzdHIsCiAgICB0b2tlbnM6IGRpY3QsCiAgICBpdGVtczogbGlzdFtQYXltZW50SXRlbV0sCiAgICBwYXltZW50X2Zvcjogc3RyLAogICAgYXNrX292ZXJ3cml0ZTogYm9vbCwKICAgIG92ZXJ3cml0ZV9hbW91bnQ6IGludCA9IC0xLAogICAgdG9rZW5fY29uZmlybWF0aW9uX2lkeDogaW50ID0gMCwKICAgIGFtb3VudF9pZHg6IGludCA9IC0xLAogICAgdG9wdXBfbnVtYmVyOiBzdHIgPSAiIiwKICAgIHN0YWdlX3Rva2VuOiBzdHIgPSAiIiwKKToKICAgICMgU2FuaXR5IGNoZWNrCiAgICBpZiBvdmVyd3JpdGVfYW1vdW50ID09IC0xIGFuZCBub3QgYXNrX292ZXJ3cml0ZToKICAgICAgICBwcmludCgiRWl0aGVyIGFza19vdmVyd3JpdGUgbXVzdCBiZSBUcnVlIG9yIG92ZXJ3cml0ZV9hbW91bnQgbXVzdCBiZSBzZXQuIikKICAgICAgICByZXR1cm4gTm9uZQoKICAgIHRva2VuX2NvbmZpcm1hdGlvbiA9IGl0ZW1zW3Rva2VuX2NvbmZpcm1hdGlvbl9pZHhdWyJ0b2tlbl9jb25maXJtYXRpb24iXQogICAgcGF5bWVudF90YXJnZXRzID0gIiIKICAgIGZvciBpdGVtIGluIGl0ZW1zOgogICAgICAgIGlmIHBheW1lbnRfdGFyZ2V0cyAhPSAiIjoKICAgICAgICAgICAgcGF5bWVudF90YXJnZXRzICs9ICI7IgogICAgICAgIHBheW1lbnRfdGFyZ2V0cyArPSBpdGVtWyJpdGVtX2NvZGUiXQoKICAgIGFtb3VudF9pbnQgPSAwCiAgICAKICAgICMgRGV0ZXJtaW5lIGFtb3VudCB0byB1c2UKICAgIGlmIG92ZXJ3cml0ZV9hbW91bnQgIT0gLTE6CiAgICAgICAgYW1vdW50X2ludCA9IG92ZXJ3cml0ZV9hbW91bnQKICAgIGVsaWYgYW1vdW50X2lkeCA9PSAtMToKICAgICAgICBhbW91bnRfaW50ID0gaXRlbXNbYW1vdW50X2lkeF1bIml0ZW1fcHJpY2UiXQoKICAgICMgSWYgT3ZlcndyaXRlCiAgICBpZiBhc2tfb3ZlcndyaXRlOgogICAgICAgIHByaW50KGYiVG90YWwgYW1vdW50IGlzIHthbW91bnRfaW50fS5cbkVudGVyIG5ldyBhbW91bnQgaWYgeW91IG5lZWQgdG8gb3ZlcndyaXRlLiIpCiAgICAgICAgYW1vdW50X3N0ciA9IGlucHV0KCJQcmVzcyBlbnRlciB0byBpZ25vcmUgJiB1c2UgZGVmYXVsdCBhbW91bnQ6ICIpCiAgICAgICAgaWYgYW1vdW50X3N0ciAhPSAiIjoKICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgYW1vdW50X2ludCA9IGludChhbW91bnRfc3RyKQogICAgICAgICAgICBleGNlcHQgVmFsdWVFcnJvcjoKICAgICAgICAgICAgICAgIHByaW50KCJJbnZhbGlkIG92ZXJ3cml0ZSBpbnB1dCwgdXNpbmcgb3JpZ2luYWwgcHJpY2UuIikKICAgICAgICAgICAgICAgICMgcmV0dXJuIE5vbmUKICAgIGludGVyY2VwdF9wYWdlKGFwaV9rZXksIHRva2VucywgaXRlbXNbMF1bIml0ZW1fY29kZSJdLCBGYWxzZSkKICAgIAogICAgIyBHZXQgcGF5bWVudCBtZXRob2RzCiAgICBwYXltZW50X3BhdGggPSAicGF5bWVudHMvYXBpL3Y4L3BheW1lbnQtbWV0aG9kcy1vcHRpb24iCiAgICBwYXltZW50X3BheWxvYWQgPSB7CiAgICAgICAgInBheW1lbnRfdHlwZSI6ICJQVVJDSEFTRSIsCiAgICAgICAgImlzX2VudGVycHJpc2UiOiBGYWxzZSwKICAgICAgICAicGF5bWVudF90YXJnZXQiOiBpdGVtc1t0b2tlbl9jb25maXJtYXRpb25faWR4XVsiaXRlbV9jb2RlIl0sCiAgICAgICAgImxhbmciOiAiZW4iLAogICAgICAgICJpc19yZWZlcnJhbCI6IEZhbHNlLAogICAgICAgICJ0b2tlbl9jb25maXJtYXRpb24iOiB0b2tlbl9jb25maXJtYXRpb24KICAgIH0KICAgIAogICAgcHJpbnQoIkdldHRpbmcgcGF5bWVudCBtZXRob2RzLi4uIikKICAgIHBheW1lbnRfcmVzID0gc2VuZF9hcGlfcmVxdWVzdChhcGlfa2V5LCBwYXltZW50X3BhdGgsIHBheW1lbnRfcGF5bG9hZCwgdG9rZW5zWyJpZF90b2tlbiJdLCAiUE9TVCIpCiAgICBpZiBwYXltZW50X3Jlc1sic3RhdHVzIl0gIT0gIlNVQ0NFU1MiOgogICAgICAgIHByaW50KCJGYWlsZWQgdG8gZmV0Y2ggcGF5bWVudCBtZXRob2RzLiIpCiAgICAgICAgcHJpbnQoZiJFcnJvcjoge3BheW1lbnRfcmVzfSIpCiAgICAgICAgcmV0dXJuIHBheW1lbnRfcmVzCiAgICAKICAgIHRva2VuX3BheW1lbnQgPSBwYXltZW50X3Jlc1siZGF0YSJdWyJ0b2tlbl9wYXltZW50Il0KICAgIHRzX3RvX3NpZ24gPSBwYXltZW50X3Jlc1siZGF0YSJdWyJ0aW1lc3RhbXAiXQogICAgCiAgICAjIFNldHRsZW1lbnQgcmVxdWVzdAogICAgcGF0aCA9ICJwYXltZW50cy9hcGkvdjgvc2V0dGxlbWVudC1tdWx0aXBheW1lbnQiCiAgICBzZXR0bGVtZW50X3BheWxvYWQgPSB7CiAgICAgICAgInRvdGFsX2Rpc2NvdW50IjogMCwKICAgICAgICAiaXNfZW50ZXJwcmlzZSI6IEZhbHNlLAogICAgICAgICJwYXltZW50X3Rva2VuIjogIiIsCiAgICAgICAgInRva2VuX3BheW1lbnQiOiB0b2tlbl9wYXltZW50LAogICAgICAgICJhY3RpdmF0ZWRfYXV0b2J1eV9jb2RlIjogIiIsCiAgICAgICAgImNjX3BheW1lbnRfdHlwZSI6ICIiLAogICAgICAgICJpc19teXhsX3dhbGxldCI6IEZhbHNlLAogICAgICAgICJwaW4iOiAiIiwKICAgICAgICAiZXdhbGxldF9wcm9tb19pZCI6ICIiLAogICAgICAgICJtZW1iZXJzIjogW10sCiAgICAgICAgInRvdGFsX2ZlZSI6IDAsCiAgICAgICAgImZpbmdlcnByaW50IjogIiIsCiAgICAgICAgImF1dG9idXlfdGhyZXNob2xkX3NldHRpbmciOiB7CiAgICAgICAgICAgICJsYWJlbCI6ICIiLAogICAgICAgICAgICAidHlwZSI6ICIiLAogICAgICAgICAgICAidmFsdWUiOiAwCiAgICAgICAgfSwKICAgICAgICAiaXNfdXNlX3BvaW50IjogRmFsc2UsCiAgICAgICAgImxhbmciOiAiZW4iLAogICAgICAgICJwYXltZW50X21ldGhvZCI6ICJCQUxBTkNFIiwKICAgICAgICAidGltZXN0YW1wIjogaW50KHRpbWUudGltZSgpKSwKICAgICAgICAicG9pbnRzX2dhaW5lZCI6IDAsCiAgICAgICAgImNhbl90cmlnZ2VyX3JhdGluZyI6IEZhbHNlLAogICAgICAgICJha3JhYl9tZW1iZXJzIjogW10sCiAgICAgICAgImFrcmFiX3BhcmVudF9hbGlhcyI6ICIiLAogICAgICAgICJyZWZlcnJhbF91bmlxdWVfY29kZSI6ICIiLAogICAgICAgICJjb3Vwb24iOiAiIiwKICAgICAgICAicGF5bWVudF9mb3IiOiBwYXltZW50X2ZvciwKICAgICAgICAid2l0aF91cHNlbGwiOiBGYWxzZSwKICAgICAgICAidG9wdXBfbnVtYmVyIjogdG9wdXBfbnVtYmVyLAogICAgICAgICJzdGFnZV90b2tlbiI6IHN0YWdlX3Rva2VuLAogICAgICAgICJhdXRoZW50aWNhdGlvbl9pZCI6ICIiLAogICAgICAgICJlbmNyeXB0ZWRfcGF5bWVudF90b2tlbiI6IGJ1aWxkX2VuY3J5cHRlZF9maWVsZCh1cmxzYWZlX2I2ND1UcnVlKSwKICAgICAgICAidG9rZW4iOiAiIiwKICAgICAgICAidG9rZW5fY29uZmlybWF0aW9uIjogIiIsCiAgICAgICAgImFjY2Vzc190b2tlbiI6IHRva2Vuc1siYWNjZXNzX3Rva2VuIl0sCiAgICAgICAgIndhbGxldF9udW1iZXIiOiAiIiwKICAgICAgICAiZW5jcnlwdGVkX2F1dGhlbnRpY2F0aW9uX2lkIjogYnVpbGRfZW5jcnlwdGVkX2ZpZWxkKHVybHNhZmVfYjY0PVRydWUpLAogICAgICAgICJhZGRpdGlvbmFsX2RhdGEiOiB7CiAgICAgICAgICAgICJvcmlnaW5hbF9wcmljZSI6IGl0ZW1zWy0xXVsiaXRlbV9wcmljZSJdLAogICAgICAgICAgICAiaXNfc3BlbmRfbGltaXRfdGVtcG9yYXJ5IjogRmFsc2UsCiAgICAgICAgICAgICJtaWdyYXRpb25fdHlwZSI6ICIiLAogICAgICAgICAgICAiYWtyYWJfbTJtX2dyb3VwX2lkIjogImZhbHNlIiwKICAgICAgICAgICAgInNwZW5kX2xpbWl0X2Ftb3VudCI6IDAsCiAgICAgICAgICAgICJpc19zcGVuZF9saW1pdCI6IEZhbHNlLAogICAgICAgICAgICAibWlzc2lvbl9pZCI6ICIiLAogICAgICAgICAgICAidGF4IjogMCwKICAgICAgICAgICAgInF1b3RhX2JvbnVzIjogMCwKICAgICAgICAgICAgImNhc2h0YWciOiAiIiwKICAgICAgICAgICAgImlzX2ZhbWlseV9wbGFuIjogRmFsc2UsCiAgICAgICAgICAgICJjb21ib19kZXRhaWxzIjogW10sCiAgICAgICAgICAgICJpc19zd2l0Y2hfcGxhbiI6IEZhbHNlLAogICAgICAgICAgICAiZGlzY291bnRfcmVjdXJyaW5nIjogMCwKICAgICAgICAgICAgImlzX2FrcmFiX20ybSI6IEZhbHNlLAogICAgICAgICAgICAiYmFsYW5jZV90eXBlIjogIlBSRVBBSURfQkFMQU5DRSIsCiAgICAgICAgICAgICJoYXNfYm9udXMiOiBGYWxzZSwKICAgICAgICAgICAgImRpc2NvdW50X3Byb21vIjogMAogICAgICAgIH0sCiAgICAgICAgInRvdGFsX2Ftb3VudCI6IGFtb3VudF9pbnQsCiAgICAgICAgImlzX3VzaW5nX2F1dG9idXkiOiBGYWxzZSwKICAgICAgICAiaXRlbXMiOiBpdGVtcywKICAgIH0KICAgIAogICAgIyBwcmludChmIltTQl0gcGF5bG9hZDoge2pzb24uZHVtcHMoc2V0dGxlbWVudF9wYXlsb2FkLCBpbmRlbnQ9MSl9IikKICAgIAogICAgZW5jcnlwdGVkX3BheWxvYWQgPSBlbmNyeXB0c2lnbl94ZGF0YSgKICAgICAgICBhcGlfa2V5PWFwaV9rZXksCiAgICAgICAgbWV0aG9kPSJQT1NUIiwKICAgICAgICBwYXRoPXBhdGgsCiAgICAgICAgaWRfdG9rZW49dG9rZW5zWyJpZF90b2tlbiJdLAogICAgICAgIHBheWxvYWQ9c2V0dGxlbWVudF9wYXlsb2FkCiAgICApCiAgICAKICAgIHh0aW1lID0gaW50KGVuY3J5cHRlZF9wYXlsb2FkWyJlbmNyeXB0ZWRfYm9keSJdWyJ4dGltZSJdKQogICAgc2lnX3RpbWVfc2VjID0gKHh0aW1lIC8vIDEwMDApCiAgICB4X3JlcXVlc3RlZF9hdCA9IGRhdGV0aW1lLmZyb210aW1lc3RhbXAoc2lnX3RpbWVfc2VjLCB0ej10aW1lem9uZS51dGMpLmFzdGltZXpvbmUoKQogICAgc2V0dGxlbWVudF9wYXlsb2FkWyJ0aW1lc3RhbXAiXSA9IHRzX3RvX3NpZ24KICAgIAogICAgYm9keSA9IGVuY3J5cHRlZF9wYXlsb2FkWyJlbmNyeXB0ZWRfYm9keSJdCiAgICB4X3NpZyA9IGdldF94X3NpZ25hdHVyZV9wYXltZW50KAogICAgICAgICAgICAgICAgYXBpX2tleSwKICAgICAgICAgICAgICAgIHRva2Vuc1siYWNjZXNzX3Rva2VuIl0sCiAgICAgICAgICAgICAgICB0c190b19zaWduLAogICAgICAgICAgICAgICAgcGF5bWVudF90YXJnZXRzLAogICAgICAgICAgICAgICAgdG9rZW5fcGF5bWVudCwKICAgICAgICAgICAgICAgICJCQUxBTkNFIiwKICAgICAgICAgICAgICAgIHBheW1lbnRfZm9yLAogICAgICAgICAgICAgICAgcGF0aAogICAgICAgICAgICApCiAgICAKICAgIGhlYWRlcnMgPSB7CiAgICAgICAgImhvc3QiOiBCQVNFX0FQSV9VUkwucmVwbGFjZSgiaHR0cHM6Ly8iLCAiIiksCiAgICAgICAgImNvbnRlbnQtdHlwZSI6ICJhcHBsaWNhdGlvbi9qc29uOyBjaGFyc2V0PXV0Zi04IiwKICAgICAgICAidXNlci1hZ2VudCI6IFVBLAogICAgICAgICJ4LWFwaS1rZXkiOiBBUElfS0VZLAogICAgICAgICJhdXRob3JpemF0aW9uIjogZiJCZWFyZXIge3Rva2Vuc1snaWRfdG9rZW4nXX0iLAogICAgICAgICJ4LWh2IjogInYzIiwKICAgICAgICAieC1zaWduYXR1cmUtdGltZSI6IHN0cihzaWdfdGltZV9zZWMpLAogICAgICAgICJ4LXNpZ25hdHVyZSI6IHhfc2lnLAogICAgICAgICJ4LXJlcXVlc3QtaWQiOiBzdHIodXVpZC51dWlkNCgpKSwKICAgICAgICAieC1yZXF1ZXN0LWF0IjogamF2YV9saWtlX3RpbWVzdGFtcCh4X3JlcXVlc3RlZF9hdCksCiAgICAgICAgIngtdmVyc2lvbi1hcHAiOiAiOC45LjAiLAogICAgfQogICAgCiAgICB1cmwgPSBmIntCQVNFX0FQSV9VUkx9L3twYXRofSIKICAgIHByaW50KCJTZW5kaW5nIHNldHRsZW1lbnQgcmVxdWVzdC4uLiIpCiAgICByZXNwID0gcmVxdWVzdHMucG9zdCh1cmwsIGhlYWRlcnM9aGVhZGVycywgZGF0YT1qc29uLmR1bXBzKGJvZHkpLCB0aW1lb3V0PTMwKQogICAgCiAgICB0cnk6CiAgICAgICAgZGVjcnlwdGVkX2JvZHkgPSBkZWNyeXB0X3hkYXRhKGFwaV9rZXksIGpzb24ubG9hZHMocmVzcC50ZXh0KSkKICAgICAgICBpZiBkZWNyeXB0ZWRfYm9keVsic3RhdHVzIl0gIT0gIlNVQ0NFU1MiOgogICAgICAgICAgICBwcmludCgiRmFpbGVkIHRvIGluaXRpYXRlIHNldHRsZW1lbnQuIikKICAgICAgICAgICAgcHJpbnQoZiJFcnJvcjoge2RlY3J5cHRlZF9ib2R5fSIpCiAgICAgICAgICAgIHJldHVybiBkZWNyeXB0ZWRfYm9keQogICAgICAgIAogICAgICAgIHByaW50KGYiUHVyY2hhc2UgcmVzdWx0Olxue2pzb24uZHVtcHMoZGVjcnlwdGVkX2JvZHksIGluZGVudD0yKX0iKQogICAgICAgIAogICAgICAgIHJldHVybiBkZWNyeXB0ZWRfYm9keQogICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgIHByaW50KCJbZGVjcnlwdCBlcnJdIiwgZSkKICAgICAgICByZXR1cm4gcmVzcC50ZXh0').decode())
