#!/usr/bin/env python3
import base64
exec(base64.b64decode('ZnJvbSBkYXRldGltZSBpbXBvcnQgZGF0ZXRpbWUsIHRpbWV6b25lLCB0aW1lZGVsdGEKaW1wb3J0IGpzb24KaW1wb3J0IHV1aWQKaW1wb3J0IGJhc2U2NAppbXBvcnQgcXJjb2RlCgppbXBvcnQgdGltZQppbXBvcnQgcmVxdWVzdHMKZnJvbSBhcHAuY2xpZW50LmVuZ3NlbCBpbXBvcnQgKgpmcm9tIGFwcC5jbGllbnQuZW5jcnlwdCBpbXBvcnQgQVBJX0tFWSwgZGVjcnlwdF94ZGF0YSwgZW5jcnlwdHNpZ25feGRhdGEsIGphdmFfbGlrZV90aW1lc3RhbXAsIGdldF94X3NpZ25hdHVyZV9wYXltZW50CmZyb20gYXBwLnR5cGVfZGljdCBpbXBvcnQgUGF5bWVudEl0ZW0KCmRlZiBzZXR0bGVtZW50X3FyaXMoCiAgICBhcGlfa2V5OiBzdHIsCiAgICB0b2tlbnM6IGRpY3QsCiAgICBpdGVtczogbGlzdFtQYXltZW50SXRlbV0sCiAgICBwYXltZW50X2Zvcjogc3RyLAogICAgYXNrX292ZXJ3cml0ZTogYm9vbCwKICAgIG92ZXJ3cml0ZV9hbW91bnQ6IGludCA9IC0xLAogICAgdG9rZW5fY29uZmlybWF0aW9uX2lkeDogaW50ID0gMCwKICAgIGFtb3VudF9pZHg6IGludCA9IC0xLAogICAgdG9wdXBfbnVtYmVyOiBzdHIgPSAiIiwKICAgIHN0YWdlX3Rva2VuOiBzdHIgPSAiIiwKKTogIAogICAgIyBTYW5pdHkgY2hlY2sKICAgIGlmIG92ZXJ3cml0ZV9hbW91bnQgPT0gLTEgYW5kIG5vdCBhc2tfb3ZlcndyaXRlOgogICAgICAgIHByaW50KCJFaXRoZXIgYXNrX292ZXJ3cml0ZSBtdXN0IGJlIFRydWUgb3Igb3ZlcndyaXRlX2Ftb3VudCBtdXN0IGJlIHNldC4iKQogICAgICAgIHJldHVybiBOb25lCgogICAgdG9rZW5fY29uZmlybWF0aW9uID0gaXRlbXNbdG9rZW5fY29uZmlybWF0aW9uX2lkeF1bInRva2VuX2NvbmZpcm1hdGlvbiJdCiAgICBwYXltZW50X3RhcmdldHMgPSAiIgogICAgZm9yIGl0ZW0gaW4gaXRlbXM6CiAgICAgICAgaWYgcGF5bWVudF90YXJnZXRzICE9ICIiOgogICAgICAgICAgICBwYXltZW50X3RhcmdldHMgKz0gIjsiCiAgICAgICAgcGF5bWVudF90YXJnZXRzICs9IGl0ZW1bIml0ZW1fY29kZSJdCgogICAgYW1vdW50X2ludCA9IDAKICAgIAogICAgIyBEZXRlcm1pbmUgYW1vdW50IHRvIHVzZQogICAgaWYgb3ZlcndyaXRlX2Ftb3VudCAhPSAtMToKICAgICAgICBhbW91bnRfaW50ID0gb3ZlcndyaXRlX2Ftb3VudAogICAgZWxpZiBhbW91bnRfaWR4ID09IC0xOgogICAgICAgIGFtb3VudF9pbnQgPSBpdGVtc1thbW91bnRfaWR4XVsiaXRlbV9wcmljZSJdCgogICAgIyBJZiBPdmVyd3JpdGUKICAgIGlmIGFza19vdmVyd3JpdGU6CiAgICAgICAgcHJpbnQoZiJUb3RhbCBhbW91bnQgaXMge2Ftb3VudF9pbnR9LlxuRW50ZXIgbmV3IGFtb3VudCBpZiB5b3UgbmVlZCB0byBvdmVyd3JpdGUuIikKICAgICAgICBhbW91bnRfc3RyID0gaW5wdXQoIlByZXNzIGVudGVyIHRvIGlnbm9yZSAmIHVzZSBkZWZhdWx0IGFtb3VudDogIikKICAgICAgICBpZiBhbW91bnRfc3RyICE9ICIiOgogICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICBhbW91bnRfaW50ID0gaW50KGFtb3VudF9zdHIpCiAgICAgICAgICAgIGV4Y2VwdCBWYWx1ZUVycm9yOgogICAgICAgICAgICAgICAgcHJpbnQoIkludmFsaWQgb3ZlcndyaXRlIGlucHV0LCB1c2luZyBvcmlnaW5hbCBwcmljZS4iKQogICAgICAgICAgICAgICAgIyByZXR1cm4gTm9uZQogICAgCiAgICBpbnRlcmNlcHRfcGFnZShhcGlfa2V5LCB0b2tlbnMsIGl0ZW1zWzBdWyJpdGVtX2NvZGUiXSwgRmFsc2UpCiAgICAKICAgICMgR2V0IHBheW1lbnQgbWV0aG9kcwogICAgcGF5bWVudF9wYXRoID0gInBheW1lbnRzL2FwaS92OC9wYXltZW50LW1ldGhvZHMtb3B0aW9uIgogICAgcGF5bWVudF9wYXlsb2FkID0gewogICAgICAgICJwYXltZW50X3R5cGUiOiAiUFVSQ0hBU0UiLAogICAgICAgICJpc19lbnRlcnByaXNlIjogRmFsc2UsCiAgICAgICAgInBheW1lbnRfdGFyZ2V0IjogaXRlbXNbdG9rZW5fY29uZmlybWF0aW9uX2lkeF1bIml0ZW1fY29kZSJdLAogICAgICAgICJsYW5nIjogImVuIiwKICAgICAgICAiaXNfcmVmZXJyYWwiOiBGYWxzZSwKICAgICAgICAidG9rZW5fY29uZmlybWF0aW9uIjogdG9rZW5fY29uZmlybWF0aW9uCiAgICB9CiAgICAKICAgIHByaW50KCJHZXR0aW5nIHBheW1lbnQgbWV0aG9kcy4uLiIpCiAgICBwYXltZW50X3JlcyA9IHNlbmRfYXBpX3JlcXVlc3QoYXBpX2tleSwgcGF5bWVudF9wYXRoLCBwYXltZW50X3BheWxvYWQsIHRva2Vuc1siaWRfdG9rZW4iXSwgIlBPU1QiKQogICAgaWYgcGF5bWVudF9yZXNbInN0YXR1cyJdICE9ICJTVUNDRVNTIjoKICAgICAgICBwcmludCgiRmFpbGVkIHRvIGZldGNoIHBheW1lbnQgbWV0aG9kcy4iKQogICAgICAgIHByaW50KGYiRXJyb3I6IHtwYXltZW50X3Jlc30iKQogICAgICAgIHJldHVybiBOb25lCiAgICAKICAgIHRva2VuX3BheW1lbnQgPSBwYXltZW50X3Jlc1siZGF0YSJdWyJ0b2tlbl9wYXltZW50Il0KICAgIHRzX3RvX3NpZ24gPSBwYXltZW50X3Jlc1siZGF0YSJdWyJ0aW1lc3RhbXAiXQogICAgCiAgICAjIFNldHRsZW1lbnQgcmVxdWVzdAogICAgcGF0aCA9ICJwYXltZW50cy9hcGkvdjgvc2V0dGxlbWVudC1tdWx0aXBheW1lbnQvcXJpcyIKICAgIHNldHRsZW1lbnRfcGF5bG9hZCA9IHsKICAgICAgICAiYWtyYWIiOiB7CiAgICAgICAgICAgICJha3JhYl9tZW1iZXJzIjogW10sCiAgICAgICAgICAgICJha3JhYl9wYXJlbnRfYWxpYXMiOiAiIiwKICAgICAgICAgICAgIm1lbWJlcnMiOiBbXQogICAgICAgIH0sCiAgICAgICAgImNhbl90cmlnZ2VyX3JhdGluZyI6IEZhbHNlLAogICAgICAgICJ0b3RhbF9kaXNjb3VudCI6IDAsCiAgICAgICAgImNvdXBvbiI6ICIiLAogICAgICAgICJwYXltZW50X2ZvciI6IHBheW1lbnRfZm9yLAogICAgICAgICJ0b3B1cF9udW1iZXIiOiB0b3B1cF9udW1iZXIsCiAgICAgICAgInN0YWdlX3Rva2VuIjogc3RhZ2VfdG9rZW4sCiAgICAgICAgImlzX2VudGVycHJpc2UiOiBGYWxzZSwKICAgICAgICAiYXV0b2J1eSI6IHsKICAgICAgICAgICAgImlzX3VzaW5nX2F1dG9idXkiOiBGYWxzZSwKICAgICAgICAgICAgImFjdGl2YXRlZF9hdXRvYnV5X2NvZGUiOiAiIiwKICAgICAgICAgICAgImF1dG9idXlfdGhyZXNob2xkX3NldHRpbmciOiB7CiAgICAgICAgICAgICJsYWJlbCI6ICIiLAogICAgICAgICAgICAidHlwZSI6ICIiLAogICAgICAgICAgICAidmFsdWUiOiAwCiAgICAgICAgICAgIH0KICAgICAgICB9LAogICAgICAgICJhY2Nlc3NfdG9rZW4iOiB0b2tlbnNbImFjY2Vzc190b2tlbiJdLAogICAgICAgICJpc19teXhsX3dhbGxldCI6IEZhbHNlLAogICAgICAgICJhZGRpdGlvbmFsX2RhdGEiOiB7CiAgICAgICAgICAgICJvcmlnaW5hbF9wcmljZSI6IGl0ZW1zWzBdWyJpdGVtX3ByaWNlIl0sCiAgICAgICAgICAgICJpc19zcGVuZF9saW1pdF90ZW1wb3JhcnkiOiBGYWxzZSwKICAgICAgICAgICAgIm1pZ3JhdGlvbl90eXBlIjogIiIsCiAgICAgICAgICAgICJzcGVuZF9saW1pdF9hbW91bnQiOiAwLAogICAgICAgICAgICAiaXNfc3BlbmRfbGltaXQiOiBGYWxzZSwKICAgICAgICAgICAgInRheCI6IDAsCiAgICAgICAgICAgICJiZW5lZml0X3R5cGUiOiAiIiwKICAgICAgICAgICAgInF1b3RhX2JvbnVzIjogMCwKICAgICAgICAgICAgImNhc2h0YWciOiAiIiwKICAgICAgICAgICAgImlzX2ZhbWlseV9wbGFuIjogRmFsc2UsCiAgICAgICAgICAgICJjb21ib19kZXRhaWxzIjogW10sCiAgICAgICAgICAgICJpc19zd2l0Y2hfcGxhbiI6IEZhbHNlLAogICAgICAgICAgICAiZGlzY291bnRfcmVjdXJyaW5nIjogMCwKICAgICAgICAgICAgImhhc19ib251cyI6IEZhbHNlLAogICAgICAgICAgICAiZGlzY291bnRfcHJvbW8iOiAwCiAgICAgICAgfSwKICAgICAgICAidG90YWxfYW1vdW50IjogYW1vdW50X2ludCwKICAgICAgICAidG90YWxfZmVlIjogMCwKICAgICAgICAiaXNfdXNlX3BvaW50IjogRmFsc2UsCiAgICAgICAgImxhbmciOiAiZW4iLAogICAgICAgICJpdGVtcyI6IGl0ZW1zLAogICAgICAgICJ2ZXJpZmljYXRpb25fdG9rZW4iOiB0b2tlbl9wYXltZW50LAogICAgICAgICJwYXltZW50X21ldGhvZCI6ICJRUklTIiwKICAgICAgICAidGltZXN0YW1wIjogaW50KHRpbWUudGltZSgpKSwKICAgIH0KICAgIAogICAgZW5jcnlwdGVkX3BheWxvYWQgPSBlbmNyeXB0c2lnbl94ZGF0YSgKICAgICAgICBhcGlfa2V5PWFwaV9rZXksCiAgICAgICAgbWV0aG9kPSJQT1NUIiwKICAgICAgICBwYXRoPXBhdGgsCiAgICAgICAgaWRfdG9rZW49dG9rZW5zWyJpZF90b2tlbiJdLAogICAgICAgIHBheWxvYWQ9c2V0dGxlbWVudF9wYXlsb2FkCiAgICApCiAgICAKICAgIHh0aW1lID0gaW50KGVuY3J5cHRlZF9wYXlsb2FkWyJlbmNyeXB0ZWRfYm9keSJdWyJ4dGltZSJdKQogICAgc2lnX3RpbWVfc2VjID0gKHh0aW1lIC8vIDEwMDApCiAgICB4X3JlcXVlc3RlZF9hdCA9IGRhdGV0aW1lLmZyb210aW1lc3RhbXAoc2lnX3RpbWVfc2VjLCB0ej10aW1lem9uZS51dGMpLmFzdGltZXpvbmUoKQogICAgc2V0dGxlbWVudF9wYXlsb2FkWyJ0aW1lc3RhbXAiXSA9IHRzX3RvX3NpZ24KICAgIAogICAgYm9keSA9IGVuY3J5cHRlZF9wYXlsb2FkWyJlbmNyeXB0ZWRfYm9keSJdCiAgICB4X3NpZyA9IGdldF94X3NpZ25hdHVyZV9wYXltZW50KAogICAgICAgICAgICBhcGlfa2V5LAogICAgICAgICAgICB0b2tlbnNbImFjY2Vzc190b2tlbiJdLAogICAgICAgICAgICB0c190b19zaWduLAogICAgICAgICAgICBwYXltZW50X3RhcmdldHMsCiAgICAgICAgICAgIHRva2VuX3BheW1lbnQsCiAgICAgICAgICAgICJRUklTIiwKICAgICAgICAgICAgcGF5bWVudF9mb3IsCiAgICAgICAgICAgIHBhdGgKICAgICAgICApCiAgICAKICAgIGhlYWRlcnMgPSB7CiAgICAgICAgImhvc3QiOiBCQVNFX0FQSV9VUkwucmVwbGFjZSgiaHR0cHM6Ly8iLCAiIiksCiAgICAgICAgImNvbnRlbnQtdHlwZSI6ICJhcHBsaWNhdGlvbi9qc29uOyBjaGFyc2V0PXV0Zi04IiwKICAgICAgICAidXNlci1hZ2VudCI6IFVBLAogICAgICAgICJ4LWFwaS1rZXkiOiBBUElfS0VZLAogICAgICAgICJhdXRob3JpemF0aW9uIjogZiJCZWFyZXIge3Rva2Vuc1snaWRfdG9rZW4nXX0iLAogICAgICAgICJ4LWh2IjogInYzIiwKICAgICAgICAieC1zaWduYXR1cmUtdGltZSI6IHN0cihzaWdfdGltZV9zZWMpLAogICAgICAgICJ4LXNpZ25hdHVyZSI6IHhfc2lnLAogICAgICAgICJ4LXJlcXVlc3QtaWQiOiBzdHIodXVpZC51dWlkNCgpKSwKICAgICAgICAieC1yZXF1ZXN0LWF0IjogamF2YV9saWtlX3RpbWVzdGFtcCh4X3JlcXVlc3RlZF9hdCksCiAgICAgICAgIngtdmVyc2lvbi1hcHAiOiAiOC45LjAiLAogICAgfQogICAgCiAgICB1cmwgPSBmIntCQVNFX0FQSV9VUkx9L3twYXRofSIKICAgIHByaW50KCJTZW5kaW5nIHNldHRsZW1lbnQgcmVxdWVzdC4uLiIpCiAgICByZXNwID0gcmVxdWVzdHMucG9zdCh1cmwsIGhlYWRlcnM9aGVhZGVycywgZGF0YT1qc29uLmR1bXBzKGJvZHkpLCB0aW1lb3V0PTMwKQogICAgCiAgICB0cnk6CiAgICAgICAgZGVjcnlwdGVkX2JvZHkgPSBkZWNyeXB0X3hkYXRhKGFwaV9rZXksIGpzb24ubG9hZHMocmVzcC50ZXh0KSkKICAgICAgICBpZiBkZWNyeXB0ZWRfYm9keVsic3RhdHVzIl0gIT0gIlNVQ0NFU1MiOgogICAgICAgICAgICBwcmludCgiRmFpbGVkIHRvIGluaXRpYXRlIHNldHRsZW1lbnQuIikKICAgICAgICAgICAgcHJpbnQoZiJFcnJvcjoge2RlY3J5cHRlZF9ib2R5fSIpCiAgICAgICAgICAgIHJldHVybiBOb25lCiAgICAgICAgCiAgICAgICAgdHJhbnNhY3Rpb25faWQgPSBkZWNyeXB0ZWRfYm9keVsiZGF0YSJdWyJ0cmFuc2FjdGlvbl9jb2RlIl0KICAgICAgICAKICAgICAgICByZXR1cm4gdHJhbnNhY3Rpb25faWQKICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICBwcmludCgiW2RlY3J5cHQgZXJyXSIsIGUpCiAgICAgICAgcmV0dXJuIHJlc3AudGV4dAoKZGVmIGdldF9xcmlzX2NvZGUoCiAgICBhcGlfa2V5OiBzdHIsCiAgICB0b2tlbnM6IGRpY3QsCiAgICB0cmFuc2FjdGlvbl9pZDogc3RyCik6CiAgICBwYXRoID0gInBheW1lbnRzL2FwaS92OC9wZW5kaW5nLWRldGFpbCIKICAgIHBheWxvYWQgPSB7CiAgICAgICAgInRyYW5zYWN0aW9uX2lkIjogdHJhbnNhY3Rpb25faWQsCiAgICAgICAgImlzX2VudGVycHJpc2UiOiBGYWxzZSwKICAgICAgICAibGFuZyI6ICJlbiIsCiAgICAgICAgInN0YXR1cyI6ICIiCiAgICB9CiAgICAKICAgIHJlcyA9IHNlbmRfYXBpX3JlcXVlc3QoYXBpX2tleSwgcGF0aCwgcGF5bG9hZCwgdG9rZW5zWyJpZF90b2tlbiJdLCAiUE9TVCIpCiAgICBpZiByZXNbInN0YXR1cyJdICE9ICJTVUNDRVNTIjoKICAgICAgICBwcmludCgiRmFpbGVkIHRvIGZldGNoIFFSSVMgY29kZS4iKQogICAgICAgIHByaW50KGYiRXJyb3I6IHtyZXN9IikKICAgICAgICByZXR1cm4gTm9uZQogICAgCiAgICByZXR1cm4gcmVzWyJkYXRhIl1bInFyX2NvZGUiXQoKZGVmIHNob3dfcXJpc19wYXltZW50KAogICAgYXBpX2tleTogc3RyLAogICAgdG9rZW5zOiBkaWN0LAogICAgaXRlbXM6IGxpc3RbUGF5bWVudEl0ZW1dLAogICAgcGF5bWVudF9mb3I6IHN0ciwKICAgIGFza19vdmVyd3JpdGU6IGJvb2wsCiAgICBvdmVyd3JpdGVfYW1vdW50OiBpbnQgPSAtMSwKICAgIHRva2VuX2NvbmZpcm1hdGlvbl9pZHg6IGludCA9IDAsCiAgICBhbW91bnRfaWR4OiBpbnQgPSAtMSwKICAgIHRvcHVwX251bWJlcjogc3RyID0gIiIsCiAgICBzdGFnZV90b2tlbjogc3RyID0gIiIsCik6ICAKICAgIHRyYW5zYWN0aW9uX2lkID0gc2V0dGxlbWVudF9xcmlzKAogICAgICAgIGFwaV9rZXksCiAgICAgICAgdG9rZW5zLAogICAgICAgIGl0ZW1zLAogICAgICAgIHBheW1lbnRfZm9yLAogICAgICAgIGFza19vdmVyd3JpdGUsCiAgICAgICAgb3ZlcndyaXRlX2Ftb3VudCwKICAgICAgICB0b2tlbl9jb25maXJtYXRpb25faWR4LAogICAgICAgIGFtb3VudF9pZHgsCiAgICAgICAgdG9wdXBfbnVtYmVyLAogICAgICAgIHN0YWdlX3Rva2VuCiAgICApCiAgICAKICAgIGlmIG5vdCB0cmFuc2FjdGlvbl9pZDoKICAgICAgICBwcmludCgiRmFpbGVkIHRvIGNyZWF0ZSBRUklTIHRyYW5zYWN0aW9uLiIpCiAgICAgICAgcmV0dXJuCiAgICAKICAgIHByaW50KCJGZXRjaGluZyBRUklTIGNvZGUuLi4iKQogICAgcXJpc19jb2RlID0gZ2V0X3FyaXNfY29kZShhcGlfa2V5LCB0b2tlbnMsIHRyYW5zYWN0aW9uX2lkKQogICAgaWYgbm90IHFyaXNfY29kZToKICAgICAgICBwcmludCgiRmFpbGVkIHRvIGdldCBRUklTIGNvZGUuIikKICAgICAgICByZXR1cm4KICAgIHByaW50KGYiUVJJUyBkYXRhOlxue3FyaXNfY29kZX0iKQogICAgCiAgICBxciA9IHFyY29kZS5RUkNvZGUoCiAgICAgICAgdmVyc2lvbj0xLAogICAgICAgIGVycm9yX2NvcnJlY3Rpb249cXJjb2RlLmNvbnN0YW50cy5FUlJPUl9DT1JSRUNUX0wsCiAgICAgICAgYm94X3NpemU9MSwKICAgICAgICBib3JkZXI9MSwKICAgICkKICAgIHFyLmFkZF9kYXRhKHFyaXNfY29kZSkKICAgIHFyLm1ha2UoZml0PVRydWUpCiAgICBxci5wcmludF9hc2NpaShpbnZlcnQ9VHJ1ZSkKICAgIAogICAgcXJpc19iNjQgPSBiYXNlNjQudXJsc2FmZV9iNjRlbmNvZGUocXJpc19jb2RlLmVuY29kZSgpKS5kZWNvZGUoKQogICAgcXJpc191cmwgPSBmImh0dHBzOi8va2ktYXIta29kLm5ldGxpZnkuYXBwLz9kYXRhPXtxcmlzX2I2NH0iCiAgICAKICAgIHByaW50KGYiQXRhdSBidWthIGxpbmsgYmVyaWt1dCB1bnR1ayBtZWxpaGF0IFFSSVM6XG57cXJpc191cmx9IikKICAgIAogICAgcmV0dXJuIHFyaXNfYjY0Cg==').decode())
