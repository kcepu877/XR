#!/usr/bin/env python3
import base64
exec(base64.b64decode('aW1wb3J0IGpzb24KaW1wb3J0IHRpbWUKaW1wb3J0IHV1aWQKZnJvbSBkYXRldGltZSBpbXBvcnQgdGltZXpvbmUsIGRhdGV0aW1lCgppbXBvcnQgcmVxdWVzdHMKCmZyb20gYXBwLmNsaWVudC5lbmNyeXB0IGltcG9ydCBBUElfS0VZLCBidWlsZF9lbmNyeXB0ZWRfZmllbGQsIGRlY3J5cHRfeGRhdGEsIGVuY3J5cHRzaWduX3hkYXRhLCBcCiAgICBnZXRfeF9zaWduYXR1cmVfcGF5bWVudCwgamF2YV9saWtlX3RpbWVzdGFtcApmcm9tIGFwcC5jbGllbnQuZW5nc2VsIGltcG9ydCBCQVNFX0FQSV9VUkwsIFVBLCBpbnRlcmNlcHRfcGFnZSwgc2VuZF9hcGlfcmVxdWVzdApmcm9tIGFwcC50eXBlX2RpY3QgaW1wb3J0IFBheW1lbnRJdGVtCgoKZGVmIHNldHRsZW1lbnRfYmFsYW5jZSgKICAgICAgICBhcGlfa2V5OiBzdHIsCiAgICAgICAgdG9rZW5zOiBkaWN0LAogICAgICAgIGl0ZW1zOiBsaXN0W1BheW1lbnRJdGVtXSwKICAgICAgICBwYXltZW50X2Zvcjogc3RyLAogICAgICAgIGFza19vdmVyd3JpdGU6IGJvb2wsCiAgICAgICAgb3ZlcndyaXRlX2Ftb3VudDogaW50ID0gLTEsCiAgICAgICAgdG9rZW5fY29uZmlybWF0aW9uX2lkeDogaW50ID0gMCwKICAgICAgICBhbW91bnRfaWR4OiBpbnQgPSAtMSwKKToKICAgICMgU2FuaXR5IGNoZWNrCiAgICBpZiBvdmVyd3JpdGVfYW1vdW50ID09IC0xIGFuZCBub3QgYXNrX292ZXJ3cml0ZToKICAgICAgICBwcmludCgiRWl0aGVyIGFza19vdmVyd3JpdGUgbXVzdCBiZSBUcnVlIG9yIG92ZXJ3cml0ZV9hbW91bnQgbXVzdCBiZSBzZXQuIikKICAgICAgICByZXR1cm4gTm9uZQoKICAgIHRva2VuX2NvbmZpcm1hdGlvbiA9IGl0ZW1zW3Rva2VuX2NvbmZpcm1hdGlvbl9pZHhdWyJ0b2tlbl9jb25maXJtYXRpb24iXQogICAgcGF5bWVudF90YXJnZXRzID0gIiIKICAgIGZvciBpdGVtIGluIGl0ZW1zOgogICAgICAgIGlmIHBheW1lbnRfdGFyZ2V0cyAhPSAiIjoKICAgICAgICAgICAgcGF5bWVudF90YXJnZXRzICs9ICI7IgogICAgICAgIHBheW1lbnRfdGFyZ2V0cyArPSBpdGVtWyJpdGVtX2NvZGUiXQoKICAgIGFtb3VudF9pbnQgPSAwCgogICAgIyBEZXRlcm1pbmUgYW1vdW50IHRvIHVzZQogICAgaWYgb3ZlcndyaXRlX2Ftb3VudCAhPSAtMToKICAgICAgICBhbW91bnRfaW50ID0gb3ZlcndyaXRlX2Ftb3VudAogICAgZWxpZiBhbW91bnRfaWR4ID09IC0xOgogICAgICAgIGFtb3VudF9pbnQgPSBpdGVtc1thbW91bnRfaWR4XVsiaXRlbV9wcmljZSJdCgogICAgIyBJZiBPdmVyd3JpdGUKICAgIGlmIGFza19vdmVyd3JpdGU6CiAgICAgICAgcHJpbnQoZiJUb3RhbCBhbW91bnQgaXMge2Ftb3VudF9pbnR9LlxuRW50ZXIgbmV3IGFtb3VudCBpZiB5b3UgbmVlZCB0byBvdmVyd3JpdGUuIikKICAgICAgICBhbW91bnRfc3RyID0gaW5wdXQoIlByZXNzIGVudGVyIHRvIGlnbm9yZSAmIHVzZSBkZWZhdWx0IGFtb3VudDogIikKICAgICAgICBpZiBhbW91bnRfc3RyICE9ICIiOgogICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICBhbW91bnRfaW50ID0gaW50KGFtb3VudF9zdHIpCiAgICAgICAgICAgIGV4Y2VwdCBWYWx1ZUVycm9yOgogICAgICAgICAgICAgICAgcHJpbnQoIkludmFsaWQgb3ZlcndyaXRlIGlucHV0LCB1c2luZyBvcmlnaW5hbCBwcmljZS4iKQogICAgICAgICAgICAgICAgIyByZXR1cm4gTm9uZQogICAgaW50ZXJjZXB0X3BhZ2UoYXBpX2tleSwgdG9rZW5zLCBpdGVtc1swXVsiaXRlbV9jb2RlIl0sIEZhbHNlKQoKICAgICMgR2V0IHBheW1lbnQgbWV0aG9kcwogICAgcGF5bWVudF9wYXRoID0gInBheW1lbnRzL2FwaS92OC9wYXltZW50LW1ldGhvZHMtb3B0aW9uIgogICAgcGF5bWVudF9wYXlsb2FkID0gewogICAgICAgICJwYXltZW50X3R5cGUiOiAiUFVSQ0hBU0UiLAogICAgICAgICJpc19lbnRlcnByaXNlIjogRmFsc2UsCiAgICAgICAgInBheW1lbnRfdGFyZ2V0IjogaXRlbXNbdG9rZW5fY29uZmlybWF0aW9uX2lkeF1bIml0ZW1fY29kZSJdLAogICAgICAgICJsYW5nIjogImVuIiwKICAgICAgICAiaXNfcmVmZXJyYWwiOiBGYWxzZSwKICAgICAgICAidG9rZW5fY29uZmlybWF0aW9uIjogdG9rZW5fY29uZmlybWF0aW9uCiAgICB9CgogICAgcHJpbnQoIkdldHRpbmcgcGF5bWVudCBtZXRob2RzLi4uIikKICAgIHBheW1lbnRfcmVzID0gc2VuZF9hcGlfcmVxdWVzdChhcGlfa2V5LCBwYXltZW50X3BhdGgsIHBheW1lbnRfcGF5bG9hZCwgdG9rZW5zWyJpZF90b2tlbiJdLCAiUE9TVCIpCiAgICBpZiBwYXltZW50X3Jlc1sic3RhdHVzIl0gIT0gIlNVQ0NFU1MiOgogICAgICAgIHByaW50KCJGYWlsZWQgdG8gZmV0Y2ggcGF5bWVudCBtZXRob2RzLiIpCiAgICAgICAgcHJpbnQoZiJFcnJvcjoge3BheW1lbnRfcmVzfSIpCiAgICAgICAgcmV0dXJuIHBheW1lbnRfcmVzCgogICAgdG9rZW5fcGF5bWVudCA9IHBheW1lbnRfcmVzWyJkYXRhIl1bInRva2VuX3BheW1lbnQiXQogICAgdHNfdG9fc2lnbiA9IHBheW1lbnRfcmVzWyJkYXRhIl1bInRpbWVzdGFtcCJdCgogICAgIyBTZXR0bGVtZW50IHJlcXVlc3QKICAgIHBhdGggPSAicGF5bWVudHMvYXBpL3Y4L3NldHRsZW1lbnQtbXVsdGlwYXltZW50IgogICAgc2V0dGxlbWVudF9wYXlsb2FkID0gewogICAgICAgICJ0b3RhbF9kaXNjb3VudCI6IDAsCiAgICAgICAgImlzX2VudGVycHJpc2UiOiBGYWxzZSwKICAgICAgICAicGF5bWVudF90b2tlbiI6ICIiLAogICAgICAgICJ0b2tlbl9wYXltZW50IjogdG9rZW5fcGF5bWVudCwKICAgICAgICAiYWN0aXZhdGVkX2F1dG9idXlfY29kZSI6ICIiLAogICAgICAgICJjY19wYXltZW50X3R5cGUiOiAiIiwKICAgICAgICAiaXNfbXl4bF93YWxsZXQiOiBGYWxzZSwKICAgICAgICAicGluIjogIiIsCiAgICAgICAgImV3YWxsZXRfcHJvbW9faWQiOiAiIiwKICAgICAgICAibWVtYmVycyI6IFtdLAogICAgICAgICJ0b3RhbF9mZWUiOiAwLAogICAgICAgICJmaW5nZXJwcmludCI6ICIiLAogICAgICAgICJhdXRvYnV5X3RocmVzaG9sZF9zZXR0aW5nIjogewogICAgICAgICAgICAibGFiZWwiOiAiIiwKICAgICAgICAgICAgInR5cGUiOiAiIiwKICAgICAgICAgICAgInZhbHVlIjogMAogICAgICAgIH0sCiAgICAgICAgImlzX3VzZV9wb2ludCI6IEZhbHNlLAogICAgICAgICJsYW5nIjogImVuIiwKICAgICAgICAicGF5bWVudF9tZXRob2QiOiAiQkFMQU5DRSIsCiAgICAgICAgInRpbWVzdGFtcCI6IGludCh0aW1lLnRpbWUoKSksCiAgICAgICAgInBvaW50c19nYWluZWQiOiAwLAogICAgICAgICJjYW5fdHJpZ2dlcl9yYXRpbmciOiBGYWxzZSwKICAgICAgICAiYWtyYWJfbWVtYmVycyI6IFtdLAogICAgICAgICJha3JhYl9wYXJlbnRfYWxpYXMiOiAiIiwKICAgICAgICAicmVmZXJyYWxfdW5pcXVlX2NvZGUiOiAiIiwKICAgICAgICAiY291cG9uIjogIiIsCiAgICAgICAgInBheW1lbnRfZm9yIjogcGF5bWVudF9mb3IsCiAgICAgICAgIndpdGhfdXBzZWxsIjogRmFsc2UsCiAgICAgICAgInRvcHVwX251bWJlciI6ICIiLAogICAgICAgICJzdGFnZV90b2tlbiI6ICIiLAogICAgICAgICJhdXRoZW50aWNhdGlvbl9pZCI6ICIiLAogICAgICAgICJlbmNyeXB0ZWRfcGF5bWVudF90b2tlbiI6IGJ1aWxkX2VuY3J5cHRlZF9maWVsZCh1cmxzYWZlX2I2ND1UcnVlKSwKICAgICAgICAidG9rZW4iOiAiIiwKICAgICAgICAidG9rZW5fY29uZmlybWF0aW9uIjogIiIsCiAgICAgICAgImFjY2Vzc190b2tlbiI6IHRva2Vuc1siYWNjZXNzX3Rva2VuIl0sCiAgICAgICAgIndhbGxldF9udW1iZXIiOiAiIiwKICAgICAgICAiZW5jcnlwdGVkX2F1dGhlbnRpY2F0aW9uX2lkIjogYnVpbGRfZW5jcnlwdGVkX2ZpZWxkKHVybHNhZmVfYjY0PVRydWUpLAogICAgICAgICJhZGRpdGlvbmFsX2RhdGEiOiB7CiAgICAgICAgICAgICJvcmlnaW5hbF9wcmljZSI6IGl0ZW1zWy0xXVsiaXRlbV9wcmljZSJdLAogICAgICAgICAgICAiaXNfc3BlbmRfbGltaXRfdGVtcG9yYXJ5IjogRmFsc2UsCiAgICAgICAgICAgICJtaWdyYXRpb25fdHlwZSI6ICIiLAogICAgICAgICAgICAiYWtyYWJfbTJtX2dyb3VwX2lkIjogImZhbHNlIiwKICAgICAgICAgICAgInNwZW5kX2xpbWl0X2Ftb3VudCI6IDAsCiAgICAgICAgICAgICJpc19zcGVuZF9saW1pdCI6IEZhbHNlLAogICAgICAgICAgICAibWlzc2lvbl9pZCI6ICIiLAogICAgICAgICAgICAidGF4IjogMCwKICAgICAgICAgICAgInF1b3RhX2JvbnVzIjogMCwKICAgICAgICAgICAgImNhc2h0YWciOiAiIiwKICAgICAgICAgICAgImlzX2ZhbWlseV9wbGFuIjogRmFsc2UsCiAgICAgICAgICAgICJjb21ib19kZXRhaWxzIjogW10sCiAgICAgICAgICAgICJpc19zd2l0Y2hfcGxhbiI6IEZhbHNlLAogICAgICAgICAgICAiZGlzY291bnRfcmVjdXJyaW5nIjogMCwKICAgICAgICAgICAgImlzX2FrcmFiX20ybSI6IEZhbHNlLAogICAgICAgICAgICAiYmFsYW5jZV90eXBlIjogIlBSRVBBSURfQkFMQU5DRSIsCiAgICAgICAgICAgICJoYXNfYm9udXMiOiBGYWxzZSwKICAgICAgICAgICAgImRpc2NvdW50X3Byb21vIjogMAogICAgICAgIH0sCiAgICAgICAgInRvdGFsX2Ftb3VudCI6IGFtb3VudF9pbnQsCiAgICAgICAgImlzX3VzaW5nX2F1dG9idXkiOiBGYWxzZSwKICAgICAgICAiaXRlbXMiOiBpdGVtcywKICAgIH0KCiAgICBlbmNyeXB0ZWRfcGF5bG9hZCA9IGVuY3J5cHRzaWduX3hkYXRhKAogICAgICAgIGFwaV9rZXk9YXBpX2tleSwKICAgICAgICBtZXRob2Q9IlBPU1QiLAogICAgICAgIHBhdGg9cGF0aCwKICAgICAgICBpZF90b2tlbj10b2tlbnNbImlkX3Rva2VuIl0sCiAgICAgICAgcGF5bG9hZD1zZXR0bGVtZW50X3BheWxvYWQKICAgICkKCiAgICB4dGltZSA9IGludChlbmNyeXB0ZWRfcGF5bG9hZFsiZW5jcnlwdGVkX2JvZHkiXVsieHRpbWUiXSkKICAgIHNpZ190aW1lX3NlYyA9ICh4dGltZSAvLyAxMDAwKQogICAgeF9yZXF1ZXN0ZWRfYXQgPSBkYXRldGltZS5mcm9tdGltZXN0YW1wKHNpZ190aW1lX3NlYywgdHo9dGltZXpvbmUudXRjKS5hc3RpbWV6b25lKCkKICAgIHNldHRsZW1lbnRfcGF5bG9hZFsidGltZXN0YW1wIl0gPSB0c190b19zaWduCgogICAgYm9keSA9IGVuY3J5cHRlZF9wYXlsb2FkWyJlbmNyeXB0ZWRfYm9keSJdCiAgICB4X3NpZyA9IGdldF94X3NpZ25hdHVyZV9wYXltZW50KAogICAgICAgIGFwaV9rZXksCiAgICAgICAgdG9rZW5zWyJhY2Nlc3NfdG9rZW4iXSwKICAgICAgICB0c190b19zaWduLAogICAgICAgIHBheW1lbnRfdGFyZ2V0cywKICAgICAgICB0b2tlbl9wYXltZW50LAogICAgICAgICJCQUxBTkNFIiwKICAgICAgICBwYXltZW50X2ZvciwKICAgICAgICBwYXRoCiAgICApCgogICAgaGVhZGVycyA9IHsKICAgICAgICAiaG9zdCI6IEJBU0VfQVBJX1VSTC5yZXBsYWNlKCJodHRwczovLyIsICIiKSwKICAgICAgICAiY29udGVudC10eXBlIjogImFwcGxpY2F0aW9uL2pzb247IGNoYXJzZXQ9dXRmLTgiLAogICAgICAgICJ1c2VyLWFnZW50IjogVUEsCiAgICAgICAgIngtYXBpLWtleSI6IEFQSV9LRVksCiAgICAgICAgImF1dGhvcml6YXRpb24iOiBmIkJlYXJlciB7dG9rZW5zWydpZF90b2tlbiddfSIsCiAgICAgICAgIngtaHYiOiAidjMiLAogICAgICAgICJ4LXNpZ25hdHVyZS10aW1lIjogc3RyKHNpZ190aW1lX3NlYyksCiAgICAgICAgIngtc2lnbmF0dXJlIjogeF9zaWcsCiAgICAgICAgIngtcmVxdWVzdC1pZCI6IHN0cih1dWlkLnV1aWQ0KCkpLAogICAgICAgICJ4LXJlcXVlc3QtYXQiOiBqYXZhX2xpa2VfdGltZXN0YW1wKHhfcmVxdWVzdGVkX2F0KSwKICAgICAgICAieC12ZXJzaW9uLWFwcCI6ICI4LjguMCIsCiAgICB9CgogICAgdXJsID0gZiJ7QkFTRV9BUElfVVJMfS97cGF0aH0iCiAgICBwcmludCgiU2VuZGluZyBzZXR0bGVtZW50IHJlcXVlc3QuLi4iKQogICAgcmVzcCA9IHJlcXVlc3RzLnBvc3QodXJsLCBoZWFkZXJzPWhlYWRlcnMsIGRhdGE9anNvbi5kdW1wcyhib2R5KSwgdGltZW91dD0zMCkKCiAgICB0cnk6CiAgICAgICAgZGVjcnlwdGVkX2JvZHkgPSBkZWNyeXB0X3hkYXRhKGFwaV9rZXksIGpzb24ubG9hZHMocmVzcC50ZXh0KSkKICAgICAgICBpZiBkZWNyeXB0ZWRfYm9keVsic3RhdHVzIl0gIT0gIlNVQ0NFU1MiOgogICAgICAgICAgICBwcmludCgiRmFpbGVkIHRvIGluaXRpYXRlIHNldHRsZW1lbnQuIikKICAgICAgICAgICAgcHJpbnQoZiJFcnJvcjoge2RlY3J5cHRlZF9ib2R5fSIpCiAgICAgICAgICAgIHJldHVybiBkZWNyeXB0ZWRfYm9keQoKICAgICAgICBwcmludChmIlB1cmNoYXNlIHJlc3VsdDpcbntqc29uLmR1bXBzKGRlY3J5cHRlZF9ib2R5LCBpbmRlbnQ9Mil9IikKCiAgICAgICAgcmV0dXJuIGRlY3J5cHRlZF9ib2R5CiAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgcHJpbnQoIltkZWNyeXB0IGVycl0iLCBlKQogICAgICAgIHJldHVybiByZXNwLnRleHQK').decode())
