#!/usr/bin/env python3
import base64
exec(base64.b64decode('ZnJvbSBhcHAuY2xpZW50LmVuZ3NlbCBpbXBvcnQgc2VuZF9hcGlfcmVxdWVzdAoKZGVmIGdldF9mYW1pbHlfbGlzdCgKICAgIGFwaV9rZXk6IHN0ciwKICAgIHRva2VuczogZGljdCwKICAgIHN1YnNfdHlwZTogc3RyID0gIlBSRVBBSUQiLAogICAgaXNfZW50ZXJwcmlzZTogYm9vbCA9IEZhbHNlLAopOgogICAgcGF0aCA9ICJhcGkvdjgveGwtc3RvcmVzL29wdGlvbnMvc2VhcmNoL2ZhbWlseS1saXN0IgogICAgcGF5bG9hZCA9IHsKICAgICAgICAiaXNfZW50ZXJwcmlzZSI6IGlzX2VudGVycHJpc2UsCiAgICAgICAgInN1YnNfdHlwZSI6IHN1YnNfdHlwZSwKICAgICAgICAibGFuZyI6ICJlbiIKICAgIH0KICAgIAogICAgcmVzID0gc2VuZF9hcGlfcmVxdWVzdChhcGlfa2V5LCBwYXRoLCBwYXlsb2FkLCB0b2tlbnNbImlkX3Rva2VuIl0sICJQT1NUIikKICAgIGlmIHJlc1sic3RhdHVzIl0gIT0gIlNVQ0NFU1MiOgogICAgICAgIHByaW50KCJGYWlsZWQgdG8gZmV0Y2ggZmFtaWx5IGxpc3QuIikKICAgICAgICBwcmludChmIkVycm9yOiB7cmVzfSIpCiAgICAgICAgcmV0dXJuIE5vbmUKICAgIAogICAgcmV0dXJuIHJlcwoKZGVmIGdldF9zdG9yZV9wYWNrYWdlcygKICAgIGFwaV9rZXk6IHN0ciwKICAgIHRva2VuczogZGljdCwKICAgIHN1YnNfdHlwZTogc3RyID0gIlBSRVBBSUQiLAogICAgaXNfZW50ZXJwcmlzZTogYm9vbCA9IEZhbHNlLAopOgogICAgcGF0aCA9ICJhcGkvdjkveGwtc3RvcmVzL29wdGlvbnMvc2VhcmNoIgogICAgcGF5bG9hZCA9IHsKICAgICAgICAiaXNfZW50ZXJwcmlzZSI6IGlzX2VudGVycHJpc2UsCiAgICAgICAgImZpbHRlcnMiOiBbCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICJ1bml0IjogIlRIT1VTQU5EIiwKICAgICAgICAgICAgICAgICJpZCI6ICJGSUxfU0VMX1AiLAogICAgICAgICAgICAgICAgInR5cGUiOiAiUFJJQ0UiLAogICAgICAgICAgICAgICAgIml0ZW1zIjogW10KICAgICAgICAgICAgfSwKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgInVuaXQiOiAiR0IiLAogICAgICAgICAgICAgICAgImlkIjogIkZJTF9TRUxfTVEiLAogICAgICAgICAgICAgICAgInR5cGUiOiAiREFUQV9UWVBFIiwKICAgICAgICAgICAgICAgICJpdGVtcyI6IFtdCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAidW5pdCI6ICJQQUNLQUdFX05BTUUiLAogICAgICAgICAgICAgICAgImlkIjogIkZJTF9QS0dfTiIsCiAgICAgICAgICAgICAgICAidHlwZSI6ICJQQUNLQUdFX05BTUUiLAogICAgICAgICAgICAgICAgIml0ZW1zIjogW3sKICAgICAgICAgICAgICAgICAgICAiaWQiOiAiIiwKICAgICAgICAgICAgICAgICAgICAibGFiZWwiOiAiIgogICAgICAgICAgICAgICAgfV0KICAgICAgICAgICAgfSwKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgInVuaXQiOiAiREFZIiwKICAgICAgICAgICAgICAgICJpZCI6ICJGSUxfU0VMX1YiLAogICAgICAgICAgICAgICAgInR5cGUiOiAiVkFMSURJVFkiLAogICAgICAgICAgICAgICAgIml0ZW1zIjogW10KICAgICAgICAgICAgfQogICAgICAgIF0sCiAgICAgICAgInN1YnN0eXBlIjogc3Vic190eXBlLAogICAgICAgICJ0ZXh0X3NlYXJjaCI6ICIiLAogICAgICAgICJsYW5nIjogImVuIgogICAgfQogICAgCiAgICByZXMgPSBzZW5kX2FwaV9yZXF1ZXN0KGFwaV9rZXksIHBhdGgsIHBheWxvYWQsIHRva2Vuc1siaWRfdG9rZW4iXSwgIlBPU1QiKQogICAgaWYgcmVzWyJzdGF0dXMiXSAhPSAiU1VDQ0VTUyI6CiAgICAgICAgcHJpbnQoIkZhaWxlZCB0byBmZXRjaCBzdG9yZSBwYWNrYWdlcy4iKQogICAgICAgIHByaW50KGYiRXJyb3I6IHtyZXN9IikKICAgICAgICByZXR1cm4gTm9uZQogICAgCiAgICByZXR1cm4gcmVz').decode())
