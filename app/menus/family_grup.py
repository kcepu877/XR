#!/usr/bin/env python3
import base64
exec(base64.b64decode('aW1wb3J0IG9zCmltcG9ydCBqc29uCgpmcm9tIGFwcC5jb25maWcuaW1wb3J0cyBpbXBvcnQgKgpmcm9tIGFwcC5tZW51cy5wYWNrYWdlIGltcG9ydCBnZXRfcGFja2FnZXNfYnlfZmFtaWx5CmZyb20gYXBwLm1lbnVzLnV0aWwgaW1wb3J0IGNsZWFyX3NjcmVlbiwgcGF1c2UsIHByaW50X3BhbmVsLCBsaXZlX2xvYWRpbmcsIHNpbXBsZV9udW1iZXIKCmNvbnNvbGUgPSBDb25zb2xlKCkKCgpGQU1JTFlfRklMRSA9IG9zLnBhdGguYWJzcGF0aCgiZmFtaWx5X2NvZGVzLmpzb24iKQoKCmRlZiBlbnN1cmVfZmFtaWx5X2ZpbGUoKToKICAgIGRlZmF1bHRfZGF0YSA9IHsiY29kZXMiOiBbXX0KICAgIGlmIG5vdCBvcy5wYXRoLmV4aXN0cyhGQU1JTFlfRklMRSk6CiAgICAgICAgd2l0aCBvcGVuKEZBTUlMWV9GSUxFLCAidyIpIGFzIGY6CiAgICAgICAgICAgIGpzb24uZHVtcChkZWZhdWx0X2RhdGEsIGYsIGluZGVudD0yKQogICAgICAgIHJldHVybiBkZWZhdWx0X2RhdGEKCiAgICB0cnk6CiAgICAgICAgd2l0aCBvcGVuKEZBTUlMWV9GSUxFLCAiciIpIGFzIGY6CiAgICAgICAgICAgIGRhdGEgPSBqc29uLmxvYWQoZikKICAgICAgICBpZiBub3QgaXNpbnN0YW5jZShkYXRhLCBkaWN0KSBvciAiY29kZXMiIG5vdCBpbiBkYXRhIG9yIG5vdCBpc2luc3RhbmNlKGRhdGFbImNvZGVzIl0sIGxpc3QpOgogICAgICAgICAgICByYWlzZSBWYWx1ZUVycm9yKCJTdHJ1a3R1ciB0aWRhayB2YWxpZCIpCiAgICAgICAgcmV0dXJuIGRhdGEKICAgIGV4Y2VwdCAoanNvbi5KU09ORGVjb2RlRXJyb3IsIFZhbHVlRXJyb3IpOgogICAgICAgIHdpdGggb3BlbihGQU1JTFlfRklMRSwgInciKSBhcyBmOgogICAgICAgICAgICBqc29uLmR1bXAoZGVmYXVsdF9kYXRhLCBmLCBpbmRlbnQ9MikKICAgICAgICByZXR1cm4gZGVmYXVsdF9kYXRhCgoKZGVmIGxpc3RfZmFtaWx5X2NvZGVzKCk6CiAgICByZXR1cm4gZW5zdXJlX2ZhbWlseV9maWxlKClbImNvZGVzIl0KCgpkZWYgYWRkX2ZhbWlseV9jb2RlKGNvZGUsIG5hbWUpOgogICAgaWYgbm90IGNvZGUuc3RyaXAoKSBvciBub3QgbmFtZS5zdHJpcCgpOgogICAgICAgIHJldHVybiBGYWxzZQogICAgZGF0YSA9IGVuc3VyZV9mYW1pbHlfZmlsZSgpCiAgICBpZiBhbnkoaXRlbVsiY29kZSJdID09IGNvZGUgZm9yIGl0ZW0gaW4gZGF0YVsiY29kZXMiXSk6CiAgICAgICAgcmV0dXJuIEZhbHNlCiAgICBkYXRhWyJjb2RlcyJdLmFwcGVuZCh7ImNvZGUiOiBjb2RlLnN0cmlwKCksICJuYW1lIjogbmFtZS5zdHJpcCgpfSkKICAgIHdpdGggb3BlbihGQU1JTFlfRklMRSwgInciKSBhcyBmOgogICAgICAgIGpzb24uZHVtcChkYXRhLCBmLCBpbmRlbnQ9MikKICAgIHJldHVybiBUcnVlCgoKZGVmIHJlbW92ZV9mYW1pbHlfY29kZShpbmRleCk6CiAgICBkYXRhID0gZW5zdXJlX2ZhbWlseV9maWxlKCkKICAgIGlmIDAgPD0gaW5kZXggPCBsZW4oZGF0YVsiY29kZXMiXSk6CiAgICAgICAgcmVtb3ZlZCA9IGRhdGFbImNvZGVzIl0ucG9wKGluZGV4KQogICAgICAgIHdpdGggb3BlbihGQU1JTFlfRklMRSwgInciKSBhcyBmOgogICAgICAgICAgICBqc29uLmR1bXAoZGF0YSwgZiwgaW5kZW50PTIpCiAgICAgICAgcmV0dXJuIHJlbW92ZWRbImNvZGUiXQogICAgcmV0dXJuIE5vbmUKCgpkZWYgZWRpdF9mYW1pbHlfbmFtZShpbmRleCwgbmV3X25hbWUpOgogICAgaWYgbm90IG5ld19uYW1lLnN0cmlwKCk6CiAgICAgICAgcmV0dXJuIEZhbHNlCiAgICBkYXRhID0gZW5zdXJlX2ZhbWlseV9maWxlKCkKICAgIGlmIDAgPD0gaW5kZXggPCBsZW4oZGF0YVsiY29kZXMiXSk6CiAgICAgICAgZGF0YVsiY29kZXMiXVtpbmRleF1bIm5hbWUiXSA9IG5ld19uYW1lLnN0cmlwKCkKICAgICAgICB3aXRoIG9wZW4oRkFNSUxZX0ZJTEUsICJ3IikgYXMgZjoKICAgICAgICAgICAganNvbi5kdW1wKGRhdGEsIGYsIGluZGVudD0yKQogICAgICAgIHJldHVybiBUcnVlCiAgICByZXR1cm4gRmFsc2UKCgpkZWYgc2hvd19mYW1pbHlfZ3J1cF9tZW51KHJldHVybl9wYWNrYWdlX2RldGFpbDogYm9vbCA9IEZhbHNlKToKICAgIHdoaWxlIFRydWU6CiAgICAgICAgY2xlYXJfc2NyZWVuKCkKICAgICAgICBlbnN1cmVfZ2l0KCkKICAgICAgICBzZW11YV9rb2RlID0gbGlzdF9mYW1pbHlfY29kZXMoKQogICAgICAgIHRoZW1lID0gZ2V0X3RoZW1lKCkKCiAgICAgICAgY29uc29sZS5wcmludChQYW5lbCgKICAgICAgICAgICAgQWxpZ24uY2VudGVyKCLwn5OLIEZhbWlseSBLb2RlIFlhbmcgVGVyZGFmdGFyIiwgdmVydGljYWw9Im1pZGRsZSIpLAogICAgICAgICAgICBib3JkZXJfc3R5bGU9dGhlbWVbImJvcmRlcl9pbmZvIl0sCiAgICAgICAgICAgIHBhZGRpbmc9KDEsIDIpLAogICAgICAgICAgICBleHBhbmQ9VHJ1ZQogICAgICAgICkpCiAgICAgICAgc2ltcGxlX251bWJlcigpCgogICAgICAgIHBhY2thZ2VzID0gW10KICAgICAgICBpZiBzZW11YV9rb2RlOgogICAgICAgICAgICB0YWJsZSA9IFRhYmxlKGJveD1NSU5JTUFMX0RPVUJMRV9IRUFELCBleHBhbmQ9VHJ1ZSkKICAgICAgICAgICAgdGFibGUuYWRkX2NvbHVtbigiTm8iLCBqdXN0aWZ5PSJyaWdodCIsIHN0eWxlPXRoZW1lWyJ0ZXh0X2tleSJdLCB3aWR0aD0zKQogICAgICAgICAgICB0YWJsZS5hZGRfY29sdW1uKCJOYW1hIEZDIiwgc3R5bGU9dGhlbWVbInRleHRfYm9keSJdKQogICAgICAgICAgICB0YWJsZS5hZGRfY29sdW1uKCJGYW1pbHkgQ29kZSIsIHN0eWxlPXRoZW1lWyJib3JkZXJfaW5mbyJdKQoKICAgICAgICAgICAgZm9yIGksIGl0ZW0gaW4gZW51bWVyYXRlKHNlbXVhX2tvZGUsIHN0YXJ0PTEpOgogICAgICAgICAgICAgICAgdGFibGUuYWRkX3JvdyhzdHIoaSksIGl0ZW1bIm5hbWUiXSwgaXRlbVsiY29kZSJdKQogICAgICAgICAgICAgICAgcGFja2FnZXMuYXBwZW5kKHsKICAgICAgICAgICAgICAgICAgICAibnVtYmVyIjogaSwKICAgICAgICAgICAgICAgICAgICAiY29kZSI6IGl0ZW1bImNvZGUiXSwKICAgICAgICAgICAgICAgICAgICAibmFtZSI6IGl0ZW1bIm5hbWUiXQogICAgICAgICAgICAgICAgfSkKCiAgICAgICAgICAgIGNvbnNvbGUucHJpbnQoUGFuZWwodGFibGUsIGJvcmRlcl9zdHlsZT10aGVtZVsiYm9yZGVyX2luZm8iXSwgcGFkZGluZz0oMCwgMCksIGV4cGFuZD1UcnVlKSkKICAgICAgICBlbHNlOgogICAgICAgICAgICBjb25zb2xlLnByaW50KFBhbmVsKAogICAgICAgICAgICAgICAgIltpdGFsaWNdQmVsdW0gYWRhIGZhbWlseSBjb2RlIHlhbmcgdGVyZGFmdGFyLlsvaXRhbGljXSIsCiAgICAgICAgICAgICAgICBib3JkZXJfc3R5bGU9dGhlbWVbImJvcmRlcl93YXJuaW5nIl0sCiAgICAgICAgICAgICAgICBwYWRkaW5nPSgxLCAyKSwKICAgICAgICAgICAgICAgIGV4cGFuZD1UcnVlCiAgICAgICAgICAgICkpCgogICAgICAgIG5hdl90YWJsZSA9IFRhYmxlKHNob3dfaGVhZGVyPUZhbHNlLCBib3g9TUlOSU1BTF9ET1VCTEVfSEVBRCwgZXhwYW5kPVRydWUpCiAgICAgICAgbmF2X3RhYmxlLmFkZF9jb2x1bW4oanVzdGlmeT0icmlnaHQiLCBzdHlsZT10aGVtZVsidGV4dF9rZXkiXSwgd2lkdGg9NikKICAgICAgICBuYXZfdGFibGUuYWRkX2NvbHVtbihzdHlsZT10aGVtZVsidGV4dF9ib2R5Il0pCiAgICAgICAgbmF2X3RhYmxlLmFkZF9yb3coIlQiLCAiVGFtYmFoIGZhbWlseSBjb2RlIikKICAgICAgICBpZiBzZW11YV9rb2RlOgogICAgICAgICAgICBuYXZfdGFibGUuYWRkX3JvdygiRSIsICJFZGl0IG5hbWEgZmFtaWx5IGNvZGUiKQogICAgICAgICAgICBuYXZfdGFibGUuYWRkX3JvdygiSCIsIGYiW3t0aGVtZVsndGV4dF9lcnInXX1dSGFwdXMgZmFtaWx5IGNvZGVbL10iKQogICAgICAgIG5hdl90YWJsZS5hZGRfcm93KCIwMCIsIGYiW3t0aGVtZVsndGV4dF9zdWInXX1dS2VtYmFsaSBrZSBtZW51IGF3YWxbL10iKQoKICAgICAgICBjb25zb2xlLnByaW50KFBhbmVsKG5hdl90YWJsZSwgYm9yZGVyX3N0eWxlPXRoZW1lWyJib3JkZXJfcHJpbWFyeSJdLCBwYWRkaW5nPSgwLCAxKSwgZXhwYW5kPVRydWUpKQoKICAgICAgICBha3NpID0gY29uc29sZS5pbnB1dChmIlt7dGhlbWVbJ3RleHRfdGl0bGUnXX1dUGlsaWggYWtzaSBhdGF1IG5vbW9yIGtvZGU6Wy97dGhlbWVbJ3RleHRfdGl0bGUnXX1dICIpLnN0cmlwKCkubG93ZXIoKQoKICAgICAgICBpZiBha3NpID09ICJ0IjoKICAgICAgICAgICAgY29kZSA9IGNvbnNvbGUuaW5wdXQoIk1hc3Vra2FuIGZhbWlseSBjb2RlOiAiKS5zdHJpcCgpCiAgICAgICAgICAgIG5hbWUgPSBjb25zb2xlLmlucHV0KCJNYXN1a2thbiBuYW1hIGZhbWlseTogIikuc3RyaXAoKQogICAgICAgICAgICBzdWNjZXNzID0gYWRkX2ZhbWlseV9jb2RlKGNvZGUsIG5hbWUpCiAgICAgICAgICAgIHByaW50X3BhbmVsKCLinIUgSW5mbyIgaWYgc3VjY2VzcyBlbHNlICLinYwgRXJyb3IiLCAiQmVyaGFzaWwgbWVuYW1iYWhrYW4uIiBpZiBzdWNjZXNzIGVsc2UgIkdhZ2FsIG1lbmFtYmFoa2FuLCBmYW1pbHkgY29kZSBzdWRhaCBhZGEgZGkgZGFmdGFyLiIpCiAgICAgICAgICAgIHBhdXNlKCkKCiAgICAgICAgZWxpZiBha3NpID09ICJoIjoKICAgICAgICAgICAgaWYgbm90IHNlbXVhX2tvZGU6CiAgICAgICAgICAgICAgICBwcmludF9wYW5lbCgiSW5mbyIsICJUaWRhayBhZGEga29kZSB1bnR1ayBkaWhhcHVzLiIpCiAgICAgICAgICAgICAgICBwYXVzZSgpCiAgICAgICAgICAgICAgICBjb250aW51ZQogICAgICAgICAgICBpZHggPSBjb25zb2xlLmlucHV0KCJNYXN1a2thbiBub21vciBrb2RlIHlhbmcgaW5naW4gZGloYXB1czogIikuc3RyaXAoKQogICAgICAgICAgICBpZiBpZHguaXNkaWdpdCgpIGFuZCAxIDw9IGludChpZHgpIDw9IGxlbihzZW11YV9rb2RlKToKICAgICAgICAgICAgICAgIGluZGV4ID0gaW50KGlkeCkgLSAxCiAgICAgICAgICAgICAgICBuYW1hID0gc2VtdWFfa29kZVtpbmRleF1bIm5hbWUiXQogICAgICAgICAgICAgICAga29kZSA9IHNlbXVhX2tvZGVbaW5kZXhdWyJjb2RlIl0KICAgICAgICAgICAgICAgIGtvbmZpcm1hc2kgPSBjb25zb2xlLmlucHV0KGYiWWFraW4gaW5naW4gbWVuZ2hhcHVzICd7bmFtYX0nICh7a29kZX0pPyAoeS9uKTogIikuc3RyaXAoKS5sb3dlcigpCiAgICAgICAgICAgICAgICBpZiBrb25maXJtYXNpID09ICJ5IjoKICAgICAgICAgICAgICAgICAgICByZW1vdmVkID0gcmVtb3ZlX2ZhbWlseV9jb2RlKGluZGV4KQogICAgICAgICAgICAgICAgICAgIHByaW50X3BhbmVsKCLinIUgSW5mbyIgaWYgcmVtb3ZlZCBlbHNlICLinYwgRXJyb3IiLCBmIkJlcmhhc2lsIG1lbmdoYXB1cyB7cmVtb3ZlZH0uIiBpZiByZW1vdmVkIGVsc2UgIkdhZ2FsIG1lbmdoYXB1cy4iKQogICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICBwcmludF9wYW5lbCgi4p2OIEluZm8iLCAiUGVuZ2hhcHVzYW4gZGliYXRhbGthbi4iKQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgcHJpbnRfcGFuZWwoIuKdjCBFcnJvciIsICJOb21vciB0aWRhayB2YWxpZC4iKQogICAgICAgICAgICBwYXVzZSgpCgogICAgICAgIGVsaWYgYWtzaSA9PSAiZSI6CiAgICAgICAgICAgIGlmIG5vdCBzZW11YV9rb2RlOgogICAgICAgICAgICAgICAgcHJpbnRfcGFuZWwoIkluZm8iLCAiVGlkYWsgYWRhIGtvZGUgdW50dWsgZGllZGl0LiIpCiAgICAgICAgICAgICAgICBwYXVzZSgpCiAgICAgICAgICAgICAgICBjb250aW51ZQogICAgICAgICAgICBpZHggPSBjb25zb2xlLmlucHV0KCJNYXN1a2thbiBub21vciBrb2RlIHlhbmcgaW5naW4gZGl1YmFoIG5hbWFueWE6ICIpLnN0cmlwKCkKICAgICAgICAgICAgaWYgaWR4LmlzZGlnaXQoKSBhbmQgMSA8PSBpbnQoaWR4KSA8PSBsZW4oc2VtdWFfa29kZSk6CiAgICAgICAgICAgICAgICBuZXdfbmFtZSA9IGNvbnNvbGUuaW5wdXQoIk1hc3Vra2FuIG5hbWEgYmFydTogIikuc3RyaXAoKQogICAgICAgICAgICAgICAgc3VjY2VzcyA9IGVkaXRfZmFtaWx5X25hbWUoaW50KGlkeCkgLSAxLCBuZXdfbmFtZSkKICAgICAgICAgICAgICAgIHByaW50X3BhbmVsKCLinIUgSW5mbyIgaWYgc3VjY2VzcyBlbHNlICLinYwgRXJyb3IiLCAiTmFtYSBiZXJoYXNpbCBkaXBlcmJhcnVpLiIgaWYgc3VjY2VzcyBlbHNlICJHYWdhbCBtZW1wZXJiYXJ1aSBuYW1hLiIpCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBwcmludF9wYW5lbCgi4p2MIEVycm9yIiwgIk5vbW9yIHRpZGFrIHZhbGlkLiIpCiAgICAgICAgICAgIHBhdXNlKCkKCiAgICAgICAgZWxpZiBha3NpID09ICIwMCI6CiAgICAgICAgICAgIHJldHVybiBOb25lLCBOb25lIGlmIHJldHVybl9wYWNrYWdlX2RldGFpbCBlbHNlIE5vbmUKCiAgICAgICAgZWxpZiBha3NpLmlzZGlnaXQoKToKICAgICAgICAgICAgbm9tb3IgPSBpbnQoYWtzaSkKICAgICAgICAgICAgc2VsZWN0ZWQgPSBuZXh0KChwIGZvciBwIGluIHBhY2thZ2VzIGlmIHBbIm51bWJlciJdID09IG5vbW9yKSwgTm9uZSkKICAgICAgICAgICAgaWYgc2VsZWN0ZWQ6CiAgICAgICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0gZ2V0X3BhY2thZ2VzX2J5X2ZhbWlseShzZWxlY3RlZFsiY29kZSJdLCByZXR1cm5fcGFja2FnZV9kZXRhaWw9cmV0dXJuX3BhY2thZ2VfZGV0YWlsKQogICAgICAgICAgICAgICAgICAgIGlmIHJldHVybl9wYWNrYWdlX2RldGFpbDoKICAgICAgICAgICAgICAgICAgICAgICAgaWYgaXNpbnN0YW5jZShyZXN1bHQsIHR1cGxlKToKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiByZXN1bHQKICAgICAgICAgICAgICAgICAgICAgICAgZWxpZiByZXN1bHQgPT0gIk1BSU4iOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICJNQUlOIgogICAgICAgICAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIE5vbmUsIE5vbmUKICAgICAgICAgICAgICAgICAgICBpZiByZXN1bHQgPT0gIk1BSU4iOgogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gTm9uZQogICAgICAgICAgICAgICAgICAgIGVsaWYgcmVzdWx0ID09ICJCQUNLIjoKICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWUKICAgICAgICAgICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAgICAgICAgICBwcmludF9wYW5lbCgi4p2MIEVycm9yIiwgZiJHYWdhbCBtZW5hbXBpbGthbiBwYWtldDoge2V9IikKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHByaW50X3BhbmVsKCLinYwgRXJyb3IiLCAiTm9tb3IgdGlkYWsgdmFsaWQuIikKICAgICAgICAgICAgcGF1c2UoKQo=').decode())
