#!/usr/bin/env python3
import base64
exec(base64.b64decode('ZnJvbSBhcHAubWVudXMucGFja2FnZSBpbXBvcnQgc2hvd19wYWNrYWdlX2RldGFpbHMKZnJvbSBhcHAuc2VydmljZS5hdXRoIGltcG9ydCBBdXRoSW5zdGFuY2UKZnJvbSBhcHAubWVudXMudXRpbCBpbXBvcnQgY2xlYXJfc2NyZWVuLCBwYXVzZQpmcm9tIGFwcC5zZXJ2aWNlLmJvb2ttYXJrIGltcG9ydCBCb29rbWFya0luc3RhbmNlCmZyb20gYXBwLmNsaWVudC5lbmdzZWwgaW1wb3J0IGdldF9mYW1pbHkKCldJRFRIID0gNTUKCgpkZWYgcHJpbnRfaGVhZGVyKHRpdGxlOiBzdHIpOgogICAgcHJpbnQoIi0iICogV0lEVEgpCiAgICBwcmludCh0aXRsZS5jZW50ZXIoV0lEVEgpKQogICAgcHJpbnQoIi0iICogV0lEVEgpCgoKZGVmIHNob3dfYm9va21hcmtfbWVudSgpOgogICAgYXBpX2tleSA9IEF1dGhJbnN0YW5jZS5hcGlfa2V5CiAgICB0b2tlbnMgPSBBdXRoSW5zdGFuY2UuZ2V0X2FjdGl2ZV90b2tlbnMoKQoKICAgIGluX2Jvb2ttYXJrX21lbnUgPSBUcnVlCiAgICB3aGlsZSBpbl9ib29rbWFya19tZW51OgogICAgICAgIGNsZWFyX3NjcmVlbigpCiAgICAgICAgcHJpbnRfaGVhZGVyKCJCb29rbWFyayBQYWtldCIpCiAgICAgICAgYm9va21hcmtzID0gQm9va21hcmtJbnN0YW5jZS5nZXRfYm9va21hcmtzKCkKCiAgICAgICAgaWYgbm90IGJvb2ttYXJrcyBvciBsZW4oYm9va21hcmtzKSA9PSAwOgogICAgICAgICAgICBwcmludCgiQmVsdW0gYWRhIGJvb2ttYXJrIHRlcnNpbXBhbi4iKQogICAgICAgICAgICBwYXVzZSgpCiAgICAgICAgICAgIHJldHVybiBOb25lCgogICAgICAgIGZvciBpZHgsIGJtIGluIGVudW1lcmF0ZShib29rbWFya3MpOgogICAgICAgICAgICBwcmludChmIiB7aWR4ICsgMX0uIHtibVsnZmFtaWx5X25hbWUnXX0gLSB7Ym1bJ3ZhcmlhbnRfbmFtZSddfSAtIHtibVsnb3B0aW9uX25hbWUnXX0iKQoKICAgICAgICBwcmludCgiLSIgKiBXSURUSCkKICAgICAgICBwcmludCgiUGVyaW50YWg6IikKICAgICAgICBwcmludCgiIFswMF0gS2VtYmFsaSBrZSBtZW51IHV0YW1hIikKICAgICAgICBwcmludCgiIFswMDBdIEhhcHVzIGJvb2ttYXJrIHRlcnRlbnR1IikKICAgICAgICBwcmludCgiLSIgKiBXSURUSCkKCiAgICAgICAgY2hvaWNlID0gaW5wdXQoIlBpbGloIGJvb2ttYXJrIChub21vcik6ICIpLnN0cmlwKCkKCiAgICAgICAgaWYgY2hvaWNlID09ICIwMCI6CiAgICAgICAgICAgIGluX2Jvb2ttYXJrX21lbnUgPSBGYWxzZQogICAgICAgICAgICByZXR1cm4gTm9uZQoKICAgICAgICBlbGlmIGNob2ljZSA9PSAiMDAwIjoKICAgICAgICAgICAgZGVsX2Nob2ljZSA9IGlucHV0KCJNYXN1a2thbiBub21vciBib29rbWFyayB5YW5nIGluZ2luIGRpaGFwdXM6ICIpLnN0cmlwKCkKICAgICAgICAgICAgaWYgZGVsX2Nob2ljZS5pc2RpZ2l0KCkgYW5kIDEgPD0gaW50KGRlbF9jaG9pY2UpIDw9IGxlbihib29rbWFya3MpOgogICAgICAgICAgICAgICAgZGVsX2JtID0gYm9va21hcmtzW2ludChkZWxfY2hvaWNlKSAtIDFdCiAgICAgICAgICAgICAgICBCb29rbWFya0luc3RhbmNlLnJlbW92ZV9ib29rbWFyaygKICAgICAgICAgICAgICAgICAgICBkZWxfYm1bImZhbWlseV9jb2RlIl0sCiAgICAgICAgICAgICAgICAgICAgZGVsX2JtWyJpc19lbnRlcnByaXNlIl0sCiAgICAgICAgICAgICAgICAgICAgZGVsX2JtWyJ2YXJpYW50X25hbWUiXSwKICAgICAgICAgICAgICAgICAgICBkZWxfYm1bIm9yZGVyIl0sCiAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICBwcmludChmIkJvb2ttYXJrIHtkZWxfYm1bJ29wdGlvbl9uYW1lJ119IGJlcmhhc2lsIGRpaGFwdXMuIikKICAgICAgICAgICAgICAgIHBhdXNlKCkKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHByaW50KCJJbnB1dCB0aWRhayB2YWxpZC4gU2lsYWthbiBjb2JhIGxhZ2kuIikKICAgICAgICAgICAgICAgIHBhdXNlKCkKICAgICAgICAgICAgY29udGludWUKCiAgICAgICAgZWxpZiBjaG9pY2UuaXNkaWdpdCgpIGFuZCAxIDw9IGludChjaG9pY2UpIDw9IGxlbihib29rbWFya3MpOgogICAgICAgICAgICBzZWxlY3RlZF9ibSA9IGJvb2ttYXJrc1tpbnQoY2hvaWNlKSAtIDFdCiAgICAgICAgICAgIGZhbWlseV9jb2RlID0gc2VsZWN0ZWRfYm1bImZhbWlseV9jb2RlIl0KICAgICAgICAgICAgaXNfZW50ZXJwcmlzZSA9IHNlbGVjdGVkX2JtWyJpc19lbnRlcnByaXNlIl0KCiAgICAgICAgICAgIGZhbWlseV9kYXRhID0gZ2V0X2ZhbWlseShhcGlfa2V5LCB0b2tlbnMsIGZhbWlseV9jb2RlLCBpc19lbnRlcnByaXNlKQogICAgICAgICAgICBpZiBub3QgZmFtaWx5X2RhdGE6CiAgICAgICAgICAgICAgICBwcmludCgiR2FnYWwgbWVuZ2FtYmlsIGRhdGEgcGFrZXQuIikKICAgICAgICAgICAgICAgIHBhdXNlKCkKICAgICAgICAgICAgICAgIGNvbnRpbnVlCgogICAgICAgICAgICBwYWNrYWdlX3ZhcmlhbnRzID0gZmFtaWx5X2RhdGEuZ2V0KCJwYWNrYWdlX3ZhcmlhbnRzIiwgW10pCiAgICAgICAgICAgIG9wdGlvbl9jb2RlID0gTm9uZQoKICAgICAgICAgICAgZm9yIHZhcmlhbnQgaW4gcGFja2FnZV92YXJpYW50czoKICAgICAgICAgICAgICAgIGlmIHZhcmlhbnQuZ2V0KCJuYW1lIikgPT0gc2VsZWN0ZWRfYm1bInZhcmlhbnRfbmFtZSJdOgogICAgICAgICAgICAgICAgICAgIGZvciBvcHRpb24gaW4gdmFyaWFudC5nZXQoInBhY2thZ2Vfb3B0aW9ucyIsIFtdKToKICAgICAgICAgICAgICAgICAgICAgICAgaWYgb3B0aW9uLmdldCgib3JkZXIiKSA9PSBzZWxlY3RlZF9ibVsib3JkZXIiXToKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbl9jb2RlID0gb3B0aW9uLmdldCgicGFja2FnZV9vcHRpb25fY29kZSIpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhawoKICAgICAgICAgICAgaWYgb3B0aW9uX2NvZGU6CiAgICAgICAgICAgICAgICBwcmludChmIk9wdGlvbiBjb2RlOiB7b3B0aW9uX2NvZGV9IikKICAgICAgICAgICAgICAgIHNob3dfcGFja2FnZV9kZXRhaWxzKGFwaV9rZXksIHRva2Vucywgb3B0aW9uX2NvZGUsIGlzX2VudGVycHJpc2UpCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBwcmludCgiT3B0aW9uIGNvZGUgdGlkYWsgZGl0ZW11a2FuLiIpCiAgICAgICAgICAgICAgICBwYXVzZSgpCgogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHByaW50KCJJbnB1dCB0aWRhayB2YWxpZC4gU2lsYWthbiBjb2JhIGxhZ2kuIikKICAgICAgICAgICAgcGF1c2UoKQogICAgICAgICAgICBjb250aW51ZQo=').decode())
