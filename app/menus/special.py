#!/usr/bin/env python3
import base64
exec(base64.b64decode('ZnJvbSBhcHAuY2xpZW50LmVuZ3NlbDIgaW1wb3J0IHNlZ21lbnRzCmZyb20gYXBwLm1lbnVzLnV0aWwgaW1wb3J0IGNsZWFyX3NjcmVlbiwgcGF1c2UKZnJvbSBhcHAubWVudXMudXRpbF9oZWxwZXIgaW1wb3J0IHByaW50X3BhbmVsLCBnZXRfcnVwaWFoCmZyb20gYXBwLmNvbmZpZy50aGVtZV9jb25maWcgaW1wb3J0IGdldF90aGVtZQpmcm9tIGFwcC5zZXJ2aWNlLmF1dGggaW1wb3J0IEF1dGhJbnN0YW5jZQpmcm9tIGFwcC5tZW51cy5wYWNrYWdlIGltcG9ydCBzaG93X3BhY2thZ2VfZGV0YWlscwpmcm9tIHJpY2guY29uc29sZSBpbXBvcnQgQ29uc29sZQpmcm9tIHJpY2gudGFibGUgaW1wb3J0IFRhYmxlCmZyb20gcmljaC5wYW5lbCBpbXBvcnQgUGFuZWwKZnJvbSByaWNoLmJveCBpbXBvcnQgTUlOSU1BTF9ET1VCTEVfSEVBRApmcm9tIHJpY2guYWxpZ24gaW1wb3J0IEFsaWduCgpjb25zb2xlID0gQ29uc29sZSgpCgoKZGVmIGZldGNoX3NwZWNpYWxfZm9yX3lvdShhcGlfa2V5OiBzdHIsIGlkX3Rva2VuOiBzdHIsIGFjY2Vzc190b2tlbjogc3RyLCBiYWxhbmNlOiBpbnQgPSAwKSAtPiBsaXN0OgogICAgdHJ5OgogICAgICAgIHNlZ19kYXRhID0gc2VnbWVudHMoYXBpX2tleSwgaWRfdG9rZW4sIGFjY2Vzc190b2tlbiwgYmFsYW5jZSkKICAgICAgICBpZiBub3Qgc2VnX2RhdGE6CiAgICAgICAgICAgIHJldHVybiBbXQoKICAgICAgICBwYWNrYWdlcyA9IHNlZ19kYXRhLmdldCgic3BlY2lhbF9wYWNrYWdlcyIsIFtdKQogICAgICAgIHNwZWNpYWxfcGFja2FnZXMgPSBbXQoKICAgICAgICBmb3IgcGtnIGluIHBhY2thZ2VzOgogICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICBuYW1lID0gcGtnLmdldCgibmFtZSIsICJVbmtub3duIFBhY2thZ2UiKQogICAgICAgICAgICAgICAga29kZV9wYWtldCA9IHBrZy5nZXQoImtvZGVfcGFrZXQiLCAiLSIpCgogICAgICAgICAgICAgICAgaWYgbm90IGtvZGVfcGFrZXQgb3Iga29kZV9wYWtldCA9PSAiLSI6CiAgICAgICAgICAgICAgICAgICAgY29udGludWUgICMgc2tpcCBqaWthIHRpZGFrIGFkYSBrb2RlIHBha2V0CgogICAgICAgICAgICAgICAgb3JpZ2luYWxfcHJpY2UgPSBpbnQocGtnLmdldCgib3JpZ2luYWxfcHJpY2UiLCAwKSkKICAgICAgICAgICAgICAgIGRpc2tvbl9wcmljZSA9IGludChwa2cuZ2V0KCJkaXNrb25fcHJpY2UiLCBvcmlnaW5hbF9wcmljZSkpCgogICAgICAgICAgICAgICAgZGlza29uX3BlcmNlbnQgPSAwCiAgICAgICAgICAgICAgICBpZiBvcmlnaW5hbF9wcmljZSA+IDAgYW5kIGRpc2tvbl9wcmljZSA8IG9yaWdpbmFsX3ByaWNlOgogICAgICAgICAgICAgICAgICAgIGRpc2tvbl9wZXJjZW50ID0gaW50KHJvdW5kKChvcmlnaW5hbF9wcmljZSAtIGRpc2tvbl9wcmljZSkgLyBvcmlnaW5hbF9wcmljZSAqIDEwMCkpCgogICAgICAgICAgICAgICAgc3BlY2lhbF9wYWNrYWdlcy5hcHBlbmQoewogICAgICAgICAgICAgICAgICAgICJuYW1lIjogbmFtZSwKICAgICAgICAgICAgICAgICAgICAia29kZV9wYWtldCI6IGtvZGVfcGFrZXQsCiAgICAgICAgICAgICAgICAgICAgIm9yaWdpbmFsX3ByaWNlIjogZiJScCB7b3JpZ2luYWxfcHJpY2U6LH0iLnJlcGxhY2UoIiwiLCAiLiIpLAogICAgICAgICAgICAgICAgICAgICJkaXNrb25fcHJpY2UiOiBmIlJwIHtkaXNrb25fcHJpY2U6LH0iLnJlcGxhY2UoIiwiLCAiLiIpLAogICAgICAgICAgICAgICAgICAgICJkaXNrb25fcGVyY2VudCI6IGRpc2tvbl9wZXJjZW50LAogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgICAgICAgICAgcHJpbnRfcGFuZWwoIuKaoO+4jyBFcnJvciIsIGYiR2FnYWwgcGFyc2UgcGFrZXQ6IHtlfSIpCiAgICAgICAgICAgICAgICBjb250aW51ZQoKICAgICAgICBzcGVjaWFsX3BhY2thZ2VzLnNvcnQoa2V5PWxhbWJkYSB4OiB4WyJkaXNrb25fcGVyY2VudCJdLCByZXZlcnNlPVRydWUpCiAgICAgICAgcmV0dXJuIHNwZWNpYWxfcGFja2FnZXMKCiAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgcHJpbnRfcGFuZWwoIuKaoO+4jyBFcnJvciIsIGYiR2FnYWwgbWVuZ2FtYmlsIGRhdGEgU0ZZOiB7ZX0iKQogICAgICAgIHJldHVybiBbXQoKCmRlZiBzaG93X3NwZWNpYWxfZm9yX3lvdV9tZW51KHRva2VuczogZGljdCwgc3BlY2lhbF9wYWNrYWdlczogbGlzdCk6CiAgICB0aGVtZSA9IGdldF90aGVtZSgpCgogICAgd2hpbGUgVHJ1ZToKICAgICAgICBjbGVhcl9zY3JlZW4oKQoKICAgICAgICBpZiBub3Qgc3BlY2lhbF9wYWNrYWdlczoKICAgICAgICAgICAgcHJpbnRfcGFuZWwoIkluZm8iLCAiVGlkYWsgYWRhIHBha2V0IHNwZXNpYWwgdGVyc2VkaWEgc2FhdCBpbmkuIikKICAgICAgICAgICAgcGF1c2UoKQogICAgICAgICAgICByZXR1cm4KCiAgICAgICAgaW5mb190ZXh0ID0gQWxpZ24uY2VudGVyKAogICAgICAgICAgICBmIlt7dGhlbWVbJ3RleHRfYm9keSddfV3wn5SlIERhZnRhciBQYWtldCBTcGVjaWFsIEZvciBZb3Ug8J+UpVsve3RoZW1lWyd0ZXh0X2JvZHknXX1dIgogICAgICAgICkKICAgICAgICBjb25zb2xlLnByaW50KFBhbmVsKAogICAgICAgICAgICBpbmZvX3RleHQsCiAgICAgICAgICAgICN0aXRsZT1mIlt7dGhlbWVbJ3RleHRfdGl0bGUnXX1d8J+UpSBEYWZ0YXIgUGFrZXQgU3BlY2lhbCBGb3IgWW91IPCflKVbL10iLAogICAgICAgICAgICBib3JkZXJfc3R5bGU9dGhlbWVbImJvcmRlcl9pbmZvIl0sCiAgICAgICAgICAgIHBhZGRpbmc9KDEsIDIpLAogICAgICAgICAgICBleHBhbmQ9VHJ1ZQogICAgICAgICkpCgogICAgICAgIHRhYmxlID0gVGFibGUoYm94PU1JTklNQUxfRE9VQkxFX0hFQUQsIGV4cGFuZD1UcnVlKQogICAgICAgIHRhYmxlLmFkZF9jb2x1bW4oIk5vIiwganVzdGlmeT0icmlnaHQiLCBzdHlsZT10aGVtZVsidGV4dF9rZXkiXSwgd2lkdGg9NCkKICAgICAgICB0YWJsZS5hZGRfY29sdW1uKCJOYW1hIFBha2V0Iiwgc3R5bGU9dGhlbWVbInRleHRfYm9keSJdKQogICAgICAgIHRhYmxlLmFkZF9jb2x1bW4oIkRpc2tvbiIsIGp1c3RpZnk9InJpZ2h0Iiwgc3R5bGU9dGhlbWVbInRleHRfbW9uZXkiXSkKICAgICAgICB0YWJsZS5hZGRfY29sdW1uKCJIYXJnYSBOb3JtYWwiLCBqdXN0aWZ5PSJyaWdodCIsIHN0eWxlPXRoZW1lWyJ0ZXh0X2VyciJdKQogICAgICAgIHRhYmxlLmFkZF9jb2x1bW4oIkhhcmdhIERpc2tvbiIsIGp1c3RpZnk9InJpZ2h0Iiwgc3R5bGU9dGhlbWVbInRleHRfbW9uZXkiXSkKCiAgICAgICAgZm9yIGlkeCwgcGtnIGluIGVudW1lcmF0ZShzcGVjaWFsX3BhY2thZ2VzLCAxKToKICAgICAgICAgICAgZW1vamlfZGlza29uID0gIvCfkrgiIGlmIHBrZy5nZXQoImRpc2tvbl9wZXJjZW50IiwgMCkgPj0gNTAgZWxzZSAiIgogICAgICAgICAgICBlbW9qaV9rdW90YSA9ICLwn5SlIiBpZiBwa2cuZ2V0KCJrdW90YV9nYiIsIDApID49IDEwMCBlbHNlICIiCgogICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICBvcmlnaW5hbF9pbnQgPSBpbnQoc3RyKHBrZy5nZXQoIm9yaWdpbmFsX3ByaWNlIiwgIjAiKSkucmVwbGFjZSgiUnAiLCAiIikucmVwbGFjZSgiLiIsICIiKS5yZXBsYWNlKCIsIiwgIiIpLnN0cmlwKCkpCiAgICAgICAgICAgICAgICBkaXNrb25faW50ID0gaW50KHN0cihwa2cuZ2V0KCJkaXNrb25fcHJpY2UiLCAiMCIpKS5yZXBsYWNlKCJScCIsICIiKS5yZXBsYWNlKCIuIiwgIiIpLnJlcGxhY2UoIiwiLCAiIikuc3RyaXAoKSkKICAgICAgICAgICAgZXhjZXB0OgogICAgICAgICAgICAgICAgb3JpZ2luYWxfaW50ID0gMAogICAgICAgICAgICAgICAgZGlza29uX2ludCA9IDAKCiAgICAgICAgICAgIG9yaWdpbmFsX3ByaWNlID0gZ2V0X3J1cGlhaChvcmlnaW5hbF9pbnQpCiAgICAgICAgICAgIGRpc2tvbl9wcmljZSA9IGdldF9ydXBpYWgoZGlza29uX2ludCkKCiAgICAgICAgICAgIHRhYmxlLmFkZF9yb3coCiAgICAgICAgICAgICAgICBzdHIoaWR4KSwKICAgICAgICAgICAgICAgIGYie2Vtb2ppX2t1b3RhfSB7cGtnLmdldCgnbmFtZScsICctJyl9IiwKICAgICAgICAgICAgICAgIGYie3BrZy5nZXQoJ2Rpc2tvbl9wZXJjZW50JywgMCl9JSB7ZW1vamlfZGlza29ufSIsCiAgICAgICAgICAgICAgICBmIlt7dGhlbWVbJ3RleHRfZXJyJ119XVtzdHJpa2Vde29yaWdpbmFsX3ByaWNlfVsvc3RyaWtlXVsve3RoZW1lWyd0ZXh0X2VyciddfV0iLAogICAgICAgICAgICAgICAgZiJbe3RoZW1lWyd0ZXh0X21vbmV5J119XXtkaXNrb25fcHJpY2V9Wy97dGhlbWVbJ3RleHRfbW9uZXknXX1dIgogICAgICAgICAgICApCgogICAgICAgIGNvbnNvbGUucHJpbnQoUGFuZWwodGFibGUsIGJvcmRlcl9zdHlsZT10aGVtZVsiYm9yZGVyX3ByaW1hcnkiXSwgcGFkZGluZz0oMCwgMCksIGV4cGFuZD1UcnVlKSkKCiAgICAgICAgbmF2X3RhYmxlID0gVGFibGUoc2hvd19oZWFkZXI9RmFsc2UsIGJveD1NSU5JTUFMX0RPVUJMRV9IRUFELCBleHBhbmQ9VHJ1ZSkKICAgICAgICBuYXZfdGFibGUuYWRkX2NvbHVtbihqdXN0aWZ5PSJyaWdodCIsIHN0eWxlPXRoZW1lWyJ0ZXh0X2tleSJdLCB3aWR0aD02KQogICAgICAgIG5hdl90YWJsZS5hZGRfY29sdW1uKHN0eWxlPXRoZW1lWyJ0ZXh0X2JvZHkiXSkKICAgICAgICBuYXZfdGFibGUuYWRkX3JvdygiMDAiLCBmIlt7dGhlbWVbJ3RleHRfc3ViJ119XUtlbWJhbGkga2UgbWVudSBzZWJlbHVtbnlhWy9dIikKCiAgICAgICAgY29uc29sZS5wcmludChQYW5lbCgKICAgICAgICAgICAgbmF2X3RhYmxlLAogICAgICAgICAgICBib3JkZXJfc3R5bGU9dGhlbWVbImJvcmRlcl9pbmZvIl0sCiAgICAgICAgICAgIHBhZGRpbmc9KDAsIDEpLAogICAgICAgICAgICBleHBhbmQ9VHJ1ZQogICAgICAgICkpCgogICAgICAgIGNob2ljZSA9IGNvbnNvbGUuaW5wdXQoZiJbe3RoZW1lWyd0ZXh0X3N1YiddfV1QaWxpaCBwYWtldCAobm9tb3IpOlsve3RoZW1lWyd0ZXh0X3N1YiddfV0gIikuc3RyaXAoKQoKICAgICAgICBpZiBjaG9pY2UgPT0gIjk5IjoKICAgICAgICAgICAgcmV0dXJuICJNQUlOIgogICAgICAgIGlmIGNob2ljZSA9PSAiMDAiOgogICAgICAgICAgICByZXR1cm4gIkJBQ0siCgogICAgICAgIGlmIG5vdCBjaG9pY2UuaXNkaWdpdCgpOgogICAgICAgICAgICBwcmludF9wYW5lbCgi4pqg77iPIEVycm9yIiwgIklucHV0IHRpZGFrIHZhbGlkLiBNYXN1a2thbiBhbmdrYSB5YW5nIHNlc3VhaS4iKQogICAgICAgICAgICBwYXVzZSgpCiAgICAgICAgICAgIGNvbnRpbnVlCgogICAgICAgIGNob2ljZV9pZHggPSBpbnQoY2hvaWNlKSAtIDEKICAgICAgICBpZiAwIDw9IGNob2ljZV9pZHggPCBsZW4oc3BlY2lhbF9wYWNrYWdlcyk6CiAgICAgICAgICAgIHNlbGVjdGVkX3BrZyA9IHNwZWNpYWxfcGFja2FnZXNbY2hvaWNlX2lkeF0KICAgICAgICAgICAgI3ByaW50X3BhbmVsKCLwn5OmIFBha2V0IERpcGlsaWgiLCBzZWxlY3RlZF9wa2dbIm5hbWUiXSkKICAgICAgICAgICAgI3BhdXNlKCkKICAgICAgICAgICAgYXBpX2tleSA9IEF1dGhJbnN0YW5jZS5hcGlfa2V5CiAgICAgICAgICAgIHJlc3VsdCA9IHNob3dfcGFja2FnZV9kZXRhaWxzKGFwaV9rZXksIHRva2Vucywgc2VsZWN0ZWRfcGtnWyJrb2RlX3Bha2V0Il0sIGlzX2VudGVycHJpc2U9RmFsc2UpCgogICAgICAgICAgICBpZiByZXN1bHQgPT0gIk1BSU4iOgogICAgICAgICAgICAgICAgcmV0dXJuICJNQUlOIgogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHByaW50X3BhbmVsKCLimqDvuI8gRXJyb3IiLCAiTm9tb3IgcGFrZXQgdGlkYWsgdmFsaWQuIikKICAgICAgICAgICAgcGF1c2UoKQo=').decode())
