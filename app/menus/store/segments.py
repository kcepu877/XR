#!/usr/bin/env python3
import base64
exec(base64.b64decode('aW1wb3J0IGpzb24KZnJvbSBhcHAuY2xpZW50LnN0b3JlLnNlZ21lbnRzIGltcG9ydCBnZXRfc2VnbWVudHMKZnJvbSBhcHAubWVudXMudXRpbCBpbXBvcnQgY2xlYXJfc2NyZWVuLCBwYXVzZQpmcm9tIGFwcC5zZXJ2aWNlLmF1dGggaW1wb3J0IEF1dGhJbnN0YW5jZQpmcm9tIGFwcC5tZW51cy5wYWNrYWdlIGltcG9ydCBzaG93X3BhY2thZ2VfZGV0YWlscwoKV0lEVEggPSA1NQoKZGVmIHNob3dfc3RvcmVfc2VnbWVudHNfbWVudShpc19lbnRlcnByaXNlOiBib29sID0gRmFsc2UpOgogICAgaW5fc3RvcmVfc2VnbWVudHNfbWVudSA9IFRydWUKICAgIHdoaWxlIGluX3N0b3JlX3NlZ21lbnRzX21lbnU6CiAgICAgICAgYXBpX2tleSA9IEF1dGhJbnN0YW5jZS5hcGlfa2V5CiAgICAgICAgdG9rZW5zID0gQXV0aEluc3RhbmNlLmdldF9hY3RpdmVfdG9rZW5zKCkKICAgICAgICAKICAgICAgICBwcmludCgiRmV0Y2hpbmcgc3RvcmUgc2VnbWVudHMuLi4iKQogICAgICAgIHNlZ21lbnRzX3JlcyA9IGdldF9zZWdtZW50cyhhcGlfa2V5LCB0b2tlbnMsIGlzX2VudGVycHJpc2UpCiAgICAgICAgaWYgbm90IHNlZ21lbnRzX3JlczoKICAgICAgICAgICAgcHJpbnQoIk5vIHNlZ21lbnRzIGZvdW5kLiIpCiAgICAgICAgICAgIGluX3N0b3JlX3NlZ21lbnRzX21lbnUgPSBGYWxzZQogICAgICAgICAgICBjb250aW51ZQogICAgICAgIAogICAgICAgIHNlZ21lbnRzID0gc2VnbWVudHNfcmVzLmdldCgiZGF0YSIsIHt9KS5nZXQoInN0b3JlX3NlZ21lbnRzIiwgW10pCiAgICAgICAgCiAgICAgICAgY2xlYXJfc2NyZWVuKCkKICAgICAgICAKICAgICAgICBwcmludCgiPSIgKiBXSURUSCkKICAgICAgICBwcmludCgiU3RvcmUgU2VnbWVudHM6IikKICAgICAgICBwcmludCgiPSIgKiBXSURUSCkKICAgICAgICAKICAgICAgICBwYWNrYWdlcyA9IHt9CiAgICAgICAgZm9yIGksIHNlZ21lbnQgaW4gZW51bWVyYXRlKHNlZ21lbnRzKToKICAgICAgICAgICAgbmFtZSA9IHNlZ21lbnQuZ2V0KCJ0aXRsZSIsICJOL0EiKQogICAgICAgICAgICBiYW5uZXJzID0gc2VnbWVudC5nZXQoImJhbm5lcnMiLCBbXSkKICAgICAgICAgICAgCiAgICAgICAgICAgIGxldHRlciA9IGNocig2NSArIGkpICAjIENvbnZlcnQgMCAtPiBBLCAxIC0+IEIsIGV0Yy4KICAgICAgICAgICAgcHJpbnQoIi0iICogV0lEVEgpCiAgICAgICAgICAgIHByaW50KGYie2xldHRlcn0uIEJhbm5lcjoge25hbWV9IikKICAgICAgICAgICAgcHJpbnQoIi0iICogV0lEVEgpCiAgICAgICAgICAgIAogICAgICAgICAgICBmb3IgaiwgYmFubmVyIGluIGVudW1lcmF0ZShiYW5uZXJzKToKICAgICAgICAgICAgICAgIGRpc2NvdW50ZWRfcHJpY2UgPSBiYW5uZXIuZ2V0KCJkaXNjb3VudGVkX3ByaWNlIiwgIk4vQSIpCiAgICAgICAgICAgICAgICB0aXRsZSA9IGJhbm5lci5nZXQoInRpdGxlIiwgIk4vQSIpCiAgICAgICAgICAgICAgICB2YWxpZGl0eSA9IGJhbm5lci5nZXQoInZhbGlkaXR5IiwgIk4vQSIpCiAgICAgICAgICAgICAgICBmYW1pbHlfbmFtZSA9IGJhbm5lci5nZXQoImZhbWlseV9uYW1lIiwgIk4vQSIpCiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIGFjdGlvbl9wYXJhbSA9IGJhbm5lci5nZXQoImFjdGlvbl9wYXJhbSIsICIiKQogICAgICAgICAgICAgICAgYWN0aW9uX3R5cGUgPSBiYW5uZXIuZ2V0KCJhY3Rpb25fdHlwZSIsICIiKQogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBwYWNrYWdlc1tmIntsZXR0ZXIubG93ZXIoKX17aiArIDF9Il0gPSB7CiAgICAgICAgICAgICAgICAgICAgImFjdGlvbl9wYXJhbSI6IGFjdGlvbl9wYXJhbSwKICAgICAgICAgICAgICAgICAgICAiYWN0aW9uX3R5cGUiOiBhY3Rpb25fdHlwZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBwcmludChmIiAge2xldHRlcn17aiArIDF9LiB7ZmFtaWx5X25hbWV9IC0ge3RpdGxlfSIpCiAgICAgICAgICAgICAgICBwcmludChmIiAgICAgUHJpY2U6IFJwe2Rpc2NvdW50ZWRfcHJpY2V9IikKICAgICAgICAgICAgICAgIHByaW50KGYiICAgICBWYWxpZGl0eToge3ZhbGlkaXR5fSIpCiAgICAgICAgICAgICAgICBwcmludCgiLSIgKiBXSURUSCkKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgIyBwcmludChqc29uLmR1bXBzKGJhbm5lciwgaW5kZW50PTQpKSAgIyBEZWJ1ZzogU2hvdyBmdWxsIGJhbm5lciBkYXRhCiAgICAgICAgICAgIAogICAgICAgIHByaW50KCIwMC4gQmFjayB0byBNYWluIE1lbnUiKQogICAgICAgIHByaW50KCI9IiAqIFdJRFRIKQogICAgICAgIGNob2ljZSA9IGlucHV0KCJFbnRlciB5b3VyIGNob2ljZSB0byB2aWV3IHBhY2thZ2UgZGV0YWlscyAoZS5nLiwgQTEsIEIyKTogIikKICAgICAgICBpZiBjaG9pY2UgPT0gIjAwIjoKICAgICAgICAgICAgaW5fc3RvcmVfc2VnbWVudHNfbWVudSA9IEZhbHNlCiAgICAgICAgICAgIGNvbnRpbnVlCiAgICAgICAgCiAgICAgICAgc2VsZWN0ZWRfcGtnID0gcGFja2FnZXMuZ2V0KGNob2ljZS5sb3dlcigpKQogICAgICAgIGlmIG5vdCBzZWxlY3RlZF9wa2c6CiAgICAgICAgICAgIHByaW50KCJJbnZhbGlkIGNob2ljZS4gUGxlYXNlIGVudGVyIGEgdmFsaWQgcGFja2FnZSBjb2RlLiIpCiAgICAgICAgICAgIHBhdXNlKCkKICAgICAgICAgICAgY29udGludWUKICAgICAgICAKICAgICAgICBhY3Rpb25fcGFyYW0gPSBzZWxlY3RlZF9wa2dbImFjdGlvbl9wYXJhbSJdCiAgICAgICAgYWN0aW9uX3R5cGUgPSBzZWxlY3RlZF9wa2dbImFjdGlvbl90eXBlIl0KICAgICAgICAKICAgICAgICBpZiBhY3Rpb25fdHlwZSA9PSAiUERQIjoKICAgICAgICAgICAgXyA9IHNob3dfcGFja2FnZV9kZXRhaWxzKAogICAgICAgICAgICAgICAgYXBpX2tleSwKICAgICAgICAgICAgICAgIHRva2VucywKICAgICAgICAgICAgICAgIGFjdGlvbl9wYXJhbSwKICAgICAgICAgICAgICAgIGlzX2VudGVycHJpc2UKICAgICAgICAgICAgKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHByaW50KCI9IiAqIFdJRFRIKQogICAgICAgICAgICBwcmludCgiVW5oYW5kbGVkIEFjdGlvbiBUeXBlIikKICAgICAgICAgICAgcHJpbnQoZiJBY3Rpb24gdHlwZToge2FjdGlvbl90eXBlfVxuUGFyYW06IHthY3Rpb25fcGFyYW19IikKICAgICAgICAgICAgcGF1c2UoKQo=').decode())
