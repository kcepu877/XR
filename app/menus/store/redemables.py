#!/usr/bin/env python3
import base64
exec(base64.b64decode('ZnJvbSBhcHAuY2xpZW50LnN0b3JlLnJlZGVlbWFibGVzIGltcG9ydCBnZXRfcmVkZWVtYWJsZXMKZnJvbSBhcHAuc2VydmljZS5hdXRoIGltcG9ydCBBdXRoSW5zdGFuY2UKZnJvbSBhcHAubWVudXMudXRpbCBpbXBvcnQgY2xlYXJfc2NyZWVuLCBwYXVzZQpmcm9tIGFwcC5tZW51cy5wYWNrYWdlIGltcG9ydCBzaG93X3BhY2thZ2VfZGV0YWlscywgZ2V0X3BhY2thZ2VzX2J5X2ZhbWlseQoKZnJvbSBkYXRldGltZSBpbXBvcnQgZGF0ZXRpbWUKCldJRFRIID0gNTUKCmRlZiBzaG93X3JlZGVlbWFibGVzX21lbnUoaXNfZW50ZXJwcmlzZTogYm9vbCA9IEZhbHNlKToKICAgIGluX3JlZGVlbWFibGVzX21lbnUgPSBUcnVlCiAgICB3aGlsZSBpbl9yZWRlZW1hYmxlc19tZW51OgogICAgICAgIGFwaV9rZXkgPSBBdXRoSW5zdGFuY2UuYXBpX2tleQogICAgICAgIHRva2VucyA9IEF1dGhJbnN0YW5jZS5nZXRfYWN0aXZlX3Rva2VucygpCiAgICAgICAgCiAgICAgICAgcHJpbnQoIkZldGNoaW5nIHJlZGVlbWFibGVzLi4uIikKICAgICAgICByZWRlZW1hYmxlc19yZXMgPSBnZXRfcmVkZWVtYWJsZXMoYXBpX2tleSwgdG9rZW5zLCBpc19lbnRlcnByaXNlKQogICAgICAgIGlmIG5vdCByZWRlZW1hYmxlc19yZXM6CiAgICAgICAgICAgIHByaW50KCJObyByZWRlZW1hYmxlcyBmb3VuZC4iKQogICAgICAgICAgICBpbl9yZWRlZW1hYmxlc19tZW51ID0gRmFsc2UKICAgICAgICAgICAgY29udGludWUKICAgICAgICAKICAgICAgICBjYXRlZ29yaWVzID0gcmVkZWVtYWJsZXNfcmVzLmdldCgiZGF0YSIsIHt9KS5nZXQoImNhdGVnb3JpZXMiLCBbXSkKICAgICAgICAKICAgICAgICBjbGVhcl9zY3JlZW4oKQogICAgICAgIAogICAgICAgIHByaW50KCI9IiAqIFdJRFRIKQogICAgICAgIHByaW50KCJSZWRlZW1hYmxlczoiKQogICAgICAgIHByaW50KCI9IiAqIFdJRFRIKQogICAgICAgIAogICAgICAgIHBhY2thZ2VzID0ge30KICAgICAgICBmb3IgaSwgY2F0ZWdvcnkgaW4gZW51bWVyYXRlKGNhdGVnb3JpZXMpOgogICAgICAgICAgICBjYXRlZ29yeV9uYW1lID0gY2F0ZWdvcnkuZ2V0KCJjYXRlZ29yeV9uYW1lIiwgIk4vQSIpCiAgICAgICAgICAgIGNhdGVnb3J5X2NvZGUgPSBjYXRlZ29yeS5nZXQoImNhdGVnb3J5X2NvZGUiLCAiTi9BIikKICAgICAgICAgICAgcmVkZW1hYmxlcyA9IGNhdGVnb3J5LmdldCgicmVkZWVtYWJsZXMiLCBbXSkKICAgICAgICAgICAgCiAgICAgICAgICAgIGxldHRlciA9IGNocig2NSArIGkpCiAgICAgICAgICAgIHByaW50KCItIiAqIFdJRFRIKQogICAgICAgICAgICBwcmludChmIntsZXR0ZXJ9LiBDYXRlZ29yeToge2NhdGVnb3J5X25hbWV9IikKICAgICAgICAgICAgcHJpbnQoZiJDb2RlOiB7Y2F0ZWdvcnlfY29kZX0iKQogICAgICAgICAgICBwcmludCgiLSIgKiBXSURUSCkKICAgICAgICAgICAgCiAgICAgICAgICAgIGlmIGxlbihyZWRlbWFibGVzKSA9PSAwOgogICAgICAgICAgICAgICAgcHJpbnQoIiAgTm8gcmVkZWVtYWJsZXMgaW4gdGhpcyBjYXRlZ29yeS4iKQogICAgICAgICAgICAgICAgY29udGludWUKICAgICAgICAgICAgCiAgICAgICAgICAgIGZvciBqLCByZWRlbWFibGUgaW4gZW51bWVyYXRlKHJlZGVtYWJsZXMpOgogICAgICAgICAgICAgICAgbmFtZSA9IHJlZGVtYWJsZS5nZXQoIm5hbWUiLCAiTi9BIikKICAgICAgICAgICAgICAgIHZhbGlkX3VudGlsID0gcmVkZW1hYmxlLmdldCgidmFsaWRfdW50aWwiLCAwKQogICAgICAgICAgICAgICAgdmFsaWRfdW50aWxfZGF0ZSA9IGRhdGV0aW1lLnN0cmZ0aW1lKAogICAgICAgICAgICAgICAgICAgIGRhdGV0aW1lLmZyb210aW1lc3RhbXAodmFsaWRfdW50aWwpLCAiJVktJW0tJWQiCiAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIGFjdGlvbl9wYXJhbSA9IHJlZGVtYWJsZS5nZXQoImFjdGlvbl9wYXJhbSIsICIiKQogICAgICAgICAgICAgICAgYWN0aW9uX3R5cGUgPSByZWRlbWFibGUuZ2V0KCJhY3Rpb25fdHlwZSIsICIiKQogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBwYWNrYWdlc1tmIntsZXR0ZXIubG93ZXIoKX17aiArIDF9Il0gPSB7CiAgICAgICAgICAgICAgICAgICAgImFjdGlvbl9wYXJhbSI6IGFjdGlvbl9wYXJhbSwKICAgICAgICAgICAgICAgICAgICAiYWN0aW9uX3R5cGUiOiBhY3Rpb25fdHlwZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBwcmludChmIiAge2xldHRlcn17aiArIDF9LiB7bmFtZX0iKQogICAgICAgICAgICAgICAgcHJpbnQoZiIgICAgIFZhbGlkIFVudGlsOiB7dmFsaWRfdW50aWxfZGF0ZX0iKQogICAgICAgICAgICAgICAgcHJpbnQoZiIgICAgIEFjdGlvbiBUeXBlOiB7YWN0aW9uX3R5cGV9IikKICAgICAgICAgICAgICAgIHByaW50KCItIiAqIFdJRFRIKQogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAjIHByaW50KGpzb24uZHVtcHMocmVkZW1hYmxlLCBpbmRlbnQ9NCkpICAjIERlYnVnOiBTaG93IGZ1bGwgcmVkZW1hYmxlIGRhdGEKICAgICAgICAgICAgICAgIAogICAgICAgIHByaW50KCIwMC4gQmFjayIpCiAgICAgICAgcHJpbnQoIj0iICogV0lEVEgpCiAgICAgICAgcHJpbnQoIkVudGVyIHlvdXIgY2hvaWNlIHRvIHZpZXcgcGFja2FnZSBkZXRhaWxzIChlLmcuLCBBMSwgQjIpOiAiKQogICAgICAgIAogICAgICAgIGNob2ljZSA9IGlucHV0KCkKICAgICAgICBpZiBjaG9pY2UgPT0gIjAwIjoKICAgICAgICAgICAgaW5fcmVkZWVtYWJsZXNfbWVudSA9IEZhbHNlCiAgICAgICAgICAgIGNvbnRpbnVlCiAgICAgICAgc2VsZWN0ZWRfcGtnID0gcGFja2FnZXMuZ2V0KGNob2ljZS5sb3dlcigpKQogICAgICAgIGlmIG5vdCBzZWxlY3RlZF9wa2c6CiAgICAgICAgICAgIHByaW50KCJJbnZhbGlkIGNob2ljZS4gUGxlYXNlIGVudGVyIGEgdmFsaWQgcGFja2FnZSBjb2RlLiIpCiAgICAgICAgICAgIHBhdXNlKCkKICAgICAgICAgICAgY29udGludWUKICAgICAgICBhY3Rpb25fcGFyYW0gPSBzZWxlY3RlZF9wa2dbImFjdGlvbl9wYXJhbSJdCiAgICAgICAgYWN0aW9uX3R5cGUgPSBzZWxlY3RlZF9wa2dbImFjdGlvbl90eXBlIl0KICAgICAgICAKICAgICAgICBpZiBhY3Rpb25fdHlwZSA9PSAiUExQIjoKICAgICAgICAgICAgZ2V0X3BhY2thZ2VzX2J5X2ZhbWlseShhY3Rpb25fcGFyYW0sIGlzX2VudGVycHJpc2UsICIiKQogICAgICAgIGVsaWYgYWN0aW9uX3R5cGUgPT0gIlBEUCI6CiAgICAgICAgICAgIHNob3dfcGFja2FnZV9kZXRhaWxzKAogICAgICAgICAgICAgICAgYXBpX2tleSwKICAgICAgICAgICAgICAgIHRva2VucywKICAgICAgICAgICAgICAgIGFjdGlvbl9wYXJhbSwKICAgICAgICAgICAgICAgIGlzX2VudGVycHJpc2UsCiAgICAgICAgICAgICkKICAgICAgICBlbHNlOgogICAgICAgICAgICBwcmludCgiPSIgKiBXSURUSCkKICAgICAgICAgICAgcHJpbnQoIlVuaGFuZGxlZCBBY3Rpb24gVHlwZSIpCiAgICAgICAgICAgIHByaW50KGYiQWN0aW9uIHR5cGU6IHthY3Rpb25fdHlwZX1cblBhcmFtOiB7YWN0aW9uX3BhcmFtfSIpCiAgICAgICAgICAgIHBhdXNlKCkK').decode())
