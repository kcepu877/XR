#!/usr/bin/env python3
import base64
exec(base64.b64decode('ZnJvbSBhcHAuY2xpZW50LnN0b3JlLnNlYXJjaCBpbXBvcnQgZ2V0X2ZhbWlseV9saXN0LCBnZXRfc3RvcmVfcGFja2FnZXMKZnJvbSBhcHAubWVudXMucGFja2FnZSBpbXBvcnQgZ2V0X3BhY2thZ2VzX2J5X2ZhbWlseSwgc2hvd19wYWNrYWdlX2RldGFpbHMKZnJvbSBhcHAubWVudXMudXRpbCBpbXBvcnQgY2xlYXJfc2NyZWVuLCBwYXVzZQpmcm9tIGFwcC5zZXJ2aWNlLmF1dGggaW1wb3J0IEF1dGhJbnN0YW5jZQoKV0lEVEggPSA1NQoKZGVmIHNob3dfZmFtaWx5X2xpc3RfbWVudSgKICAgIHN1YnNfdHlwZTogc3RyID0gIlBSRVBBSUQiLAogICAgaXNfZW50ZXJwcmlzZTogYm9vbCA9IEZhbHNlLAopOgogICAgaW5fZmFtaWx5X2xpc3RfbWVudSA9IFRydWUKICAgIHdoaWxlIGluX2ZhbWlseV9saXN0X21lbnU6CiAgICAgICAgYXBpX2tleSA9IEF1dGhJbnN0YW5jZS5hcGlfa2V5CiAgICAgICAgdG9rZW5zID0gQXV0aEluc3RhbmNlLmdldF9hY3RpdmVfdG9rZW5zKCkKICAgICAgICAKICAgICAgICBwcmludCgiRmV0Y2hpbmcgZmFtaWx5IGxpc3QuLi4iKQogICAgICAgIGZhbWlseV9saXN0X3JlcyA9IGdldF9mYW1pbHlfbGlzdChhcGlfa2V5LCB0b2tlbnMsIHN1YnNfdHlwZSwgaXNfZW50ZXJwcmlzZSkKICAgICAgICBpZiBub3QgZmFtaWx5X2xpc3RfcmVzOgogICAgICAgICAgICBwcmludCgiTm8gZmFtaWx5IGxpc3QgZm91bmQuIikKICAgICAgICAgICAgaW5fZmFtaWx5X2xpc3RfbWVudSA9IEZhbHNlCiAgICAgICAgICAgIGNvbnRpbnVlCiAgICAgICAgCiAgICAgICAgZmFtaWx5X2xpc3QgPSBmYW1pbHlfbGlzdF9yZXMuZ2V0KCJkYXRhIiwge30pLmdldCgicmVzdWx0cyIsIFtdKQogICAgICAgIAogICAgICAgIGNsZWFyX3NjcmVlbigpCiAgICAgICAgCiAgICAgICAgcHJpbnQoIj0iICogV0lEVEgpCiAgICAgICAgcHJpbnQoIkZhbWlseSBMaXN0OiIpCiAgICAgICAgcHJpbnQoIj0iICogV0lEVEgpCiAgICAgICAgCiAgICAgICAgZm9yIGksIGZhbWlseSBpbiBlbnVtZXJhdGUoZmFtaWx5X2xpc3QpOgogICAgICAgICAgICBmYW1pbHlfbmFtZSA9IGZhbWlseS5nZXQoImxhYmVsIiwgIk4vQSIpCiAgICAgICAgICAgIGZhbWlseV9jb2RlID0gZmFtaWx5LmdldCgiaWQiLCAiTi9BIikKICAgICAgICAgICAgCiAgICAgICAgICAgIHByaW50KGYie2kgKyAxfS4ge2ZhbWlseV9uYW1lfSIpCiAgICAgICAgICAgIHByaW50KGYiICAgRmFtaWx5IGNvZGU6IHtmYW1pbHlfY29kZX0iKQogICAgICAgICAgICBwcmludCgiLSIgKiBXSURUSCkKICAgICAgICAKICAgICAgICBwcmludCgiMDAuIEJhY2sgdG8gTWFpbiBNZW51IikKICAgICAgICBwcmludCgiSW5wdXQgdGhlIG51bWJlciB0byB2aWV3IHBhY2thZ2VzIGluIHRoYXQgZmFtaWx5LiIpCiAgICAgICAgY2hvaWNlID0gaW5wdXQoIkVudGVyIHlvdXIgY2hvaWNlOiAiKQogICAgICAgIGlmIGNob2ljZSA9PSAiMDAiOgogICAgICAgICAgICBpbl9mYW1pbHlfbGlzdF9tZW51ID0gRmFsc2UKICAgICAgICAKICAgICAgICBpZiBjaG9pY2UuaXNkaWdpdCgpIGFuZCBpbnQoY2hvaWNlKSA+IDAgYW5kIGludChjaG9pY2UpIDw9IGxlbihmYW1pbHlfbGlzdCk6CiAgICAgICAgICAgIHNlbGVjdGVkX2ZhbWlseSA9IGZhbWlseV9saXN0W2ludChjaG9pY2UpIC0gMV0KICAgICAgICAgICAgZmFtaWx5X2NvZGUgPSBzZWxlY3RlZF9mYW1pbHkuZ2V0KCJpZCIsICIiKQogICAgICAgICAgICBmYW1pbHlfbmFtZSA9IHNlbGVjdGVkX2ZhbWlseS5nZXQoImxhYmVsIiwgIk4vQSIpCiAgICAgICAgICAgIAogICAgICAgICAgICBwcmludChmIkZldGNoaW5nIHBhY2thZ2VzIGZvciBmYW1pbHk6IHtmYW1pbHlfbmFtZX0uLi4iKQogICAgICAgICAgICBnZXRfcGFja2FnZXNfYnlfZmFtaWx5KGZhbWlseV9jb2RlKQogICAgCiAgICBwYXVzZSgpCgpkZWYgc2hvd19zdG9yZV9wYWNrYWdlc19tZW51KAogICAgc3Vic190eXBlOiBzdHIgPSAiUFJFUEFJRCIsCiAgICBpc19lbnRlcnByaXNlOiBib29sID0gRmFsc2UsCik6CiAgICBpbl9zdG9yZV9wYWNrYWdlc19tZW51ID0gVHJ1ZQogICAgd2hpbGUgaW5fc3RvcmVfcGFja2FnZXNfbWVudToKICAgICAgICBhcGlfa2V5ID0gQXV0aEluc3RhbmNlLmFwaV9rZXkKICAgICAgICB0b2tlbnMgPSBBdXRoSW5zdGFuY2UuZ2V0X2FjdGl2ZV90b2tlbnMoKQogICAgICAgIAogICAgICAgIHByaW50KCJGZXRjaGluZyBzdG9yZSBwYWNrYWdlcy4uLiIpCiAgICAgICAgc3RvcmVfcGFja2FnZXNfcmVzID0gZ2V0X3N0b3JlX3BhY2thZ2VzKGFwaV9rZXksIHRva2Vucywgc3Vic190eXBlLCBpc19lbnRlcnByaXNlKQogICAgICAgIGlmIG5vdCBzdG9yZV9wYWNrYWdlc19yZXM6CiAgICAgICAgICAgIHByaW50KCJObyBzdG9yZSBwYWNrYWdlcyBmb3VuZC4iKQogICAgICAgICAgICBpbl9zdG9yZV9wYWNrYWdlc19tZW51ID0gRmFsc2UKICAgICAgICAgICAgY29udGludWUKICAgICAgICAKICAgICAgICBzdG9yZV9wYWNrYWdlcyA9IHN0b3JlX3BhY2thZ2VzX3Jlcy5nZXQoImRhdGEiLCB7fSkuZ2V0KCJyZXN1bHRzX3ByaWNlX29ubHkiLCBbXSkKICAgICAgICAKICAgICAgICBjbGVhcl9zY3JlZW4oKQogICAgICAgIAogICAgICAgIHByaW50KCI9IiAqIFdJRFRIKQogICAgICAgIHByaW50KCJTdG9yZSBQYWNrYWdlczoiKQogICAgICAgIHByaW50KCI9IiAqIFdJRFRIKQogICAgICAgIAogICAgICAgIHBhY2thZ2VzID0ge30KICAgICAgICBmb3IgaSwgcGFja2FnZSBpbiBlbnVtZXJhdGUoc3RvcmVfcGFja2FnZXMpOgogICAgICAgICAgICB0aXRsZSA9IHBhY2thZ2UuZ2V0KCJ0aXRsZSIsICJOL0EiKQogICAgICAgICAgICAKICAgICAgICAgICAgCiAgICAgICAgICAgIG9yaWdpbmFsX3ByaWNlID0gcGFja2FnZS5nZXQoIm9yaWdpbmFsX3ByaWNlIiwgMCkKICAgICAgICAgICAgZGlzY291bnRlZF9wcmljZSA9IHBhY2thZ2UuZ2V0KCJkaXNjb3VudGVkX3ByaWNlIiwgMCkKICAgICAgICAgICAgCiAgICAgICAgICAgIHByaWNlID0gb3JpZ2luYWxfcHJpY2UKICAgICAgICAgICAgaWYgZGlzY291bnRlZF9wcmljZSA+IDA6CiAgICAgICAgICAgICAgICBwcmljZSA9IGRpc2NvdW50ZWRfcHJpY2UKICAgICAgICAgICAgCiAgICAgICAgICAgIHZhbGlkaXR5ID0gcGFja2FnZS5nZXQoInZhbGlkaXR5IiwgIk4vQSIpCiAgICAgICAgICAgIGZhbWlseV9uYW1lID0gcGFja2FnZS5nZXQoImZhbWlseV9uYW1lIiwgIk4vQSIpCiAgICAgICAgICAgIAogICAgICAgICAgICBhY3Rpb25fdHlwZSA9IHBhY2thZ2UuZ2V0KCJhY3Rpb25fdHlwZSIsICIiKQogICAgICAgICAgICBhY3Rpb25fcGFyYW0gPSBwYWNrYWdlLmdldCgiYWN0aW9uX3BhcmFtIiwgIiIpCiAgICAgICAgICAgIAogICAgICAgICAgICBwYWNrYWdlc1tmIntpICsgMX0iXSA9IHsKICAgICAgICAgICAgICAgICJhY3Rpb25fdHlwZSI6IGFjdGlvbl90eXBlLAogICAgICAgICAgICAgICAgImFjdGlvbl9wYXJhbSI6IGFjdGlvbl9wYXJhbQogICAgICAgICAgICB9CiAgICAgICAgICAgIAogICAgICAgICAgICBwcmludChmIntpICsgMX0uIHt0aXRsZX0iKQogICAgICAgICAgICBwcmludChmIiAgIEZhbWlseToge2ZhbWlseV9uYW1lfSIpCiAgICAgICAgICAgIHByaW50KGYiICAgUHJpY2U6IFJwe3ByaWNlfSIpCiAgICAgICAgICAgIHByaW50KGYiICAgVmFsaWRpdHk6IHt2YWxpZGl0eX0iKQogICAgICAgICAgICBwcmludCgiLSIgKiBXSURUSCkKICAgICAgICAKICAgICAgICBwcmludCgiMDAuIEJhY2sgdG8gTWFpbiBNZW51IikKICAgICAgICBwcmludCgiSW5wdXQgdGhlIG51bWJlciB0byB2aWV3IHBhY2thZ2UgZGV0YWlscy4iKQogICAgICAgIGNob2ljZSA9IGlucHV0KCJFbnRlciB5b3VyIGNob2ljZTogIikKICAgICAgICBpZiBjaG9pY2UgPT0gIjAwIjoKICAgICAgICAgICAgaW5fc3RvcmVfcGFja2FnZXNfbWVudSA9IEZhbHNlCiAgICAgICAgZWxpZiBjaG9pY2UgaW4gcGFja2FnZXM6CiAgICAgICAgICAgIHNlbGVjdGVkX3BhY2thZ2UgPSBwYWNrYWdlc1tjaG9pY2VdCiAgICAgICAgICAgIAogICAgICAgICAgICBhY3Rpb25fdHlwZSA9IHNlbGVjdGVkX3BhY2thZ2VbImFjdGlvbl90eXBlIl0KICAgICAgICAgICAgYWN0aW9uX3BhcmFtID0gc2VsZWN0ZWRfcGFja2FnZVsiYWN0aW9uX3BhcmFtIl0KICAgICAgICAgICAgCiAgICAgICAgICAgIGlmIGFjdGlvbl90eXBlID09ICJQRFAiOgogICAgICAgICAgICAgICAgXyA9IHNob3dfcGFja2FnZV9kZXRhaWxzKAogICAgICAgICAgICAgICAgICAgICAgICBhcGlfa2V5LAogICAgICAgICAgICAgICAgICAgICAgICB0b2tlbnMsCiAgICAgICAgICAgICAgICAgICAgICAgIGFjdGlvbl9wYXJhbSwKICAgICAgICAgICAgICAgICAgICAgICAgaXNfZW50ZXJwcmlzZQogICAgICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHByaW50KCI9IiAqIFdJRFRIKQogICAgICAgICAgICAgICAgcHJpbnQoIlVuaGFuZGxlZCBBY3Rpb24gVHlwZSIpCiAgICAgICAgICAgICAgICBwcmludChmIkFjdGlvbiB0eXBlOiB7YWN0aW9uX3R5cGV9XG5QYXJhbToge2FjdGlvbl9wYXJhbX0iKQogICAgICAgICAgICAgICAgcGF1c2UoKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHByaW50KCJJbnZhbGlkIGNob2ljZS4gUGxlYXNlIGVudGVyIGEgdmFsaWQgcGFja2FnZSBudW1iZXIuIikKICAgICAgICAgICAgcGF1c2UoKQ==').decode())
