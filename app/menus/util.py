#!/usr/bin/env python3
import base64
exec(base64.b64decode('ZnJvbSBodG1sLnBhcnNlciBpbXBvcnQgSFRNTFBhcnNlcgppbXBvcnQgb3MKaW1wb3J0IHJlCmltcG9ydCB0ZXh0d3JhcAoKV0lEVEggPSA1NQoKCmRlZiBjbGVhcl9zY3JlZW4oKToKICAgIG9zLnN5c3RlbSgnY2xzJyBpZiBvcy5uYW1lID09ICdudCcgZWxzZSAnY2xlYXInKQogICAgYXNjaWlfYXJ0ID0gciIiIgogX19fICAgICAgX19fICBfX18gIF9fXyAgX19fICBfX18gIF9fXyAgICAgICAKfCIgIFwgICAgLyIgIHx8IiAgXC8iICB8fCIgIFwvIiAgfHwiICB8ICAgICAgCiBcICAgXCAgLy8gICB8IFwgICBcICAvICBcICAgXCAgLyB8fCAgfCAgICAgIAogL1xcICBcLy4gICAgfCAgXFwgIFwvICAgIFxcICBcLyAgfDogIHwgICAgICAKfDogXC4gICAgICAgIHwgIC8gICAvICAgICAvXC4gIFwgICBcICB8X19fICAgCnwuICBcICAgIC86ICB8IC8gICAvICAgICAvICBcICAgXCAoIFxffDogIFwgIAp8X19ffFxfXy98X19ffHxfX18vICAgICB8X19fL1xfX198IFxfX19fX19fKQoiIiIKICAgIHByaW50KGFzY2lpX2FydCkKCgpkZWYgcGF1c2UobWVzc2FnZTogc3RyID0gIuKYlSBUZWthbiBFbnRlciBiaWFyIGxhbmp1dC4uLiIpOgogICAgaW5wdXQoZiJcbnttZXNzYWdlfSIpCgoKY2xhc3MgSFRNTFRvVGV4dChIVE1MUGFyc2VyKToKICAgIGRlZiBfX2luaXRfXyhzZWxmLCB3aWR0aD04MCk6CiAgICAgICAgc3VwZXIoKS5fX2luaXRfXygpCiAgICAgICAgc2VsZi53aWR0aCA9IHdpZHRoCiAgICAgICAgc2VsZi5yZXN1bHQgPSBbXQogICAgICAgIHNlbGYuaW5fbGkgPSBGYWxzZQoKICAgIGRlZiBoYW5kbGVfc3RhcnR0YWcoc2VsZiwgdGFnLCBhdHRycyk6CiAgICAgICAgaWYgdGFnID09ICJsaSI6CiAgICAgICAgICAgIHNlbGYuaW5fbGkgPSBUcnVlCiAgICAgICAgZWxpZiB0YWcgPT0gImJyIjoKICAgICAgICAgICAgc2VsZi5yZXN1bHQuYXBwZW5kKCJcbiIpCgogICAgZGVmIGhhbmRsZV9lbmR0YWcoc2VsZiwgdGFnKToKICAgICAgICBpZiB0YWcgPT0gImxpIjoKICAgICAgICAgICAgc2VsZi5pbl9saSA9IEZhbHNlCiAgICAgICAgICAgIHNlbGYucmVzdWx0LmFwcGVuZCgiXG4iKQoKICAgIGRlZiBoYW5kbGVfZGF0YShzZWxmLCBkYXRhKToKICAgICAgICB0ZXh0ID0gZGF0YS5zdHJpcCgpCiAgICAgICAgaWYgdGV4dDoKICAgICAgICAgICAgaWYgc2VsZi5pbl9saToKICAgICAgICAgICAgICAgIHNlbGYucmVzdWx0LmFwcGVuZChmIi0ge3RleHR9IikKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHNlbGYucmVzdWx0LmFwcGVuZCh0ZXh0KQoKICAgIGRlZiBnZXRfdGV4dChzZWxmKToKICAgICAgICB0ZXh0ID0gIiIuam9pbihzZWxmLnJlc3VsdCkKICAgICAgICB0ZXh0ID0gcmUuc3ViKHIiXG5ccypcblxzKlxuKyIsICJcblxuIiwgdGV4dCkKICAgICAgICByZXR1cm4gIlxuIi5qb2luKHRleHR3cmFwLndyYXAodGV4dCwgd2lkdGg9c2VsZi53aWR0aCwgcmVwbGFjZV93aGl0ZXNwYWNlPUZhbHNlKSkKCgpkZWYgZGlzcGxheV9odG1sKGh0bWxfdGV4dCwgd2lkdGg9ODApOgogICAgcGFyc2VyID0gSFRNTFRvVGV4dCh3aWR0aD13aWR0aCkKICAgIHBhcnNlci5mZWVkKGh0bWxfdGV4dCkKICAgIHJldHVybiBwYXJzZXIuZ2V0X3RleHQoKQoKCmRlZiBmb3JtYXRfcXVvdGFfYnl0ZShxdW90YV9ieXRlOiBpbnQpIC0+IHN0cjoKICAgIEdCID0gMTAyNCAqKiAzCiAgICBNQiA9IDEwMjQgKiogMgogICAgS0IgPSAxMDI0CgogICAgaWYgcXVvdGFfYnl0ZSA+PSBHQjoKICAgICAgICByZXR1cm4gZiJ7cXVvdGFfYnl0ZSAvIEdCOi4yZn0gR0IiCiAgICBlbGlmIHF1b3RhX2J5dGUgPj0gTUI6CiAgICAgICAgcmV0dXJuIGYie3F1b3RhX2J5dGUgLyBNQjouMmZ9IE1CIgogICAgZWxpZiBxdW90YV9ieXRlID49IEtCOgogICAgICAgIHJldHVybiBmIntxdW90YV9ieXRlIC8gS0I6LjJmfSBLQiIKICAgIGVsc2U6CiAgICAgICAgcmV0dXJuIGYie3F1b3RhX2J5dGV9IEIiCg==').decode())
