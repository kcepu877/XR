#!/usr/bin/env python3
import base64
exec(base64.b64decode('ZnJvbSBhcHAuY29uZmlnLmltcG9ydHMgaW1wb3J0ICoKZnJvbSBhcHAubWVudXMudXRpbCBpbXBvcnQgY2xlYXJfc2NyZWVuLCBwYXVzZSwgcHJpbnRfcGFuZWwsIHNpbXBsZV9udW1iZXIKCmNvbnNvbGUgPSBDb25zb2xlKCkKCgpkZWYgc2hvd190aGVtZV9tZW51KCk6CiAgICB3aGlsZSBUcnVlOgogICAgICAgIGNsZWFyX3NjcmVlbigpCiAgICAgICAgZW5zdXJlX2dpdCgpCiAgICAgICAgdGhlbWUgPSBnZXRfdGhlbWUoKQogICAgICAgIHByZXNldHMgPSBnZXRfYWxsX3ByZXNldHMoKQogICAgICAgIHRoZW1lX25hbWVzID0gbGlzdChwcmVzZXRzLmtleXMoKSkKCiAgICAgICAgY29uc29sZS5wcmludChQYW5lbCgKICAgICAgICAgICAgQWxpZ24uY2VudGVyKCLwn46oIFBpbGloIFRlbWEgQ0xJIiwgdmVydGljYWw9Im1pZGRsZSIpLAogICAgICAgICAgICBzdHlsZT10aGVtZVsidGV4dF90aXRsZSJdLAogICAgICAgICAgICBib3JkZXJfc3R5bGU9dGhlbWVbImJvcmRlcl9pbmZvIl0sCiAgICAgICAgICAgIHBhZGRpbmc9KDEsIDIpLAogICAgICAgICAgICBleHBhbmQ9VHJ1ZSwKICAgICAgICApKQogICAgICAgIHNpbXBsZV9udW1iZXIoKQoKICAgICAgICB0YWJsZSA9IFRhYmxlKGJveD1NSU5JTUFMX0RPVUJMRV9IRUFELCBleHBhbmQ9VHJ1ZSkKICAgICAgICB0YWJsZS5hZGRfY29sdW1uKCJObyIsIGp1c3RpZnk9InJpZ2h0Iiwgc3R5bGU9dGhlbWVbInRleHRfbnVtYmVyIl0sIHdpZHRoPTYpCiAgICAgICAgdGFibGUuYWRkX2NvbHVtbigiTmFtYSBUZW1hIiwgc3R5bGU9dGhlbWVbInRleHRfYm9keSJdKQogICAgICAgIHRhYmxlLmFkZF9jb2x1bW4oIlByZXZpZXciLCBqdXN0aWZ5PSJsZWZ0IikKCiAgICAgICAgZm9yIGlkeCwgbmFtZSBpbiBlbnVtZXJhdGUodGhlbWVfbmFtZXMsIHN0YXJ0PTEpOgogICAgICAgICAgICBwcmVzZXQgPSBwcmVzZXRzW25hbWVdCiAgICAgICAgICAgIHByZXZpZXcgPSAoCiAgICAgICAgICAgICAgICBmIlt7cHJlc2V0Wydib3JkZXJfcHJpbWFyeSddfV3ilqBbL10gIgogICAgICAgICAgICAgICAgZiJbe3ByZXNldFsnYm9yZGVyX2luZm8nXX1d4pagWy9dICIKICAgICAgICAgICAgICAgIGYiW3twcmVzZXRbJ2JvcmRlcl9zdWNjZXNzJ119XeKWoFsvXSAiCiAgICAgICAgICAgICAgICBmIlt7cHJlc2V0Wydib3JkZXJfd2FybmluZyddfV3ilqBbL10gIgogICAgICAgICAgICAgICAgZiJbe3ByZXNldFsnYm9yZGVyX2Vycm9yJ119XeKWoFsvXSIKICAgICAgICAgICAgKQogICAgICAgICAgICB0YWJsZS5hZGRfcm93KHN0cihpZHgpLCBuYW1lLnJlcGxhY2UoIl8iLCAiICIpLnRpdGxlKCksIHByZXZpZXcpCgogICAgICAgIGNvbnNvbGUucHJpbnQoUGFuZWwodGFibGUsIGJvcmRlcl9zdHlsZT10aGVtZVsiYm9yZGVyX2luZm8iXSwgcGFkZGluZz0oMCwgMCksIGV4cGFuZD1UcnVlKSkKCiAgICAgICAgbmF2X3RhYmxlID0gVGFibGUoc2hvd19oZWFkZXI9RmFsc2UsIGJveD1NSU5JTUFMX0RPVUJMRV9IRUFELCBleHBhbmQ9VHJ1ZSkKICAgICAgICBuYXZfdGFibGUuYWRkX2NvbHVtbihqdXN0aWZ5PSJyaWdodCIsIHN0eWxlPXRoZW1lWyJ0ZXh0X2tleSJdLCB3aWR0aD00KQogICAgICAgIG5hdl90YWJsZS5hZGRfY29sdW1uKHN0eWxlPXRoZW1lWyJ0ZXh0X2JvZHkiXSkKICAgICAgICBuYXZfdGFibGUuYWRkX3JvdygiMDAiLCBmIlt7dGhlbWVbJ3RleHRfc3ViJ119XUtlbWJhbGkga2UgbWVudSB1dGFtYVsvXSIpCgogICAgICAgIGNvbnNvbGUucHJpbnQoUGFuZWwobmF2X3RhYmxlLCBib3JkZXJfc3R5bGU9dGhlbWVbImJvcmRlcl9wcmltYXJ5Il0sIHBhZGRpbmc9KDAsIDEpLCBleHBhbmQ9VHJ1ZSkpCgogICAgICAgIGNob2ljZSA9IGNvbnNvbGUuaW5wdXQoZiJbe3RoZW1lWyd0ZXh0X3RpdGxlJ119XVBpbGloIG5vbW9yIHRlbWE6Wy97dGhlbWVbJ3RleHRfdGl0bGUnXX1dICIpLnN0cmlwKCkKCiAgICAgICAgaWYgY2hvaWNlID09ICIwMCI6CiAgICAgICAgICAgIHJldHVybgoKICAgICAgICBpZiBjaG9pY2UuaXNkaWdpdCgpIGFuZCAxIDw9IGludChjaG9pY2UpIDw9IGxlbih0aGVtZV9uYW1lcyk6CiAgICAgICAgICAgIHNlbGVjdGVkX3RoZW1lID0gdGhlbWVfbmFtZXNbaW50KGNob2ljZSkgLSAxXQogICAgICAgICAgICBzZWxlY3RlZF9wcmVzZXQgPSBwcmVzZXRzW3NlbGVjdGVkX3RoZW1lXQoKICAgICAgICAgICAgcHJldmlld19wYW5lbCA9IFBhbmVsKAogICAgICAgICAgICAgICAgQWxpZ24uY2VudGVyKGYiUHJldmlldyBUZW1hOiB7c2VsZWN0ZWRfdGhlbWUucmVwbGFjZSgnXycsICcgJykudGl0bGUoKX0iKSwKICAgICAgICAgICAgICAgIGJvcmRlcl9zdHlsZT1zZWxlY3RlZF9wcmVzZXRbImJvcmRlcl9wcmltYXJ5Il0sCiAgICAgICAgICAgICAgICBzdHlsZT1zZWxlY3RlZF9wcmVzZXRbInRleHRfdGl0bGUiXSwKICAgICAgICAgICAgICAgIHBhZGRpbmc9KDEsIDIpLAogICAgICAgICAgICAgICAgZXhwYW5kPVRydWUKICAgICAgICAgICAgKQogICAgICAgICAgICBjb25zb2xlLnByaW50KHByZXZpZXdfcGFuZWwpCgogICAgICAgICAgICBjb25maXJtID0gY29uc29sZS5pbnB1dCgKICAgICAgICAgICAgICAgIGYiW3t0aGVtZVsndGV4dF9zdWInXX1dR3VuYWthbiB0ZW1hICd7c2VsZWN0ZWRfdGhlbWUucmVwbGFjZSgnXycsICcgJykudGl0bGUoKX0nPyAoeS9uKTpbL3t0aGVtZVsndGV4dF9zdWInXX1dICIKICAgICAgICAgICAgKS5zdHJpcCgpLmxvd2VyKCkKCiAgICAgICAgICAgIGlmIGNvbmZpcm0gPT0gInkiOgogICAgICAgICAgICAgICAgc2V0X3RoZW1lKHNlbGVjdGVkX3RoZW1lKQogICAgICAgICAgICAgICAgdGhlbWUgPSBnZXRfdGhlbWUoZm9yY2VfcmVsb2FkPVRydWUpCiAgICAgICAgICAgICAgICBwcmludF90aGVtZV9jaGFuZ2VkKHNlbGVjdGVkX3RoZW1lKQogICAgICAgICAgICAgICAgcGF1c2UoKQogICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgZWxzZToKICAgICAgICAgICAgcHJpbnRfcGFuZWwoIuKaoO+4jyBFcnJvciIsICJQaWxpaGFuIHRpZGFrIHZhbGlkLiIpCiAgICAgICAgICAgIHBhdXNlKCkKCgpkZWYgcHJpbnRfdGhlbWVfY2hhbmdlZCh0aGVtZV9uYW1lKToKICAgIHRoZW1lID0gZ2V0X3RoZW1lKCkKICAgIHRlcm1pbmFsX3dpZHRoID0gY29uc29sZS5zaXplLndpZHRoCiAgICBtZXNzYWdlX3RleHQgPSAoCiAgICAgICAgZiJbe3RoZW1lWyd0ZXh0X29rJ119XeKchSBUZW1hIERpdWJhaFsvXVxuIgogICAgICAgIGYiW3t0aGVtZVsndGV4dF9zdWInXX1dVGVtYSBzZWthcmFuZzoge3RoZW1lX25hbWUucmVwbGFjZSgnXycsICcgJykudGl0bGUoKX1bL10iCiAgICApCiAgICBwYW5lbCA9IFBhbmVsKAogICAgICAgIEFsaWduLmxlZnQobWVzc2FnZV90ZXh0KSwKICAgICAgICB0aXRsZT0iIiwKICAgICAgICB0aXRsZV9hbGlnbj0ibGVmdCIsCiAgICAgICAgc3R5bGU9dGhlbWVbImJvcmRlcl9zdWNjZXNzIl0sCiAgICAgICAgd2lkdGg9dGVybWluYWxfd2lkdGgKICAgICkKICAgIGNvbnNvbGUucHJpbnQocGFuZWwpCg==').decode())
