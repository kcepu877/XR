#!/usr/bin/env python3
import base64
exec(base64.b64decode('aW1wb3J0IGpzb24KZnJvbSBhcHAyLmNsaWVudC5lbmdzZWwgaW1wb3J0IHNlbmRfYXBpX3JlcXVlc3QKZnJvbSBhcHAyLm1lbnVzLnV0aWwgaW1wb3J0IGZvcm1hdF9xdW90YV9ieXRlLCBsaXZlX2xvYWRpbmcsIHByaW50X3BhbmVsCmZyb20gYXBwMi5jb25maWcudGhlbWVfY29uZmlnIGltcG9ydCBnZXRfdGhlbWUKCgpkZWYgZ2V0X2ZhbWlseV9kYXRhKAogICAgYXBpX2tleTogc3RyLAogICAgdG9rZW5zOiBkaWN0LAopIC0+IGRpY3Q6CiAgICBwYXRoID0gInNoYXJpbmdzL2FwaS92OC9mYW1pbHktcGxhbi9tZW1iZXItaW5mbyIKCiAgICByYXdfcGF5bG9hZCA9IHsKICAgICAgICAiZ3JvdXBfaWQiOiAwLAogICAgICAgICJpc19lbnRlcnByaXNlIjogRmFsc2UsCiAgICAgICAgImxhbmciOiAiZW4iCiAgICB9CgogICAgd2l0aCBsaXZlX2xvYWRpbmcoIk1lbmdhbWJpbCBkYXRhIGZhbWlseS4uLiIsIGdldF90aGVtZSgpKToKICAgICAgICByZXMgPSBzZW5kX2FwaV9yZXF1ZXN0KGFwaV9rZXksIHBhdGgsIHJhd19wYXlsb2FkLCB0b2tlbnNbImlkX3Rva2VuIl0sICJQT1NUIikKCiAgICByZXR1cm4gcmVzCgoKZGVmIHZhbGlkYXRlX21zaXNkbigKICAgIGFwaV9rZXk6IHN0ciwKICAgIHRva2VuczogZGljdCwKICAgIG1zaXNkbjogc3RyLAopIC0+IGRpY3Q6CiAgICAjIHBhdGggPSAiYXBpL3Y4L2F1dGgvdmFsaWRhdGUtbXNpc2RuIgogICAgcGF0aCA9ICJhcGkvdjgvYXV0aC9jaGVjay1kdWtjYXBpbCIKCiAgICByYXdfcGF5bG9hZCA9IHsKICAgICAgICAid2l0aF9iaXpvbiI6IFRydWUsCiAgICAgICAgIndpdGhfZmFtaWx5X3BsYW4iOiBUcnVlLAogICAgICAgICJpc19lbnRlcnByaXNlIjogRmFsc2UsCiAgICAgICAgIndpdGhfb3B0aW11cyI6IFRydWUsCiAgICAgICAgImxhbmciOiAiZW4iLAogICAgICAgICJtc2lzZG4iOiBtc2lzZG4sCiAgICAgICAgIndpdGhfcmVnaXN0X3N0YXR1cyI6IFRydWUsCiAgICAgICAgIndpdGhfZW50ZXJwcmlzZSI6IFRydWUKICAgIH0KCiAgICB3aXRoIGxpdmVfbG9hZGluZyhmIk1lbXZhbGlkYXNpIG5vbW9yIHttc2lzZG59Li4uIiwgZ2V0X3RoZW1lKCkpOgogICAgICAgIHJlcyA9IHNlbmRfYXBpX3JlcXVlc3QoYXBpX2tleSwgcGF0aCwgcmF3X3BheWxvYWQsIHRva2Vuc1siaWRfdG9rZW4iXSwgIlBPU1QiKQoKICAgIHJldHVybiByZXMKCgpkZWYgY2hhbmdlX21lbWJlcigKICAgIGFwaV9rZXk6IHN0ciwKICAgIHRva2VuczogZGljdCwKICAgIHBhcmVudF9hbGlhczogc3RyLAogICAgYWxpYXM6IHN0ciwKICAgIHNsb3RfaWQ6IGludCwKICAgIGZhbWlseV9tZW1iZXJfaWQ6IHN0ciwKICAgIG5ld19tc2lzZG46IHN0ciwKKSAtPiBkaWN0OgogICAgcGF0aCA9ICJzaGFyaW5ncy9hcGkvdjgvZmFtaWx5LXBsYW4vY2hhbmdlLW1lbWJlciIKCiAgICByYXdfcGF5bG9hZCA9IHsKICAgICAgICAicGFyZW50X2FsaWFzIjogcGFyZW50X2FsaWFzLAogICAgICAgICJpc19lbnRlcnByaXNlIjogRmFsc2UsCiAgICAgICAgInNsb3RfaWQiOiBzbG90X2lkLAogICAgICAgICJhbGlhcyI6IGFsaWFzLAogICAgICAgICJsYW5nIjogImVuIiwKICAgICAgICAibXNpc2RuIjogbmV3X21zaXNkbiwKICAgICAgICAiZmFtaWx5X21lbWJlcl9pZCI6IGZhbWlseV9tZW1iZXJfaWQKICAgIH0KCiAgICB3aXRoIGxpdmVfbG9hZGluZyhmIk1lbmd1YmFoIHNsb3Qge3Nsb3RfaWR9IGtlIHtuZXdfbXNpc2RufS4uLiIsIGdldF90aGVtZSgpKToKICAgICAgICByZXMgPSBzZW5kX2FwaV9yZXF1ZXN0KGFwaV9rZXksIHBhdGgsIHJhd19wYXlsb2FkLCB0b2tlbnNbImlkX3Rva2VuIl0sICJQT1NUIikKCiAgICByZXR1cm4gcmVzCgoKZGVmIHJlbW92ZV9tZW1iZXIoCiAgICBhcGlfa2V5OiBzdHIsCiAgICB0b2tlbnM6IGRpY3QsCiAgICBmYW1pbHlfbWVtYmVyX2lkOiBzdHIsCikgLT4gZGljdDoKICAgIHBhdGggPSAic2hhcmluZ3MvYXBpL3Y4L2ZhbWlseS1wbGFuL3JlbW92ZS1tZW1iZXIiCgogICAgcmF3X3BheWxvYWQgPSB7CiAgICAgICAgImlzX2VudGVycHJpc2UiOiBGYWxzZSwKICAgICAgICAiZmFtaWx5X21lbWJlcl9pZCI6IGZhbWlseV9tZW1iZXJfaWQsCiAgICAgICAgImxhbmciOiAiZW4iCiAgICB9CgogICAgd2l0aCBsaXZlX2xvYWRpbmcoZiJNZW5naGFwdXMgbWVtYmVyIHtmYW1pbHlfbWVtYmVyX2lkfSBkYXJpIGZhbWlseS4uLiIsIGdldF90aGVtZSgpKToKICAgICAgICByZXMgPSBzZW5kX2FwaV9yZXF1ZXN0KGFwaV9rZXksIHBhdGgsIHJhd19wYXlsb2FkLCB0b2tlbnNbImlkX3Rva2VuIl0sICJQT1NUIikKCiAgICByZXR1cm4gcmVzCgoKZGVmIHNldF9xdW90YV9saW1pdCgKICAgIGFwaV9rZXk6IHN0ciwKICAgIHRva2VuczogZGljdCwKICAgIG9yaWdpbmFsX2FsbG9jYXRpb246IGludCwKICAgIG5ld19hbGxvY2F0aW9uOiBpbnQsCiAgICBmYW1pbHlfbWVtYmVyX2lkOiBzdHIsCikgLT4gZGljdDoKICAgIHBhdGggPSAic2hhcmluZ3MvYXBpL3Y4L2ZhbWlseS1wbGFuL2FsbG9jYXRlLXF1b3RhIgoKICAgIHJhd19wYXlsb2FkID0gewogICAgICAgICJpc19lbnRlcnByaXNlIjogRmFsc2UsCiAgICAgICAgIm1lbWJlcl9hbGxvY2F0aW9ucyI6IFt7CiAgICAgICAgICAgICJuZXdfdGV4dF9hbGxvY2F0aW9uIjogMCwKICAgICAgICAgICAgIm9yaWdpbmFsX3RleHRfYWxsb2NhdGlvbiI6IDAsCiAgICAgICAgICAgICJvcmlnaW5hbF92b2ljZV9hbGxvY2F0aW9uIjogMCwKICAgICAgICAgICAgIm9yaWdpbmFsX2FsbG9jYXRpb24iOiBvcmlnaW5hbF9hbGxvY2F0aW9uLAogICAgICAgICAgICAibmV3X3ZvaWNlX2FsbG9jYXRpb24iOiAwLAogICAgICAgICAgICAibWVzc2FnZSI6ICIiLAogICAgICAgICAgICAibmV3X2FsbG9jYXRpb24iOiBuZXdfYWxsb2NhdGlvbiwKICAgICAgICAgICAgImZhbWlseV9tZW1iZXJfaWQiOiBmYW1pbHlfbWVtYmVyX2lkLAogICAgICAgICAgICAic3RhdHVzIjogIiIKICAgICAgICB9XSwKICAgICAgICAibGFuZyI6ICJlbiIKICAgIH0KCiAgICBmb3JtYXR0ZWRfbmV3X2FsbG9jYXRpb24gPSBmb3JtYXRfcXVvdGFfYnl0ZShuZXdfYWxsb2NhdGlvbikKCiAgICB3aXRoIGxpdmVfbG9hZGluZyhmIk1lbmdhdHVyIGxpbWl0IGt1b3RhIHVudHVrIHtmYW1pbHlfbWVtYmVyX2lkfSBrZSB7Zm9ybWF0dGVkX25ld19hbGxvY2F0aW9ufS4uLiIsIGdldF90aGVtZSgpKToKICAgICAgICByZXMgPSBzZW5kX2FwaV9yZXF1ZXN0KGFwaV9rZXksIHBhdGgsIHJhd19wYXlsb2FkLCB0b2tlbnNbImlkX3Rva2VuIl0sICJQT1NUIikKCiAgICByZXR1cm4gcmVzCg==').decode())
