#!/usr/bin/env python3
import base64
exec(base64.b64decode('aW1wb3J0IGJhc2U2NAppbXBvcnQgb3MKaW1wb3J0IGpzb24KaW1wb3J0IHV1aWQKaW1wb3J0IHJlcXVlc3RzCmZyb20gdXJsbGliLnBhcnNlIGltcG9ydCB1cmxwYXJzZQpmcm9tIGRhdGV0aW1lIGltcG9ydCBkYXRldGltZSwgdGltZXpvbmUsIHRpbWVkZWx0YQoKZnJvbSBhcHAyLm1lbnVzLnV0aWwgaW1wb3J0IGxpdmVfbG9hZGluZywgcHJpbnRfcGFuZWwKZnJvbSBhcHAyLmNvbmZpZy50aGVtZV9jb25maWcgaW1wb3J0IGdldF90aGVtZQpmcm9tIGFwcDIuY2xpZW50LmVuY3J5cHQgaW1wb3J0ICgKICAgIGphdmFfbGlrZV90aW1lc3RhbXAsCiAgICB0c19nbXQ3X3dpdGhvdXRfY29sb24sCiAgICBheF9hcGlfc2lnbmF0dXJlLAogICAgbG9hZF9heF9mcCwKICAgIGF4X2RldmljZV9pZAopCgpCQVNFX0NJQU1fVVJMID0gb3MuZ2V0ZW52KCJCQVNFX0NJQU1fVVJMIikKaWYgbm90IEJBU0VfQ0lBTV9VUkw6CiAgICByYWlzZSBWYWx1ZUVycm9yKCJCQVNFX0NJQU1fVVJMIGVudmlyb25tZW50IHZhcmlhYmxlIG5vdCBzZXQiKQoKQkFTSUNfQVVUSCA9IG9zLmdldGVudigiQkFTSUNfQVVUSCIpCkFYX0RFVklDRV9JRCA9IGF4X2RldmljZV9pZCgpCkFYX0ZQID0gbG9hZF9heF9mcCgpClVBID0gb3MuZ2V0ZW52KCJVQSIpCgoKZGVmIHZhbGlkYXRlX2NvbnRhY3QoY29udGFjdDogc3RyKSAtPiBib29sOgogICAgcmV0dXJuIGNvbnRhY3Quc3RhcnRzd2l0aCgiNjI4IikgYW5kIGxlbihjb250YWN0KSA8PSAxNAoKCmRlZiBnZXRfb3RwKGNvbnRhY3Q6IHN0cikgLT4gc3RyIHwgTm9uZToKICAgIGlmIG5vdCB2YWxpZGF0ZV9jb250YWN0KGNvbnRhY3QpOgogICAgICAgIHByaW50X3BhbmVsKCJLZXNhbGFoYW4iLCAiTm9tb3IgdGlkYWsgdmFsaWQuIikKICAgICAgICByZXR1cm4gTm9uZQoKICAgIHVybCA9IEJBU0VfQ0lBTV9VUkwgKyAiL3JlYWxtcy94bC1jaWFtL2F1dGgvb3RwIgogICAgcXVlcnlzdHJpbmcgPSB7ImNvbnRhY3QiOiBjb250YWN0LCAiY29udGFjdFR5cGUiOiAiU01TIiwgImFsdGVybmF0ZUNvbnRhY3QiOiAiZmFsc2UifQogICAgbm93ID0gZGF0ZXRpbWUubm93KHRpbWV6b25lKHRpbWVkZWx0YShob3Vycz03KSkpCiAgICBheF9yZXF1ZXN0X2F0ID0gamF2YV9saWtlX3RpbWVzdGFtcChub3cpCiAgICBheF9yZXF1ZXN0X2lkID0gc3RyKHV1aWQudXVpZDQoKSkKCiAgICBoZWFkZXJzID0gewogICAgICAgICJBdXRob3JpemF0aW9uIjogZiJCYXNpYyB7QkFTSUNfQVVUSH0iLAogICAgICAgICJBeC1EZXZpY2UtSWQiOiBBWF9ERVZJQ0VfSUQsCiAgICAgICAgIkF4LUZpbmdlcnByaW50IjogQVhfRlAsCiAgICAgICAgIkF4LVJlcXVlc3QtQXQiOiBheF9yZXF1ZXN0X2F0LAogICAgICAgICJBeC1SZXF1ZXN0LURldmljZSI6ICJzYW1zdW5nIiwKICAgICAgICAiQXgtUmVxdWVzdC1EZXZpY2UtTW9kZWwiOiAiU00tTjkzNUYiLAogICAgICAgICJBeC1SZXF1ZXN0LUlkIjogYXhfcmVxdWVzdF9pZCwKICAgICAgICAiQXgtU3Vic3R5cGUiOiAiUFJFUEFJRCIsCiAgICAgICAgIkNvbnRlbnQtVHlwZSI6ICJhcHBsaWNhdGlvbi9qc29uIiwKICAgICAgICAiSG9zdCI6IEJBU0VfQ0lBTV9VUkwucmVwbGFjZSgiaHR0cHM6Ly8iLCAiIiksCiAgICAgICAgIlVzZXItQWdlbnQiOiBVQSwKICAgIH0KCiAgICB3aXRoIGxpdmVfbG9hZGluZyhmIk1lbWludGEgT1RQIHVudHVrIHtjb250YWN0fS4uLiIsIGdldF90aGVtZSgpKToKICAgICAgICB0cnk6CiAgICAgICAgICAgIHJlc3BvbnNlID0gcmVxdWVzdHMuZ2V0KHVybCwgaGVhZGVycz1oZWFkZXJzLCBwYXJhbXM9cXVlcnlzdHJpbmcsIHRpbWVvdXQ9MzApCiAgICAgICAgICAgIGpzb25fYm9keSA9IHJlc3BvbnNlLmpzb24oKQogICAgICAgICAgICBpZiAic3Vic2NyaWJlcl9pZCIgbm90IGluIGpzb25fYm9keToKICAgICAgICAgICAgICAgIHByaW50X3BhbmVsKCJLZXNhbGFoYW4iLCAiT1RQIGdhZ2FsIGRpYW1iaWwuIikKICAgICAgICAgICAgICAgIHJldHVybiBOb25lCiAgICAgICAgICAgIHByaW50X3BhbmVsKCJCZXJoYXNpbCIsIGYiT1RQIGJlcmhhc2lsIGRpa2lyaW0ga2Uge2NvbnRhY3R9LiIpCiAgICAgICAgICAgIHJldHVybiBqc29uX2JvZHlbInN1YnNjcmliZXJfaWQiXQogICAgICAgIGV4Y2VwdCBFeGNlcHRpb246CiAgICAgICAgICAgIHByaW50X3BhbmVsKCJLZXNhbGFoYW4iLCAiVGVyamFkaSBlcnJvciBzYWF0IHJlcXVlc3QgT1RQLiIpCiAgICAgICAgICAgIHJldHVybiBOb25lCgoKZGVmIGV4dGVuZF9zZXNzaW9uKHN1YnNjcmliZXJfaWQ6IHN0cikgLT4gc3RyIHwgTm9uZToKICAgIGI2NF9zdWJzY3JpYmVyX2lkID0gYmFzZTY0LmI2NGVuY29kZShzdWJzY3JpYmVyX2lkLmVuY29kZSgpKS5kZWNvZGUoKQogICAgdXJsID0gZiJ7QkFTRV9DSUFNX1VSTH0vcmVhbG1zL3hsLWNpYW0vYXV0aC9leHRlbmQtc2Vzc2lvbiIKICAgIHF1ZXJ5c3RyaW5nID0geyJjb250YWN0IjogYjY0X3N1YnNjcmliZXJfaWQsICJjb250YWN0VHlwZSI6ICJERVZJQ0VJRCJ9CiAgICBub3cgPSBkYXRldGltZS5ub3codGltZXpvbmUodGltZWRlbHRhKGhvdXJzPTcpKSkKICAgIGF4X3JlcXVlc3RfYXQgPSBqYXZhX2xpa2VfdGltZXN0YW1wKG5vdykKICAgIGF4X3JlcXVlc3RfaWQgPSBzdHIodXVpZC51dWlkNCgpKQoKICAgIGhlYWRlcnMgPSB7CiAgICAgICAgIkF1dGhvcml6YXRpb24iOiBmIkJhc2ljIHtCQVNJQ19BVVRIfSIsCiAgICAgICAgIkF4LURldmljZS1JZCI6IEFYX0RFVklDRV9JRCwKICAgICAgICAiQXgtRmluZ2VycHJpbnQiOiBBWF9GUCwKICAgICAgICAiQXgtUmVxdWVzdC1BdCI6IGF4X3JlcXVlc3RfYXQsCiAgICAgICAgIkF4LVJlcXVlc3QtRGV2aWNlIjogInNhbXN1bmciLAogICAgICAgICJBeC1SZXF1ZXN0LURldmljZS1Nb2RlbCI6ICJTTS1OOTM1RiIsCiAgICAgICAgIkF4LVJlcXVlc3QtSWQiOiBheF9yZXF1ZXN0X2lkLAogICAgICAgICJBeC1TdWJzdHlwZSI6ICJQUkVQQUlEIiwKICAgICAgICAiQ29udGVudC1UeXBlIjogImFwcGxpY2F0aW9uL2pzb24iLAogICAgICAgICJIb3N0IjogQkFTRV9DSUFNX1VSTC5yZXBsYWNlKCJodHRwczovLyIsICIiKSwKICAgICAgICAiVXNlci1BZ2VudCI6IFVBLAogICAgfQoKICAgIHdpdGggbGl2ZV9sb2FkaW5nKCJNZW1wZXJwYW5qYW5nIHNlc3Npb24uLi4iLCBnZXRfdGhlbWUoKSk6CiAgICAgICAgdHJ5OgogICAgICAgICAgICByZXNwb25zZSA9IHJlcXVlc3RzLmdldCh1cmwsIGhlYWRlcnM9aGVhZGVycywgcGFyYW1zPXF1ZXJ5c3RyaW5nLCB0aW1lb3V0PTMwKQogICAgICAgICAgICBpZiByZXNwb25zZS5zdGF0dXNfY29kZSAhPSAyMDA6CiAgICAgICAgICAgICAgICBwcmludF9wYW5lbCgiS2VzYWxhaGFuIiwgIkV4dGVuZCBzZXNzaW9uIGdhZ2FsLiIpCiAgICAgICAgICAgICAgICByZXR1cm4gTm9uZQogICAgICAgICAgICBkYXRhID0gcmVzcG9uc2UuanNvbigpCiAgICAgICAgICAgIHByaW50X3BhbmVsKCJCZXJoYXNpbCIsICJTZXNzaW9uIGJlcmhhc2lsIGRpcGVycGFuamFuZy4iKQogICAgICAgICAgICByZXR1cm4gZGF0YS5nZXQoImRhdGEiLCB7fSkuZ2V0KCJleGNoYW5nZV9jb2RlIikKICAgICAgICBleGNlcHQgRXhjZXB0aW9uOgogICAgICAgICAgICBwcmludF9wYW5lbCgiS2VzYWxhaGFuIiwgIlRlcmphZGkgZXJyb3Igc2FhdCBleHRlbmQgc2Vzc2lvbi4iKQogICAgICAgICAgICByZXR1cm4gTm9uZQoKCmRlZiBzdWJtaXRfb3RwKGFwaV9rZXk6IHN0ciwgY29udGFjdF90eXBlOiBzdHIsIGNvbnRhY3Q6IHN0ciwgY29kZTogc3RyKSAtPiBkaWN0IHwgTm9uZToKICAgIGlmIGNvbnRhY3RfdHlwZSA9PSAiU01TIjoKICAgICAgICBpZiBub3QgdmFsaWRhdGVfY29udGFjdChjb250YWN0KToKICAgICAgICAgICAgcHJpbnRfcGFuZWwoIktlc2FsYWhhbiIsICJOb21vciB0aWRhayB2YWxpZC4iKQogICAgICAgICAgICByZXR1cm4gTm9uZQogICAgICAgIGlmIG5vdCBjb2RlIG9yIGxlbihjb2RlKSAhPSA2OgogICAgICAgICAgICBwcmludF9wYW5lbCgiS2VzYWxhaGFuIiwgIktvZGUgT1RQIHRpZGFrIHZhbGlkLiIpCiAgICAgICAgICAgIHJldHVybiBOb25lCiAgICAgICAgZmluYWxfY29udGFjdCA9IGNvbnRhY3QKICAgICAgICBmaW5hbF9jb2RlID0gY29kZQogICAgZWxpZiBjb250YWN0X3R5cGUgPT0gIkRFVklDRUlEIjoKICAgICAgICBmaW5hbF9jb250YWN0ID0gYmFzZTY0LmI2NGVuY29kZShjb250YWN0LmVuY29kZSgpKS5kZWNvZGUoKQogICAgICAgIGZpbmFsX2NvZGUgPSBjb2RlCiAgICBlbHNlOgogICAgICAgIHByaW50X3BhbmVsKCJLZXNhbGFoYW4iLCAiQ29udGFjdCB0eXBlIHRpZGFrIHZhbGlkLiIpCiAgICAgICAgcmV0dXJuIE5vbmUKCiAgICB1cmwgPSBCQVNFX0NJQU1fVVJMICsgIi9yZWFsbXMveGwtY2lhbS9wcm90b2NvbC9vcGVuaWQtY29ubmVjdC90b2tlbiIKICAgIG5vd19nbXQ3ID0gZGF0ZXRpbWUubm93KHRpbWV6b25lKHRpbWVkZWx0YShob3Vycz03KSkpCiAgICB0c19mb3Jfc2lnbiA9IHRzX2dtdDdfd2l0aG91dF9jb2xvbihub3dfZ210NykKICAgIHRzX2hlYWRlciA9IHRzX2dtdDdfd2l0aG91dF9jb2xvbihub3dfZ210NyAtIHRpbWVkZWx0YShtaW51dGVzPTUpKQogICAgc2lnbmF0dXJlID0gYXhfYXBpX3NpZ25hdHVyZShhcGlfa2V5LCB0c19mb3Jfc2lnbiwgZmluYWxfY29udGFjdCwgY29kZSwgY29udGFjdF90eXBlKQoKICAgIHBheWxvYWQgPSBmImNvbnRhY3RUeXBlPXtjb250YWN0X3R5cGV9JmNvZGU9e2ZpbmFsX2NvZGV9JmdyYW50X3R5cGU9cGFzc3dvcmQmY29udGFjdD17ZmluYWxfY29udGFjdH0mc2NvcGU9b3BlbmlkIgogICAgaGVhZGVycyA9IHsKICAgICAgICAiQXV0aG9yaXphdGlvbiI6IGYiQmFzaWMge0JBU0lDX0FVVEh9IiwKICAgICAgICAiQXgtQXBpLVNpZ25hdHVyZSI6IHNpZ25hdHVyZSwKICAgICAgICAiQXgtRGV2aWNlLUlkIjogQVhfREVWSUNFX0lELAogICAgICAgICJBeC1GaW5nZXJwcmludCI6IEFYX0ZQLAogICAgICAgICJBeC1SZXF1ZXN0LUF0IjogdHNfaGVhZGVyLAogICAgICAgICJBeC1SZXF1ZXN0LURldmljZSI6ICJzYW1zdW5nIiwKICAgICAgICAiQXgtUmVxdWVzdC1EZXZpY2UtTW9kZWwiOiAiU00tTjkzNUYiLAogICAgICAgICJBeC1SZXF1ZXN0LUlkIjogc3RyKHV1aWQudXVpZDQoKSksCiAgICAgICAgIkF4LVN1YnN0eXBlIjogIlBSRVBBSUQiLAogICAgICAgICJDb250ZW50LVR5cGUiOiAiYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkIiwKICAgICAgICAiVXNlci1BZ2VudCI6IFVBLAogICAgfQoKICAgIHdpdGggbGl2ZV9sb2FkaW5nKCJTdWJtaXQgT1RQLi4uIiwgZ2V0X3RoZW1lKCkpOgogICAgICAgIHRyeToKICAgICAgICAgICAgcmVzcG9uc2UgPSByZXF1ZXN0cy5wb3N0KHVybCwgZGF0YT1wYXlsb2FkLCBoZWFkZXJzPWhlYWRlcnMsIHRpbWVvdXQ9MzApCiAgICAgICAgICAgIGpzb25fYm9keSA9IHJlc3BvbnNlLmpzb24oKQogICAgICAgICAgICBpZiAiZXJyb3IiIGluIGpzb25fYm9keToKICAgICAgICAgICAgICAgIHByaW50X3BhbmVsKCJLZXNhbGFoYW4iLCAiT1RQIGRpdG9sYWsuIikKICAgICAgICAgICAgICAgIHJldHVybiBOb25lCiAgICAgICAgICAgIHByaW50X3BhbmVsKCJCZXJoYXNpbCIsICJPVFAgYmVyaGFzaWwgZGl2YWxpZGFzaS4iKQogICAgICAgICAgICByZXR1cm4ganNvbl9ib2R5CiAgICAgICAgZXhjZXB0IHJlcXVlc3RzLlJlcXVlc3RFeGNlcHRpb246CiAgICAgICAgICAgIHByaW50X3BhbmVsKCJLZXNhbGFoYW4iLCAiVGVyamFkaSBlcnJvciBzYWF0IHN1Ym1pdCBPVFAuIikKICAgICAgICAgICAgcmV0dXJuIE5vbmUKCgpkZWYgZ2V0X25ld190b2tlbihhcGlfa2V5OiBzdHIsIHJlZnJlc2hfdG9rZW46IHN0ciwgc3Vic2NyaWJlcl9pZDogc3RyKSAtPiBkaWN0IHwgTm9uZToKICAgIHVybCA9IEJBU0VfQ0lBTV9VUkwgKyAiL3JlYWxtcy94bC1jaWFtL3Byb3RvY29sL29wZW5pZC1jb25uZWN0L3Rva2VuIgogICAgbm93ID0gZGF0ZXRpbWUubm93KHRpbWV6b25lKHRpbWVkZWx0YShob3Vycz03KSkpCiAgICBheF9yZXF1ZXN0X2F0ID0gbm93LnN0cmZ0aW1lKCIlWS0lbS0lZFQlSDolTTolUy4lZiIpWzotM10gKyAiKzA3MDAiCiAgICBheF9yZXF1ZXN0X2lkID0gc3RyKHV1aWQudXVpZDQoKSkKCiAgICBoZWFkZXJzID0gewogICAgICAgICJIb3N0IjogQkFTRV9DSUFNX1VSTC5yZXBsYWNlKCJodHRwczovLyIsICIiKSwKICAgICAgICAiYXgtcmVxdWVzdC1hdCI6IGF4X3JlcXVlc3RfYXQsCiAgICAgICAgImF4LWRldmljZS1pZCI6IEFYX0RFVklDRV9JRCwKICAgICAgICAiYXgtcmVxdWVzdC1pZCI6IGF4X3JlcXVlc3RfaWQsCiAgICAgICAgImF4LXJlcXVlc3QtZGV2aWNlIjogInNhbXN1bmciLAogICAgICAgICJheC1yZXF1ZXN0LWRldmljZS1tb2RlbCI6ICJTTS1OOTM1RiIsCiAgICAgICAgImF4LWZpbmdlcnByaW50IjogQVhfRlAsCiAgICAgICAgImF1dGhvcml6YXRpb24iOiBmIkJhc2ljIHtCQVNJQ19BVVRIfSIsCiAgICAgICAgInVzZXItYWdlbnQiOiBVQSwKICAgICAgICAiYXgtc3Vic3R5cGUiOiAiUFJFUEFJRCIsCiAgICAgICAgImNvbnRlbnQtdHlwZSI6ICJhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQiLAogICAgfQogICAgZGF0YSA9IHsiZ3JhbnRfdHlwZSI6ICJyZWZyZXNoX3Rva2VuIiwgInJlZnJlc2hfdG9rZW4iOiByZWZyZXNoX3Rva2VufQoKICAgICN3aXRoIGxpdmVfbG9hZGluZygiUmVmcmVzaCB0b2tlbi4uLiIsIGdldF90aGVtZSgpKToKICAgIHRyeToKICAgICAgICByZXNwID0gcmVxdWVzdHMucG9zdCh1cmwsIGhlYWRlcnM9aGVhZGVycywgZGF0YT1kYXRhLCB0aW1lb3V0PTMwKQogICAgZXhjZXB0IHJlcXVlc3RzLlJlcXVlc3RFeGNlcHRpb246CiAgICAgICAgcHJpbnRfcGFuZWwoIktlc2FsYWhhbiIsICJUZXJqYWRpIGVycm9yIHNhYXQgcmVmcmVzaCB0b2tlbi4iKQogICAgICAgIHJldHVybiBOb25lCgogICAgaWYgcmVzcC5zdGF0dXNfY29kZSA9PSA0MDA6CiAgICAgICAgdHJ5OgogICAgICAgICAgICBlcnJfanNvbiA9IHJlc3AuanNvbigpCiAgICAgICAgZXhjZXB0IFZhbHVlRXJyb3I6CiAgICAgICAgICAgIHJldHVybiBOb25lCiAgICAgICAgaWYgZXJyX2pzb24uZ2V0KCJlcnJvcl9kZXNjcmlwdGlvbiIpICE9ICJTZXNzaW9uIG5vdCBhY3RpdmUiOgogICAgICAgICAgICByZXR1cm4gTm9uZQogICAgICAgIGlmIG5vdCBzdWJzY3JpYmVyX2lkOgogICAgICAgICAgICByZXR1cm4gTm9uZQogICAgICAgIGV4Y2hhbmdlX2NvZGUgPSBleHRlbmRfc2Vzc2lvbihzdWJzY3JpYmVyX2lkKQogICAgICAgIGlmIG5vdCBleGNoYW5nZV9jb2RlOgogICAgICAgICAgICBwcmludF9wYW5lbCgiS2VzYWxhaGFuIiwgIkV4dGVuZCBzZXNzaW9uIGdhZ2FsLiIpCiAgICAgICAgICAgIHJldHVybiBOb25lCiAgICAgICAgcHJpbnRfcGFuZWwoIkluZm9ybWFzaSIsICJTZXNzaW9uIGV4cGlyZWQsIHNpbGFrYW4gc3VibWl0IE9UUCBrZW1iYWxpLiIpCiAgICAgICAgcmV0dXJuIHN1Ym1pdF9vdHAoYXBpX2tleSwgIkRFVklDRUlEIiwgc3Vic2NyaWJlcl9pZCwgZXhjaGFuZ2VfY29kZSkKCiAgICB0cnk6CiAgICAgICAgcmVzcC5yYWlzZV9mb3Jfc3RhdHVzKCkKICAgIGV4Y2VwdCByZXF1ZXN0cy5IVFRQRXJyb3I6CiAgICAgICAgcHJpbnRfcGFuZWwoIktlc2FsYWhhbiIsICJIVFRQIGVycm9yIHNhYXQgcmVmcmVzaCB0b2tlbi4iKQogICAgICAgIHJldHVybiBOb25lCgogICAgdHJ5OgogICAgICAgIGJvZHkgPSByZXNwLmpzb24oKQogICAgZXhjZXB0IFZhbHVlRXJyb3I6CiAgICAgICAgcHJpbnRfcGFuZWwoIktlc2FsYWhhbiIsICJSZXNwb25zZSB0b2tlbiB0aWRhayB2YWxpZC4iKQogICAgICAgIHJldHVybiBOb25lCgogICAgaWYgImlkX3Rva2VuIiBub3QgaW4gYm9keSBvciAiZXJyb3IiIGluIGJvZHk6CiAgICAgICAgcHJpbnRfcGFuZWwoIktlc2FsYWhhbiIsICJUb2tlbiBiYXJ1IGdhZ2FsIGRpYW1iaWwuIikKICAgICAgICByZXR1cm4gTm9uZQoKICAgICMgcHJpbnRfcGFuZWwoIkJlcmhhc2lsIiwgIlRva2VuIGJhcnUgYmVyaGFzaWwgZGlhbWJpbC4iKQogICAgcmV0dXJuIGJvZHkKCgpkZWYgZ2V0X2F1dGhfY29kZSh0b2tlbnM6IGRpY3QsIHBpbjogc3RyLCBtc2lzZG46IHN0cikgLT4gc3RyIHwgTm9uZToKICAgIHVybCA9IEJBU0VfQ0lBTV9VUkwgKyAiL2NpYW0vYXV0aC9hdXRob3JpemF0aW9uLXRva2VuL2dlbmVyYXRlIgoKICAgIHBhcnNlZCA9IHVybHBhcnNlKEJBU0VfQ0lBTV9VUkwpCiAgICBob3N0X2hlYWRlciA9IHBhcnNlZC5uZXRsb2Mgb3IgQkFTRV9DSUFNX1VSTC5yZXBsYWNlKCJodHRwczovLyIsICIiKQoKICAgIG5vdyA9IGRhdGV0aW1lLm5vdyh0aW1lem9uZSh0aW1lZGVsdGEoaG91cnM9NykpKQogICAgYXhfcmVxdWVzdF9hdCA9IG5vdy5zdHJmdGltZSgiJVktJW0tJWRUJUg6JU06JVMuJWYiKVs6LTNdICsgIiswNzAwIgogICAgYXhfcmVxdWVzdF9pZCA9IHN0cih1dWlkLnV1aWQ0KCkpCgogICAgaGVhZGVycyA9IHsKICAgICAgICAiSG9zdCI6IGhvc3RfaGVhZGVyLAogICAgICAgICJBeC1SZXF1ZXN0LUF0IjogYXhfcmVxdWVzdF9hdCwKICAgICAgICAiQXgtRGV2aWNlLUlkIjogQVhfREVWSUNFX0lELAogICAgICAgICJBeC1SZXF1ZXN0LUlkIjogYXhfcmVxdWVzdF9pZCwKICAgICAgICAiQXgtUmVxdWVzdC1EZXZpY2UiOiAic2Ftc3VuZyIsCiAgICAgICAgIkF4LVJlcXVlc3QtRGV2aWNlLU1vZGVsIjogIlNNLU45MzVGIiwKICAgICAgICAiQXgtRmluZ2VycHJpbnQiOiBBWF9GUCwKICAgICAgICAiQXV0aG9yaXphdGlvbiI6IGYiQmVhcmVyIHt0b2tlbnNbJ2FjY2Vzc190b2tlbiddfSIsCiAgICAgICAgIlVzZXItQWdlbnQiOiBVQSwKICAgICAgICAiQXgtU3Vic3R5cGUiOiAiUFJFUEFJRCIsCiAgICAgICAgIkNvbnRlbnQtVHlwZSI6ICJhcHBsaWNhdGlvbi9qc29uIiwKICAgIH0KCiAgICBwaW5fYjY0ID0gYmFzZTY0LmI2NGVuY29kZShwaW4uZW5jb2RlKCJ1dGYtOCIpKS5kZWNvZGUoInV0Zi04IikKICAgIGJvZHkgPSB7CiAgICAgICAgInBpbiI6IHBpbl9iNjQsCiAgICAgICAgInRyYW5zYWN0aW9uX3R5cGUiOiAiU0hBUkVfQkFMQU5DRSIsCiAgICAgICAgInJlY2VpdmVyX21zaXNkbiI6IG1zaXNkbiwKICAgIH0KCiAgICB3aXRoIGxpdmVfbG9hZGluZyhmIk1lbWludGEgYXV0aG9yaXphdGlvbiBjb2RlIHVudHVrIHttc2lzZG59Li4uIiwgZ2V0X3RoZW1lKCkpOgogICAgICAgIHRyeToKICAgICAgICAgICAgcmVzcCA9IHJlcXVlc3RzLnBvc3QodXJsLCBoZWFkZXJzPWhlYWRlcnMsIGpzb249Ym9keSwgdGltZW91dD0zMCkKICAgICAgICBleGNlcHQgcmVxdWVzdHMuUmVxdWVzdEV4Y2VwdGlvbjoKICAgICAgICAgICAgcHJpbnRfcGFuZWwoIktlc2FsYWhhbiIsICJUZXJqYWRpIGVycm9yIHNhYXQgcmVxdWVzdCBhdXRob3JpemF0aW9uIGNvZGUuIikKICAgICAgICAgICAgcmV0dXJuIE5vbmUKCiAgICBpZiByZXNwLnN0YXR1c19jb2RlICE9IDIwMDoKICAgICAgICBwcmludF9wYW5lbCgiS2VzYWxhaGFuIiwgIkF1dGhvcml6YXRpb24gY29kZSBnYWdhbCBkaWFtYmlsLiIpCiAgICAgICAgcmV0dXJuIE5vbmUKCiAgICB0cnk6CiAgICAgICAgZGF0YSA9IHJlc3AuanNvbigpCiAgICBleGNlcHQgVmFsdWVFcnJvcjoKICAgICAgICBwcmludF9wYW5lbCgiS2VzYWxhaGFuIiwgIlJlc3BvbnNlIGF1dGhvcml6YXRpb24gY29kZSB0aWRhayB2YWxpZC4iKQogICAgICAgIHJldHVybiBOb25lCgogICAgaWYgbm90IGlzaW5zdGFuY2UoZGF0YSwgZGljdCk6CiAgICAgICAgcHJpbnRfcGFuZWwoIktlc2FsYWhhbiIsICJGb3JtYXQgZGF0YSBhdXRob3JpemF0aW9uIGNvZGUgdGlkYWsgdmFsaWQuIikKICAgICAgICByZXR1cm4gTm9uZQoKICAgIHN0YXR1cyA9IGRhdGEuZ2V0KCJzdGF0dXMiLCAiIikKICAgIG1lc3NhZ2UgPSBkYXRhLmdldCgibWVzc2FnZSIsICIiKQoKICAgIGlmIHN0YXR1cyA9PSAiU3VjY2VzcyI6CiAgICAgICAgIyBwcmludF9wYW5lbCgiQmVyaGFzaWwiLCBmIkF1dGhvcml6YXRpb24gY29kZSBiZXJoYXNpbCBkaWFtYmlsLlxuUGVzYW46IHttZXNzYWdlfSIpCiAgICAgICAgcGFzcwogICAgZWxzZToKICAgICAgICBwcmludF9wYW5lbCgiS2VzYWxhaGFuIiwgZiJBdXRob3JpemF0aW9uIGNvZGUgZ2FnYWwuXG5QZXNhbjoge21lc3NhZ2V9IikKICAgICAgICByZXR1cm4gTm9uZQoKICAgIGF1dGhvcml6YXRpb25fY29kZSA9IGRhdGEuZ2V0KCJkYXRhIiwge30pLmdldCgiYXV0aG9yaXphdGlvbl9jb2RlIikKICAgIGlmIG5vdCBhdXRob3JpemF0aW9uX2NvZGU6CiAgICAgICAgcHJpbnRfcGFuZWwoIktlc2FsYWhhbiIsICJBdXRob3JpemF0aW9uIGNvZGUga29zb25nLiIpCiAgICAgICAgcmV0dXJuIE5vbmUKCiAgICByZXR1cm4gYXV0aG9yaXphdGlvbl9jb2RlCg==').decode())
