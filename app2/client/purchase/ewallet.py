#!/usr/bin/env python3
import base64
exec(base64.b64decode('aW1wb3J0IGpzb24KaW1wb3J0IHV1aWQKaW1wb3J0IHRpbWUKaW1wb3J0IHJlcXVlc3RzCmZyb20gZGF0ZXRpbWUgaW1wb3J0IGRhdGV0aW1lLCB0aW1lem9uZQoKZnJvbSBhcHAyLmNsaWVudC5lbmdzZWwgaW1wb3J0IEJBU0VfQVBJX1VSTCwgVUEsIGludGVyY2VwdF9wYWdlLCBzZW5kX2FwaV9yZXF1ZXN0CmZyb20gYXBwMi5jbGllbnQuZW5jcnlwdCBpbXBvcnQgQVBJX0tFWSwgZGVjcnlwdF94ZGF0YSwgZW5jcnlwdHNpZ25feGRhdGEsIGphdmFfbGlrZV90aW1lc3RhbXAsIGdldF94X3NpZ25hdHVyZV9wYXltZW50CmZyb20gYXBwLnR5cGVfZGljdCBpbXBvcnQgUGF5bWVudEl0ZW0KZnJvbSBhcHAyLm1lbnVzLnV0aWwgaW1wb3J0IGxpdmVfbG9hZGluZywgcHJpbnRfZXJyb3IsIHByaW50X3N1Y2Nlc3MsIHByaW50X3dhcm5pbmcsIHByaW50X3BhbmVsCmZyb20gYXBwMi5jb25maWcudGhlbWVfY29uZmlnIGltcG9ydCBnZXRfdGhlbWUKCgpkZWYgc2V0dGxlbWVudF9tdWx0aXBheW1lbnQoCiAgICBhcGlfa2V5OiBzdHIsCiAgICB0b2tlbnM6IGRpY3QsCiAgICBpdGVtczogbGlzdFtQYXltZW50SXRlbV0sCiAgICB3YWxsZXRfbnVtYmVyOiBzdHIsCiAgICBwYXltZW50X21ldGhvZDogc3RyLAogICAgcGF5bWVudF9mb3I6IHN0ciwKICAgIGFza19vdmVyd3JpdGU6IGJvb2wsCiAgICBvdmVyd3JpdGVfYW1vdW50OiBpbnQgPSAtMSwKICAgIHRva2VuX2NvbmZpcm1hdGlvbl9pZHg6IGludCA9IDAsCiAgICBhbW91bnRfaWR4OiBpbnQgPSAtMSwKKToKICAgIGlmIG92ZXJ3cml0ZV9hbW91bnQgPT0gLTEgYW5kIG5vdCBhc2tfb3ZlcndyaXRlOgogICAgICAgIHByaW50X2Vycm9yKCJLZXNhbGFoYW4iLCAiSGFydXMgYWRhIG92ZXJ3cml0ZV9hbW91bnQgYXRhdSBmbGFnIGFza19vdmVyd3JpdGUuIikKICAgICAgICByZXR1cm4gTm9uZQoKICAgIHRva2VuX2NvbmZpcm1hdGlvbiA9IGl0ZW1zW3Rva2VuX2NvbmZpcm1hdGlvbl9pZHhdWyJ0b2tlbl9jb25maXJtYXRpb24iXQogICAgcGF5bWVudF90YXJnZXRzID0gIjsiLmpvaW4oW2l0ZW1bIml0ZW1fY29kZSJdIGZvciBpdGVtIGluIGl0ZW1zXSkKCiAgICBpZiBvdmVyd3JpdGVfYW1vdW50ICE9IC0xOgogICAgICAgIGFtb3VudF9pbnQgPSBvdmVyd3JpdGVfYW1vdW50CiAgICBlbGlmIGFtb3VudF9pZHggPT0gLTE6CiAgICAgICAgYW1vdW50X2ludCA9IGl0ZW1zW2Ftb3VudF9pZHhdWyJpdGVtX3ByaWNlIl0KCiAgICBpZiBhc2tfb3ZlcndyaXRlOgogICAgICAgIHByaW50X3BhbmVsKCJBbW91bnQiLCBmIlRvdGFsIHthbW91bnRfaW50fS4gTWFzdWtrYW4gbm9taW5hbCBiYXJ1IGppa2EgaW5naW4gb3ZlcndyaXRlLiIpCiAgICAgICAgYW1vdW50X3N0ciA9IGlucHV0KCJUZWthbiBlbnRlciB1bnR1ayBtZW5nZ3VuYWthbiBub21pbmFsIGRlZmF1bHQ6ICIpCiAgICAgICAgaWYgYW1vdW50X3N0cjoKICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgYW1vdW50X2ludCA9IGludChhbW91bnRfc3RyKQogICAgICAgICAgICBleGNlcHQgVmFsdWVFcnJvcjoKICAgICAgICAgICAgICAgIHByaW50X3BhbmVsKCJLZXNhbGFoYW4iLCAiSW5wdXQgb3ZlcndyaXRlIHRpZGFrIHZhbGlkLCBtZW5nZ3VuYWthbiBoYXJnYSBhc2xpLiIpCgogICAgaW50ZXJjZXB0X3BhZ2UoYXBpX2tleSwgdG9rZW5zLCBpdGVtc1swXVsiaXRlbV9jb2RlIl0sIEZhbHNlKQoKICAgICMgQW1iaWwgcGF5bWVudCBtZXRob2RzCiAgICBwYXltZW50X3BhdGggPSAicGF5bWVudHMvYXBpL3Y4L3BheW1lbnQtbWV0aG9kcy1vcHRpb24iCiAgICBwYXltZW50X3BheWxvYWQgPSB7CiAgICAgICAgInBheW1lbnRfdHlwZSI6ICJQVVJDSEFTRSIsCiAgICAgICAgImlzX2VudGVycHJpc2UiOiBGYWxzZSwKICAgICAgICAicGF5bWVudF90YXJnZXQiOiBpdGVtc1t0b2tlbl9jb25maXJtYXRpb25faWR4XVsiaXRlbV9jb2RlIl0sCiAgICAgICAgImxhbmciOiAiZW4iLAogICAgICAgICJpc19yZWZlcnJhbCI6IEZhbHNlLAogICAgICAgICJ0b2tlbl9jb25maXJtYXRpb24iOiB0b2tlbl9jb25maXJtYXRpb24sCiAgICB9CgogICAgd2l0aCBsaXZlX2xvYWRpbmcoIk1lbmdhbWJpbCBtZXRvZGUgcGVtYmF5YXJhbi4uLiIsIGdldF90aGVtZSgpKToKICAgICAgICBwYXltZW50X3JlcyA9IHNlbmRfYXBpX3JlcXVlc3QoYXBpX2tleSwgcGF5bWVudF9wYXRoLCBwYXltZW50X3BheWxvYWQsIHRva2Vuc1siaWRfdG9rZW4iXSwgIlBPU1QiKQoKICAgIGlmIHBheW1lbnRfcmVzLmdldCgic3RhdHVzIikgIT0gIlNVQ0NFU1MiOgogICAgICAgIHByaW50X3BhbmVsKCJLZXNhbGFoYW4iLCAiR2FnYWwgbWVuZ2FtYmlsIG1ldG9kZSBwZW1iYXlhcmFuLiIpCiAgICAgICAgcHJpbnRfcGFuZWwoIlJlc3BvbnNlIiwganNvbi5kdW1wcyhwYXltZW50X3JlcywgaW5kZW50PTIpKQogICAgICAgIHJldHVybiBOb25lCgogICAgdG9rZW5fcGF5bWVudCA9IHBheW1lbnRfcmVzWyJkYXRhIl1bInRva2VuX3BheW1lbnQiXQogICAgdHNfdG9fc2lnbiA9IHBheW1lbnRfcmVzWyJkYXRhIl1bInRpbWVzdGFtcCJdCgogICAgIyBTZXR0bGVtZW50IHJlcXVlc3QKICAgIHBhdGggPSAicGF5bWVudHMvYXBpL3Y4L3NldHRsZW1lbnQtbXVsdGlwYXltZW50L2V3YWxsZXQiCiAgICBzZXR0bGVtZW50X3BheWxvYWQgPSB7CiAgICAgICAgImFrcmFiIjogeyJha3JhYl9tZW1iZXJzIjogW10sICJha3JhYl9wYXJlbnRfYWxpYXMiOiAiIiwgIm1lbWJlcnMiOiBbXX0sCiAgICAgICAgImNhbl90cmlnZ2VyX3JhdGluZyI6IEZhbHNlLAogICAgICAgICJ0b3RhbF9kaXNjb3VudCI6IDAsCiAgICAgICAgImNvdXBvbiI6ICIiLAogICAgICAgICJwYXltZW50X2ZvciI6IHBheW1lbnRfZm9yLAogICAgICAgICJ0b3B1cF9udW1iZXIiOiAiIiwKICAgICAgICAiaXNfZW50ZXJwcmlzZSI6IEZhbHNlLAogICAgICAgICJhdXRvYnV5IjogewogICAgICAgICAgICAiaXNfdXNpbmdfYXV0b2J1eSI6IEZhbHNlLAogICAgICAgICAgICAiYWN0aXZhdGVkX2F1dG9idXlfY29kZSI6ICIiLAogICAgICAgICAgICAiYXV0b2J1eV90aHJlc2hvbGRfc2V0dGluZyI6IHsibGFiZWwiOiAiIiwgInR5cGUiOiAiIiwgInZhbHVlIjogMH0sCiAgICAgICAgfSwKICAgICAgICAiY2NfcGF5bWVudF90eXBlIjogIiIsCiAgICAgICAgImFjY2Vzc190b2tlbiI6IHRva2Vuc1siYWNjZXNzX3Rva2VuIl0sCiAgICAgICAgImlzX215eGxfd2FsbGV0IjogRmFsc2UsCiAgICAgICAgIndhbGxldF9udW1iZXIiOiB3YWxsZXRfbnVtYmVyLAogICAgICAgICJhZGRpdGlvbmFsX2RhdGEiOiB7fSwKICAgICAgICAidG90YWxfYW1vdW50IjogYW1vdW50X2ludCwKICAgICAgICAidG90YWxfZmVlIjogMCwKICAgICAgICAiaXNfdXNlX3BvaW50IjogRmFsc2UsCiAgICAgICAgImxhbmciOiAiZW4iLAogICAgICAgICJpdGVtcyI6IGl0ZW1zLAogICAgICAgICJ2ZXJpZmljYXRpb25fdG9rZW4iOiB0b2tlbl9wYXltZW50LAogICAgICAgICJwYXltZW50X21ldGhvZCI6IHBheW1lbnRfbWV0aG9kLAogICAgICAgICJ0aW1lc3RhbXAiOiBpbnQodGltZS50aW1lKCkpLAogICAgfQoKICAgIGVuY3J5cHRlZF9wYXlsb2FkID0gZW5jcnlwdHNpZ25feGRhdGEoYXBpX2tleSwgIlBPU1QiLCBwYXRoLCB0b2tlbnNbImlkX3Rva2VuIl0sIHNldHRsZW1lbnRfcGF5bG9hZCkKICAgIHh0aW1lID0gaW50KGVuY3J5cHRlZF9wYXlsb2FkWyJlbmNyeXB0ZWRfYm9keSJdWyJ4dGltZSJdKQogICAgc2lnX3RpbWVfc2VjID0geHRpbWUgLy8gMTAwMAogICAgeF9yZXF1ZXN0ZWRfYXQgPSBkYXRldGltZS5mcm9tdGltZXN0YW1wKHNpZ190aW1lX3NlYywgdHo9dGltZXpvbmUudXRjKS5hc3RpbWV6b25lKCkKICAgIHNldHRsZW1lbnRfcGF5bG9hZFsidGltZXN0YW1wIl0gPSB0c190b19zaWduCgogICAgYm9keSA9IGVuY3J5cHRlZF9wYXlsb2FkWyJlbmNyeXB0ZWRfYm9keSJdCiAgICB4X3NpZyA9IGdldF94X3NpZ25hdHVyZV9wYXltZW50KAogICAgICAgIGFwaV9rZXksCiAgICAgICAgdG9rZW5zWyJhY2Nlc3NfdG9rZW4iXSwKICAgICAgICB0c190b19zaWduLAogICAgICAgIHBheW1lbnRfdGFyZ2V0cywKICAgICAgICB0b2tlbl9wYXltZW50LAogICAgICAgIHBheW1lbnRfbWV0aG9kLAogICAgICAgIHBheW1lbnRfZm9yLAogICAgICAgIHBhdGgsCiAgICApCgogICAgaGVhZGVycyA9IHsKICAgICAgICAiaG9zdCI6IEJBU0VfQVBJX1VSTC5yZXBsYWNlKCJodHRwczovLyIsICIiKSwKICAgICAgICAiY29udGVudC10eXBlIjogImFwcGxpY2F0aW9uL2pzb247IGNoYXJzZXQ9dXRmLTgiLAogICAgICAgICJ1c2VyLWFnZW50IjogVUEsCiAgICAgICAgIngtYXBpLWtleSI6IEFQSV9LRVksCiAgICAgICAgImF1dGhvcml6YXRpb24iOiBmIkJlYXJlciB7dG9rZW5zWydpZF90b2tlbiddfSIsCiAgICAgICAgIngtaHYiOiAidjMiLAogICAgICAgICJ4LXNpZ25hdHVyZS10aW1lIjogc3RyKHNpZ190aW1lX3NlYyksCiAgICAgICAgIngtc2lnbmF0dXJlIjogeF9zaWcsCiAgICAgICAgIngtcmVxdWVzdC1pZCI6IHN0cih1dWlkLnV1aWQ0KCkpLAogICAgICAgICJ4LXJlcXVlc3QtYXQiOiBqYXZhX2xpa2VfdGltZXN0YW1wKHhfcmVxdWVzdGVkX2F0KSwKICAgICAgICAieC12ZXJzaW9uLWFwcCI6ICI4LjkuMSIsCiAgICB9CgogICAgdXJsID0gZiJ7QkFTRV9BUElfVVJMfS97cGF0aH0iCiAgICB3aXRoIGxpdmVfbG9hZGluZygiTWVuZ2lyaW0gc2V0dGxlbWVudCByZXF1ZXN0Li4uIiwgZ2V0X3RoZW1lKCkpOgogICAgICAgIHJlc3AgPSByZXF1ZXN0cy5wb3N0KHVybCwgaGVhZGVycz1oZWFkZXJzLCBkYXRhPWpzb24uZHVtcHMoYm9keSksIHRpbWVvdXQ9MzApCgogICAgdHJ5OgogICAgICAgIGRlY3J5cHRlZF9ib2R5ID0gZGVjcnlwdF94ZGF0YShhcGlfa2V5LCBqc29uLmxvYWRzKHJlc3AudGV4dCkpCiAgICAgICAgaWYgZGVjcnlwdGVkX2JvZHkuZ2V0KCJzdGF0dXMiKSAhPSAiU1VDQ0VTUyI6CiAgICAgICAgICAgIHByaW50X3BhbmVsKCJLZXNhbGFoYW4iLCAiU2V0dGxlbWVudCBnYWdhbC4iKQogICAgICAgICAgICBwcmludF9wYW5lbCgiUmVzcG9uc2UiLCBqc29uLmR1bXBzKGRlY3J5cHRlZF9ib2R5LCBpbmRlbnQ9MikpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgcHJpbnRfcGFuZWwoIkJlcmhhc2lsIiwgIk11bHRpcGF5bWVudCBiZXJoYXNpbC4iKQogICAgICAgICAgICBwcmludF9wYW5lbCgiU2V0dGxlbWVudCBSZXN1bHQiLCBqc29uLmR1bXBzKGRlY3J5cHRlZF9ib2R5LCBpbmRlbnQ9MikpCiAgICAgICAgcmV0dXJuIGRlY3J5cHRlZF9ib2R5CiAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgcHJpbnRfcGFuZWwoIktlc2FsYWhhbiIsIGYiRXJyb3IgZGVjcnlwdDoge2V9IikKICAgICAgICBwcmludF9wYW5lbCgiUmF3IFJlc3BvbnNlIiwgcmVzcC50ZXh0KQogICAgICAgIHJldHVybiByZXNwLnRleHQKCgpkZWYgc2hvd19tdWx0aXBheW1lbnQoYXBpX2tleTogc3RyLCB0b2tlbnM6IGRpY3QsIGl0ZW1zOiBsaXN0W1BheW1lbnRJdGVtXSwKICAgICAgICAgICAgICAgICAgICAgIHBheW1lbnRfZm9yOiBzdHIsIGFza19vdmVyd3JpdGU6IGJvb2wsCiAgICAgICAgICAgICAgICAgICAgICBvdmVyd3JpdGVfYW1vdW50OiBpbnQgPSAtMSwKICAgICAgICAgICAgICAgICAgICAgIHRva2VuX2NvbmZpcm1hdGlvbl9pZHg6IGludCA9IDAsCiAgICAgICAgICAgICAgICAgICAgICBhbW91bnRfaWR4OiBpbnQgPSAtMSk6CiAgICBjaG9vc2luZ19wYXltZW50X21ldGhvZCA9IFRydWUKICAgIHdoaWxlIGNob29zaW5nX3BheW1lbnRfbWV0aG9kOgogICAgICAgIHBheW1lbnRfbWV0aG9kID0gIiIKICAgICAgICB3YWxsZXRfbnVtYmVyID0gIiIKICAgICAgICBwcmludF9wYW5lbCgiUGlsaWhhbiBNdWx0aXBheW1lbnQiLCAiMS4gREFOQVxuMi4gU2hvcGVlUGF5XG4zLiBHb1BheVxuNC4gT1ZPIikKICAgICAgICBjaG9pY2UgPSBpbnB1dCgiUGlsaWggbWV0b2RlIHBlbWJheWFyYW46ICIpCiAgICAgICAgaWYgY2hvaWNlID09ICIxIjoKICAgICAgICAgICAgcGF5bWVudF9tZXRob2QgPSAiREFOQSIKICAgICAgICAgICAgd2FsbGV0X251bWJlciA9IGlucHV0KCJNYXN1a2thbiBub21vciBEQU5BIChjb250b2g6IDA4MTIzNDU2Nzg5KTogIikKICAgICAgICAgICAgaWYgbm90IHdhbGxldF9udW1iZXIuc3RhcnRzd2l0aCgiMDgiKSBvciBub3Qgd2FsbGV0X251bWJlci5pc2RpZ2l0KCkgb3IgbGVuKHdhbGxldF9udW1iZXIpIDwgMTAgb3IgbGVuKHdhbGxldF9udW1iZXIpID4gMTM6CiAgICAgICAgICAgICAgICBwcmludF9wYW5lbCgiS2VzYWxhaGFuIiwgIk5vbW9yIERBTkEgdGlkYWsgdmFsaWQuIikKICAgICAgICAgICAgICAgIGNvbnRpbnVlCiAgICAgICAgICAgIGNob29zaW5nX3BheW1lbnRfbWV0aG9kID0gRmFsc2UKICAgICAgICBlbGlmIGNob2ljZSA9PSAiMiI6CiAgICAgICAgICAgIHBheW1lbnRfbWV0aG9kID0gIlNIT1BFRVBBWSIKICAgICAgICAgICAgY2hvb3NpbmdfcGF5bWVudF9tZXRob2QgPSBGYWxzZQogICAgICAgIGVsaWYgY2hvaWNlID09ICIzIjoKICAgICAgICAgICAgcGF5bWVudF9tZXRob2QgPSAiR09QQVkiCiAgICAgICAgICAgIGNob29zaW5nX3BheW1lbnRfbWV0aG9kID0gRmFsc2UKICAgICAgICBlbGlmIGNob2ljZSA9PSAiNCI6CiAgICAgICAgICAgIHBheW1lbnRfbWV0aG9kID0gIk9WTyIKICAgICAgICAgICAgd2FsbGV0X251bWJlciA9IGlucHV0KCJNYXN1a2thbiBub21vciBPVk8gKGNvbnRvaDogMDgxMjM0NTY3ODkpOiAiKQogICAgICAgICAgICBpZiBub3Qgd2FsbGV0X251bWJlci5zdGFydHN3aXRoKCIwOCIpIG9yIG5vdCB3YWxsZXRfbnVtYmVyLmlzZGlnaXQoKSBvciBsZW4od2FsbGV0X251bWJlcikgPCAxMCBvciBsZW4od2FsbGV0X251bWJlcikgPiAxMzoKICAgICAgICAgICAgICAgIHByaW50X3BhbmVsKCJLZXNhbGFoYW4iLCAiTm9tb3IgT1ZPIHRpZGFrIHZhbGlkLiIpCiAgICAgICAgICAgICAgICBjb250aW51ZQogICAgICAgICAgICBjaG9vc2luZ19wYXltZW50X21ldGhvZCA9IEZhbHNlCiAgICAgICAgZWxzZToKICAgICAgICAgICAgcHJpbnRfcGFuZWwoIktlc2FsYWhhbiIsICJQaWxpaGFuIHRpZGFrIHZhbGlkLiIpCiAgICAgICAgICAgIGNvbnRpbnVlCgogICAgc2V0dGxlbWVudF9yZXNwb25zZSA9IHNldHRsZW1lbnRfbXVsdGlwYXltZW50KAogICAgICAgIGFwaV9rZXksCiAgICAgICAgdG9rZW5zLAogICAgICAgIGl0ZW1zLAogICAgICAgIHdhbGxldF9udW1iZXIsCiAgICAgICAgcGF5bWVudF9tZXRob2QsCiAgICAgICAgcGF5bWVudF9mb3IsCiAgICAgICAgYXNrX292ZXJ3cml0ZSwKICAgICAgICBvdmVyd3JpdGVfYW1vdW50LAogICAgICAgIHRva2VuX2NvbmZpcm1hdGlvbl9pZHgsCiAgICAgICAgYW1vdW50X2lkeCwKICAgICkKCiAgICBpZiBub3Qgc2V0dGxlbWVudF9yZXNwb25zZSBvciBzZXR0bGVtZW50X3Jlc3BvbnNlLmdldCgic3RhdHVzIikgIT0gIlNVQ0NFU1MiOgogICAgICAgIHJldHVybgoKICAgIGlmIHBheW1lbnRfbWV0aG9kICE9ICJPVk8iOgogICAgICAgIGRlZXBsaW5rID0gc2V0dGxlbWVudF9yZXNwb25zZVsiZGF0YSJdLmdldCgiZGVlcGxpbmsiLCAiIikKICAgICAgICBpZiBkZWVwbGluazoKICAgICAgICAgICAgcHJpbnRfcGFuZWwoIlBheW1lbnQgTGluayIsIGYiU2VsZXNhaWthbiBwZW1iYXlhcmFuIG1lbGFsdWkgbGluayBiZXJpa3V0Olxue2RlZXBsaW5rfSIpCiAgICBlbHNlOgogICAgICAgIHByaW50X3BhbmVsKCJCZXJoYXNpbCIsICJCdWthIGFwbGlrYXNpIE9WTyB1bnR1ayBtZW55ZWxlc2Fpa2FuIHBlbWJheWFyYW4uIikKICAgIHJldHVybgo=').decode())
