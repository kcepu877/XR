#!/usr/bin/env python3
import base64
exec(base64.b64decode('aW1wb3J0IGpzb24KaW1wb3J0IHV1aWQKaW1wb3J0IGJhc2U2NAppbXBvcnQgcXJjb2RlCmltcG9ydCB0aW1lCmltcG9ydCByZXF1ZXN0cwpmcm9tIGRhdGV0aW1lIGltcG9ydCBkYXRldGltZSwgdGltZXpvbmUKCmZyb20gYXBwMi5jbGllbnQuZW5nc2VsIGltcG9ydCBCQVNFX0FQSV9VUkwsIFVBLCBpbnRlcmNlcHRfcGFnZSwgc2VuZF9hcGlfcmVxdWVzdApmcm9tIGFwcDIuY2xpZW50LmVuY3J5cHQgaW1wb3J0IEFQSV9LRVksIGRlY3J5cHRfeGRhdGEsIGVuY3J5cHRzaWduX3hkYXRhLCBqYXZhX2xpa2VfdGltZXN0YW1wLCBnZXRfeF9zaWduYXR1cmVfcGF5bWVudApmcm9tIGFwcC50eXBlX2RpY3QgaW1wb3J0IFBheW1lbnRJdGVtCmZyb20gYXBwMi5tZW51cy51dGlsIGltcG9ydCBsaXZlX2xvYWRpbmcsIHByaW50X3BhbmVsCmZyb20gYXBwMi5jb25maWcudGhlbWVfY29uZmlnIGltcG9ydCBnZXRfdGhlbWUKCgpkZWYgc2V0dGxlbWVudF9xcmlzKGFwaV9rZXk6IHN0ciwgdG9rZW5zOiBkaWN0LCBpdGVtczogbGlzdFtQYXltZW50SXRlbV0sCiAgICAgICAgICAgICAgICAgICAgcGF5bWVudF9mb3I6IHN0ciwgYXNrX292ZXJ3cml0ZTogYm9vbCwKICAgICAgICAgICAgICAgICAgICBvdmVyd3JpdGVfYW1vdW50OiBpbnQgPSAtMSwKICAgICAgICAgICAgICAgICAgICB0b2tlbl9jb25maXJtYXRpb25faWR4OiBpbnQgPSAwLAogICAgICAgICAgICAgICAgICAgIGFtb3VudF9pZHg6IGludCA9IC0xLAogICAgICAgICAgICAgICAgICAgIHRvcHVwX251bWJlcjogc3RyID0gIiIsCiAgICAgICAgICAgICAgICAgICAgc3RhZ2VfdG9rZW46IHN0ciA9ICIiKSAtPiBzdHIgfCBOb25lOgogICAgaWYgb3ZlcndyaXRlX2Ftb3VudCA9PSAtMSBhbmQgbm90IGFza19vdmVyd3JpdGU6CiAgICAgICAgcHJpbnRfcGFuZWwoIktlc2FsYWhhbiIsICJIYXJ1cyBhZGEgb3ZlcndyaXRlX2Ftb3VudCBhdGF1IGZsYWcgYXNrX292ZXJ3cml0ZS4iKQogICAgICAgIHJldHVybiBOb25lCgogICAgdG9rZW5fY29uZmlybWF0aW9uID0gaXRlbXNbdG9rZW5fY29uZmlybWF0aW9uX2lkeF1bInRva2VuX2NvbmZpcm1hdGlvbiJdCiAgICBwYXltZW50X3RhcmdldHMgPSAiOyIuam9pbihbaXRlbVsiaXRlbV9jb2RlIl0gZm9yIGl0ZW0gaW4gaXRlbXNdKQoKICAgICMgVGVudHVrYW4gYW1vdW50CiAgICBpZiBvdmVyd3JpdGVfYW1vdW50ICE9IC0xOgogICAgICAgIGFtb3VudF9pbnQgPSBvdmVyd3JpdGVfYW1vdW50CiAgICBlbGlmIGFtb3VudF9pZHggPT0gLTE6CiAgICAgICAgYW1vdW50X2ludCA9IGl0ZW1zW2Ftb3VudF9pZHhdWyJpdGVtX3ByaWNlIl0KCiAgICBpZiBhc2tfb3ZlcndyaXRlOgogICAgICAgIHByaW50X3BhbmVsKCJBbW91bnQiLCBmIlRvdGFsIHthbW91bnRfaW50fS4gTWFzdWtrYW4gbm9taW5hbCBiYXJ1IGppa2EgaW5naW4gb3ZlcndyaXRlLiIpCiAgICAgICAgYW1vdW50X3N0ciA9IGlucHV0KCJUZWthbiBlbnRlciB1bnR1ayBtZW5nZ3VuYWthbiBub21pbmFsIGRlZmF1bHQ6ICIpCiAgICAgICAgaWYgYW1vdW50X3N0cjoKICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgYW1vdW50X2ludCA9IGludChhbW91bnRfc3RyKQogICAgICAgICAgICBleGNlcHQgVmFsdWVFcnJvcjoKICAgICAgICAgICAgICAgIHByaW50X3BhbmVsKCJLZXNhbGFoYW4iLCAiSW5wdXQgb3ZlcndyaXRlIHRpZGFrIHZhbGlkLCBtZW5nZ3VuYWthbiBoYXJnYSBhc2xpLiIpCgogICAgaW50ZXJjZXB0X3BhZ2UoYXBpX2tleSwgdG9rZW5zLCBpdGVtc1swXVsiaXRlbV9jb2RlIl0sIEZhbHNlKQoKICAgICMgQW1iaWwgcGF5bWVudCBtZXRob2RzCiAgICBwYXltZW50X3BhdGggPSAicGF5bWVudHMvYXBpL3Y4L3BheW1lbnQtbWV0aG9kcy1vcHRpb24iCiAgICBwYXltZW50X3BheWxvYWQgPSB7CiAgICAgICAgInBheW1lbnRfdHlwZSI6ICJQVVJDSEFTRSIsCiAgICAgICAgImlzX2VudGVycHJpc2UiOiBGYWxzZSwKICAgICAgICAicGF5bWVudF90YXJnZXQiOiBpdGVtc1t0b2tlbl9jb25maXJtYXRpb25faWR4XVsiaXRlbV9jb2RlIl0sCiAgICAgICAgImxhbmciOiAiZW4iLAogICAgICAgICJpc19yZWZlcnJhbCI6IEZhbHNlLAogICAgICAgICJ0b2tlbl9jb25maXJtYXRpb24iOiB0b2tlbl9jb25maXJtYXRpb24sCiAgICB9CgogICAgd2l0aCBsaXZlX2xvYWRpbmcoIk1lbmdhbWJpbCBtZXRvZGUgcGVtYmF5YXJhbi4uLiIsIGdldF90aGVtZSgpKToKICAgICAgICBwYXltZW50X3JlcyA9IHNlbmRfYXBpX3JlcXVlc3QoYXBpX2tleSwgcGF5bWVudF9wYXRoLCBwYXltZW50X3BheWxvYWQsIHRva2Vuc1siaWRfdG9rZW4iXSwgIlBPU1QiKQoKICAgIGlmIHBheW1lbnRfcmVzLmdldCgic3RhdHVzIikgIT0gIlNVQ0NFU1MiOgogICAgICAgIHByaW50X3BhbmVsKCJLZXNhbGFoYW4iLCAiR2FnYWwgbWVuZ2FtYmlsIG1ldG9kZSBwZW1iYXlhcmFuLiIpCiAgICAgICAgcHJpbnRfcGFuZWwoIlJlc3BvbnNlIiwganNvbi5kdW1wcyhwYXltZW50X3JlcywgaW5kZW50PTIpKQogICAgICAgIHJldHVybiBOb25lCgogICAgdG9rZW5fcGF5bWVudCA9IHBheW1lbnRfcmVzWyJkYXRhIl1bInRva2VuX3BheW1lbnQiXQogICAgdHNfdG9fc2lnbiA9IHBheW1lbnRfcmVzWyJkYXRhIl1bInRpbWVzdGFtcCJdCgogICAgIyBTZXR0bGVtZW50IHJlcXVlc3QKICAgIHBhdGggPSAicGF5bWVudHMvYXBpL3Y4L3NldHRsZW1lbnQtbXVsdGlwYXltZW50L3FyaXMiCiAgICBzZXR0bGVtZW50X3BheWxvYWQgPSB7CiAgICAgICAgImFrcmFiIjogeyJha3JhYl9tZW1iZXJzIjogW10sICJha3JhYl9wYXJlbnRfYWxpYXMiOiAiIiwgIm1lbWJlcnMiOiBbXX0sCiAgICAgICAgImNhbl90cmlnZ2VyX3JhdGluZyI6IEZhbHNlLAogICAgICAgICJ0b3RhbF9kaXNjb3VudCI6IDAsCiAgICAgICAgImNvdXBvbiI6ICIiLAogICAgICAgICJwYXltZW50X2ZvciI6IHBheW1lbnRfZm9yLAogICAgICAgICJ0b3B1cF9udW1iZXIiOiB0b3B1cF9udW1iZXIsCiAgICAgICAgInN0YWdlX3Rva2VuIjogc3RhZ2VfdG9rZW4sCiAgICAgICAgImlzX2VudGVycHJpc2UiOiBGYWxzZSwKICAgICAgICAiYXV0b2J1eSI6IHsKICAgICAgICAgICAgImlzX3VzaW5nX2F1dG9idXkiOiBGYWxzZSwKICAgICAgICAgICAgImFjdGl2YXRlZF9hdXRvYnV5X2NvZGUiOiAiIiwKICAgICAgICAgICAgImF1dG9idXlfdGhyZXNob2xkX3NldHRpbmciOiB7ImxhYmVsIjogIiIsICJ0eXBlIjogIiIsICJ2YWx1ZSI6IDB9LAogICAgICAgIH0sCiAgICAgICAgImFjY2Vzc190b2tlbiI6IHRva2Vuc1siYWNjZXNzX3Rva2VuIl0sCiAgICAgICAgImlzX215eGxfd2FsbGV0IjogRmFsc2UsCiAgICAgICAgImFkZGl0aW9uYWxfZGF0YSI6IHsKICAgICAgICAgICAgIm9yaWdpbmFsX3ByaWNlIjogaXRlbXNbMF1bIml0ZW1fcHJpY2UiXSwKICAgICAgICAgICAgImlzX3NwZW5kX2xpbWl0X3RlbXBvcmFyeSI6IEZhbHNlLAogICAgICAgICAgICAibWlncmF0aW9uX3R5cGUiOiAiIiwKICAgICAgICAgICAgInNwZW5kX2xpbWl0X2Ftb3VudCI6IDAsCiAgICAgICAgICAgICJpc19zcGVuZF9saW1pdCI6IEZhbHNlLAogICAgICAgICAgICAidGF4IjogMCwKICAgICAgICAgICAgImJlbmVmaXRfdHlwZSI6ICIiLAogICAgICAgICAgICAicXVvdGFfYm9udXMiOiAwLAogICAgICAgICAgICAiY2FzaHRhZyI6ICIiLAogICAgICAgICAgICAiaXNfZmFtaWx5X3BsYW4iOiBGYWxzZSwKICAgICAgICAgICAgImNvbWJvX2RldGFpbHMiOiBbXSwKICAgICAgICAgICAgImlzX3N3aXRjaF9wbGFuIjogRmFsc2UsCiAgICAgICAgICAgICJkaXNjb3VudF9yZWN1cnJpbmciOiAwLAogICAgICAgICAgICAiaGFzX2JvbnVzIjogRmFsc2UsCiAgICAgICAgICAgICJkaXNjb3VudF9wcm9tbyI6IDAsCiAgICAgICAgfSwKICAgICAgICAidG90YWxfYW1vdW50IjogYW1vdW50X2ludCwKICAgICAgICAidG90YWxfZmVlIjogMCwKICAgICAgICAiaXNfdXNlX3BvaW50IjogRmFsc2UsCiAgICAgICAgImxhbmciOiAiZW4iLAogICAgICAgICJpdGVtcyI6IGl0ZW1zLAogICAgICAgICJ2ZXJpZmljYXRpb25fdG9rZW4iOiB0b2tlbl9wYXltZW50LAogICAgICAgICJwYXltZW50X21ldGhvZCI6ICJRUklTIiwKICAgICAgICAidGltZXN0YW1wIjogaW50KHRpbWUudGltZSgpKSwKICAgIH0KCiAgICBlbmNyeXB0ZWRfcGF5bG9hZCA9IGVuY3J5cHRzaWduX3hkYXRhKGFwaV9rZXksICJQT1NUIiwgcGF0aCwgdG9rZW5zWyJpZF90b2tlbiJdLCBzZXR0bGVtZW50X3BheWxvYWQpCiAgICB4dGltZSA9IGludChlbmNyeXB0ZWRfcGF5bG9hZFsiZW5jcnlwdGVkX2JvZHkiXVsieHRpbWUiXSkKICAgIHNpZ190aW1lX3NlYyA9IHh0aW1lIC8vIDEwMDAKICAgIHhfcmVxdWVzdGVkX2F0ID0gZGF0ZXRpbWUuZnJvbXRpbWVzdGFtcChzaWdfdGltZV9zZWMsIHR6PXRpbWV6b25lLnV0YykuYXN0aW1lem9uZSgpCiAgICBzZXR0bGVtZW50X3BheWxvYWRbInRpbWVzdGFtcCJdID0gdHNfdG9fc2lnbgoKICAgIGJvZHkgPSBlbmNyeXB0ZWRfcGF5bG9hZFsiZW5jcnlwdGVkX2JvZHkiXQogICAgeF9zaWcgPSBnZXRfeF9zaWduYXR1cmVfcGF5bWVudChhcGlfa2V5LCB0b2tlbnNbImFjY2Vzc190b2tlbiJdLCB0c190b19zaWduLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXltZW50X3RhcmdldHMsIHRva2VuX3BheW1lbnQsICJRUklTIiwgcGF5bWVudF9mb3IsIHBhdGgpCgogICAgaGVhZGVycyA9IHsKICAgICAgICAiaG9zdCI6IEJBU0VfQVBJX1VSTC5yZXBsYWNlKCJodHRwczovLyIsICIiKSwKICAgICAgICAiY29udGVudC10eXBlIjogImFwcGxpY2F0aW9uL2pzb247IGNoYXJzZXQ9dXRmLTgiLAogICAgICAgICJ1c2VyLWFnZW50IjogVUEsCiAgICAgICAgIngtYXBpLWtleSI6IEFQSV9LRVksCiAgICAgICAgImF1dGhvcml6YXRpb24iOiBmIkJlYXJlciB7dG9rZW5zWydpZF90b2tlbiddfSIsCiAgICAgICAgIngtaHYiOiAidjMiLAogICAgICAgICJ4LXNpZ25hdHVyZS10aW1lIjogc3RyKHNpZ190aW1lX3NlYyksCiAgICAgICAgIngtc2lnbmF0dXJlIjogeF9zaWcsCiAgICAgICAgIngtcmVxdWVzdC1pZCI6IHN0cih1dWlkLnV1aWQ0KCkpLAogICAgICAgICJ4LXJlcXVlc3QtYXQiOiBqYXZhX2xpa2VfdGltZXN0YW1wKHhfcmVxdWVzdGVkX2F0KSwKICAgICAgICAieC12ZXJzaW9uLWFwcCI6ICI4LjkuMSIsCiAgICB9CgogICAgdXJsID0gZiJ7QkFTRV9BUElfVVJMfS97cGF0aH0iCiAgICB3aXRoIGxpdmVfbG9hZGluZygiTWVuZ2lyaW0gc2V0dGxlbWVudCByZXF1ZXN0Li4uIiwgZ2V0X3RoZW1lKCkpOgogICAgICAgIHJlc3AgPSByZXF1ZXN0cy5wb3N0KHVybCwgaGVhZGVycz1oZWFkZXJzLCBkYXRhPWpzb24uZHVtcHMoYm9keSksIHRpbWVvdXQ9MzApCgogICAgdHJ5OgogICAgICAgIGRlY3J5cHRlZF9ib2R5ID0gZGVjcnlwdF94ZGF0YShhcGlfa2V5LCBqc29uLmxvYWRzKHJlc3AudGV4dCkpCiAgICAgICAgaWYgZGVjcnlwdGVkX2JvZHkuZ2V0KCJzdGF0dXMiKSAhPSAiU1VDQ0VTUyI6CiAgICAgICAgICAgIHByaW50X3BhbmVsKCJLZXNhbGFoYW4iLCAiU2V0dGxlbWVudCBRUklTIGdhZ2FsLiIpCiAgICAgICAgICAgIHByaW50X3BhbmVsKCJSZXNwb25zZSIsIGpzb24uZHVtcHMoZGVjcnlwdGVkX2JvZHksIGluZGVudD0yKSkKICAgICAgICAgICAgcmV0dXJuIE5vbmUKICAgICAgICB0cmFuc2FjdGlvbl9pZCA9IGRlY3J5cHRlZF9ib2R5WyJkYXRhIl1bInRyYW5zYWN0aW9uX2NvZGUiXQogICAgICAgIHByaW50X3BhbmVsKCJCZXJoYXNpbCIsICJUcmFuc2Frc2kgUVJJUyBiZXJoYXNpbCBkaWJ1YXQuIikKICAgICAgICByZXR1cm4gdHJhbnNhY3Rpb25faWQKICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICBwcmludF9wYW5lbCgiS2VzYWxhaGFuIiwgZiJFcnJvciBkZWNyeXB0OiB7ZX0iKQogICAgICAgIHByaW50X3BhbmVsKCJSYXcgUmVzcG9uc2UiLCByZXNwLnRleHQpCiAgICAgICAgcmV0dXJuIE5vbmUKCgpkZWYgZ2V0X3FyaXNfY29kZShhcGlfa2V5OiBzdHIsIHRva2VuczogZGljdCwgdHJhbnNhY3Rpb25faWQ6IHN0cikgLT4gc3RyIHwgTm9uZToKICAgIHBhdGggPSAicGF5bWVudHMvYXBpL3Y4L3BlbmRpbmctZGV0YWlsIgogICAgcGF5bG9hZCA9IHsidHJhbnNhY3Rpb25faWQiOiB0cmFuc2FjdGlvbl9pZCwgImlzX2VudGVycHJpc2UiOiBGYWxzZSwgImxhbmciOiAiZW4iLCAic3RhdHVzIjogIiJ9CgogICAgd2l0aCBsaXZlX2xvYWRpbmcoIk1lbmdhbWJpbCBRUklTIGNvZGUuLi4iLCBnZXRfdGhlbWUoKSk6CiAgICAgICAgcmVzID0gc2VuZF9hcGlfcmVxdWVzdChhcGlfa2V5LCBwYXRoLCBwYXlsb2FkLCB0b2tlbnNbImlkX3Rva2VuIl0sICJQT1NUIikKCiAgICBpZiByZXMuZ2V0KCJzdGF0dXMiKSAhPSAiU1VDQ0VTUyI6CiAgICAgICAgcHJpbnRfcGFuZWwoIktlc2FsYWhhbiIsICJHYWdhbCBtZW5nYW1iaWwgUVJJUyBjb2RlLiIpCiAgICAgICAgcHJpbnRfcGFuZWwoIlJlc3BvbnNlIiwganNvbi5kdW1wcyhyZXMsIGluZGVudD0yKSkKICAgICAgICByZXR1cm4gTm9uZQoKICAgIHByaW50X3BhbmVsKCJCZXJoYXNpbCIsICJRUklTIGNvZGUgYmVyaGFzaWwgZGlhbWJpbC4iKQogICAgcmV0dXJuIHJlc1siZGF0YSJdWyJxcl9jb2RlIl0KCgpkZWYgc2hvd19xcmlzX3BheW1lbnQoYXBpX2tleTogc3RyLCB0b2tlbnM6IGRpY3QsIGl0ZW1zOiBsaXN0W1BheW1lbnRJdGVtXSwKICAgICAgICAgICAgICAgICAgICAgIHBheW1lbnRfZm9yOiBzdHIsIGFza19vdmVyd3JpdGU6IGJvb2wsCiAgICAgICAgICAgICAgICAgICAgICBvdmVyd3JpdGVfYW1vdW50OiBpbnQgPSAtMSwKICAgICAgICAgICAgICAgICAgICAgIHRva2VuX2NvbmZpcm1hdGlvbl9pZHg6IGludCA9IDAsCiAgICAgICAgICAgICAgICAgICAgICBhbW91bnRfaWR4OiBpbnQgPSAtMSwKICAgICAgICAgICAgICAgICAgICAgIHRvcHVwX251bWJlcjogc3RyID0gIiIsCiAgICAgICAgICAgICAgICAgICAgICBzdGFnZV90b2tlbjogc3RyID0gIiIpIC0+IHN0ciB8IE5vbmU6CiAgICB0cmFuc2FjdGlvbl9pZCA9IHNldHRsZW1lbnRfcXJpcyhhcGlfa2V5LCB0b2tlbnMsIGl0ZW1zLCBwYXltZW50X2ZvciwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFza19vdmVyd3JpdGUsIG92ZXJ3cml0ZV9hbW91bnQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b2tlbl9jb25maXJtYXRpb25faWR4LCBhbW91bnRfaWR4LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG9wdXBfbnVtYmVyLCBzdGFnZV90b2tlbikKCiAgICBpZiBub3QgdHJhbnNhY3Rpb25faWQ6CiAgICAgICAgcHJpbnRfcGFuZWwoIktlc2FsYWhhbiIsICJHYWdhbCBtZW1idWF0IHRyYW5zYWtzaSBRUklTLiIpCiAgICAgICAgcmV0dXJuIE5vbmUKCiAgICBxcmlzX2NvZGUgPSBnZXRfcXJpc19jb2RlKGFwaV9rZXksIHRva2VucywgdHJhbnNhY3Rpb25faWQpCiAgICBpZiBub3QgcXJpc19jb2RlOgogICAgICAgIHByaW50X3BhbmVsKCJLZXNhbGFoYW4iLCAiR2FnYWwgbWVuZ2FtYmlsIFFSSVMgY29kZS4iKQogICAgICAgIHJldHVybiBOb25lCgogICAgcHJpbnRfcGFuZWwoIlFSSVMgRGF0YSIsIHFyaXNfY29kZSkKCiAgICBxciA9IHFyY29kZS5RUkNvZGUodmVyc2lvbj0xLCBlcnJvcl9jb3JyZWN0aW9uPXFyY29kZS5jb25zdGFudHMuRVJST1JfQ09SUkVDVF9MLAogICAgICAgICAgICAgICAgICAgICAgIGJveF9zaXplPTEsIGJvcmRlcj0xKQogICAgcXIuYWRkX2RhdGEocXJpc19jb2RlKQogICAgcXIubWFrZShmaXQ9VHJ1ZSkKICAgIHFyLnByaW50X2FzY2lpKGludmVydD1UcnVlKQoKICAgIHFyaXNfYjY0ID0gYmFzZTY0LnVybHNhZmVfYjY0ZW5jb2RlKHFyaXNfY29kZS5lbmNvZGUoKSkuZGVjb2RlKCkKICAgIHFyaXNfdXJsID0gZiJodHRwczovL2tpLWFyLWtvZC5uZXRsaWZ5LmFwcC8/ZGF0YT17cXJpc19iNjR9IgoKICAgIHByaW50X3BhbmVsKCJRUklTIExpbmsiLCBmIkF0YXUgYnVrYSB0YXV0YW4gYmVyaWt1dCB1bnR1ayBtZWxpaGF0IFFSSVM6XG57cXJpc191cmx9IikKICAgIHJldHVybiBxcmlzX2I2NAoK').decode())
