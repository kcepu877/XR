#!/usr/bin/env python3
import base64
exec(base64.b64decode('aW1wb3J0IGpzb24KaW1wb3J0IHRpbWUKaW1wb3J0IHV1aWQKaW1wb3J0IHJlcXVlc3RzCmZyb20gZGF0ZXRpbWUgaW1wb3J0IHRpbWV6b25lLCBkYXRldGltZQoKZnJvbSBhcHAyLmNsaWVudC5lbmNyeXB0IGltcG9ydCAoCiAgICBBUElfS0VZLAogICAgYnVpbGRfZW5jcnlwdGVkX2ZpZWxkLAogICAgZGVjcnlwdF94ZGF0YSwKICAgIGVuY3J5cHRzaWduX3hkYXRhLAogICAgZ2V0X3hfc2lnbmF0dXJlX3BheW1lbnQsCiAgICBqYXZhX2xpa2VfdGltZXN0YW1wLAopCmZyb20gYXBwMi5jbGllbnQuZW5nc2VsIGltcG9ydCBCQVNFX0FQSV9VUkwsIFVBLCBpbnRlcmNlcHRfcGFnZSwgc2VuZF9hcGlfcmVxdWVzdApmcm9tIGFwcC50eXBlX2RpY3QgaW1wb3J0IFBheW1lbnRJdGVtCmZyb20gYXBwMi5tZW51cy51dGlsIGltcG9ydCBsaXZlX2xvYWRpbmcsIHByaW50X2Vycm9yLCBwcmludF9zdWNjZXNzLCBwcmludF9wYW5lbApmcm9tIGFwcDIuY29uZmlnLnRoZW1lX2NvbmZpZyBpbXBvcnQgZ2V0X3RoZW1lCgoKZGVmIHNldHRsZW1lbnRfYmFsYW5jZSgKICAgIGFwaV9rZXk6IHN0ciwKICAgIHRva2VuczogZGljdCwKICAgIGl0ZW1zOiBsaXN0W1BheW1lbnRJdGVtXSwKICAgIHBheW1lbnRfZm9yOiBzdHIsCiAgICBhc2tfb3ZlcndyaXRlOiBib29sLAogICAgb3ZlcndyaXRlX2Ftb3VudDogaW50ID0gLTEsCiAgICB0b2tlbl9jb25maXJtYXRpb25faWR4OiBpbnQgPSAwLAogICAgYW1vdW50X2lkeDogaW50ID0gLTEsCiAgICB0b3B1cF9udW1iZXI6IHN0ciA9ICIiLAogICAgc3RhZ2VfdG9rZW46IHN0ciA9ICIiLAopOgogICAgIyBTYW5pdHkgY2hlY2sKICAgIGlmIG92ZXJ3cml0ZV9hbW91bnQgPT0gLTEgYW5kIG5vdCBhc2tfb3ZlcndyaXRlOgogICAgICAgIHByaW50X2Vycm9yKCJLZXNhbGFoYW4iLCAiSGFydXMgYWRhIG92ZXJ3cml0ZV9hbW91bnQgYXRhdSBmbGFnIGFza19vdmVyd3JpdGUuIikKICAgICAgICByZXR1cm4gTm9uZQoKICAgIHRva2VuX2NvbmZpcm1hdGlvbiA9IGl0ZW1zW3Rva2VuX2NvbmZpcm1hdGlvbl9pZHhdWyJ0b2tlbl9jb25maXJtYXRpb24iXQogICAgcGF5bWVudF90YXJnZXRzID0gIjsiLmpvaW4oW2l0ZW1bIml0ZW1fY29kZSJdIGZvciBpdGVtIGluIGl0ZW1zXSkKCiAgICAjIERldGVybWluZSBhbW91bnQgdG8gdXNlCiAgICBpZiBvdmVyd3JpdGVfYW1vdW50ICE9IC0xOgogICAgICAgIGFtb3VudF9pbnQgPSBvdmVyd3JpdGVfYW1vdW50CiAgICBlbGlmIGFtb3VudF9pZHggPT0gLTE6CiAgICAgICAgYW1vdW50X2ludCA9IGl0ZW1zW2Ftb3VudF9pZHhdWyJpdGVtX3ByaWNlIl0KCiAgICAjIElmIE92ZXJ3cml0ZQogICAgaWYgYXNrX292ZXJ3cml0ZToKICAgICAgICBwcmludF9wYW5lbCgiQW1vdW50IiwgZiJUb3RhbCB7YW1vdW50X2ludH0uIE1hc3Vra2FuIG5vbWluYWwgYmFydSBqaWthIGluZ2luIG92ZXJ3cml0ZS4iKQogICAgICAgIGFtb3VudF9zdHIgPSBpbnB1dCgiVGVrYW4gZW50ZXIgdW50dWsgbWVuZ2d1bmFrYW4gbm9taW5hbCBkZWZhdWx0OiAiKQogICAgICAgIGlmIGFtb3VudF9zdHIgIT0gIiI6CiAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgIGFtb3VudF9pbnQgPSBpbnQoYW1vdW50X3N0cikKICAgICAgICAgICAgZXhjZXB0IFZhbHVlRXJyb3I6CiAgICAgICAgICAgICAgICBwcmludF93YXJuaW5nKCJLZXNhbGFoYW4iLCAiSW5wdXQgb3ZlcndyaXRlIHRpZGFrIHZhbGlkLCBtZW5nZ3VuYWthbiBoYXJnYSBhc2xpLiIpCgogICAgaW50ZXJjZXB0X3BhZ2UoYXBpX2tleSwgdG9rZW5zLCBpdGVtc1swXVsiaXRlbV9jb2RlIl0sIEZhbHNlKQoKICAgICMgR2V0IHBheW1lbnQgbWV0aG9kcwogICAgcGF5bWVudF9wYXRoID0gInBheW1lbnRzL2FwaS92OC9wYXltZW50LW1ldGhvZHMtb3B0aW9uIgogICAgcGF5bWVudF9wYXlsb2FkID0gewogICAgICAgICJwYXltZW50X3R5cGUiOiAiUFVSQ0hBU0UiLAogICAgICAgICJpc19lbnRlcnByaXNlIjogRmFsc2UsCiAgICAgICAgInBheW1lbnRfdGFyZ2V0IjogaXRlbXNbdG9rZW5fY29uZmlybWF0aW9uX2lkeF1bIml0ZW1fY29kZSJdLAogICAgICAgICJsYW5nIjogImVuIiwKICAgICAgICAiaXNfcmVmZXJyYWwiOiBGYWxzZSwKICAgICAgICAidG9rZW5fY29uZmlybWF0aW9uIjogdG9rZW5fY29uZmlybWF0aW9uLAogICAgfQoKICAgIHdpdGggbGl2ZV9sb2FkaW5nKCJNZW5nYW1iaWwgbWV0b2RlIHBlbWJheWFyYW4uLi4iLCBnZXRfdGhlbWUoKSk6CiAgICAgICAgcGF5bWVudF9yZXMgPSBzZW5kX2FwaV9yZXF1ZXN0KGFwaV9rZXksIHBheW1lbnRfcGF0aCwgcGF5bWVudF9wYXlsb2FkLCB0b2tlbnNbImlkX3Rva2VuIl0sICJQT1NUIikKCiAgICBpZiBwYXltZW50X3Jlcy5nZXQoInN0YXR1cyIpICE9ICJTVUNDRVNTIjoKICAgICAgICBwcmludF9lcnJvcigiS2VzYWxhaGFuIiwgIkdhZ2FsIG1lbmdhbWJpbCBtZXRvZGUgcGVtYmF5YXJhbi4iKQogICAgICAgIHByaW50X3BhbmVsKCJSZXNwb25zZSIsIGpzb24uZHVtcHMocGF5bWVudF9yZXMsIGluZGVudD0yKSkKICAgICAgICByZXR1cm4gcGF5bWVudF9yZXMKCiAgICB0b2tlbl9wYXltZW50ID0gcGF5bWVudF9yZXNbImRhdGEiXVsidG9rZW5fcGF5bWVudCJdCiAgICB0c190b19zaWduID0gcGF5bWVudF9yZXNbImRhdGEiXVsidGltZXN0YW1wIl0KCiAgICAjIFNldHRsZW1lbnQgcmVxdWVzdAogICAgcGF0aCA9ICJwYXltZW50cy9hcGkvdjgvc2V0dGxlbWVudC1tdWx0aXBheW1lbnQiCiAgICBzZXR0bGVtZW50X3BheWxvYWQgPSB7CiAgICAgICAgInRvdGFsX2Rpc2NvdW50IjogMCwKICAgICAgICAiaXNfZW50ZXJwcmlzZSI6IEZhbHNlLAogICAgICAgICJwYXltZW50X3Rva2VuIjogIiIsCiAgICAgICAgInRva2VuX3BheW1lbnQiOiB0b2tlbl9wYXltZW50LAogICAgICAgICJhY3RpdmF0ZWRfYXV0b2J1eV9jb2RlIjogIiIsCiAgICAgICAgImNjX3BheW1lbnRfdHlwZSI6ICIiLAogICAgICAgICJpc19teXhsX3dhbGxldCI6IEZhbHNlLAogICAgICAgICJwaW4iOiAiIiwKICAgICAgICAiZXdhbGxldF9wcm9tb19pZCI6ICIiLAogICAgICAgICJtZW1iZXJzIjogW10sCiAgICAgICAgInRvdGFsX2ZlZSI6IDAsCiAgICAgICAgImZpbmdlcnByaW50IjogIiIsCiAgICAgICAgImF1dG9idXlfdGhyZXNob2xkX3NldHRpbmciOiB7ImxhYmVsIjogIiIsICJ0eXBlIjogIiIsICJ2YWx1ZSI6IDB9LAogICAgICAgICJpc191c2VfcG9pbnQiOiBGYWxzZSwKICAgICAgICAibGFuZyI6ICJlbiIsCiAgICAgICAgInBheW1lbnRfbWV0aG9kIjogIkJBTEFOQ0UiLAogICAgICAgICJ0aW1lc3RhbXAiOiBpbnQodGltZS50aW1lKCkpLAogICAgICAgICJwb2ludHNfZ2FpbmVkIjogMCwKICAgICAgICAiY2FuX3RyaWdnZXJfcmF0aW5nIjogRmFsc2UsCiAgICAgICAgImFrcmFiX21lbWJlcnMiOiBbXSwKICAgICAgICAiYWtyYWJfcGFyZW50X2FsaWFzIjogIiIsCiAgICAgICAgInJlZmVycmFsX3VuaXF1ZV9jb2RlIjogIiIsCiAgICAgICAgImNvdXBvbiI6ICIiLAogICAgICAgICJwYXltZW50X2ZvciI6IHBheW1lbnRfZm9yLAogICAgICAgICJ3aXRoX3Vwc2VsbCI6IEZhbHNlLAogICAgICAgICJ0b3B1cF9udW1iZXIiOiB0b3B1cF9udW1iZXIsCiAgICAgICAgInN0YWdlX3Rva2VuIjogc3RhZ2VfdG9rZW4sCiAgICAgICAgImF1dGhlbnRpY2F0aW9uX2lkIjogIiIsCiAgICAgICAgImVuY3J5cHRlZF9wYXltZW50X3Rva2VuIjogYnVpbGRfZW5jcnlwdGVkX2ZpZWxkKHVybHNhZmVfYjY0PVRydWUpLAogICAgICAgICJ0b2tlbiI6ICIiLAogICAgICAgICJ0b2tlbl9jb25maXJtYXRpb24iOiAiIiwKICAgICAgICAiYWNjZXNzX3Rva2VuIjogdG9rZW5zWyJhY2Nlc3NfdG9rZW4iXSwKICAgICAgICAid2FsbGV0X251bWJlciI6ICIiLAogICAgICAgICJlbmNyeXB0ZWRfYXV0aGVudGljYXRpb25faWQiOiBidWlsZF9lbmNyeXB0ZWRfZmllbGQodXJsc2FmZV9iNjQ9VHJ1ZSksCiAgICAgICAgImFkZGl0aW9uYWxfZGF0YSI6IHsKICAgICAgICAgICAgIm9yaWdpbmFsX3ByaWNlIjogaXRlbXNbLTFdWyJpdGVtX3ByaWNlIl0sCiAgICAgICAgICAgICJpc19zcGVuZF9saW1pdF90ZW1wb3JhcnkiOiBGYWxzZSwKICAgICAgICAgICAgIm1pZ3JhdGlvbl90eXBlIjogIiIsCiAgICAgICAgICAgICJha3JhYl9tMm1fZ3JvdXBfaWQiOiAiZmFsc2UiLAogICAgICAgICAgICAic3BlbmRfbGltaXRfYW1vdW50IjogMCwKICAgICAgICAgICAgImlzX3NwZW5kX2xpbWl0IjogRmFsc2UsCiAgICAgICAgICAgICJtaXNzaW9uX2lkIjogIiIsCiAgICAgICAgICAgICJ0YXgiOiAwLAogICAgICAgICAgICAicXVvdGFfYm9udXMiOiAwLAogICAgICAgICAgICAiY2FzaHRhZyI6ICIiLAogICAgICAgICAgICAiaXNfZmFtaWx5X3BsYW4iOiBGYWxzZSwKICAgICAgICAgICAgImNvbWJvX2RldGFpbHMiOiBbXSwKICAgICAgICAgICAgImlzX3N3aXRjaF9wbGFuIjogRmFsc2UsCiAgICAgICAgICAgICJkaXNjb3VudF9yZWN1cnJpbmciOiAwLAogICAgICAgICAgICAiaXNfYWtyYWJfbTJtIjogRmFsc2UsCiAgICAgICAgICAgICJiYWxhbmNlX3R5cGUiOiAiUFJFUEFJRF9CQUxBTkNFIiwKICAgICAgICAgICAgImhhc19ib251cyI6IEZhbHNlLAogICAgICAgICAgICAiZGlzY291bnRfcHJvbW8iOiAwLAogICAgICAgIH0sCiAgICAgICAgInRvdGFsX2Ftb3VudCI6IGFtb3VudF9pbnQsCiAgICAgICAgImlzX3VzaW5nX2F1dG9idXkiOiBGYWxzZSwKICAgICAgICAiaXRlbXMiOiBpdGVtcywKICAgIH0KCiAgICBlbmNyeXB0ZWRfcGF5bG9hZCA9IGVuY3J5cHRzaWduX3hkYXRhKAogICAgICAgIGFwaV9rZXk9YXBpX2tleSwKICAgICAgICBtZXRob2Q9IlBPU1QiLAogICAgICAgIHBhdGg9cGF0aCwKICAgICAgICBpZF90b2tlbj10b2tlbnNbImlkX3Rva2VuIl0sCiAgICAgICAgcGF5bG9hZD1zZXR0bGVtZW50X3BheWxvYWQsCiAgICApCgogICAgeHRpbWUgPSBpbnQoZW5jcnlwdGVkX3BheWxvYWRbImVuY3J5cHRlZF9ib2R5Il1bInh0aW1lIl0pCiAgICBzaWdfdGltZV9zZWMgPSB4dGltZSAvLyAxMDAwCiAgICB4X3JlcXVlc3RlZF9hdCA9IGRhdGV0aW1lLmZyb210aW1lc3RhbXAoc2lnX3RpbWVfc2VjLCB0ej10aW1lem9uZS51dGMpLmFzdGltZXpvbmUoKQogICAgc2V0dGxlbWVudF9wYXlsb2FkWyJ0aW1lc3RhbXAiXSA9IHRzX3RvX3NpZ24KCiAgICBib2R5ID0gZW5jcnlwdGVkX3BheWxvYWRbImVuY3J5cHRlZF9ib2R5Il0KICAgIHhfc2lnID0gZ2V0X3hfc2lnbmF0dXJlX3BheW1lbnQoCiAgICAgICAgYXBpX2tleSwKICAgICAgICB0b2tlbnNbImFjY2Vzc190b2tlbiJdLAogICAgICAgIHRzX3RvX3NpZ24sCiAgICAgICAgcGF5bWVudF90YXJnZXRzLAogICAgICAgIHRva2VuX3BheW1lbnQsCiAgICAgICAgIkJBTEFOQ0UiLAogICAgICAgIHBheW1lbnRfZm9yLAogICAgICAgIHBhdGgsCiAgICApCgogICAgaGVhZGVycyA9IHsKICAgICAgICAiaG9zdCI6IEJBU0VfQVBJX1VSTC5yZXBsYWNlKCJodHRwczovLyIsICIiKSwKICAgICAgICAiY29udGVudC10eXBlIjogImFwcGxpY2F0aW9uL2pzb247IGNoYXJzZXQ9dXRmLTgiLAogICAgICAgICJ1c2VyLWFnZW50IjogVUEsCiAgICAgICAgIngtYXBpLWtleSI6IEFQSV9LRVksCiAgICAgICAgImF1dGhvcml6YXRpb24iOiBmIkJlYXJlciB7dG9rZW5zWydpZF90b2tlbiddfSIsCiAgICAgICAgIngtaHYiOiAidjMiLAogICAgICAgICJ4LXNpZ25hdHVyZS10aW1lIjogc3RyKHNpZ190aW1lX3NlYyksCiAgICAgICAgIngtc2lnbmF0dXJlIjogeF9zaWcsCiAgICAgICAgIngtcmVxdWVzdC1pZCI6IHN0cih1dWlkLnV1aWQ0KCkpLAogICAgICAgICJ4LXJlcXVlc3QtYXQiOiBqYXZhX2xpa2VfdGltZXN0YW1wKHhfcmVxdWVzdGVkX2F0KSwKICAgICAgICAieC12ZXJzaW9uLWFwcCI6ICI4LjkuMSIsCiAgICB9CgogICAgdXJsID0gZiJ7QkFTRV9BUElfVVJMfS97cGF0aH0iCiAgICB3aXRoIGxpdmVfbG9hZGluZygiTWVuZ2lyaW0gc2V0dGxlbWVudCByZXF1ZXN0Li4uIiwgZ2V0X3RoZW1lKCkpOgogICAgICAgIHJlc3AgPSByZXF1ZXN0cy5wb3N0KHVybCwgaGVhZGVycz1oZWFkZXJzLCBkYXRhPWpzb24uZHVtcHMoYm9keSksIHRpbWVvdXQ9MzApCgogICAgdHJ5OgogICAgICAgIGRlY3J5cHRlZF9ib2R5ID0gZGVjcnlwdF94ZGF0YShhcGlfa2V5LCBqc29uLmxvYWRzKHJlc3AudGV4dCkpCiAgICAgICAgaWYgZGVjcnlwdGVkX2JvZHkuZ2V0KCJzdGF0dXMiKSAhPSAiU1VDQ0VTUyI6CiAgICAgICAgICAgIHByaW50X2Vycm9yKCJLZXNhbGFoYW4iLCAiU2V0dGxlbWVudCBnYWdhbC4iKQogICAgICAgICAgICBwcmludF9wYW5lbCgiUmVzcG9uc2UiLCBqc29uLmR1bXBzKGRlY3J5cHRlZF9ib2R5LCBpbmRlbnQ9MikpCiAgICAgICAgICAgIHJldHVybiBkZWNyeXB0ZWRfYm9keQoKICAgICAgICBwcmludF9zdWNjZXNzKCJCZXJoYXNpbCIsICJQZW1iZWxpYW4gYmVyaGFzaWwuIikKICAgICAgICBwcmludF9wYW5lbCgiUHVyY2hhc2UgUmVzdWx0IiwganNvbi5kdW1wcyhkZWNyeXB0ZWRfYm9keSwgaW5kZW50PTIpKQogICAgICAgIHJldHVybiBkZWNyeXB0ZWRfYm9keQogICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgIHByaW50X2Vycm9yKCJLZXNhbGFoYW4iLCBmIkVycm9yIGRlY3J5cHQ6IHtlfSIpCiAgICAgICAgcHJpbnRfcGFuZWwoIlJhdyBSZXNwb25zZSIsIHJlc3AudGV4dCkKICAgICAgICByZXR1cm4gcmVzcC50ZXh0Cg==').decode())
