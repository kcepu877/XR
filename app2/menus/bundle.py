#!/usr/bin/env python3
import base64
exec(base64.b64decode('ZnJvbSBhcHAyLmNvbmZpZy5pbXBvcnRzIGltcG9ydCAqCmZyb20gYXBwMi5jbGllbnQucHVyY2hhc2UuYmFsYW5jZSBpbXBvcnQgc2V0dGxlbWVudF9iYWxhbmNlCmZyb20gYXBwMi5jbGllbnQucHVyY2hhc2UucXJpcyBpbXBvcnQgc2hvd19xcmlzX3BheW1lbnQKZnJvbSBhcHAyLmNsaWVudC5wdXJjaGFzZS5ld2FsbGV0IGltcG9ydCBzaG93X211bHRpcGF5bWVudApmcm9tIGFwcDIubWVudXMudXRpbCBpbXBvcnQgY2xlYXJfc2NyZWVuLCBwYXVzZSwgcHJpbnRfcGFuZWwsIGdldF9ydXBpYWgsIHNpbXBsZV9udW1iZXIKZnJvbSBhcHAyLm1lbnVzLnBhY2thZ2UgaW1wb3J0IGdldF9wYWNrYWdlc19ieV9mYW1pbHkKZnJvbSBhcHAyLm1lbnVzLmZhbWlseV9ncnVwIGltcG9ydCBzaG93X2ZhbWlseV9ncnVwX21lbnUKZnJvbSBhcHAyLm1lbnVzLmJvb2ttYXJrIGltcG9ydCBzaG93X2Jvb2ttYXJrX21lbnUKZnJvbSBhcHAudHlwZV9kaWN0IGltcG9ydCBQYXltZW50SXRlbQoKY29uc29sZSA9IENvbnNvbGUoKQoKCmRlZiBzaG93X2J1bmRsZV9tZW51KCk6CiAgICBhcGlfa2V5ID0gQXV0aEluc3RhbmNlLmFwaV9rZXkKICAgIHRva2VucyA9IEF1dGhJbnN0YW5jZS5nZXRfYWN0aXZlX3Rva2VucygpCiAgICB0aGVtZSA9IGdldF90aGVtZSgpCgogICAgY2FydF9pdGVtcyA9IFtdCiAgICBkaXNwbGF5X2NhcnQgPSBbXQogICAgdG90YWxfcHJpY2UgPSAwCgogICAgd2hpbGUgVHJ1ZToKICAgICAgICBjbGVhcl9zY3JlZW4oKQogICAgICAgIGVuc3VyZV9naXQoKQogICAgICAgIGNvbnNvbGUucHJpbnQoUGFuZWwoCiAgICAgICAgICAgIEFsaWduLmNlbnRlcigiS2VyYW5qYW5nIFBha2V0IiwgdmVydGljYWw9Im1pZGRsZSIpLAogICAgICAgICAgICBib3JkZXJfc3R5bGU9dGhlbWVbImJvcmRlcl9pbmZvIl0sCiAgICAgICAgICAgIHBhZGRpbmc9KDEsIDIpLAogICAgICAgICAgICBleHBhbmQ9VHJ1ZQogICAgICAgICkpCiAgICAgICAgc2ltcGxlX251bWJlcigpCgogICAgICAgIGlmIGNhcnRfaXRlbXM6CiAgICAgICAgICAgIHRhYmxlID0gVGFibGUoYm94PU1JTklNQUxfRE9VQkxFX0hFQUQsIGV4cGFuZD1UcnVlKQogICAgICAgICAgICB0YWJsZS5hZGRfY29sdW1uKCJObyIsIGp1c3RpZnk9InJpZ2h0Iiwgc3R5bGU9dGhlbWVbInRleHRfa2V5Il0sIHdpZHRoPTQpCiAgICAgICAgICAgIHRhYmxlLmFkZF9jb2x1bW4oIk5hbWEgUGFrZXQiLCBzdHlsZT10aGVtZVsidGV4dF9ib2R5Il0pCiAgICAgICAgICAgIHRhYmxlLmFkZF9jb2x1bW4oIkhhcmdhIiwgc3R5bGU9dGhlbWVbInRleHRfbW9uZXkiXSwganVzdGlmeT0icmlnaHQiKQoKICAgICAgICAgICAgZm9yIGksIGl0ZW0gaW4gZW51bWVyYXRlKGRpc3BsYXlfY2FydCwgc3RhcnQ9MSk6CiAgICAgICAgICAgICAgICB0YWJsZS5hZGRfcm93KHN0cihpKSwgaXRlbVsibmFtZSJdLCBnZXRfcnVwaWFoKGl0ZW1bInByaWNlIl0pKQoKICAgICAgICAgICAgY29uc29sZS5wcmludChQYW5lbCh0YWJsZSwgYm9yZGVyX3N0eWxlPXRoZW1lWyJib3JkZXJfaW5mbyJdLCBwYWRkaW5nPSgwLCAxKSwgZXhwYW5kPVRydWUpKQogICAgICAgICAgICBjb25zb2xlLnByaW50KGYiW3t0aGVtZVsndGV4dF9ib2R5J119XVRvdGFsIEhhcmdhOiBScCB7Z2V0X3J1cGlhaCh0b3RhbF9wcmljZSl9Wy9dIikKICAgICAgICBlbHNlOgogICAgICAgICAgICBwcmludF9wYW5lbCgiSW5mb3JtYXNpIiwgIktlcmFuamFuZyBtYXNpaCBrb3NvbmcuIikKCiAgICAgICAgbmF2ID0gVGFibGUoc2hvd19oZWFkZXI9RmFsc2UsIGJveD1NSU5JTUFMX0RPVUJMRV9IRUFELCBleHBhbmQ9VHJ1ZSkKICAgICAgICBuYXYuYWRkX2NvbHVtbihqdXN0aWZ5PSJyaWdodCIsIHN0eWxlPXRoZW1lWyJ0ZXh0X2tleSJdLCB3aWR0aD02KQogICAgICAgIG5hdi5hZGRfY29sdW1uKHN0eWxlPXRoZW1lWyJ0ZXh0X2JvZHkiXSkKICAgICAgICBuYXYuYWRkX3JvdygiMSIsICJUYW1iYWggZGFyaSBCb29rbWFyayIpCiAgICAgICAgbmF2LmFkZF9yb3coIjIiLCAiVGFtYmFoIGRhcmkgRmFtaWx5IENvZGUgVGVyc2ltcGFuIikKICAgICAgICBuYXYuYWRkX3JvdygiMyIsICJUYW1iYWggZGFyaSBGYW1pbHkgQ29kZSBNYW51YWwiKQogICAgICAgIGlmIGNhcnRfaXRlbXM6CiAgICAgICAgICAgIG5hdi5hZGRfcm93KCI0IiwgZiJbe3RoZW1lWyd0ZXh0X2VyciddfV1IYXB1cyBJdGVtIGRhcmkgS2VyYW5qYW5nWy9dIikKICAgICAgICAgICAgbmF2LmFkZF9yb3coIjUiLCBmIlt7dGhlbWVbJ3RleHRfd2FybiddfV1MYW5qdXQga2UgUGVtYmF5YXJhblsvXSIpCiAgICAgICAgbmF2LmFkZF9yb3coIjAwIiwgZiJbe3RoZW1lWyd0ZXh0X3N1YiddfV1LZW1iYWxpIGtlIG1lbnUgdXRhbWFbL10iKQoKICAgICAgICBjb25zb2xlLnByaW50KFBhbmVsKG5hdiwgYm9yZGVyX3N0eWxlPXRoZW1lWyJib3JkZXJfcHJpbWFyeSJdLCBwYWRkaW5nPSgwLCAwKSwgZXhwYW5kPVRydWUpKQoKICAgICAgICBjaG9pY2UgPSBjb25zb2xlLmlucHV0KGYiW3t0aGVtZVsndGV4dF9zdWInXX1dUGlsaWhhbjpbL3t0aGVtZVsndGV4dF9zdWInXX1dICIpLnN0cmlwKCkKCiAgICAgICAgZGVmIGFkZF90b19jYXJ0KGRldGFpbCwgbmFtZSk6CiAgICAgICAgICAgIG5vbmxvY2FsIHRvdGFsX3ByaWNlCiAgICAgICAgICAgIG9wdGlvbiA9IGRldGFpbFsicGFja2FnZV9vcHRpb24iXQogICAgICAgICAgICBjYXJ0X2l0ZW1zLmFwcGVuZChQYXltZW50SXRlbSgKICAgICAgICAgICAgICAgIGl0ZW1fY29kZT1vcHRpb25bInBhY2thZ2Vfb3B0aW9uX2NvZGUiXSwKICAgICAgICAgICAgICAgIHByb2R1Y3RfdHlwZT0iIiwgaXRlbV9wcmljZT1vcHRpb25bInByaWNlIl0sCiAgICAgICAgICAgICAgICBpdGVtX25hbWU9b3B0aW9uWyJuYW1lIl0sIHRheD0wLAogICAgICAgICAgICAgICAgdG9rZW5fY29uZmlybWF0aW9uPWRldGFpbFsidG9rZW5fY29uZmlybWF0aW9uIl0KICAgICAgICAgICAgKSkKICAgICAgICAgICAgZGlzcGxheV9jYXJ0LmFwcGVuZCh7Im5hbWUiOiBuYW1lLCAicHJpY2UiOiBvcHRpb25bInByaWNlIl19KQogICAgICAgICAgICB0b3RhbF9wcmljZSArPSBvcHRpb25bInByaWNlIl0KICAgICAgICAgICAgcHJpbnRfcGFuZWwoIkJlcmhhc2lsIiwgZiJQYWtldCAne25hbWV9JyB0ZWxhaCBkaXRhbWJhaGthbiBrZSBrZXJhbmphbmcuIikKICAgICAgICAgICAgcGF1c2UoKQoKICAgICAgICBpZiBjaG9pY2UgPT0gIjEiOgogICAgICAgICAgICByZXN1bHQgPSBzaG93X2Jvb2ttYXJrX21lbnUocmV0dXJuX3BhY2thZ2VfZGV0YWlsPVRydWUpCiAgICAgICAgICAgIGlmIGlzaW5zdGFuY2UocmVzdWx0LCB0dXBsZSk6CiAgICAgICAgICAgICAgICBkZXRhaWwsIG5hbWUgPSByZXN1bHQKICAgICAgICAgICAgICAgIGlmIGRldGFpbDoKICAgICAgICAgICAgICAgICAgICBhZGRfdG9fY2FydChkZXRhaWwsIG5hbWUpCgogICAgICAgIGVsaWYgY2hvaWNlID09ICIyIjoKICAgICAgICAgICAgcmVzdWx0ID0gc2hvd19mYW1pbHlfZ3J1cF9tZW51KHJldHVybl9wYWNrYWdlX2RldGFpbD1UcnVlKQogICAgICAgICAgICBpZiByZXN1bHQgPT0gIk1BSU4iOgogICAgICAgICAgICAgICAgYnJlYWsKICAgICAgICAgICAgZWxpZiBpc2luc3RhbmNlKHJlc3VsdCwgdHVwbGUpOgogICAgICAgICAgICAgICAgZGV0YWlsLCBuYW1lID0gcmVzdWx0CiAgICAgICAgICAgICAgICBpZiBkZXRhaWw6CiAgICAgICAgICAgICAgICAgICAgYWRkX3RvX2NhcnQoZGV0YWlsLCBuYW1lKQoKICAgICAgICBlbGlmIGNob2ljZSA9PSAiMyI6CiAgICAgICAgICAgIGZjID0gY29uc29sZS5pbnB1dChmIlt7dGhlbWVbJ3RleHRfc3ViJ119XU1hc3Vra2FuIEZhbWlseSBDb2RlOlsve3RoZW1lWyd0ZXh0X3N1YiddfV0gIikuc3RyaXAoKQogICAgICAgICAgICByZXN1bHQgPSBnZXRfcGFja2FnZXNfYnlfZmFtaWx5KGZjLCByZXR1cm5fcGFja2FnZV9kZXRhaWw9VHJ1ZSkKICAgICAgICAgICAgaWYgcmVzdWx0ID09ICJNQUlOIjoKICAgICAgICAgICAgICAgIGJyZWFrCiAgICAgICAgICAgIGVsaWYgaXNpbnN0YW5jZShyZXN1bHQsIHR1cGxlKToKICAgICAgICAgICAgICAgIGRldGFpbCwgbmFtZSA9IHJlc3VsdAogICAgICAgICAgICAgICAgaWYgZGV0YWlsOgogICAgICAgICAgICAgICAgICAgIGFkZF90b19jYXJ0KGRldGFpbCwgbmFtZSkKCiAgICAgICAgZWxpZiBjaG9pY2UgPT0gIjQiIGFuZCBjYXJ0X2l0ZW1zOgogICAgICAgICAgICBpZHggPSBjb25zb2xlLmlucHV0KGYiW3t0aGVtZVsndGV4dF9zdWInXX1dTm9tb3IgaXRlbSB5YW5nIGluZ2luIGRpaGFwdXM6Wy97dGhlbWVbJ3RleHRfc3ViJ119XSAiKS5zdHJpcCgpCiAgICAgICAgICAgIGlmIGlkeC5pc2RpZ2l0KCkgYW5kIDEgPD0gaW50KGlkeCkgPD0gbGVuKGNhcnRfaXRlbXMpOgogICAgICAgICAgICAgICAgaSA9IGludChpZHgpIC0gMQogICAgICAgICAgICAgICAgcmVtb3ZlZCA9IGRpc3BsYXlfY2FydC5wb3AoaSkKICAgICAgICAgICAgICAgIGNhcnRfaXRlbXMucG9wKGkpCiAgICAgICAgICAgICAgICB0b3RhbF9wcmljZSAtPSByZW1vdmVkWyJwcmljZSJdCiAgICAgICAgICAgICAgICBwcmludF9wYW5lbCgiSW5mb3JtYXNpIiwgZiJJdGVtICd7cmVtb3ZlZFsnbmFtZSddfScgdGVsYWggZGloYXB1cyBkYXJpIGtlcmFuamFuZy4iKQogICAgICAgICAgICAgICAgcGF1c2UoKQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgcHJpbnRfcGFuZWwoIktlc2FsYWhhbiIsICJOb21vciBpdGVtIHRpZGFrIHZhbGlkLiIpCiAgICAgICAgICAgICAgICBwYXVzZSgpCgogICAgICAgIGVsaWYgY2hvaWNlID09ICI1IiBhbmQgY2FydF9pdGVtczoKICAgICAgICAgICAgY2xlYXJfc2NyZWVuKCkKICAgICAgICAgICAgaW5mb190ZXh0ID0gVGV4dCgpCiAgICAgICAgICAgIGluZm9fdGV4dC5hcHBlbmQoIkRldGFpbCBQZW1iYXlhcmFuOlxuIiwgc3R5bGU9dGhlbWVbInRleHRfYm9keSJdKQogICAgICAgICAgICBmb3IgaSwgaXRlbSBpbiBlbnVtZXJhdGUoZGlzcGxheV9jYXJ0LCBzdGFydD0xKToKICAgICAgICAgICAgICAgIGluZm9fdGV4dC5hcHBlbmQoZiJ7aX0uIHtpdGVtWyduYW1lJ119IC0gUnAge2dldF9ydXBpYWgoaXRlbVsncHJpY2UnXSl9XG4iLCBzdHlsZT10aGVtZVsidGV4dF9ib2R5Il0pCiAgICAgICAgICAgIGluZm9fdGV4dC5hcHBlbmQoZiJcblRvdGFsOiBScCB7Z2V0X3J1cGlhaCh0b3RhbF9wcmljZSl9Iiwgc3R5bGU9dGhlbWVbInRleHRfbW9uZXkiXSkKCiAgICAgICAgICAgIGNvbnNvbGUucHJpbnQoUGFuZWwoCiAgICAgICAgICAgICAgICBpbmZvX3RleHQsCiAgICAgICAgICAgICAgICB0aXRsZT1mIlt7dGhlbWVbJ3RleHRfdGl0bGUnXX1dSW5mb3JtYXNpIFBlbWJheWFyYW5bL10iLAogICAgICAgICAgICAgICAgYm9yZGVyX3N0eWxlPXRoZW1lWyJib3JkZXJfaW5mbyJdLAogICAgICAgICAgICAgICAgcGFkZGluZz0oMSwgMiksCiAgICAgICAgICAgICAgICBleHBhbmQ9VHJ1ZQogICAgICAgICAgICApKQogICAgICAgICAgICBzaW1wbGVfbnVtYmVyKCkKCiAgICAgICAgICAgIHdoaWxlIFRydWU6CiAgICAgICAgICAgICAgICBtZXRob2RfdGFibGUgPSBUYWJsZShzaG93X2hlYWRlcj1GYWxzZSwgYm94PU1JTklNQUxfRE9VQkxFX0hFQUQsIGV4cGFuZD1UcnVlKQogICAgICAgICAgICAgICAgbWV0aG9kX3RhYmxlLmFkZF9jb2x1bW4oanVzdGlmeT0icmlnaHQiLCBzdHlsZT10aGVtZVsidGV4dF9rZXkiXSwgd2lkdGg9NikKICAgICAgICAgICAgICAgIG1ldGhvZF90YWJsZS5hZGRfY29sdW1uKHN0eWxlPXRoZW1lWyJ0ZXh0X2JvZHkiXSkKICAgICAgICAgICAgICAgIG1ldGhvZF90YWJsZS5hZGRfcm93KCIxIiwgIkJhbGFuY2UiKQogICAgICAgICAgICAgICAgbWV0aG9kX3RhYmxlLmFkZF9yb3coIjIiLCAiRS1XYWxsZXQiKQogICAgICAgICAgICAgICAgbWV0aG9kX3RhYmxlLmFkZF9yb3coIjMiLCAiUVJJUyIpCiAgICAgICAgICAgICAgICBtZXRob2RfdGFibGUuYWRkX3JvdygiMDAiLCBmIlt7dGhlbWVbJ3RleHRfc3ViJ119XUtlbWJhbGkga2UgbWVudSBzZWJlbHVtbnlhWy9dIikKCiAgICAgICAgICAgICAgICBjb25zb2xlLnByaW50KFBhbmVsKAogICAgICAgICAgICAgICAgICAgIG1ldGhvZF90YWJsZSwKICAgICAgICAgICAgICAgICAgICB0aXRsZT1mIlt7dGhlbWVbJ3RleHRfdGl0bGUnXX1dUGlsaWggTWV0b2RlIFBlbWJheWFyYW5bL10iLAogICAgICAgICAgICAgICAgICAgIGJvcmRlcl9zdHlsZT10aGVtZVsiYm9yZGVyX3ByaW1hcnkiXSwKICAgICAgICAgICAgICAgICAgICBwYWRkaW5nPSgwLCAxKSwKICAgICAgICAgICAgICAgICAgICBleHBhbmQ9VHJ1ZQogICAgICAgICAgICAgICAgKSkKCiAgICAgICAgICAgICAgICBtZXRob2QgPSBjb25zb2xlLmlucHV0KGYiW3t0aGVtZVsndGV4dF9zdWInXX1dUGlsaWggbWV0b2RlIHBlbWJheWFyYW46Wy97dGhlbWVbJ3RleHRfc3ViJ119XSAiKS5zdHJpcCgpCgogICAgICAgICAgICAgICAgaWYgbWV0aG9kID09ICIwMCI6CiAgICAgICAgICAgICAgICAgICAgYnJlYWsKCiAgICAgICAgICAgICAgICBjb25maXJtID0gY29uc29sZS5pbnB1dChmIlt7dGhlbWVbJ3RleHRfc3ViJ119XUtvbmZpcm1hc2kgcGVtYmF5YXJhbiBkZW5nYW4gbWV0b2RlIGluaT8gKHkvbik6Wy97dGhlbWVbJ3RleHRfc3ViJ119XSAiKS5zdHJpcCgpLmxvd2VyKCkKICAgICAgICAgICAgICAgIGlmIGNvbmZpcm0gIT0gInkiOgogICAgICAgICAgICAgICAgICAgIHByaW50X3BhbmVsKCJJbmZvcm1hc2kiLCAiUGVtYmF5YXJhbiBkaWJhdGFsa2FuLiIpCiAgICAgICAgICAgICAgICAgICAgcGF1c2UoKQogICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlCgogICAgICAgICAgICAgICAgaWYgbWV0aG9kID09ICIxIjoKICAgICAgICAgICAgICAgICAgICBzZXR0bGVtZW50X2JhbGFuY2UoYXBpX2tleSwgdG9rZW5zLCBjYXJ0X2l0ZW1zLCAiQlVZX1BBQ0tBR0UiLCBUcnVlKQogICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuaW5wdXQoZiJbe3RoZW1lWyd0ZXh0X3N1YiddfV1QZW1iYXlhcmFuIHNlbGVzYWksIHRla2FuIEVudGVyLi4uWy97dGhlbWVbJ3RleHRfc3ViJ119XSIpCiAgICAgICAgICAgICAgICAgICAgYnJlYWsKICAgICAgICAgICAgICAgIGVsaWYgbWV0aG9kID09ICIyIjoKICAgICAgICAgICAgICAgICAgICBzaG93X211bHRpcGF5bWVudChhcGlfa2V5LCB0b2tlbnMsIGNhcnRfaXRlbXMsICJCVVlfUEFDS0FHRSIsIFRydWUpCiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5pbnB1dChmIlt7dGhlbWVbJ3RleHRfc3ViJ119XVBlbWJheWFyYW4gc2VsZXNhaSwgdGVrYW4gRW50ZXIuLi5bL3t0aGVtZVsndGV4dF9zdWInXX1dIikKICAgICAgICAgICAgICAgICAgICBicmVhawogICAgICAgICAgICAgICAgZWxpZiBtZXRob2QgPT0gIjMiOgogICAgICAgICAgICAgICAgICAgIHNob3dfcXJpc19wYXltZW50KGFwaV9rZXksIHRva2VucywgY2FydF9pdGVtcywgIkJVWV9QQUNLQUdFIiwgVHJ1ZSkKICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmlucHV0KGYiW3t0aGVtZVsndGV4dF9zdWInXX1dUGVtYmF5YXJhbiBzZWxlc2FpLCB0ZWthbiBFbnRlci4uLlsve3RoZW1lWyd0ZXh0X3N1YiddfV0iKQogICAgICAgICAgICAgICAgICAgIGJyZWFrCiAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgIHByaW50X3BhbmVsKCJLZXNhbGFoYW4iLCAiTWV0b2RlIHBlbWJheWFyYW4gdGlkYWsgdmFsaWQuIikKICAgICAgICAgICAgICAgICAgICBwYXVzZSgpCgogICAgICAgIGVsaWYgY2hvaWNlID09ICIwMCI6CiAgICAgICAgICAgIGJyZWFrCgogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHByaW50X3BhbmVsKCJLZXNhbGFoYW4iLCAiUGlsaWhhbiB0aWRhayB2YWxpZC4iKQogICAgICAgICAgICBwYXVzZSgpCg==').decode())
