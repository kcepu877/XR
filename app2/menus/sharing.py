#!/usr/bin/env python3
import base64
exec(base64.b64decode('aW1wb3J0IGpzb24KCmZyb20gYXBwMi5jb25maWcuaW1wb3J0cyBpbXBvcnQgKgpmcm9tIGFwcC5zZXJ2aWNlLmF1dGggaW1wb3J0IEF1dGhJbnN0YW5jZQpmcm9tIGFwcDIubWVudXMudXRpbCBpbXBvcnQgcGF1c2UsIGNsZWFyX3NjcmVlbiwgcHJpbnRfcGFuZWwsIGxpdmVfbG9hZGluZywgZ2V0X3J1cGlhaApmcm9tIGFwcDIuY2xpZW50LmVuZ3NlbCBpbXBvcnQgZ2V0X2JhbGFuY2UKZnJvbSBhcHAyLmNsaWVudC5zaGFyaW5nIGltcG9ydCBiYWxhbmNlX2FsbG90bWVudApmcm9tIGFwcDIuY2xpZW50LmNpYW0gaW1wb3J0IGdldF9hdXRoX2NvZGUKZnJvbSByaWNoLmNvbnNvbGUgaW1wb3J0IENvbnNvbGUKCmNvbnNvbGUgPSBDb25zb2xlKCkKCgpkZWYgc2hvd19iYWxhbmNlX2FsbG90bWVudF9tZW51KCk6CiAgICAiIiJNZW51IHVudHVrIG1lbGFrdWthbiBwZW1iYWdpYW4gc2FsZG8gKGJhbGFuY2Ugc2hhcmluZykuIiIiCiAgICB0aGVtZSA9IGdldF90aGVtZSgpCiAgICBhY3RpdmVfdXNlciA9IEF1dGhJbnN0YW5jZS5nZXRfYWN0aXZlX3VzZXIoKQogICAgY2xlYXJfc2NyZWVuKCkKICAgIHNpbXBsZV9udW1iZXIoKQogICAgZW5zdXJlX2dpdCgpCgogICAgYmFsYW5jZSA9IGdldF9iYWxhbmNlKEF1dGhJbnN0YW5jZS5hcGlfa2V5LCBhY3RpdmVfdXNlclsidG9rZW5zIl1bImlkX3Rva2VuIl0pCgogICAgaWYgbm90IGJhbGFuY2U6CiAgICAgICAgcHJpbnRfcGFuZWwoIktlc2FsYWhhbiIsICJHYWdhbCBtZW5nYW1iaWwgc2FsZG8uIikKICAgICAgICBwYXVzZSgpCiAgICAgICAgcmV0dXJuICJCQUNLIgoKICAgIGJhbGFuY2VfcmVtYWluaW5nID0gYmFsYW5jZS5nZXQoInJlbWFpbmluZyIsIDApCiAgICBjb25zb2xlLnByaW50KFBhbmVsKAogICAgICAgIEFsaWduLmNlbnRlcihmIkJhbGFuY2UgU2hhcmluZyB8IFJwIHtnZXRfcnVwaWFoKGJhbGFuY2VfcmVtYWluaW5nKX0iLCB2ZXJ0aWNhbD0ibWlkZGxlIiksCiAgICAgICAgYm9yZGVyX3N0eWxlPXRoZW1lWyJib3JkZXJfaW5mbyJdLAogICAgICAgIHBhZGRpbmc9KDEsIDIpLAogICAgICAgIGV4cGFuZD1UcnVlCiAgICApKQogICAgY29uc29sZS5wcmludChQYW5lbCgKICAgICAgICBBbGlnbi5jZW50ZXIoIlBhc3Rpa2FuIFBJTiB0cmFuc2Frc2kgc3VkYWggZGlhdHVyIGRpIGFwbGlrYXNpIE15WEwuIiwgdmVydGljYWw9Im1pZGRsZSIpLAogICAgICAgIGJvcmRlcl9zdHlsZT10aGVtZVsiYm9yZGVyX3dhcm5pbmciXSwKICAgICAgICBleHBhbmQ9VHJ1ZQogICAgKSkKCiAgICBwaW4gPSBjb25zb2xlLmlucHV0KGYiW3t0aGVtZVsndGV4dF9zdWInXX1dTWFzdWtrYW4gUElOIDYgZGlnaXQ6Wy97dGhlbWVbJ3RleHRfc3ViJ119XSAiKS5zdHJpcCgpCiAgICBpZiBsZW4ocGluKSAhPSA2IG9yIG5vdCBwaW4uaXNkaWdpdCgpOgogICAgICAgIHByaW50X3BhbmVsKCJLZXNhbGFoYW4iLCAiRm9ybWF0IFBJTiB0aWRhayB2YWxpZC4iKQogICAgICAgIHBhdXNlKCkKICAgICAgICByZXR1cm4gIkJBQ0siCgogICAgc3RhZ2VfdG9rZW4gPSBnZXRfYXV0aF9jb2RlKAogICAgICAgIGFjdGl2ZV91c2VyWyJ0b2tlbnMiXSwKICAgICAgICBwaW4sCiAgICAgICAgYWN0aXZlX3VzZXJbIm51bWJlciJdCiAgICApCiAgICBpZiBzdGFnZV90b2tlbiBpcyBOb25lOgogICAgICAgIHByaW50X3BhbmVsKCJLZXNhbGFoYW4iLCAiU3RhZ2UgdG9rZW4gZ2FnYWwgZGlhbWJpbC4iKQogICAgICAgIHBhdXNlKCkKICAgICAgICByZXR1cm4gIkJBQ0siCgogICAgcmVjZWl2ZXJfbXNpc2RuID0gY29uc29sZS5pbnB1dChmIlt7dGhlbWVbJ3RleHRfc3ViJ119XU1hc3Vra2FuIG5vbW9yIHBlbmVyaW1hICg2Mjh4eHgpOlsve3RoZW1lWyd0ZXh0X3N1YiddfV0gIikuc3RyaXAoKQogICAgYW1vdW50X3N0ciA9IGNvbnNvbGUuaW5wdXQoZiJbe3RoZW1lWyd0ZXh0X3N1YiddfV1NYXN1a2thbiBub21pbmFsIChjb250b2g6IDUwMDApOlsve3RoZW1lWyd0ZXh0X3N1YiddfV0gIikuc3RyaXAoKQoKICAgIHRyeToKICAgICAgICBhbW91bnQgPSBpbnQoYW1vdW50X3N0cikKICAgIGV4Y2VwdCBWYWx1ZUVycm9yOgogICAgICAgIHByaW50X3BhbmVsKCJLZXNhbGFoYW4iLCAiTm9taW5hbCB0aWRhayB2YWxpZC4iKQogICAgICAgIHBhdXNlKCkKICAgICAgICByZXR1cm4gIkJBQ0siCgogICAgd2l0aCBsaXZlX2xvYWRpbmcoIk1lbmdpcmltIHNhbGRvLi4uIiwgdGhlbWUpOgogICAgICAgIHJlcyA9IGJhbGFuY2VfYWxsb3RtZW50KAogICAgICAgICAgICBBdXRoSW5zdGFuY2UuYXBpX2tleSwKICAgICAgICAgICAgYWN0aXZlX3VzZXJbInRva2VucyJdLAogICAgICAgICAgICBzdGFnZV90b2tlbiwKICAgICAgICAgICAgcmVjZWl2ZXJfbXNpc2RuLAogICAgICAgICAgICBhbW91bnQsCiAgICAgICAgKQoKICAgIGlmIHJlcyBpcyBOb25lOgogICAgICAgIHByaW50X3BhbmVsKCJLZXNhbGFoYW4iLCAiQmFsYW5jZSBhbGxvdG1lbnQgZ2FnYWwuIikKICAgICAgICBwYXVzZSgpCiAgICAgICAgcmV0dXJuICJCQUNLIgoKICAgIGNvbnNvbGUucHJpbnQoUGFuZWwoCiAgICAgICAganNvbi5kdW1wcyhyZXMsIGluZGVudD0yKSwKICAgICAgICB0aXRsZT1mIlt7dGhlbWVbJ3RleHRfdGl0bGUnXX1dSGFzaWwgVHJhbnNha3NpWy9dIiwKICAgICAgICBib3JkZXJfc3R5bGU9dGhlbWVbImJvcmRlcl9zdWNjZXNzIl0sCiAgICAgICAgZXhwYW5kPVRydWUKICAgICkpCiAgICBwYXVzZSgpCiAgICByZXR1cm4gcmVzCg==').decode())
