#!/usr/bin/env python3
import base64
exec(base64.b64decode('ZnJvbSBkYXRldGltZSBpbXBvcnQgZGF0ZXRpbWUsIHRpbWVkZWx0YQoKZnJvbSBhcHAyLmNsaWVudC5lbmdzZWwgaW1wb3J0IGdldF90cmFuc2FjdGlvbl9oaXN0b3J5CmZyb20gYXBwMi5jb25maWcuaW1wb3J0cyBpbXBvcnQgKgpmcm9tIGFwcDIubWVudXMudXRpbCBpbXBvcnQgY2xlYXJfc2NyZWVuLCBwYXVzZSwgcHJpbnRfcGFuZWwsIHNpbXBsZV9udW1iZXIKCmNvbnNvbGUgPSBDb25zb2xlKCkKCgpkZWYgc2hvd190cmFuc2FjdGlvbl9oaXN0b3J5KGFwaV9rZXksIHRva2Vucyk6CiAgICB0aGVtZSA9IGdldF90aGVtZSgpCiAgICBpbl90cmFuc2FjdGlvbl9tZW51ID0gVHJ1ZQoKICAgIHdoaWxlIGluX3RyYW5zYWN0aW9uX21lbnU6CiAgICAgICAgY2xlYXJfc2NyZWVuKCkKICAgICAgICBlbnN1cmVfZ2l0KCkKICAgICAgICBjb25zb2xlLnByaW50KFBhbmVsKAogICAgICAgICAgICBBbGlnbi5jZW50ZXIoIlJpd2F5YXQgVHJhbnNha3NpIiwgdmVydGljYWw9Im1pZGRsZSIpLAogICAgICAgICAgICBib3JkZXJfc3R5bGU9dGhlbWVbImJvcmRlcl9pbmZvIl0sCiAgICAgICAgICAgIHBhZGRpbmc9KDEsIDIpLAogICAgICAgICAgICBleHBhbmQ9VHJ1ZQogICAgICAgICkpCiAgICAgICAgc2ltcGxlX251bWJlcigpCgogICAgICAgIHRyeToKICAgICAgICAgICAgZGF0YSA9IGdldF90cmFuc2FjdGlvbl9oaXN0b3J5KGFwaV9rZXksIHRva2VucykKICAgICAgICAgICAgaGlzdG9yeSA9IGRhdGEuZ2V0KCJsaXN0IiwgW10pCiAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgICAgICBwcmludF9wYW5lbCgiS2VzYWxhaGFuIiwgZiJHYWdhbCBtZW5nYW1iaWwgcml3YXlhdCB0cmFuc2Frc2k6IHtlfSIpCiAgICAgICAgICAgIGhpc3RvcnkgPSBbXQoKICAgICAgICBpZiBub3QgaGlzdG9yeToKICAgICAgICAgICAgcHJpbnRfcGFuZWwoIkluZm9ybWFzaSIsICJCZWx1bSBhZGEgcml3YXlhdCB0cmFuc2Frc2kuIikKICAgICAgICBlbHNlOgogICAgICAgICAgICBmb3IgaWR4LCB0cmFuc2FjdGlvbiBpbiBlbnVtZXJhdGUoaGlzdG9yeSwgc3RhcnQ9MSk6CiAgICAgICAgICAgICAgICB0cyA9IHRyYW5zYWN0aW9uLmdldCgidGltZXN0YW1wIiwgMCkKICAgICAgICAgICAgICAgIGR0ID0gZGF0ZXRpbWUuZnJvbXRpbWVzdGFtcCh0cykgLSB0aW1lZGVsdGEoaG91cnM9NykKICAgICAgICAgICAgICAgIGZvcm1hdHRlZF90aW1lID0gZHQuc3RyZnRpbWUoIiVkICVCICVZIHwgJUg6JU0gV0lCIikKCiAgICAgICAgICAgICAgICB0ID0gVGFibGUoYm94PU1JTklNQUxfRE9VQkxFX0hFQUQsIGV4cGFuZD1UcnVlLCBwYWRkaW5nPSgwLCAwKSkKICAgICAgICAgICAgICAgIHQuYWRkX2NvbHVtbigiTGFiZWwiLCBqdXN0aWZ5PSJsZWZ0Iiwgc3R5bGU9dGhlbWVbInRleHRfYm9keSJdLCB3aWR0aD0xOCkKICAgICAgICAgICAgICAgIHQuYWRkX2NvbHVtbigiRGV0YWlsIiwganVzdGlmeT0icmlnaHQiLCBzdHlsZT10aGVtZVsidGV4dF9ib2R5Il0pCiAgICAgICAgICAgICAgICB0LmFkZF9yb3coIkp1ZHVsIiwgdHJhbnNhY3Rpb24uZ2V0KCJ0aXRsZSIsICItIikpCiAgICAgICAgICAgICAgICB0LmFkZF9yb3coIkhhcmdhIiwgZiJScCB7dHJhbnNhY3Rpb24uZ2V0KCdwcmljZScsICctJyl9IikKICAgICAgICAgICAgICAgIHQuYWRkX3JvdygiVGFuZ2dhbCIsIGZvcm1hdHRlZF90aW1lKQogICAgICAgICAgICAgICAgdC5hZGRfcm93KCJNZXRvZGUiLCB0cmFuc2FjdGlvbi5nZXQoInBheW1lbnRfbWV0aG9kX2xhYmVsIiwgIi0iKSkKICAgICAgICAgICAgICAgIHQuYWRkX3JvdygiU3RhdHVzIFRyYW5zYWtzaSIsIHRyYW5zYWN0aW9uLmdldCgic3RhdHVzIiwgIi0iKSkKICAgICAgICAgICAgICAgIHQuYWRkX3JvdygiU3RhdHVzIFBlbWJheWFyYW4iLCB0cmFuc2FjdGlvbi5nZXQoInBheW1lbnRfc3RhdHVzIiwgIi0iKSkKCiAgICAgICAgICAgICAgICBjb25zb2xlLnByaW50KFBhbmVsKHQsIHRpdGxlPWYiVHJhbnNha3NpICN7aWR4fSIsIGJvcmRlcl9zdHlsZT10aGVtZVsiYm9yZGVyX2luZm8iXSwgZXhwYW5kPVRydWUpKQoKICAgICAgICBuYXZfdGFibGUgPSBUYWJsZShzaG93X2hlYWRlcj1GYWxzZSwgYm94PU1JTklNQUxfRE9VQkxFX0hFQUQsIGV4cGFuZD1UcnVlKQogICAgICAgIG5hdl90YWJsZS5hZGRfY29sdW1uKGp1c3RpZnk9InJpZ2h0Iiwgc3R5bGU9dGhlbWVbInRleHRfa2V5Il0sIHdpZHRoPTYpCiAgICAgICAgbmF2X3RhYmxlLmFkZF9jb2x1bW4oanVzdGlmeT0ibGVmdCIsIHN0eWxlPXRoZW1lWyJ0ZXh0X2JvZHkiXSkKICAgICAgICBuYXZfdGFibGUuYWRkX3JvdygiMCIsICJSZWZyZXNoIikKICAgICAgICBuYXZfdGFibGUuYWRkX3JvdygiMDAiLCBmIlt7dGhlbWVbJ3RleHRfc3ViJ119XUtlbWJhbGkga2UgTWVudSBVdGFtYVsvXSIpCgogICAgICAgIGNvbnNvbGUucHJpbnQoUGFuZWwobmF2X3RhYmxlLCBib3JkZXJfc3R5bGU9dGhlbWVbImJvcmRlcl9wcmltYXJ5Il0sIGV4cGFuZD1UcnVlKSkKCiAgICAgICAgY2hvaWNlID0gY29uc29sZS5pbnB1dChmIlt7dGhlbWVbJ3RleHRfc3ViJ119XVBpbGloYW46Wy97dGhlbWVbJ3RleHRfc3ViJ119XSAiKS5zdHJpcCgpCiAgICAgICAgaWYgY2hvaWNlID09ICIwIjoKICAgICAgICAgICAgY29udGludWUKICAgICAgICBlbGlmIGNob2ljZSA9PSAiMDAiOgogICAgICAgICAgICByZXR1cm4KICAgICAgICBlbHNlOgogICAgICAgICAgICBwcmludF9wYW5lbCgiS2VzYWxhaGFuIiwgIlBpbGloYW4gdGlkYWsgdmFsaWQsIHNpbGFrYW4gY29iYSBsYWdpLiIpCiAgICAgICAgICAgIHBhdXNlKCkK').decode())
