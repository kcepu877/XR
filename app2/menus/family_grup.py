#!/usr/bin/env python3
import base64
exec(base64.b64decode('aW1wb3J0IG9zCmltcG9ydCBqc29uCgpmcm9tIGFwcDIuY29uZmlnLmltcG9ydHMgaW1wb3J0ICoKZnJvbSBhcHAyLm1lbnVzLnBhY2thZ2UgaW1wb3J0IGdldF9wYWNrYWdlc19ieV9mYW1pbHkKZnJvbSBhcHAyLm1lbnVzLnV0aWwgaW1wb3J0IGNsZWFyX3NjcmVlbiwgcGF1c2UsIHByaW50X3BhbmVsLCBsaXZlX2xvYWRpbmcsIHNpbXBsZV9udW1iZXIKCmNvbnNvbGUgPSBDb25zb2xlKCkKCgpGQU1JTFlfRklMRSA9IG9zLnBhdGguYWJzcGF0aCgiZmFtaWx5X2NvZGVzLmpzb24iKQoKCmRlZiBlbnN1cmVfZmFtaWx5X2ZpbGUoKToKICAgIGRlZmF1bHRfZGF0YSA9IHsiY29kZXMiOiBbXX0KICAgIGlmIG5vdCBvcy5wYXRoLmV4aXN0cyhGQU1JTFlfRklMRSk6CiAgICAgICAgd2l0aCBvcGVuKEZBTUlMWV9GSUxFLCAidyIpIGFzIGY6CiAgICAgICAgICAgIGpzb24uZHVtcChkZWZhdWx0X2RhdGEsIGYsIGluZGVudD0yKQogICAgICAgIHJldHVybiBkZWZhdWx0X2RhdGEKCiAgICB0cnk6CiAgICAgICAgd2l0aCBvcGVuKEZBTUlMWV9GSUxFLCAiciIpIGFzIGY6CiAgICAgICAgICAgIGRhdGEgPSBqc29uLmxvYWQoZikKICAgICAgICBpZiBub3QgaXNpbnN0YW5jZShkYXRhLCBkaWN0KSBvciAiY29kZXMiIG5vdCBpbiBkYXRhIG9yIG5vdCBpc2luc3RhbmNlKGRhdGFbImNvZGVzIl0sIGxpc3QpOgogICAgICAgICAgICByYWlzZSBWYWx1ZUVycm9yKCJTdHJ1a3R1ciB0aWRhayB2YWxpZCIpCiAgICAgICAgcmV0dXJuIGRhdGEKICAgIGV4Y2VwdCAoanNvbi5KU09ORGVjb2RlRXJyb3IsIFZhbHVlRXJyb3IpOgogICAgICAgIHdpdGggb3BlbihGQU1JTFlfRklMRSwgInciKSBhcyBmOgogICAgICAgICAgICBqc29uLmR1bXAoZGVmYXVsdF9kYXRhLCBmLCBpbmRlbnQ9MikKICAgICAgICByZXR1cm4gZGVmYXVsdF9kYXRhCgoKZGVmIGxpc3RfZmFtaWx5X2NvZGVzKCk6CiAgICByZXR1cm4gZW5zdXJlX2ZhbWlseV9maWxlKClbImNvZGVzIl0KCgpkZWYgYWRkX2ZhbWlseV9jb2RlKGNvZGUsIG5hbWUpOgogICAgaWYgbm90IGNvZGUuc3RyaXAoKSBvciBub3QgbmFtZS5zdHJpcCgpOgogICAgICAgIHJldHVybiBGYWxzZQogICAgZGF0YSA9IGVuc3VyZV9mYW1pbHlfZmlsZSgpCiAgICBpZiBhbnkoaXRlbVsiY29kZSJdID09IGNvZGUgZm9yIGl0ZW0gaW4gZGF0YVsiY29kZXMiXSk6CiAgICAgICAgcmV0dXJuIEZhbHNlCiAgICBkYXRhWyJjb2RlcyJdLmFwcGVuZCh7ImNvZGUiOiBjb2RlLnN0cmlwKCksICJuYW1lIjogbmFtZS5zdHJpcCgpfSkKICAgIHdpdGggb3BlbihGQU1JTFlfRklMRSwgInciKSBhcyBmOgogICAgICAgIGpzb24uZHVtcChkYXRhLCBmLCBpbmRlbnQ9MikKICAgIHJldHVybiBUcnVlCgoKZGVmIHJlbW92ZV9mYW1pbHlfY29kZShpbmRleCk6CiAgICBkYXRhID0gZW5zdXJlX2ZhbWlseV9maWxlKCkKICAgIGlmIDAgPD0gaW5kZXggPCBsZW4oZGF0YVsiY29kZXMiXSk6CiAgICAgICAgcmVtb3ZlZCA9IGRhdGFbImNvZGVzIl0ucG9wKGluZGV4KQogICAgICAgIHdpdGggb3BlbihGQU1JTFlfRklMRSwgInciKSBhcyBmOgogICAgICAgICAgICBqc29uLmR1bXAoZGF0YSwgZiwgaW5kZW50PTIpCiAgICAgICAgcmV0dXJuIHJlbW92ZWRbImNvZGUiXQogICAgcmV0dXJuIE5vbmUKCgpkZWYgZWRpdF9mYW1pbHlfbmFtZShpbmRleCwgbmV3X25hbWUpOgogICAgaWYgbm90IG5ld19uYW1lLnN0cmlwKCk6CiAgICAgICAgcmV0dXJuIEZhbHNlCiAgICBkYXRhID0gZW5zdXJlX2ZhbWlseV9maWxlKCkKICAgIGlmIDAgPD0gaW5kZXggPCBsZW4oZGF0YVsiY29kZXMiXSk6CiAgICAgICAgZGF0YVsiY29kZXMiXVtpbmRleF1bIm5hbWUiXSA9IG5ld19uYW1lLnN0cmlwKCkKICAgICAgICB3aXRoIG9wZW4oRkFNSUxZX0ZJTEUsICJ3IikgYXMgZjoKICAgICAgICAgICAganNvbi5kdW1wKGRhdGEsIGYsIGluZGVudD0yKQogICAgICAgIHJldHVybiBUcnVlCiAgICByZXR1cm4gRmFsc2UKCgpkZWYgc2hvd19mYW1pbHlfZ3J1cF9tZW51KHJldHVybl9wYWNrYWdlX2RldGFpbDogYm9vbCA9IEZhbHNlKToKICAgIHdoaWxlIFRydWU6CiAgICAgICAgY2xlYXJfc2NyZWVuKCkKICAgICAgICBlbnN1cmVfZ2l0KCkKICAgICAgICBzZW11YV9rb2RlID0gbGlzdF9mYW1pbHlfY29kZXMoKQogICAgICAgIHRoZW1lID0gZ2V0X3RoZW1lKCkKCiAgICAgICAgY29uc29sZS5wcmludChQYW5lbCgKICAgICAgICAgICAgQWxpZ24uY2VudGVyKCJEYWZ0YXIgRmFtaWx5IENvZGUiLCB2ZXJ0aWNhbD0ibWlkZGxlIiksCiAgICAgICAgICAgIGJvcmRlcl9zdHlsZT10aGVtZVsiYm9yZGVyX2luZm8iXSwKICAgICAgICAgICAgcGFkZGluZz0oMSwgMiksCiAgICAgICAgICAgIGV4cGFuZD1UcnVlCiAgICAgICAgKSkKICAgICAgICBzaW1wbGVfbnVtYmVyKCkKCiAgICAgICAgcGFja2FnZXMgPSBbXQogICAgICAgIGlmIHNlbXVhX2tvZGU6CiAgICAgICAgICAgIHRhYmxlID0gVGFibGUoYm94PU1JTklNQUxfRE9VQkxFX0hFQUQsIGV4cGFuZD1UcnVlKQogICAgICAgICAgICB0YWJsZS5hZGRfY29sdW1uKCJObyIsIGp1c3RpZnk9InJpZ2h0Iiwgc3R5bGU9dGhlbWVbInRleHRfa2V5Il0sIHdpZHRoPTMpCiAgICAgICAgICAgIHRhYmxlLmFkZF9jb2x1bW4oIk5hbWEiLCBzdHlsZT10aGVtZVsidGV4dF9ib2R5Il0pCiAgICAgICAgICAgIHRhYmxlLmFkZF9jb2x1bW4oIkZhbWlseSBDb2RlIiwgc3R5bGU9dGhlbWVbImJvcmRlcl9pbmZvIl0pCgogICAgICAgICAgICBmb3IgaSwgaXRlbSBpbiBlbnVtZXJhdGUoc2VtdWFfa29kZSwgc3RhcnQ9MSk6CiAgICAgICAgICAgICAgICB0YWJsZS5hZGRfcm93KHN0cihpKSwgaXRlbVsibmFtZSJdLCBpdGVtWyJjb2RlIl0pCiAgICAgICAgICAgICAgICBwYWNrYWdlcy5hcHBlbmQoewogICAgICAgICAgICAgICAgICAgICJudW1iZXIiOiBpLAogICAgICAgICAgICAgICAgICAgICJjb2RlIjogaXRlbVsiY29kZSJdLAogICAgICAgICAgICAgICAgICAgICJuYW1lIjogaXRlbVsibmFtZSJdCiAgICAgICAgICAgICAgICB9KQoKICAgICAgICAgICAgY29uc29sZS5wcmludChQYW5lbCh0YWJsZSwgYm9yZGVyX3N0eWxlPXRoZW1lWyJib3JkZXJfaW5mbyJdLCBwYWRkaW5nPSgwLCAwKSwgZXhwYW5kPVRydWUpKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIGNvbnNvbGUucHJpbnQoUGFuZWwoCiAgICAgICAgICAgICAgICAiW2l0YWxpY11CZWx1bSBhZGEgZmFtaWx5IGNvZGUgdGVyc2ltcGFuLlsvaXRhbGljXSIsCiAgICAgICAgICAgICAgICBib3JkZXJfc3R5bGU9dGhlbWVbImJvcmRlcl93YXJuaW5nIl0sCiAgICAgICAgICAgICAgICBwYWRkaW5nPSgxLCAyKSwKICAgICAgICAgICAgICAgIGV4cGFuZD1UcnVlCiAgICAgICAgICAgICkpCgogICAgICAgIG5hdl90YWJsZSA9IFRhYmxlKHNob3dfaGVhZGVyPUZhbHNlLCBib3g9TUlOSU1BTF9ET1VCTEVfSEVBRCwgZXhwYW5kPVRydWUpCiAgICAgICAgbmF2X3RhYmxlLmFkZF9jb2x1bW4oanVzdGlmeT0icmlnaHQiLCBzdHlsZT10aGVtZVsidGV4dF9rZXkiXSwgd2lkdGg9NikKICAgICAgICBuYXZfdGFibGUuYWRkX2NvbHVtbihzdHlsZT10aGVtZVsidGV4dF9ib2R5Il0pCiAgICAgICAgbmF2X3RhYmxlLmFkZF9yb3coIlQiLCAiVGFtYmFoIGZhbWlseSBjb2RlIikKICAgICAgICBpZiBzZW11YV9rb2RlOgogICAgICAgICAgICBuYXZfdGFibGUuYWRkX3JvdygiRSIsICJFZGl0IG5hbWEgZmFtaWx5IGNvZGUiKQogICAgICAgICAgICBuYXZfdGFibGUuYWRkX3JvdygiSCIsIGYiW3t0aGVtZVsndGV4dF9lcnInXX1dSGFwdXMgZmFtaWx5IGNvZGVbL10iKQogICAgICAgIG5hdl90YWJsZS5hZGRfcm93KCIwMCIsIGYiW3t0aGVtZVsndGV4dF9zdWInXX1dS2VtYmFsaSBrZSBtZW51IHV0YW1hWy9dIikKCiAgICAgICAgY29uc29sZS5wcmludChQYW5lbChuYXZfdGFibGUsIGJvcmRlcl9zdHlsZT10aGVtZVsiYm9yZGVyX3ByaW1hcnkiXSwgcGFkZGluZz0oMCwgMSksIGV4cGFuZD1UcnVlKSkKCiAgICAgICAgYWtzaSA9IGNvbnNvbGUuaW5wdXQoZiJbe3RoZW1lWyd0ZXh0X3RpdGxlJ119XVBpbGloIGFrc2kgYXRhdSBub21vciBrb2RlOlsve3RoZW1lWyd0ZXh0X3RpdGxlJ119XSAiKS5zdHJpcCgpLmxvd2VyKCkKCiAgICAgICAgaWYgYWtzaSA9PSAidCI6CiAgICAgICAgICAgIGNvZGUgPSBjb25zb2xlLmlucHV0KCJNYXN1a2thbiBmYW1pbHkgY29kZTogIikuc3RyaXAoKQogICAgICAgICAgICBuYW1lID0gY29uc29sZS5pbnB1dCgiTWFzdWtrYW4gbmFtYSBmYW1pbHk6ICIpLnN0cmlwKCkKICAgICAgICAgICAgc3VjY2VzcyA9IGFkZF9mYW1pbHlfY29kZShjb2RlLCBuYW1lKQogICAgICAgICAgICBwcmludF9wYW5lbCgiQmVyaGFzaWwiIGlmIHN1Y2Nlc3MgZWxzZSAiS2VzYWxhaGFuIiwKICAgICAgICAgICAgICAgICAgICAgICAgIkZhbWlseSBjb2RlIGJhcnUgYmVyaGFzaWwgZGl0YW1iYWhrYW4uIiBpZiBzdWNjZXNzIGVsc2UgIkdhZ2FsIG1lbmFtYmFoLCBmYW1pbHkgY29kZSBzdWRhaCBhZGEuIikKICAgICAgICAgICAgcGF1c2UoKQoKICAgICAgICBlbGlmIGFrc2kgPT0gImgiOgogICAgICAgICAgICBpZiBub3Qgc2VtdWFfa29kZToKICAgICAgICAgICAgICAgIHByaW50X3BhbmVsKCJJbmZvcm1hc2kiLCAiVGlkYWsgYWRhIGtvZGUgdW50dWsgZGloYXB1cy4iKQogICAgICAgICAgICAgICAgcGF1c2UoKQogICAgICAgICAgICAgICAgY29udGludWUKICAgICAgICAgICAgaWR4ID0gY29uc29sZS5pbnB1dCgiTm9tb3Iga29kZSB5YW5nIGluZ2luIGRpaGFwdXM6ICIpLnN0cmlwKCkKICAgICAgICAgICAgaWYgaWR4LmlzZGlnaXQoKSBhbmQgMSA8PSBpbnQoaWR4KSA8PSBsZW4oc2VtdWFfa29kZSk6CiAgICAgICAgICAgICAgICBpbmRleCA9IGludChpZHgpIC0gMQogICAgICAgICAgICAgICAgbmFtYSA9IHNlbXVhX2tvZGVbaW5kZXhdWyJuYW1lIl0KICAgICAgICAgICAgICAgIGtvZGUgPSBzZW11YV9rb2RlW2luZGV4XVsiY29kZSJdCiAgICAgICAgICAgICAgICBrb25maXJtYXNpID0gY29uc29sZS5pbnB1dChmIllha2luIGluZ2luIG1lbmdoYXB1cyAne25hbWF9JyAoe2tvZGV9KT8gKHkvbik6ICIpLnN0cmlwKCkubG93ZXIoKQogICAgICAgICAgICAgICAgaWYga29uZmlybWFzaSA9PSAieSI6CiAgICAgICAgICAgICAgICAgICAgcmVtb3ZlZCA9IHJlbW92ZV9mYW1pbHlfY29kZShpbmRleCkKICAgICAgICAgICAgICAgICAgICBwcmludF9wYW5lbCgiQmVyaGFzaWwiIGlmIHJlbW92ZWQgZWxzZSAiS2VzYWxhaGFuIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmIkZhbWlseSBjb2RlIHtyZW1vdmVkfSBiZXJoYXNpbCBkaWhhcHVzLiIgaWYgcmVtb3ZlZCBlbHNlICJHYWdhbCBtZW5naGFwdXMuIikKICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgcHJpbnRfcGFuZWwoIkluZm9ybWFzaSIsICJQZW5naGFwdXNhbiBkaWJhdGFsa2FuLiIpCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBwcmludF9wYW5lbCgiS2VzYWxhaGFuIiwgIk5vbW9yIGtvZGUgdGlkYWsgdmFsaWQuIikKICAgICAgICAgICAgcGF1c2UoKQoKICAgICAgICBlbGlmIGFrc2kgPT0gImUiOgogICAgICAgICAgICBpZiBub3Qgc2VtdWFfa29kZToKICAgICAgICAgICAgICAgIHByaW50X3BhbmVsKCJJbmZvcm1hc2kiLCAiVGlkYWsgYWRhIGtvZGUgdW50dWsgZGllZGl0LiIpCiAgICAgICAgICAgICAgICBwYXVzZSgpCiAgICAgICAgICAgICAgICBjb250aW51ZQogICAgICAgICAgICBpZHggPSBjb25zb2xlLmlucHV0KCJOb21vciBrb2RlIHlhbmcgaW5naW4gZGl1YmFoIG5hbWFueWE6ICIpLnN0cmlwKCkKICAgICAgICAgICAgaWYgaWR4LmlzZGlnaXQoKSBhbmQgMSA8PSBpbnQoaWR4KSA8PSBsZW4oc2VtdWFfa29kZSk6CiAgICAgICAgICAgICAgICBuZXdfbmFtZSA9IGNvbnNvbGUuaW5wdXQoIk1hc3Vra2FuIG5hbWEgYmFydTogIikuc3RyaXAoKQogICAgICAgICAgICAgICAgc3VjY2VzcyA9IGVkaXRfZmFtaWx5X25hbWUoaW50KGlkeCkgLSAxLCBuZXdfbmFtZSkKICAgICAgICAgICAgICAgIHByaW50X3BhbmVsKCJCZXJoYXNpbCIgaWYgc3VjY2VzcyBlbHNlICJLZXNhbGFoYW4iLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIk5hbWEgZmFtaWx5IGNvZGUgYmVyaGFzaWwgZGlnYW50aS4iIGlmIHN1Y2Nlc3MgZWxzZSAiR2FnYWwgbWVuZ2dhbnRpIG5hbWEuIikKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHByaW50X3BhbmVsKCJLZXNhbGFoYW4iLCAiTm9tb3Iga29kZSB0aWRhayB2YWxpZC4iKQogICAgICAgICAgICBwYXVzZSgpCgogICAgICAgIGVsaWYgYWtzaSA9PSAiMDAiOgogICAgICAgICAgICByZXR1cm4gKE5vbmUsIE5vbmUpIGlmIHJldHVybl9wYWNrYWdlX2RldGFpbCBlbHNlIE5vbmUKCiAgICAgICAgZWxpZiBha3NpLmlzZGlnaXQoKToKICAgICAgICAgICAgbm9tb3IgPSBpbnQoYWtzaSkKICAgICAgICAgICAgc2VsZWN0ZWQgPSBuZXh0KChwIGZvciBwIGluIHBhY2thZ2VzIGlmIHBbIm51bWJlciJdID09IG5vbW9yKSwgTm9uZSkKICAgICAgICAgICAgaWYgc2VsZWN0ZWQ6CiAgICAgICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0gZ2V0X3BhY2thZ2VzX2J5X2ZhbWlseShzZWxlY3RlZFsiY29kZSJdLCByZXR1cm5fcGFja2FnZV9kZXRhaWw9cmV0dXJuX3BhY2thZ2VfZGV0YWlsKQogICAgICAgICAgICAgICAgICAgIGlmIHJldHVybl9wYWNrYWdlX2RldGFpbDoKICAgICAgICAgICAgICAgICAgICAgICAgaWYgaXNpbnN0YW5jZShyZXN1bHQsIHR1cGxlKToKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiByZXN1bHQKICAgICAgICAgICAgICAgICAgICAgICAgZWxpZiByZXN1bHQgPT0gIk1BSU4iOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICJNQUlOIgogICAgICAgICAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIE5vbmUsIE5vbmUKICAgICAgICAgICAgICAgICAgICBpZiByZXN1bHQgPT0gIk1BSU4iOgogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gTm9uZQogICAgICAgICAgICAgICAgICAgIGVsaWYgcmVzdWx0ID09ICJCQUNLIjoKICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWUKICAgICAgICAgICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAgICAgICAgICBwcmludF9wYW5lbCgiS2VzYWxhaGFuIiwgZiJHYWdhbCBtZW5hbXBpbGthbiBwYWtldDoge2V9IikKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHByaW50X3BhbmVsKCJLZXNhbGFoYW4iLCAiTm9tb3Iga29kZSB0aWRhayB2YWxpZC4iKQogICAgICAgICAgICBwYXVzZSgpCg==').decode())
