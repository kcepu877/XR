#!/usr/bin/env python3
import base64
exec(base64.b64decode('aW1wb3J0IGpzb24KZnJvbSBkYXRldGltZSBpbXBvcnQgZGF0ZXRpbWUKZnJvbSBhcHAyLmNsaWVudC5zdG9yZS5zZWdtZW50cyBpbXBvcnQgZ2V0X3NlZ21lbnRzCmZyb20gYXBwMi5tZW51cy51dGlsIGltcG9ydCAoCiAgICBjbGVhcl9zY3JlZW4sIHBhdXNlLCBwcmludF9wYW5lbCwgc2ltcGxlX251bWJlciwgZ2V0X3J1cGlhaAopCmZyb20gYXBwLnNlcnZpY2UuYXV0aCBpbXBvcnQgQXV0aEluc3RhbmNlCmZyb20gYXBwMi5tZW51cy5wYWNrYWdlIGltcG9ydCBzaG93X3BhY2thZ2VfZGV0YWlscwpmcm9tIGFwcDIuY29uZmlnLmltcG9ydHMgaW1wb3J0ICoKCmNvbnNvbGUgPSBDb25zb2xlKCkKCgpkZWYgc2hvd19zdG9yZV9zZWdtZW50c19tZW51KGlzX2VudGVycHJpc2U6IGJvb2wgPSBGYWxzZSk6CiAgICAiIiJNZW5hbXBpbGthbiBtZW51IHN0b3JlIHNlZ21lbnRzIHlhbmcgdGVyc2VkaWEuIiIiCiAgICB0aGVtZSA9IGdldF90aGVtZSgpCiAgICBpbl9zdG9yZV9zZWdtZW50c19tZW51ID0gVHJ1ZQogICAgd2hpbGUgaW5fc3RvcmVfc2VnbWVudHNfbWVudToKICAgICAgICBhcGlfa2V5ID0gQXV0aEluc3RhbmNlLmFwaV9rZXkKICAgICAgICB0b2tlbnMgPSBBdXRoSW5zdGFuY2UuZ2V0X2FjdGl2ZV90b2tlbnMoKQogICAgICAgIAogICAgICAgIHNlZ21lbnRzX3JlcyA9IGdldF9zZWdtZW50cyhhcGlfa2V5LCB0b2tlbnMsIGlzX2VudGVycHJpc2UpCiAgICAgICAgaWYgbm90IHNlZ21lbnRzX3JlczoKICAgICAgICAgICAgcHJpbnRfcGFuZWwoIkluZm9ybWFzaSIsICJUaWRhayBhZGEgc3RvcmUgc2VnbWVudHMgdGVyc2VkaWEuIikKICAgICAgICAgICAgaW5fc3RvcmVfc2VnbWVudHNfbWVudSA9IEZhbHNlCiAgICAgICAgICAgIGNvbnRpbnVlCiAgICAgICAgCiAgICAgICAgc2VnbWVudHMgPSBzZWdtZW50c19yZXMuZ2V0KCJkYXRhIiwge30pLmdldCgic3RvcmVfc2VnbWVudHMiLCBbXSkKICAgICAgICBjbGVhcl9zY3JlZW4oKQogICAgICAgIGVuc3VyZV9naXQoKQogICAgICAgIAogICAgICAgIGNvbnNvbGUucHJpbnQoUGFuZWwoCiAgICAgICAgICAgIEFsaWduLmNlbnRlcigiU3RvcmUgU2VnbWVudHMiLCB2ZXJ0aWNhbD0ibWlkZGxlIiksCiAgICAgICAgICAgIGJvcmRlcl9zdHlsZT10aGVtZVsiYm9yZGVyX2luZm8iXSwKICAgICAgICAgICAgcGFkZGluZz0oMSwgMiksCiAgICAgICAgICAgIGV4cGFuZD1UcnVlCiAgICAgICAgKSkKICAgICAgICBzaW1wbGVfbnVtYmVyKCkKICAgICAgICAKICAgICAgICBwYWNrYWdlcyA9IHt9CiAgICAgICAgZm9yIGksIHNlZ21lbnQgaW4gZW51bWVyYXRlKHNlZ21lbnRzKToKICAgICAgICAgICAgbmFtZSA9IHNlZ21lbnQuZ2V0KCJ0aXRsZSIsICJOL0EiKQogICAgICAgICAgICBiYW5uZXJzID0gc2VnbWVudC5nZXQoImJhbm5lcnMiLCBbXSkKICAgICAgICAgICAgbGV0dGVyID0gY2hyKDY1ICsgaSkgICMgQ29udmVydCAwIC0+IEEsIDEgLT4gQiwgZXRjLgogICAgICAgICAgICAKICAgICAgICAgICAgdGFibGUgPSBUYWJsZShib3g9TUlOSU1BTF9ET1VCTEVfSEVBRCwgZXhwYW5kPVRydWUpCiAgICAgICAgICAgIHRhYmxlLmFkZF9jb2x1bW4oIktvZGUiLCBzdHlsZT10aGVtZVsidGV4dF9rZXkiXSwgd2lkdGg9NikKICAgICAgICAgICAgdGFibGUuYWRkX2NvbHVtbigiRmFtaWx5Iiwgc3R5bGU9dGhlbWVbInRleHRfYm9keSJdKQogICAgICAgICAgICB0YWJsZS5hZGRfY29sdW1uKCJQYWtldCIsIHN0eWxlPXRoZW1lWyJ0ZXh0X2JvZHkiXSkKICAgICAgICAgICAgdGFibGUuYWRkX2NvbHVtbigiQWt0aWYiLCBzdHlsZT10aGVtZVsidGV4dF9kYXRlIl0pCiAgICAgICAgICAgIHRhYmxlLmFkZF9jb2x1bW4oIkhhcmdhIiwgc3R5bGU9dGhlbWVbInRleHRfbW9uZXkiXSwganVzdGlmeT0icmlnaHQiKQogICAgICAgICAgICAKICAgICAgICAgICAgaWYgbm90IGJhbm5lcnM6CiAgICAgICAgICAgICAgICB0YWJsZS5hZGRfcm93KCItIiwgZiJ7bmFtZX0gKGtvc29uZykiLCAiLSIsICItIiwgIi0iKQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgZm9yIGosIGJhbm5lciBpbiBlbnVtZXJhdGUoYmFubmVycyk6CiAgICAgICAgICAgICAgICAgICAgdGl0bGUgPSBiYW5uZXIuZ2V0KCJ0aXRsZSIsICJOL0EiKQogICAgICAgICAgICAgICAgICAgIHZhbGlkaXR5ID0gYmFubmVyLmdldCgidmFsaWRpdHkiLCAiTi9BIikKICAgICAgICAgICAgICAgICAgICBmYW1pbHlfbmFtZSA9IGJhbm5lci5nZXQoImZhbWlseV9uYW1lIiwgIk4vQSIpCiAgICAgICAgICAgICAgICAgICAgYWN0aW9uX3BhcmFtID0gYmFubmVyLmdldCgiYWN0aW9uX3BhcmFtIiwgIiIpCiAgICAgICAgICAgICAgICAgICAgYWN0aW9uX3R5cGUgPSBiYW5uZXIuZ2V0KCJhY3Rpb25fdHlwZSIsICIiKQogICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICMgaGFyZ2E6IG9yaWdpbmFsICsgZGlzY291bnRlZAogICAgICAgICAgICAgICAgICAgIG9yaWdpbmFsX3ByaWNlID0gYmFubmVyLmdldCgib3JpZ2luYWxfcHJpY2UiLCAwKQogICAgICAgICAgICAgICAgICAgIGRpc2NvdW50ZWRfcHJpY2UgPSBiYW5uZXIuZ2V0KCJkaXNjb3VudGVkX3ByaWNlIiwgMCkKICAgICAgICAgICAgICAgICAgICBpZiBkaXNjb3VudGVkX3ByaWNlIGFuZCBkaXNjb3VudGVkX3ByaWNlID4gMDoKICAgICAgICAgICAgICAgICAgICAgICAgaGFyZ2Ffc3RyID0gZiJ7Z2V0X3J1cGlhaChvcmlnaW5hbF9wcmljZSl9IOKeoSB7Z2V0X3J1cGlhaChkaXNjb3VudGVkX3ByaWNlKX0iCiAgICAgICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICAgICAgaGFyZ2Ffc3RyID0gZ2V0X3J1cGlhaChvcmlnaW5hbF9wcmljZSkKICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICBjb2RlID0gZiJ7bGV0dGVyfXtqKzF9IgogICAgICAgICAgICAgICAgICAgIHBhY2thZ2VzW2NvZGUubG93ZXIoKV0gPSB7CiAgICAgICAgICAgICAgICAgICAgICAgICJhY3Rpb25fcGFyYW0iOiBhY3Rpb25fcGFyYW0sCiAgICAgICAgICAgICAgICAgICAgICAgICJhY3Rpb25fdHlwZSI6IGFjdGlvbl90eXBlCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIHRhYmxlLmFkZF9yb3coY29kZSwgZmFtaWx5X25hbWUsIHRpdGxlLCB2YWxpZGl0eSwgaGFyZ2Ffc3RyKQogICAgICAgICAgICAKICAgICAgICAgICAgY29uc29sZS5wcmludChQYW5lbCgKICAgICAgICAgICAgICAgIHRhYmxlLAogICAgICAgICAgICAgICAgdGl0bGU9ZiJbe3RoZW1lWyd0ZXh0X3RpdGxlJ119XVNlZ21lbnQ6IHtuYW1lfVsvXSIsCiAgICAgICAgICAgICAgICBib3JkZXJfc3R5bGU9dGhlbWVbImJvcmRlcl9pbmZvIl0sCiAgICAgICAgICAgICAgICBwYWRkaW5nPSgwLCAwKSwKICAgICAgICAgICAgICAgIGV4cGFuZD1UcnVlCiAgICAgICAgICAgICkpCiAgICAgICAgCiAgICAgICAgbmF2ID0gVGFibGUoc2hvd19oZWFkZXI9RmFsc2UsIGJveD1NSU5JTUFMX0RPVUJMRV9IRUFELCBleHBhbmQ9VHJ1ZSkKICAgICAgICBuYXYuYWRkX2NvbHVtbihqdXN0aWZ5PSJyaWdodCIsIHN0eWxlPXRoZW1lWyJ0ZXh0X2tleSJdLCB3aWR0aD02KQogICAgICAgIG5hdi5hZGRfY29sdW1uKHN0eWxlPXRoZW1lWyJ0ZXh0X2JvZHkiXSkKICAgICAgICBuYXYuYWRkX3JvdygiMDAiLCBmIlt7dGhlbWVbJ3RleHRfc3ViJ119XUtlbWJhbGkga2UgbWVudSB1dGFtYVsvXSIpCiAgICAgICAgCiAgICAgICAgY29uc29sZS5wcmludChQYW5lbChuYXYsIGJvcmRlcl9zdHlsZT10aGVtZVsiYm9yZGVyX3ByaW1hcnkiXSwgZXhwYW5kPVRydWUpKQogICAgICAgIAogICAgICAgIGNob2ljZSA9IGNvbnNvbGUuaW5wdXQoZiJbe3RoZW1lWyd0ZXh0X3N1YiddfV1QaWxpaCBiYW5uZXIgKG1pc2FsIEExLCBCMik6Wy97dGhlbWVbJ3RleHRfc3ViJ119XSAiKS5zdHJpcCgpCiAgICAgICAgaWYgY2hvaWNlID09ICIwMCI6CiAgICAgICAgICAgIGluX3N0b3JlX3NlZ21lbnRzX21lbnUgPSBGYWxzZQogICAgICAgICAgICBjb250aW51ZQogICAgICAgIAogICAgICAgIHNlbGVjdGVkX3BrZyA9IHBhY2thZ2VzLmdldChjaG9pY2UubG93ZXIoKSkKICAgICAgICBpZiBub3Qgc2VsZWN0ZWRfcGtnOgogICAgICAgICAgICBwcmludF9wYW5lbCgiS2VzYWxhaGFuIiwgIlBpbGloYW4gdGlkYWsgdmFsaWQuIikKICAgICAgICAgICAgcGF1c2UoKQogICAgICAgICAgICBjb250aW51ZQogICAgICAgIAogICAgICAgIGFjdGlvbl9wYXJhbSA9IHNlbGVjdGVkX3BrZ1siYWN0aW9uX3BhcmFtIl0KICAgICAgICBhY3Rpb25fdHlwZSA9IHNlbGVjdGVkX3BrZ1siYWN0aW9uX3R5cGUiXQogICAgICAgIAogICAgICAgIGlmIGFjdGlvbl90eXBlID09ICJQRFAiOgogICAgICAgICAgICBzaG93X3BhY2thZ2VfZGV0YWlscyhhcGlfa2V5LCB0b2tlbnMsIGFjdGlvbl9wYXJhbSwgaXNfZW50ZXJwcmlzZSkKICAgICAgICBlbHNlOgogICAgICAgICAgICBwcmludF9wYW5lbCgiSW5mb3JtYXNpIiwgZiJUaWRhayBhZGEgYWtzaSB1bnR1ayB0aXBlIGluaToge2FjdGlvbl90eXBlfVxuUGFyYW06IHthY3Rpb25fcGFyYW19IikKICAgICAgICAgICAgcGF1c2UoKQo=').decode())
