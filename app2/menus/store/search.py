#!/usr/bin/env python3
import base64
exec(base64.b64decode('ZnJvbSBhcHAyLmNsaWVudC5zdG9yZS5zZWFyY2ggaW1wb3J0IGdldF9mYW1pbHlfbGlzdCwgZ2V0X3N0b3JlX3BhY2thZ2VzCmZyb20gYXBwMi5tZW51cy5wYWNrYWdlIGltcG9ydCBnZXRfcGFja2FnZXNfYnlfZmFtaWx5LCBzaG93X3BhY2thZ2VfZGV0YWlscwpmcm9tIGFwcDIubWVudXMudXRpbCBpbXBvcnQgY2xlYXJfc2NyZWVuLCBwYXVzZSwgcHJpbnRfcGFuZWwsIHNpbXBsZV9udW1iZXIsIGdldF9ydXBpYWgsIGxpdmVfbG9hZGluZwpmcm9tIGFwcC5zZXJ2aWNlLmF1dGggaW1wb3J0IEF1dGhJbnN0YW5jZQpmcm9tIGFwcDIuY29uZmlnLmltcG9ydHMgaW1wb3J0ICoKCmNvbnNvbGUgPSBDb25zb2xlKCkKCgpkZWYgc2hvd19mYW1pbHlfbGlzdF9tZW51KAogICAgc3Vic190eXBlOiBzdHIgPSAiUFJFUEFJRCIsCiAgICBpc19lbnRlcnByaXNlOiBib29sID0gRmFsc2UsCik6CiAgICAiIiJNZW5hbXBpbGthbiBkYWZ0YXIgZmFtaWx5IGxpc3QgYmVyZGFzYXJrYW4gc3Vic2NyaXB0aW9uIHR5cGUuIiIiCiAgICB0aGVtZSA9IGdldF90aGVtZSgpCiAgICBpbl9mYW1pbHlfbGlzdF9tZW51ID0gVHJ1ZQogICAgd2hpbGUgaW5fZmFtaWx5X2xpc3RfbWVudToKICAgICAgICBhcGlfa2V5ID0gQXV0aEluc3RhbmNlLmFwaV9rZXkKICAgICAgICB0b2tlbnMgPSBBdXRoSW5zdGFuY2UuZ2V0X2FjdGl2ZV90b2tlbnMoKQogICAgICAgIAogICAgICAgIGZhbWlseV9saXN0X3JlcyA9IGdldF9mYW1pbHlfbGlzdChhcGlfa2V5LCB0b2tlbnMsIHN1YnNfdHlwZSwgaXNfZW50ZXJwcmlzZSkKICAgICAgICBpZiBub3QgZmFtaWx5X2xpc3RfcmVzOgogICAgICAgICAgICBwcmludF9wYW5lbCgiSW5mb3JtYXNpIiwgIlRpZGFrIGFkYSBmYW1pbHkgbGlzdCB0ZXJzZWRpYS4iKQogICAgICAgICAgICBpbl9mYW1pbHlfbGlzdF9tZW51ID0gRmFsc2UKICAgICAgICAgICAgY29udGludWUKICAgICAgICAKICAgICAgICBmYW1pbHlfbGlzdCA9IGZhbWlseV9saXN0X3Jlcy5nZXQoImRhdGEiLCB7fSkuZ2V0KCJyZXN1bHRzIiwgW10pCiAgICAgICAgY2xlYXJfc2NyZWVuKCkKICAgICAgICBlbnN1cmVfZ2l0KCkKICAgICAgICAKICAgICAgICBjb25zb2xlLnByaW50KFBhbmVsKAogICAgICAgICAgICBBbGlnbi5jZW50ZXIoIkZhbWlseSBMaXN0IiwgdmVydGljYWw9Im1pZGRsZSIpLAogICAgICAgICAgICBib3JkZXJfc3R5bGU9dGhlbWVbImJvcmRlcl9pbmZvIl0sCiAgICAgICAgICAgIHBhZGRpbmc9KDEsIDIpLAogICAgICAgICAgICBleHBhbmQ9VHJ1ZQogICAgICAgICkpCiAgICAgICAgc2ltcGxlX251bWJlcigpCiAgICAgICAgCiAgICAgICAgdGFibGUgPSBUYWJsZShib3g9TUlOSU1BTF9ET1VCTEVfSEVBRCwgZXhwYW5kPVRydWUpCiAgICAgICAgdGFibGUuYWRkX2NvbHVtbigiTm8iLCBqdXN0aWZ5PSJyaWdodCIsIHN0eWxlPXRoZW1lWyJ0ZXh0X2tleSJdLCB3aWR0aD00KQogICAgICAgIHRhYmxlLmFkZF9jb2x1bW4oIk5hbWEgRmFtaWx5Iiwgc3R5bGU9dGhlbWVbInRleHRfYm9keSJdKQogICAgICAgIHRhYmxlLmFkZF9jb2x1bW4oIktvZGUiLCBzdHlsZT10aGVtZVsiYm9yZGVyX3dhcm5pbmciXSkKICAgICAgICAKICAgICAgICBmb3IgaSwgZmFtaWx5IGluIGVudW1lcmF0ZShmYW1pbHlfbGlzdCwgc3RhcnQ9MSk6CiAgICAgICAgICAgIHRhYmxlLmFkZF9yb3coc3RyKGkpLCBmYW1pbHkuZ2V0KCJsYWJlbCIsICJOL0EiKSwgZmFtaWx5LmdldCgiaWQiLCAiTi9BIikpCiAgICAgICAgCiAgICAgICAgY29uc29sZS5wcmludChQYW5lbCh0YWJsZSwgYm9yZGVyX3N0eWxlPXRoZW1lWyJib3JkZXJfaW5mbyJdLCBwYWRkaW5nPSgwLCAwKSwgZXhwYW5kPVRydWUpKQogICAgICAgIAogICAgICAgIG5hdiA9IFRhYmxlKHNob3dfaGVhZGVyPUZhbHNlLCBib3g9TUlOSU1BTF9ET1VCTEVfSEVBRCwgZXhwYW5kPVRydWUpCiAgICAgICAgbmF2LmFkZF9jb2x1bW4oanVzdGlmeT0icmlnaHQiLCBzdHlsZT10aGVtZVsidGV4dF9rZXkiXSwgd2lkdGg9NikKICAgICAgICBuYXYuYWRkX2NvbHVtbihzdHlsZT10aGVtZVsidGV4dF9ib2R5Il0pCiAgICAgICAgbmF2LmFkZF9yb3coIjAwIiwgZiJbe3RoZW1lWyd0ZXh0X3N1YiddfV1LZW1iYWxpIGtlIG1lbnUgdXRhbWFbL10iKQogICAgICAgIAogICAgICAgIGNvbnNvbGUucHJpbnQoUGFuZWwobmF2LCBib3JkZXJfc3R5bGU9dGhlbWVbImJvcmRlcl9wcmltYXJ5Il0sIGV4cGFuZD1UcnVlKSkKICAgICAgICAKICAgICAgICBjaG9pY2UgPSBjb25zb2xlLmlucHV0KGYiW3t0aGVtZVsndGV4dF9zdWInXX1dUGlsaWggZmFtaWx5IChub21vcik6Wy97dGhlbWVbJ3RleHRfc3ViJ119XSAiKS5zdHJpcCgpCiAgICAgICAgaWYgY2hvaWNlID09ICIwMCI6CiAgICAgICAgICAgIGluX2ZhbWlseV9saXN0X21lbnUgPSBGYWxzZQogICAgICAgICAgICBjb250aW51ZQogICAgICAgIGlmIGNob2ljZS5pc2RpZ2l0KCkgYW5kIDEgPD0gaW50KGNob2ljZSkgPD0gbGVuKGZhbWlseV9saXN0KToKICAgICAgICAgICAgc2VsZWN0ZWRfZmFtaWx5ID0gZmFtaWx5X2xpc3RbaW50KGNob2ljZSkgLSAxXQogICAgICAgICAgICBmYW1pbHlfY29kZSA9IHNlbGVjdGVkX2ZhbWlseS5nZXQoImlkIiwgIiIpCiAgICAgICAgICAgIGZhbWlseV9uYW1lID0gc2VsZWN0ZWRfZmFtaWx5LmdldCgibGFiZWwiLCAiTi9BIikKICAgICAgICAgICAgY29uc29sZS5wcmludChQYW5lbChmIk1lbmNhcmkgcGFrZXQgdW50dWsgZmFtaWx5OiB7ZmFtaWx5X25hbWV9IiwgYm9yZGVyX3N0eWxlPXRoZW1lWyJib3JkZXJfaW5mbyJdKSkKICAgICAgICAgICAgZ2V0X3BhY2thZ2VzX2J5X2ZhbWlseShmYW1pbHlfY29kZSkKICAgICAgICBlbHNlOgogICAgICAgICAgICBwcmludF9wYW5lbCgiS2VzYWxhaGFuIiwgIlBpbGloYW4gdGlkYWsgdmFsaWQuIikKICAgICAgICAgICAgcGF1c2UoKQoKCmRlZiBzaG93X3N0b3JlX3BhY2thZ2VzX21lbnUoCiAgICBzdWJzX3R5cGU6IHN0ciA9ICJQUkVQQUlEIiwKICAgIGlzX2VudGVycHJpc2U6IGJvb2wgPSBGYWxzZSwKKToKICAgICIiIk1lbmFtcGlsa2FuIGRhZnRhciBwYWtldCB5YW5nIHRlcnNlZGlhIGRpIHN0b3JlLiIiIgogICAgdGhlbWUgPSBnZXRfdGhlbWUoKQogICAgaW5fc3RvcmVfcGFja2FnZXNfbWVudSA9IFRydWUKICAgIHdoaWxlIGluX3N0b3JlX3BhY2thZ2VzX21lbnU6CiAgICAgICAgYXBpX2tleSA9IEF1dGhJbnN0YW5jZS5hcGlfa2V5CiAgICAgICAgdG9rZW5zID0gQXV0aEluc3RhbmNlLmdldF9hY3RpdmVfdG9rZW5zKCkKICAgICAgICAKICAgICAgICBzdG9yZV9wYWNrYWdlc19yZXMgPSBnZXRfc3RvcmVfcGFja2FnZXMoYXBpX2tleSwgdG9rZW5zLCBzdWJzX3R5cGUsIGlzX2VudGVycHJpc2UpCiAgICAgICAgaWYgbm90IHN0b3JlX3BhY2thZ2VzX3JlczoKICAgICAgICAgICAgcHJpbnRfcGFuZWwoIkluZm9ybWFzaSIsICJUaWRhayBhZGEgcGFrZXQgdGVyc2VkaWEgZGkgc3RvcmUuIikKICAgICAgICAgICAgaW5fc3RvcmVfcGFja2FnZXNfbWVudSA9IEZhbHNlCiAgICAgICAgICAgIGNvbnRpbnVlCiAgICAgICAgCiAgICAgICAgc3RvcmVfcGFja2FnZXMgPSBzdG9yZV9wYWNrYWdlc19yZXMuZ2V0KCJkYXRhIiwge30pLmdldCgicmVzdWx0c19wcmljZV9vbmx5IiwgW10pCiAgICAgICAgY2xlYXJfc2NyZWVuKCkKICAgICAgICBlbnN1cmVfZ2l0KCkKICAgICAgICAKICAgICAgICBjb25zb2xlLnByaW50KFBhbmVsKAogICAgICAgICAgICBBbGlnbi5jZW50ZXIoIlN0b3JlIFBhY2thZ2VzIiwgdmVydGljYWw9Im1pZGRsZSIpLAogICAgICAgICAgICBib3JkZXJfc3R5bGU9dGhlbWVbImJvcmRlcl9pbmZvIl0sCiAgICAgICAgICAgIHBhZGRpbmc9KDEsIDIpLAogICAgICAgICAgICBleHBhbmQ9VHJ1ZQogICAgICAgICkpCiAgICAgICAgc2ltcGxlX251bWJlcigpCgogICAgICAgIHdpdGggbGl2ZV9sb2FkaW5nKCJNZW55dXN1biB0YWJlbCBwYWtldC4uLiIsIHRoZW1lKToKICAgICAgICAgICAgdGFibGUgPSBUYWJsZShib3g9TUlOSU1BTF9ET1VCTEVfSEVBRCwgZXhwYW5kPVRydWUpCiAgICAgICAgICAgIHRhYmxlLmFkZF9jb2x1bW4oIk5vIiwganVzdGlmeT0icmlnaHQiLCBzdHlsZT10aGVtZVsidGV4dF9rZXkiXSwgd2lkdGg9NCkKICAgICAgICAgICAgdGFibGUuYWRkX2NvbHVtbigiUGFrZXQiLCBzdHlsZT10aGVtZVsidGV4dF9ib2R5Il0pCiAgICAgICAgICAgIHRhYmxlLmFkZF9jb2x1bW4oIkZhbWlseSIsIHN0eWxlPXRoZW1lWyJ0ZXh0X2JvZHkiXSkKICAgICAgICAgICAgdGFibGUuYWRkX2NvbHVtbigiQWt0aWYiLCBzdHlsZT10aGVtZVsidGV4dF9kYXRlIl0pCiAgICAgICAgICAgIHRhYmxlLmFkZF9jb2x1bW4oIkhhcmdhIiwgc3R5bGU9dGhlbWVbInRleHRfbW9uZXkiXSwganVzdGlmeT0icmlnaHQiKQogICAgICAgICAgICAKICAgICAgICAgICAgcGFja2FnZXMgPSB7fQogICAgICAgICAgICBmb3IgaSwgcGFja2FnZSBpbiBlbnVtZXJhdGUoc3RvcmVfcGFja2FnZXMsIHN0YXJ0PTEpOgogICAgICAgICAgICAgICAgdGl0bGUgPSBwYWNrYWdlLmdldCgidGl0bGUiLCAiTi9BIikKICAgICAgICAgICAgICAgIG9yaWdpbmFsX3ByaWNlID0gcGFja2FnZS5nZXQoIm9yaWdpbmFsX3ByaWNlIiwgMCkKICAgICAgICAgICAgICAgIGRpc2NvdW50ZWRfcHJpY2UgPSBwYWNrYWdlLmdldCgiZGlzY291bnRlZF9wcmljZSIsIDApCiAgICAgICAgICAgICAgICB2YWxpZGl0eSA9IHBhY2thZ2UuZ2V0KCJ2YWxpZGl0eSIsICJOL0EiKQogICAgICAgICAgICAgICAgZmFtaWx5X25hbWUgPSBwYWNrYWdlLmdldCgiZmFtaWx5X25hbWUiLCAiTi9BIikKICAgICAgICAgICAgICAgIGFjdGlvbl90eXBlID0gcGFja2FnZS5nZXQoImFjdGlvbl90eXBlIiwgIiIpCiAgICAgICAgICAgICAgICBhY3Rpb25fcGFyYW0gPSBwYWNrYWdlLmdldCgiYWN0aW9uX3BhcmFtIiwgIiIpCiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIHBhY2thZ2VzW3N0cihpKV0gPSB7ImFjdGlvbl90eXBlIjogYWN0aW9uX3R5cGUsICJhY3Rpb25fcGFyYW0iOiBhY3Rpb25fcGFyYW19CiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIGlmIGRpc2NvdW50ZWRfcHJpY2UgYW5kIGRpc2NvdW50ZWRfcHJpY2UgPiAwOgogICAgICAgICAgICAgICAgICAgIGhhcmdhX3N0ciA9IGYie2dldF9ydXBpYWgob3JpZ2luYWxfcHJpY2UpfSDinqEge2dldF9ydXBpYWgoZGlzY291bnRlZF9wcmljZSl9IgogICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICBoYXJnYV9zdHIgPSBnZXRfcnVwaWFoKG9yaWdpbmFsX3ByaWNlKQogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICB0YWJsZS5hZGRfcm93KHN0cihpKSwgdGl0bGUsIGZhbWlseV9uYW1lLCB2YWxpZGl0eSwgaGFyZ2Ffc3RyKQogICAgICAgIAogICAgICAgIGNvbnNvbGUucHJpbnQoUGFuZWwodGFibGUsIGJvcmRlcl9zdHlsZT10aGVtZVsiYm9yZGVyX2luZm8iXSwgcGFkZGluZz0oMCwgMCksIGV4cGFuZD1UcnVlKSkKICAgICAgICAKICAgICAgICBuYXYgPSBUYWJsZShzaG93X2hlYWRlcj1GYWxzZSwgYm94PU1JTklNQUxfRE9VQkxFX0hFQUQsIGV4cGFuZD1UcnVlKQogICAgICAgIG5hdi5hZGRfY29sdW1uKGp1c3RpZnk9InJpZ2h0Iiwgc3R5bGU9dGhlbWVbInRleHRfa2V5Il0sIHdpZHRoPTYpCiAgICAgICAgbmF2LmFkZF9jb2x1bW4oc3R5bGU9dGhlbWVbInRleHRfYm9keSJdKQogICAgICAgIG5hdi5hZGRfcm93KCIwMCIsIGYiW3t0aGVtZVsndGV4dF9zdWInXX1dS2VtYmFsaSBrZSBtZW51IHV0YW1hWy9dIikKICAgICAgICAKICAgICAgICBjb25zb2xlLnByaW50KFBhbmVsKG5hdiwgYm9yZGVyX3N0eWxlPXRoZW1lWyJib3JkZXJfcHJpbWFyeSJdLCBleHBhbmQ9VHJ1ZSkpCiAgICAgICAgCiAgICAgICAgY2hvaWNlID0gY29uc29sZS5pbnB1dChmIlt7dGhlbWVbJ3RleHRfc3ViJ119XVBpbGloIHBha2V0IChub21vcik6Wy97dGhlbWVbJ3RleHRfc3ViJ119XSAiKS5zdHJpcCgpCiAgICAgICAgaWYgY2hvaWNlID09ICIwMCI6CiAgICAgICAgICAgIGluX3N0b3JlX3BhY2thZ2VzX21lbnUgPSBGYWxzZQogICAgICAgICAgICBjb250aW51ZQogICAgICAgIGVsaWYgY2hvaWNlIGluIHBhY2thZ2VzOgogICAgICAgICAgICBzZWxlY3RlZCA9IHBhY2thZ2VzW2Nob2ljZV0KICAgICAgICAgICAgaWYgc2VsZWN0ZWRbImFjdGlvbl90eXBlIl0gPT0gIlBEUCI6CiAgICAgICAgICAgICAgICBzaG93X3BhY2thZ2VfZGV0YWlscyhhcGlfa2V5LCB0b2tlbnMsIHNlbGVjdGVkWyJhY3Rpb25fcGFyYW0iXSwgaXNfZW50ZXJwcmlzZSkKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHByaW50X3BhbmVsKCJJbmZvcm1hc2kiLCBmIlRpZGFrIGFkYSBha3NpIHVudHVrIHRpcGUgaW5pOiB7c2VsZWN0ZWRbJ2FjdGlvbl90eXBlJ119XG5QYXJhbToge3NlbGVjdGVkWydhY3Rpb25fcGFyYW0nXX0iKQogICAgICAgICAgICAgICAgcGF1c2UoKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHByaW50X3BhbmVsKCJLZXNhbGFoYW4iLCAiUGlsaWhhbiB0aWRhayB2YWxpZC4iKQogICAgICAgICAgICBwYXVzZSgpCg==').decode())
