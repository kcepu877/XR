#!/usr/bin/env python3
import base64
exec(base64.b64decode('ZnJvbSBhcHAyLmNsaWVudC5zdG9yZS5yZWRlZW1hYmxlcyBpbXBvcnQgZ2V0X3JlZGVlbWFibGVzCmZyb20gYXBwLnNlcnZpY2UuYXV0aCBpbXBvcnQgQXV0aEluc3RhbmNlCmZyb20gYXBwMi5tZW51cy51dGlsIGltcG9ydCBjbGVhcl9zY3JlZW4sIHBhdXNlLCBwcmludF9wYW5lbCwgc2ltcGxlX251bWJlcgpmcm9tIGFwcDIubWVudXMucGFja2FnZSBpbXBvcnQgc2hvd19wYWNrYWdlX2RldGFpbHMsIGdldF9wYWNrYWdlc19ieV9mYW1pbHkKZnJvbSBhcHAyLmNvbmZpZy5pbXBvcnRzIGltcG9ydCAqCmZyb20gZGF0ZXRpbWUgaW1wb3J0IGRhdGV0aW1lCgpjb25zb2xlID0gQ29uc29sZSgpCgoKZGVmIHNob3dfcmVkZWVtYWJsZXNfbWVudShpc19lbnRlcnByaXNlOiBib29sID0gRmFsc2UpOgogICAgIiIiTWVuYW1waWxrYW4gbWVudSByZWRlZW1hYmxlcyAoYm9udXMvcmV3YXJkKSB5YW5nIHRlcnNlZGlhLiIiIgogICAgdGhlbWUgPSBnZXRfdGhlbWUoKQogICAgaW5fcmVkZWVtYWJsZXNfbWVudSA9IFRydWUKICAgIHdoaWxlIGluX3JlZGVlbWFibGVzX21lbnU6CiAgICAgICAgYXBpX2tleSA9IEF1dGhJbnN0YW5jZS5hcGlfa2V5CiAgICAgICAgdG9rZW5zID0gQXV0aEluc3RhbmNlLmdldF9hY3RpdmVfdG9rZW5zKCkKICAgICAgICAKICAgICAgICByZWRlZW1hYmxlc19yZXMgPSBnZXRfcmVkZWVtYWJsZXMoYXBpX2tleSwgdG9rZW5zLCBpc19lbnRlcnByaXNlKQogICAgICAgIGlmIG5vdCByZWRlZW1hYmxlc19yZXM6CiAgICAgICAgICAgIHByaW50X3BhbmVsKCJJbmZvcm1hc2kiLCAiVGlkYWsgYWRhIHJlZGVlbWFibGVzIHRlcnNlZGlhLiIpCiAgICAgICAgICAgIGluX3JlZGVlbWFibGVzX21lbnUgPSBGYWxzZQogICAgICAgICAgICBjb250aW51ZQogICAgICAgIAogICAgICAgIGNhdGVnb3JpZXMgPSByZWRlZW1hYmxlc19yZXMuZ2V0KCJkYXRhIiwge30pLmdldCgiY2F0ZWdvcmllcyIsIFtdKQogICAgICAgIGNsZWFyX3NjcmVlbigpCiAgICAgICAgZW5zdXJlX2dpdCgpCiAgICAgICAgCiAgICAgICAgY29uc29sZS5wcmludChQYW5lbCgKICAgICAgICAgICAgQWxpZ24uY2VudGVyKCJSZWRlZW1hYmxlcyIsIHZlcnRpY2FsPSJtaWRkbGUiKSwKICAgICAgICAgICAgYm9yZGVyX3N0eWxlPXRoZW1lWyJib3JkZXJfaW5mbyJdLAogICAgICAgICAgICBwYWRkaW5nPSgxLCAyKSwKICAgICAgICAgICAgZXhwYW5kPVRydWUKICAgICAgICApKQogICAgICAgIHNpbXBsZV9udW1iZXIoKQogICAgICAgIAogICAgICAgIHBhY2thZ2VzID0ge30KICAgICAgICBmb3IgaSwgY2F0ZWdvcnkgaW4gZW51bWVyYXRlKGNhdGVnb3JpZXMpOgogICAgICAgICAgICBjYXRlZ29yeV9uYW1lID0gY2F0ZWdvcnkuZ2V0KCJjYXRlZ29yeV9uYW1lIiwgIk4vQSIpCiAgICAgICAgICAgIGNhdGVnb3J5X2NvZGUgPSBjYXRlZ29yeS5nZXQoImNhdGVnb3J5X2NvZGUiLCAiTi9BIikKICAgICAgICAgICAgcmVkZWVtYWJsZXMgPSBjYXRlZ29yeS5nZXQoInJlZGVlbWFibGVzIiwgW10pCiAgICAgICAgICAgIAogICAgICAgICAgICBsZXR0ZXIgPSBjaHIoNjUgKyBpKQogICAgICAgICAgICB0YWJsZSA9IFRhYmxlKGJveD1NSU5JTUFMX0RPVUJMRV9IRUFELCBleHBhbmQ9VHJ1ZSkKICAgICAgICAgICAgdGFibGUuYWRkX2NvbHVtbigiS29kZSIsIHN0eWxlPXRoZW1lWyJ0ZXh0X2tleSJdLCB3aWR0aD02KQogICAgICAgICAgICB0YWJsZS5hZGRfY29sdW1uKCJOYW1hIEJhcmFuZyIsIHN0eWxlPXRoZW1lWyJ0ZXh0X2JvZHkiXSkKICAgICAgICAgICAgdGFibGUuYWRkX2NvbHVtbigiQmVybGFrdSIsIHN0eWxlPXRoZW1lWyJ0ZXh0X2RhdGUiXSkKICAgICAgICAgICAgdGFibGUuYWRkX2NvbHVtbigiVGlwZSIsIHN0eWxlPXRoZW1lWyJ0ZXh0X2JvZHkiXSkKICAgICAgICAgICAgCiAgICAgICAgICAgIGlmIG5vdCByZWRlZW1hYmxlczoKICAgICAgICAgICAgICAgIHRhYmxlLmFkZF9yb3coIi0iLCBmIntjYXRlZ29yeV9uYW1lfSAoa29zb25nKSIsICItIiwgIi0iKQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgZm9yIGosIHJlZGVlbWFibGUgaW4gZW51bWVyYXRlKHJlZGVlbWFibGVzKToKICAgICAgICAgICAgICAgICAgICBuYW1lID0gcmVkZWVtYWJsZS5nZXQoIm5hbWUiLCAiTi9BIikKICAgICAgICAgICAgICAgICAgICB2YWxpZF91bnRpbCA9IHJlZGVlbWFibGUuZ2V0KCJ2YWxpZF91bnRpbCIsIDApCiAgICAgICAgICAgICAgICAgICAgdmFsaWRfdW50aWxfZGF0ZSA9IGRhdGV0aW1lLmZyb210aW1lc3RhbXAodmFsaWRfdW50aWwpLnN0cmZ0aW1lKCIlWS0lbS0lZCIpCiAgICAgICAgICAgICAgICAgICAgYWN0aW9uX3BhcmFtID0gcmVkZWVtYWJsZS5nZXQoImFjdGlvbl9wYXJhbSIsICIiKQogICAgICAgICAgICAgICAgICAgIGFjdGlvbl90eXBlID0gcmVkZWVtYWJsZS5nZXQoImFjdGlvbl90eXBlIiwgIiIpCiAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgY29kZSA9IGYie2xldHRlcn17aisxfSIKICAgICAgICAgICAgICAgICAgICBwYWNrYWdlc1tjb2RlLmxvd2VyKCldID0gewogICAgICAgICAgICAgICAgICAgICAgICAiYWN0aW9uX3BhcmFtIjogYWN0aW9uX3BhcmFtLAogICAgICAgICAgICAgICAgICAgICAgICAiYWN0aW9uX3R5cGUiOiBhY3Rpb25fdHlwZQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB0YWJsZS5hZGRfcm93KGNvZGUsIG5hbWUsIHZhbGlkX3VudGlsX2RhdGUsIGFjdGlvbl90eXBlKQogICAgICAgICAgICAKICAgICAgICAgICAgY29uc29sZS5wcmludChQYW5lbCgKICAgICAgICAgICAgICAgIHRhYmxlLAogICAgICAgICAgICAgICAgdGl0bGU9ZiJbe3RoZW1lWyd0ZXh0X3RpdGxlJ119XUthdGVnb3JpOiB7Y2F0ZWdvcnlfbmFtZX1bL10gKEtvZGU6IHtjYXRlZ29yeV9jb2RlfSkiLAogICAgICAgICAgICAgICAgYm9yZGVyX3N0eWxlPXRoZW1lWyJib3JkZXJfaW5mbyJdLAogICAgICAgICAgICAgICAgcGFkZGluZz0oMCwgMCksCiAgICAgICAgICAgICAgICBleHBhbmQ9VHJ1ZQogICAgICAgICAgICApKQogICAgICAgIAogICAgICAgIG5hdiA9IFRhYmxlKHNob3dfaGVhZGVyPUZhbHNlLCBib3g9TUlOSU1BTF9ET1VCTEVfSEVBRCwgZXhwYW5kPVRydWUpCiAgICAgICAgbmF2LmFkZF9jb2x1bW4oanVzdGlmeT0icmlnaHQiLCBzdHlsZT10aGVtZVsidGV4dF9rZXkiXSwgd2lkdGg9NikKICAgICAgICBuYXYuYWRkX2NvbHVtbihzdHlsZT10aGVtZVsidGV4dF9ib2R5Il0pCiAgICAgICAgbmF2LmFkZF9yb3coIjAwIiwgZiJbe3RoZW1lWyd0ZXh0X3N1YiddfV1LZW1iYWxpIGtlIG1lbnUgdXRhbWFbL10iKQogICAgICAgIAogICAgICAgIGNvbnNvbGUucHJpbnQoUGFuZWwobmF2LCBib3JkZXJfc3R5bGU9dGhlbWVbImJvcmRlcl9wcmltYXJ5Il0sIGV4cGFuZD1UcnVlKSkKICAgICAgICAKICAgICAgICBjaG9pY2UgPSBjb25zb2xlLmlucHV0KGYiW3t0aGVtZVsndGV4dF9zdWInXX1dUGlsaWggcmVkZWVtYWJsZSAobWlzYWwgQTEsIEIyKTpbL3t0aGVtZVsndGV4dF9zdWInXX1dICIpLnN0cmlwKCkKICAgICAgICBpZiBjaG9pY2UgPT0gIjAwIjoKICAgICAgICAgICAgaW5fcmVkZWVtYWJsZXNfbWVudSA9IEZhbHNlCiAgICAgICAgICAgIGNvbnRpbnVlCiAgICAgICAgCiAgICAgICAgc2VsZWN0ZWRfcGtnID0gcGFja2FnZXMuZ2V0KGNob2ljZS5sb3dlcigpKQogICAgICAgIGlmIG5vdCBzZWxlY3RlZF9wa2c6CiAgICAgICAgICAgIHByaW50X3BhbmVsKCJLZXNhbGFoYW4iLCAiUGlsaWhhbiB0aWRhayB2YWxpZC4iKQogICAgICAgICAgICBwYXVzZSgpCiAgICAgICAgICAgIGNvbnRpbnVlCiAgICAgICAgCiAgICAgICAgYWN0aW9uX3BhcmFtID0gc2VsZWN0ZWRfcGtnWyJhY3Rpb25fcGFyYW0iXQogICAgICAgIGFjdGlvbl90eXBlID0gc2VsZWN0ZWRfcGtnWyJhY3Rpb25fdHlwZSJdCiAgICAgICAgCiAgICAgICAgaWYgYWN0aW9uX3R5cGUgPT0gIlBMUCI6CiAgICAgICAgICAgIGdldF9wYWNrYWdlc19ieV9mYW1pbHkoYWN0aW9uX3BhcmFtLCBpc19lbnRlcnByaXNlLCAiIikKICAgICAgICBlbGlmIGFjdGlvbl90eXBlID09ICJQRFAiOgogICAgICAgICAgICBzaG93X3BhY2thZ2VfZGV0YWlscyhhcGlfa2V5LCB0b2tlbnMsIGFjdGlvbl9wYXJhbSwgaXNfZW50ZXJwcmlzZSkKICAgICAgICBlbHNlOgogICAgICAgICAgICBwcmludF9wYW5lbCgiSW5mb3JtYXNpIiwgZiJUaWRhayBhZGEgYWtzaSB1bnR1ayB0aXBlIGluaToge2FjdGlvbl90eXBlfVxuUGFyYW06IHthY3Rpb25fcGFyYW19IikKICAgICAgICAgICAgcGF1c2UoKQo=').decode())
